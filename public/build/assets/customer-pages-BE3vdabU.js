import{_ as me,u as we}from"./admin-pages-C_NGfial.js";import{c as Fe,u as se,d as Ne,e as ve}from"./utils-CcZu3SrZ.js";import{i as o,j as e,x as s,c as ce,K as ae,e as Ae,f as qe,ai as te,o as Y,k as p,t,u as m,F as U,l as O,n as $,ad as X,ae as le,m as re,y as B,z as Z,A as $e,g as xe,aa as Te,q as L,N as ke,r as S,H as I,I as Q,J as W,w as pe,aw as Ie,a4 as Le,R as ye,av as Ue,X as ze,T as he,h as Be,a9 as Oe,al as Ce,ax as je,D as oe,L as de,ay as Ge,a3 as He,a1 as Xe,U as Ke,a6 as Qe,M as Ee,az as Pe,C as We,b as Je,S as ge,E as De,aA as Se,aB as ue,G as Re,W as Ve,V as Ze,P as Ye}from"./vue-core-BXnTE0w7.js";import{P as et,_ as Me,A as tt}from"./common-components-C44zC4g7.js";import{i as st,d as ot}from"./vendor-Cg4W4xsk.js";const rt={name:"PhoneInput",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"NumÃ©ro de tÃ©lÃ©phone"},preferredCountries:{type:Array,default:()=>["ga","cm","ci","cg","cf","td","gq","bf","bj","tg","fr","ca"]},initialCountry:{type:String,default:"ga"}},data(){return{phoneNumber:this.modelValue,iti:null}},watch:{phoneNumber(R){this.$emit("update:modelValue",R)},modelValue(R){R!==this.phoneNumber&&(this.phoneNumber=R,this.iti&&this.$refs.phoneInput&&R&&this.iti.setNumber(R))}},mounted(){this.initializeIntlTelInput()},beforeUnmount(){this.iti&&this.iti.destroy()},methods:{initializeIntlTelInput(){const R=this.$refs.phoneInput;this.iti=st(R,{preferredCountries:this.preferredCountries,initialCountry:this.initialCountry,separateDialCode:!0,customPlaceholder:(A,N)=>A}),R.addEventListener("input",A=>{this.phoneNumber=A.target.value,this.emitAllData()}),R.addEventListener("countrychange",()=>{this.emitAllData()}),setTimeout(()=>{this.modelValue&&this.iti.setNumber(this.modelValue),this.emitAllData()},100)},emitAllData(){if(this.iti&&this.iti.getSelectedCountryData)try{const R=this.iti.getSelectedCountryData(),A=this.phoneNumber||"";let N="";A.trim()&&(A.startsWith("+")?N=A:N=`+${R.dialCode}${A}`);const P=this.validatePhoneNumber(A,R);this.$emit("update:modelValue",N),console.log("PhoneInput emitting:",{number:A,fullNumber:N,countryCode:R.dialCode,countryIso2:R.iso2,isValid:P}),this.$emit("phone-change",{number:A,fullNumber:N,countryCode:R.dialCode,countryIso2:R.iso2,isValid:P})}catch(R){console.warn("PhoneInput: Error emitting data",R)}},emitPhoneData(){this.emitAllData()},validatePhoneNumber(R,A){if(!R||!R.trim())return!1;const P={ga:{min:7,max:8},cm:{min:8,max:9},ci:{min:8,max:10},fr:{min:9,max:10},ca:{min:10,max:10},cg:{min:8,max:9},cf:{min:8,max:8},td:{min:8,max:8},gq:{min:9,max:9},bf:{min:8,max:8},bj:{min:8,max:8},tg:{min:8,max:8}}[A.iso2]||{min:7,max:15},D=R.replace(/[^\d]/g,"");return D.length>=P.min&&D.length<=P.max},getNumber(){if(this.iti&&this.iti.getSelectedCountryData){const R=this.iti.getSelectedCountryData(),A=this.phoneNumber||"";if(A.trim())return A.startsWith("+")?A:`+${R.dialCode}${A}`}return""},isValidNumber(){if(this.iti&&this.iti.getSelectedCountryData){const R=this.iti.getSelectedCountryData();return this.validatePhoneNumber(this.phoneNumber,R)}return!1},setNumber(R){this.iti&&(this.iti.setNumber(R),this.phoneNumber=R,this.emitAllData())}}},lt={class:"phone-input-wrapper"},at=["placeholder"];function nt(R,A,N,P,D,a){return s(),o("div",lt,[e("input",{ref:"phoneInput",type:"tel",class:"form-control",placeholder:N.placeholder},null,8,at)])}const it=me(rt,[["render",nt],["__scopeId","data-v-118cdfc2"]]),dt={class:"mb-8"},ut={class:"text-3xl font-bold text-gray-900"},ct={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},mt={class:"flex items-center"},pt={class:"ml-4"},gt={class:"text-sm font-medium text-gray-600"},vt={class:"text-2xl font-bold text-gray-900"},xt={key:0,class:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4"},yt={class:"flex"},bt={class:"ml-3"},ft={class:"mt-1 text-sm text-red-700"},_t={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-8"},ht={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},wt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},$t={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},kt={class:"flex justify-between items-center mb-4"},Ct={key:0,class:"text-center py-8"},jt={key:1,class:"space-y-4"},Et=["src","alt"],Pt={class:"flex-1"},Mt={class:"font-medium text-gray-900"},At={class:"text-sm text-gray-600"},Tt={class:"text-xs text-gray-500"},Dt={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},St={class:"flex justify-between items-center mb-4"},Rt={class:"space-y-4"},Vt={class:"flex items-start space-x-4"},Ft=["src","alt"],Nt={class:"flex-1"},qt={class:"font-medium text-gray-900 mb-1"},It={class:"text-sm text-gray-600 mb-2"},Lt={class:"mb-3"},Ut={class:"flex justify-between text-sm text-gray-600 mb-1"},zt={class:"w-full bg-gray-200 rounded-full h-2"},Bt={class:"flex justify-between items-center"},Ot={class:"text-xs text-gray-500"},B0={__name:"Dashboard",setup(R){const A=we(),{stats:N,recentTickets:P,activeLotteries:D,loading:a,error:C,loadDashboardData:j,formatDate:d}=Fe(),g={TicketIcon:te,GiftIcon:qe,CurrencyDollarIcon:Ae,TrophyIcon:ae},F=ce(()=>N.value.map(V=>({...V,icon:g[V.icon]||te}))),_=V=>({active:"Actif",won:"GagnÃ©",lost:"Perdu",pending:"En attente"})[V]||V,k=async()=>{await j()};return Y(async()=>{await j()}),(V,h)=>{const q=le("router-link");return s(),o("div",null,[e("div",dt,[e("h1",ut," Bonjour "+t(m(A).user?.first_name)+" ! ",1),h[0]||(h[0]=e("p",{class:"mt-2 text-gray-600"}," Voici un aperÃ§u de vos activitÃ©s sur la plateforme ",-1))]),e("div",ct,[m(a)?(s(),o(U,{key:0},O(4,x=>e("div",{key:x,class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 animate-pulse"},h[1]||(h[1]=[re('<div class="flex items-center"><div class="p-3 rounded-lg bg-gray-200"></div><div class="ml-4 flex-1"><div class="h-4 bg-gray-200 rounded w-20 mb-2"></div><div class="h-6 bg-gray-200 rounded w-16"></div></div></div>',1)]))),64)):(s(!0),o(U,{key:1},O(F.value,x=>(s(),o("div",{key:x.label,class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-200"},[e("div",mt,[e("div",{class:B(["p-3 rounded-lg",x.color])},[(s(),Z($e(x.icon),{class:"w-6 h-6 text-white"}))],2),e("div",pt,[e("p",gt,t(x.label),1),e("p",vt,t(x.value),1)])])]))),128))]),m(C)&&!m(a)?(s(),o("div",xt,[e("div",yt,[e("div",bt,[h[2]||(h[2]=e("h3",{class:"text-sm font-medium text-red-800"},"Erreur de chargement",-1)),e("p",ft,t(m(C)),1),e("button",{onClick:k,class:"mt-2 text-sm bg-red-100 hover:bg-red-200 text-red-800 px-3 py-1 rounded"}," RÃ©essayer ")])])])):p("",!0),e("div",_t,[h[6]||(h[6]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Actions rapides",-1)),e("div",ht,[$(q,{to:"/customer/products",class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-[#0099cc] hover:bg-blue-50 transition-colors"},{default:X(()=>[$(m(xe),{class:"w-8 h-8 text-[#0099cc] mr-3"}),h[3]||(h[3]=e("div",null,[e("p",{class:"font-medium text-gray-900"},"Acheter des tickets"),e("p",{class:"text-sm text-gray-600"},"DÃ©couvrir les produits disponibles")],-1))]),_:1,__:[3]}),$(q,{to:"/customer/tickets",class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-black hover:bg-gray-50 transition-colors"},{default:X(()=>[$(m(te),{class:"w-8 h-8 text-black mr-3"}),h[4]||(h[4]=e("div",null,[e("p",{class:"font-medium text-gray-900"},"Mes tickets"),e("p",{class:"text-sm text-gray-600"},"Voir mes participations")],-1))]),_:1,__:[4]}),$(q,{to:"/customer/profile",class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-[#0099cc] hover:bg-blue-50 transition-colors"},{default:X(()=>[$(m(Te),{class:"w-8 h-8 text-[#0099cc] mr-3"}),h[5]||(h[5]=e("div",null,[e("p",{class:"font-medium text-gray-900"},"Mon profil"),e("p",{class:"text-sm text-gray-600"},"GÃ©rer mes informations")],-1))]),_:1,__:[5]})])]),e("div",wt,[e("div",$t,[e("div",kt,[h[8]||(h[8]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Mes derniers tickets",-1)),$(q,{to:"/customer/tickets",class:"text-sm text-[#0099cc] hover:text-blue-700"},{default:X(()=>h[7]||(h[7]=[L(" Voir tout ",-1)])),_:1,__:[7]})]),m(P).length===0?(s(),o("div",Ct,[$(m(te),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),h[10]||(h[10]=e("p",{class:"text-gray-600"},"Aucun ticket achetÃ© pour le moment",-1)),$(q,{to:"/customer/products",class:"inline-block mt-2 text-[#0099cc] hover:text-blue-700"},{default:X(()=>h[9]||(h[9]=[L(" Acheter des tickets ",-1)])),_:1,__:[9]})])):(s(),o("div",jt,[(s(!0),o(U,null,O(m(P),x=>(s(),o("div",{key:x.id,class:"flex items-center space-x-4 p-3 border border-gray-200 rounded-lg"},[e("img",{src:x.product.image_url||x.product.main_image||x.product.image,alt:x.product.title,class:"w-12 h-12 rounded-lg object-cover"},null,8,Et),e("div",Pt,[e("p",Mt,t(x.product.title),1),e("p",At,t(x.quantity)+" ticket"+t(x.quantity>1?"s":"")+" - "+t(x.total_price)+" FCFA ",1),e("p",Tt,t(m(d)(x.purchased_at)),1)]),e("span",{class:B(["px-2 py-1 text-xs font-medium rounded-full",x.status==="active"?"bg-[#0099cc] text-white":x.status==="won"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},t(_(x.status)),3)]))),128))]))]),e("div",Dt,[e("div",St,[h[12]||(h[12]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Tombolas populaires",-1)),$(q,{to:"/customer/products",class:"text-sm text-[#0099cc] hover:text-blue-700"},{default:X(()=>h[11]||(h[11]=[L(" Voir tout ",-1)])),_:1,__:[11]})]),e("div",Rt,[(s(!0),o(U,null,O(m(D),x=>(s(),o("div",{key:x.id,class:"border border-gray-200 rounded-lg p-4 hover:border-[#0099cc] transition-colors"},[e("div",Vt,[e("img",{src:x.product.image_url||x.product.main_image||x.product.image,alt:x.product.title,class:"w-16 h-16 rounded-lg object-cover"},null,8,Ft),e("div",Nt,[e("h4",qt,t(x.product.title),1),e("p",It,t(x.product.price)+" FCFA",1),e("div",Lt,[e("div",Ut,[h[13]||(h[13]=e("span",null,"Progression",-1)),e("span",null,t(x.progress)+"%",1)]),e("div",zt,[e("div",{class:"bg-[#0099cc] h-2 rounded-full transition-all duration-300",style:ke({width:x.progress+"%"})},null,4)])]),e("div",Bt,[e("span",Ot," Tirage le "+t(m(d)(x.draw_date)),1),$(q,{to:`/customer/products/${x.product.id}`,class:"text-sm bg-[#0099cc] text-white px-3 py-1 rounded-md hover:bg-blue-700 transition-colors"},{default:X(()=>h[14]||(h[14]=[L(" Participer ",-1)])),_:2,__:[14]},1032,["to"])])])])]))),128))])])])])}}},Gt={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-6 product-filter"},Ht={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4"},Xt={key:0,disabled:""},Kt=["value"],Qt={key:0,class:"text-center py-12"},Wt={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Jt={key:2,class:"text-center py-12"},Zt={key:3,class:"mt-8 flex justify-center"},Yt={class:"flex space-x-2"},es=["disabled"],ts={class:"px-4 py-2 text-gray-700"},ss=["disabled"],_e=9,O0={__name:"Products",setup(R){const{get:A,loading:N}=se();S(!0);const P=S([]),D=S([]),a=pe(),C=S(1),j=S({search:"",category:"",saleMode:"",maxPrice:""}),d=ce(()=>{const x=(C.value-1)*_e,b=x+_e;return P.value.slice(x,b)}),g=ce(()=>Math.ceil(P.value.length/_e)),F=async()=>{try{const x=new URLSearchParams;j.value.search&&x.append("search",j.value.search),j.value.category&&x.append("category_id",j.value.category),j.value.saleMode&&x.append("sale_mode",j.value.saleMode),j.value.maxPrice&&x.append("max_price",j.value.maxPrice);const b=x.toString()?`/products?${x.toString()}`:"/products",n=await A(b);n&&n.success&&n.data&&(P.value=n.data.products||n.data||[],C.value=1)}catch(x){console.error("Erreur lors du chargement des produits:",x),P.value=[]}},_=async()=>{try{console.log("Customer - Chargement des catÃ©gories...");const x=await A("/categories");console.log("Customer - RÃ©ponse API categories:",x),x&&x.success?(D.value=x.data||[],console.log("Customer - CatÃ©gories chargÃ©es:",D.value.length)):(console.log("Customer - Structure de rÃ©ponse inattendue:",x),D.value=x?.data||x||[])}catch(x){console.error("Customer - Erreur lors du chargement des catÃ©gories:",x),D.value=[]}},k=()=>{j.value={search:"",category:"",saleMode:"",maxPrice:""},F()},V=ot(()=>{F()},300),h=()=>{F()},q=x=>{a.push({name:"customer.product.detail",params:{id:x.id}})};return Y(async()=>{await Promise.all([F(),_()])}),(x,b)=>(s(),o("div",null,[b[18]||(b[18]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Produits disponibles"),e("p",{class:"mt-2 text-gray-600"},"DÃ©couvrez tous les produits que vous pouvez gagner")],-1)),e("div",Gt,[e("div",Ht,[e("div",null,[b[7]||(b[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rechercher",-1)),I(e("input",{"onUpdate:modelValue":b[0]||(b[0]=n=>j.value.search=n),onInput:b[1]||(b[1]=(...n)=>m(V)&&m(V)(...n)),type:"text",placeholder:"Nom du produit...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 placeholder-gray-500 bg-white"},null,544),[[Q,j.value.search]])]),e("div",null,[b[9]||(b[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type de vente",-1)),I(e("select",{"onUpdate:modelValue":b[2]||(b[2]=n=>j.value.saleMode=n),onChange:h,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white"},b[8]||(b[8]=[e("option",{value:""},"Tous les types",-1),e("option",{value:"direct"},"Achat direct",-1),e("option",{value:"lottery"},"Tombola",-1)]),544),[[W,j.value.saleMode]])]),e("div",null,[b[11]||(b[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"CatÃ©gorie",-1)),I(e("select",{"onUpdate:modelValue":b[3]||(b[3]=n=>j.value.category=n),onChange:h,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white"},[b[10]||(b[10]=e("option",{value:""},"Toutes les catÃ©gories",-1)),D.value.length===0?(s(),o("option",Xt,"Aucune catÃ©gorie disponible")):p("",!0),(s(!0),o(U,null,O(D.value,n=>(s(),o("option",{key:n.id,value:n.id},t(n.name),9,Kt))),128))],544),[[W,j.value.category]])]),e("div",null,[b[13]||(b[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prix max",-1)),I(e("select",{"onUpdate:modelValue":b[4]||(b[4]=n=>j.value.maxPrice=n),onChange:h,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white"},b[12]||(b[12]=[re('<option value="">Tous les prix</option><option value="100000">100,000 FCFA</option><option value="500000">500,000 FCFA</option><option value="1000000">1,000,000 FCFA</option><option value="2000000">2,000,000+ FCFA</option>',5)]),544),[[W,j.value.maxPrice]])]),e("div",{class:"flex items-end"},[e("button",{onClick:k,class:"w-full px-4 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"}," RÃ©initialiser ")])])]),m(N)?(s(),o("div",Qt,b[14]||(b[14]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement des produits...",-1)]))):(s(),o("div",Wt,[(s(!0),o(U,null,O(d.value,n=>(s(),Z(et,{key:n.id,product:n,onViewProduct:q},null,8,["product"]))),128))])),!m(N)&&P.value.length===0?(s(),o("div",Jt,[$(m(xe),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),b[15]||(b[15]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Aucun produit trouvÃ©",-1)),b[16]||(b[16]=e("p",{class:"text-gray-600"},"Essayez de modifier vos filtres de recherche",-1))])):p("",!0),g.value>1?(s(),o("div",Zt,[e("nav",Yt,[e("button",{onClick:b[5]||(b[5]=n=>C.value=Math.max(1,C.value-1)),disabled:C.value===1,class:"px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"}," PrÃ©cÃ©dent ",8,es),e("span",ts," Page "+t(C.value)+" sur "+t(g.value),1),e("button",{onClick:b[6]||(b[6]=n=>C.value=Math.min(g.value,C.value+1)),disabled:C.value===g.value,class:"px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"}," Suivant ",8,ss)])])):p("",!0),p("",!0)]))}},os={key:0,class:"text-center py-12"},rs={key:1,class:"max-w-7xl mx-auto"},ls={class:"mb-6"},as={class:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"},ns={class:"relative"},is={class:"absolute top-4 left-4"},ds={key:0,class:"absolute top-4 right-4"},us={key:0,class:"grid grid-cols-4 gap-2 mt-4"},cs={class:"mb-6"},ms={class:"text-3xl font-bold text-gray-900 mb-4"},ps={class:"text-lg text-gray-600 mb-4"},gs={class:"flex items-center space-x-4 mb-6"},vs={class:"text-center"},xs={class:"text-3xl font-bold text-blue-600"},ys={class:"text-sm text-gray-500"},bs={key:0,class:"text-center"},fs={class:"text-xl font-semibold text-gray-900"},_s={key:0,class:"mb-6"},hs={class:"flex justify-between text-sm text-gray-600 mb-2"},ws={class:"w-full bg-gray-200 rounded-full h-3"},$s={class:"flex justify-between text-xs text-gray-500 mt-1"},ks={key:1,class:"mb-6 p-4 bg-gray-50 rounded-lg"},Cs={class:"flex items-center mb-2"},js={class:"font-medium text-gray-900"},Es={class:"flex items-center"},Ps={class:"text-gray-600"},Ms={class:"bg-white border border-gray-200 rounded-xl p-6 mb-6"},As={key:0},Ts={class:"flex items-center space-x-4 mb-4"},Ds={class:"flex items-center space-x-2"},Ss=["disabled"],Rs=["max"],Vs=["disabled"],Fs={class:"flex justify-between items-center mb-4"},Ns={class:"text-2xl font-bold text-blue-600"},qs=["disabled"],Is={key:0},Ls={key:1},Us={key:2},zs={key:1},Bs={class:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200"},Os={class:"flex items-center mb-2"},Gs={class:"flex justify-between items-center mb-6"},Hs={class:"text-3xl font-bold text-blue-600"},Xs=["disabled"],Ks={key:0},Qs={class:"mb-8"},Ws={class:"border-b border-gray-200 mb-6"},Js={class:"flex space-x-8"},Zs=["onClick"],Ys={key:0,class:"prose max-w-none"},eo={class:"text-gray-600 leading-relaxed"},to={key:0,class:"space-y-2"},so={class:"text-gray-600"},oo={key:1,class:"prose max-w-none"},ro={key:2},lo={class:"text-lg font-semibold mb-3"},ao={key:0,class:"text-center py-8"},no={key:1,class:"space-y-3"},io={class:"flex items-center"},uo={class:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white text-sm font-medium"},co={class:"ml-3 text-gray-900"},mo={class:"text-sm text-gray-600"},po={key:2,class:"text-center py-12"},G0={__name:"ProductDetail",setup(R){const A=Ce(),N=pe(),{get:P,post:D,loading:a}=se(),C=we(),j=S(!1),d=S(null),g=S(1),F=S("description"),_=S(""),k=S([]),V=[{key:"description",label:"Description"},{key:"rules",label:"RÃ¨gles"},{key:"participants",label:"Participants"}],h=ce(()=>d.value&&(d.value.lottery||d.value.active_lottery)&&(d.value.lottery?.total_tickets>0||d.value.active_lottery?.total_tickets>0)),q=ce(()=>{if(!d.value)return 0;const l=d.value.lottery||d.value.active_lottery;return l?(l.ticket_price||d.value.ticket_price||0)*g.value:0}),x=()=>{if(!d.value)return 0;const l=d.value.lottery||d.value.active_lottery;if(!l)return 0;const u=l.sold_tickets||0,J=l.total_tickets||1;return Math.round(u/J*100)},b=l=>l==null||isNaN(l)?"0":new Intl.NumberFormat("fr-FR").format(Number(l)),n=()=>{const l=d.value.lottery||d.value.active_lottery,u=(l?.total_tickets||0)-(l?.sold_tickets||0);g.value<u&&g.value++},r=()=>{g.value>1&&g.value--},v=l=>{if(!l)return"";const u=new Date(l);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(u)},w=l=>{if(!l)return"";const u=new Date,z=new Date(l)-u,G=Math.floor(z/(1e3*60*60*24));if(G>7)return`Plus de ${G} jours restants`;if(G>0)return`${G} jour${G>1?"s":""} restant${G>1?"s":""}`;{const ne=Math.floor(z/36e5);return ne>0?`${ne}h restantes`:"Se termine bientÃ´t"}},y=l=>({active:"Actif",ending_soon:"BientÃ´t terminÃ©",completed:"TerminÃ©"})[l]||l,c=async()=>{j.value=!0;try{const l=d.value.lottery||d.value.active_lottery,J=(l?.ticket_price||d.value.ticket_price||0)*g.value,z=C.user?.phone;if(!z){window.$toast&&window.$toast.error("Veuillez ajouter un numÃ©ro de tÃ©lÃ©phone Ã  votre profil avant d'effectuer un achat.","ðŸ“± TÃ©lÃ©phone requis");return}const G=await D("/tickets/purchase",{lottery_id:l?.id,quantity:g.value,phone_number:z,total_amount:J});if(G&&G.success)window.$toast&&window.$toast.success(G.message||"Commande crÃ©Ã©e avec succÃ¨s !","âœ… Commande crÃ©Ã©e"),N.push({path:"/payment/method",query:{transaction_id:G.data.transaction_id,amount:J,lottery_id:l?.id,quantity:g.value}});else throw new Error(G?.message||"Erreur lors de la crÃ©ation de la commande")}catch(l){console.error("Error purchasing tickets:",l);const u=l.response?.data?.message||l.message||"Erreur lors de l'achat des tickets";window.$toast&&window.$toast.error(""+u," Erreur d'achat")}finally{j.value=!1}},H=async()=>{j.value=!0;try{const l=await D("/payments/initiate",{product_id:d.value.id,type:"product_purchase",amount:d.value.price});if(l&&l.success)l.redirect_to_payment?N.push({name:"payment.method",query:{transaction_id:l.data.transaction_id,amount:l.data.amount,type:"product"}}):(window.$toast&&window.$toast.success("ðŸŽ‰ Produit achetÃ© avec succÃ¨s ! Vous recevrez une confirmation par SMS.","âœ… Achat confirmÃ©"),await M());else throw new Error(l?.message||"Erreur lors de l'achat")}catch(l){console.error("Error purchasing product directly:",l);const u=l.response?.data?.message||l.message||"Erreur lors de l'achat";window.$toast&&window.$toast.error(" "+u," Erreur d'achat")}finally{j.value=!1}},M=async()=>{try{const l=A.params.id;console.log("Loading product ID:",l);const u=await P(`/products/${l}`);console.log("Product API response:",u),u&&u.success&&u.data?(d.value=u.data,_.value=d.value.image||"/images/products/placeholder.jpg",(d.value.lottery||d.value.active_lottery)&&await E()):u&&u.data?(d.value=u.data,_.value=d.value.image||"/images/products/placeholder.jpg"):(console.error("Product not found in response:",u),d.value=null)}catch(l){console.error("Error loading product:",l),d.value=null}},E=async()=>{try{const l=d.value.lottery||d.value.active_lottery;l&&(console.log("Participants endpoint not available yet for lottery:",l.id),k.value=[])}catch(l){console.error("Error loading participants:",l),k.value=[]}};return Y(()=>{M()}),(l,u)=>{const J=le("router-link");return m(a)?(s(),o("div",os,u[1]||(u[1]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement du produit...",-1)]))):d.value?(s(),o("div",rs,[e("div",ls,[$(J,{to:"/customer/products",class:"inline-flex items-center text-gray-600 hover:text-gray-900"},{default:X(()=>[$(m(je),{class:"w-5 h-5 mr-2"}),u[2]||(u[2]=L(" Retour aux produits ",-1))]),_:1,__:[2]})]),e("div",as,[e("div",null,[e("div",ns,[$(Me,{src:d.value.image_url||d.value.main_image||d.value.image,alt:d.value.title||d.value.name,"container-class":"w-full h-96 rounded-xl overflow-hidden","image-class":"w-full h-96 object-cover","fallback-text":"Image non disponible"},null,8,["src","alt"]),e("div",is,[e("span",{class:B(["px-3 py-1 text-sm font-medium rounded-full",d.value.status==="active"?"bg-blue-100 text-blue-800":d.value.status==="ending_soon"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},t(y(d.value.status)),3)]),d.value.featured?(s(),o("div",ds,[$(m(Ie),{class:"w-8 h-8 text-yellow-500 fill-current"})])):p("",!0)]),d.value.gallery&&d.value.gallery.length>0?(s(),o("div",us,[(s(!0),o(U,null,O(d.value.gallery,(z,G)=>(s(),Z(Me,{key:G,src:z,alt:`${d.value.title||d.value.name} ${G+1}`,"container-class":"w-full h-20 rounded-lg overflow-hidden cursor-pointer hover:opacity-75 transition-opacity","image-class":"w-full h-20 object-cover",onClick:ne=>_.value=z},null,8,["src","alt","onClick"]))),128))])):p("",!0)]),e("div",null,[e("div",cs,[e("h1",ms,t(d.value.title||d.value.name),1),e("p",ps,t(d.value.description),1),e("div",gs,[e("div",vs,[e("div",xs,t(b(d.value.price))+" FCFA",1),e("div",ys,t(h.value?"Valeur du produit":"Prix"),1)]),h.value?(s(),o("div",bs,[e("div",fs,t(b(d.value.lottery?.ticket_price||d.value.active_lottery?.ticket_price||d.value.ticket_price||0))+" FCFA",1),u[3]||(u[3]=e("div",{class:"text-sm text-gray-500"},"Prix par ticket",-1))])):p("",!0)]),h.value?(s(),o("div",_s,[e("div",hs,[u[4]||(u[4]=e("span",null,"Progression de la tombola",-1)),e("span",null,t(x())+"% ("+t(d.value.lottery?.sold_tickets||d.value.active_lottery?.sold_tickets||0)+"/"+t(d.value.lottery?.total_tickets||d.value.active_lottery?.total_tickets||0)+")",1)]),e("div",ws,[e("div",{class:"bg-blue-600 h-3 rounded-full transition-all duration-300",style:ke({width:x()+"%"})},null,4)]),e("div",$s,[u[5]||(u[5]=e("span",null,"0 tickets",-1)),e("span",null,t(d.value.lottery?.total_tickets||d.value.active_lottery?.total_tickets||0)+" tickets",1)])])):p("",!0),h.value?(s(),o("div",ks,[e("div",Cs,[$(m(Le),{class:"w-5 h-5 text-gray-600 mr-2"}),e("span",js,"Date de tirage: "+t(v(d.value.lottery?.draw_date||d.value.active_lottery?.draw_date)),1)]),e("div",Es,[$(m(ye),{class:"w-5 h-5 text-gray-600 mr-2"}),e("span",Ps,t(w(d.value.lottery?.draw_date||d.value.active_lottery?.draw_date)),1)])])):p("",!0)]),e("div",Ms,[h.value?(s(),o("div",As,[u[8]||(u[8]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Acheter des tickets",-1)),e("div",Ts,[u[6]||(u[6]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nombre de tickets:",-1)),e("div",Ds,[e("button",{onClick:r,class:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50",disabled:g.value<=1},[$(m(Ue),{class:"w-4 h-4"})],8,Ss),I(e("input",{"onUpdate:modelValue":u[0]||(u[0]=z=>g.value=z),type:"number",min:"1",max:(d.value.lottery?.total_tickets||d.value.active_lottery?.total_tickets||0)-(d.value.lottery?.sold_tickets||d.value.active_lottery?.sold_tickets||0),class:"w-20 text-center border border-gray-300 rounded-md py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,Rs),[[Q,g.value]]),e("button",{onClick:n,class:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50",disabled:g.value>=(d.value.lottery?.total_tickets||0)-(d.value.lottery?.sold_tickets||0)},[$(m(ze),{class:"w-4 h-4"})],8,Vs)])]),e("div",Fs,[u[7]||(u[7]=e("span",{class:"text-gray-600"},"Total Ã  payer:",-1)),e("span",Ns,t(b(q.value))+" FCFA",1)]),e("button",{onClick:c,disabled:j.value||d.value.status!=="active",class:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[j.value?(s(),o("span",Is,"Achat en cours...")):d.value.status!=="active"?(s(),o("span",Ls,"Tombola terminÃ©e")):(s(),o("span",Us,"Acheter "+t(g.value)+" ticket"+t(g.value>1?"s":""),1))],8,qs)])):(s(),o("div",zs,[u[14]||(u[14]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Acheter ce produit",-1)),e("div",Bs,[e("div",Os,[$(m(he),{class:"w-5 h-5 text-[#0099cc] mr-2"}),u[9]||(u[9]=e("span",{class:"font-medium text-blue-900"},"Achat direct disponible",-1))]),u[10]||(u[10]=e("p",{class:"text-sm text-blue-700"}," Ce produit peut Ãªtre achetÃ© directement sans passer par une tombola. ",-1))]),e("div",Gs,[u[11]||(u[11]=e("span",{class:"text-gray-600 text-lg"},"Prix:",-1)),e("span",Hs,t(d.value.price)+" FCFA",1)]),e("button",{onClick:H,disabled:j.value,class:"w-full bg-[#0099cc] text-white py-3 rounded-lg font-medium hover:bg-[#0088bb] transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center space-x-2"},[j.value?(s(),o("span",Ks,"Achat en cours...")):(s(),o(U,{key:1},[u[12]||(u[12]=e("span",null,"ðŸ›’",-1)),u[13]||(u[13]=e("span",null,"Acheter maintenant",-1))],64))],8,Xs)]))])])]),e("div",Qs,[e("div",Ws,[e("nav",Js,[(s(),o(U,null,O(V,z=>e("button",{key:z.key,onClick:G=>F.value=z.key,class:B(["py-2 px-1 border-b-2 font-medium text-sm",F.value===z.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},t(z.label),11,Zs)),64))])]),F.value==="description"?(s(),o("div",Ys,[u[15]||(u[15]=e("h3",{class:"text-lg font-semibold mb-3"},"Description dÃ©taillÃ©e",-1)),e("p",eo,t(d.value.detailed_description||d.value.description),1),u[16]||(u[16]=e("h4",{class:"text-md font-semibold mt-6 mb-3"},"CaractÃ©ristiques",-1)),d.value.features?(s(),o("ul",to,[(s(!0),o(U,null,O(d.value.features,z=>(s(),o("li",{key:z,class:"flex items-center"},[$(m(he),{class:"w-5 h-5 text-blue-500 mr-2 flex-shrink-0"}),e("span",so,t(z),1)]))),128))])):p("",!0)])):p("",!0),F.value==="rules"?(s(),o("div",oo,u[17]||(u[17]=[e("h3",{class:"text-lg font-semibold mb-3"},"RÃ¨gles de la tombola",-1),e("div",{class:"space-y-4 text-gray-600"},[e("p",null,"â€¢ Chaque ticket achetÃ© vous donne une chance de gagner ce produit"),e("p",null,"â€¢ Le tirage aura lieu Ã  la date indiquÃ©e une fois tous les tickets vendus"),e("p",null,"â€¢ Le gagnant sera choisi de maniÃ¨re alÃ©atoire et Ã©quitable"),e("p",null,"â€¢ Vous serez notifiÃ© par email et SMS si vous gagnez"),e("p",null,"â€¢ Les prix non rÃ©clamÃ©s dans les 30 jours seront remis en jeu")],-1)]))):p("",!0),F.value==="participants"?(s(),o("div",ro,[e("h3",lo,"Participants ("+t(d.value.sold_tickets)+")",1),k.value.length===0?(s(),o("div",ao,[$(m(Be),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),u[18]||(u[18]=e("p",{class:"text-gray-600"},"Soyez le premier Ã  participer !",-1))])):(s(),o("div",no,[(s(!0),o(U,null,O(k.value,z=>(s(),o("div",{key:z.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("div",io,[e("div",uo,t(z.name.charAt(0).toUpperCase()),1),e("span",co,t(z.name),1)]),e("span",mo,t(z.tickets)+" ticket"+t(z.tickets>1?"s":""),1)]))),128))]))])):p("",!0)])])):(s(),o("div",po,[$(m(Oe),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),u[20]||(u[20]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Produit introuvable",-1)),u[21]||(u[21]=e("p",{class:"text-gray-600 mb-4"},"Le produit que vous cherchez n'existe pas ou a Ã©tÃ© supprimÃ©",-1)),$(J,{to:"/customer/products",class:"inline-block bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"},{default:X(()=>u[19]||(u[19]=[L(" Retour aux produits ",-1)])),_:1,__:[19]})]))}}},go={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},vo={class:"lg:col-span-1"},xo={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},yo={class:"text-center mb-6"},bo={class:"mt-4 text-lg font-semibold text-gray-900"},fo={class:"text-sm text-gray-600"},_o={class:"space-y-1"},ho=["onClick"],wo={class:"lg:col-span-2"},$o={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},ko={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Co={class:"mt-6 flex justify-end"},jo=["disabled"],Eo={key:0},Po={key:1},Mo={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Ao={class:"space-y-4"},To={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Do={class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-600"},So={class:"mt-6 flex justify-end"},Ro=["disabled"],Vo={key:0},Fo={key:1},No={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},qo={class:"space-y-6"},Io={class:"border-b border-gray-200 pb-6"},Lo=["disabled"],Uo={key:0},zo={key:1},Bo={class:"border-b border-gray-200 pb-6"},Oo={class:"flex justify-between items-start"},Go={class:"space-y-3"},Ho={class:"flex items-center"},Xo={class:"font-medium text-gray-900"},Ko={class:"text-sm text-gray-600"},Qo={class:"flex items-center"},Wo={key:0,class:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full mr-3"},Jo=["onClick"],Zo={key:3,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Yo={class:"space-y-6"},er={class:"text-lg font-medium text-gray-900 mb-3"},tr={class:"space-y-3"},sr={class:"flex-1"},or={class:"font-medium text-gray-900"},rr={class:"text-sm text-gray-600"},lr={class:"ml-4 flex space-x-4"},ar={class:"flex items-center"},nr=["onUpdate:modelValue"],ir={class:"flex items-center"},dr=["onUpdate:modelValue"],ur={class:"mt-6 flex justify-end"},cr=["disabled"],mr={key:0},pr={key:1},H0={__name:"Profile",setup(R){we();const{get:A,put:N,post:P}=se(),D=S("personal"),a=S(!1),C=S(!1),j=S(!1),d=S(!1),g=S(null),F=[{key:"personal",label:"Informations personnelles",icon:Te},{key:"address",label:"Adresse",icon:Ge},{key:"security",label:"SÃ©curitÃ©",icon:He},{key:"notifications",label:"Notifications",icon:Xe}],_=oe({id:null,first_name:"",last_name:"",email:"",phone:"",birth_date:"",gender:"",avatar:null,two_factor_enabled:!1,address:{address:"",city:"",postal_code:"",country_id:null,state:""}}),k=oe({first_name:_.first_name,last_name:_.last_name,email:_.email,phone:_.phone,birth_date:_.birth_date,gender:_.gender}),V=oe({address:_.address.address,city:_.address.city,postal_code:_.address.postal_code,country_id:_.address.country_id}),h=oe({current_password:"",new_password:"",confirm_password:""}),q=S([]),x=S([]),b=[{key:"lottery",title:"Tombolas",notifications:[{key:"draw_results",title:"RÃ©sultats des tirages",description:"ÃŠtre notifiÃ© des rÃ©sultats des tombolas auxquelles vous participez"},{key:"new_lottery",title:"Nouvelles tombolas",description:"ÃŠtre informÃ© des nouveaux produits mis en tombola"},{key:"ending_soon",title:"Fin de tombola",description:"Rappel quand une tombola se termine bientÃ´t"}]},{key:"account",title:"Compte",notifications:[{key:"login",title:"Nouvelle connexion",description:"ÃŠtre alertÃ© des nouvelles connexions Ã  votre compte"},{key:"profile_update",title:"Modification du profil",description:"Confirmation des modifications de votre profil"}]}],n=oe({draw_results:{email:!0,sms:!0},new_lottery:{email:!0,sms:!1},ending_soon:{email:!0,sms:!0},login:{email:!0,sms:!1},profile_update:{email:!0,sms:!1}}),r=async()=>{if(!k.first_name||!k.first_name.trim()){window.$toast&&window.$toast.error("Le prÃ©nom est requis","âŒ Validation");return}if(!k.last_name||!k.last_name.trim()){window.$toast&&window.$toast.error("Le nom de famille est requis","âŒ Validation");return}if(!k.email||!k.email.trim()){window.$toast&&window.$toast.error("L'email est requis","âŒ Validation");return}a.value=!0;try{console.log("Updating personal info with data:",k);const f=await N("/user/profile",k);if(console.log("Update personal info response:",f),f&&f.success)Object.assign(_,k),window.$toast&&window.$toast.success("Informations personnelles mises Ã  jour avec succÃ¨s","âœ… Profil mis Ã  jour");else throw new Error(f?.message||"Erreur lors de la mise Ã  jour")}catch(f){if(console.error("Error updating personal info:",f),console.error("Error details:",f.response?.data),f.response?.status===422&&f.response?.data?.errors){const i=f.response.data.errors,T=[];Object.keys(i).forEach(K=>{i[K].forEach(be=>{let ie=be;be.includes("validation.required")&&(ie=`${{first_name:"Le prÃ©nom",last_name:"Le nom de famille",email:"L'email",phone:"Le tÃ©lÃ©phone"}[K]||K} est requis`),T.push(ie)})}),window.$toast&&window.$toast.error(T.join(", "),"âŒ Erreurs de validation")}else window.$toast&&window.$toast.error("Erreur lors de la mise Ã  jour: "+(f.response?.data?.message||f.message),"âŒ Erreur")}finally{a.value=!1}},v=async()=>{const f={first_name:k.first_name||_.first_name||"",last_name:k.last_name||_.last_name||"",email:k.email||_.email||"",phone:k.phone||_.phone||"",birth_date:k.birth_date||_.birth_date||null,gender:k.gender||_.gender||null,...V};if(!f.first_name||!f.first_name.trim()){window.$toast&&window.$toast.error("Le prÃ©nom est requis pour mettre Ã  jour l'adresse","âŒ Validation");return}if(!f.last_name||!f.last_name.trim()){window.$toast&&window.$toast.error("Le nom de famille est requis pour mettre Ã  jour l'adresse","âŒ Validation");return}C.value=!0;try{console.log("Updating address with data:",f);const i=await N("/user/profile",f);if(console.log("Update address response:",i),i&&i.success)Object.assign(_,V),window.$toast&&window.$toast.success("Adresse mise Ã  jour avec succÃ¨s","âœ… Adresse");else throw new Error(i?.message||"Erreur lors de la mise Ã  jour")}catch(i){if(console.error("Error updating address:",i),console.error("Error details:",i.response?.data),i.response?.status===422&&i.response?.data?.errors){const T=i.response.data.errors,K=[];Object.keys(T).forEach(ee=>{T[ee].forEach(ie=>{let fe=ie;ie.includes("validation.required")&&(fe=`${{first_name:"Le prÃ©nom",last_name:"Le nom de famille",email:"L'email",phone:"Le tÃ©lÃ©phone",address:"L'adresse",city:"La ville",postal_code:"Le code postal",country:"Le pays"}[ee]||ee} est requis`),K.push(fe)})}),window.$toast&&window.$toast.error(K.join(", "),"âŒ Erreurs de validation")}else window.$toast&&window.$toast.error("Erreur lors de la mise Ã  jour de l'adresse: "+(i.response?.data?.message||i.message),"âŒ Erreur")}finally{C.value=!1}},w=async()=>{if(h.new_password!==h.confirm_password){window.$toast&&window.$toast.error("Les mots de passe ne correspondent pas","âŒ Erreur de validation");return}j.value=!0;try{const f=await N("/user/password",{current_password:h.current_password,new_password:h.new_password,new_password_confirmation:h.confirm_password});if(f&&f.success)Object.assign(h,{current_password:"",new_password:"",confirm_password:""}),window.$toast&&window.$toast.success("Mot de passe mis Ã  jour avec succÃ¨s","âœ… SÃ©curitÃ©");else throw new Error(f?.message||"Erreur lors de la mise Ã  jour")}catch(f){console.error("Error updating password:",f),window.$toast&&window.$toast.error("Erreur lors de la mise Ã  jour du mot de passe","âŒ Erreur")}finally{j.value=!1}},y=async()=>{d.value=!0;try{const f=await N("/user/preferences/detailed",{email_notifications:{lottery_results:n.draw_results.email,new_lotteries:n.new_lottery.email,ending_soon:n.ending_soon.email,account_updates:n.profile_update.email,login_alerts:n.login.email},sms_notifications:{lottery_results:n.draw_results.sms,new_lotteries:n.new_lottery.sms,ending_soon:n.ending_soon.sms,account_updates:n.profile_update.sms,login_alerts:n.login.sms},push_notifications:!0,marketing_emails:!0});if(f&&f.success)window.$toast&&window.$toast.success("PrÃ©fÃ©rences de notifications mises Ã  jour","âœ… Notifications");else throw new Error(f?.message||"Erreur lors de la mise Ã  jour")}catch(f){console.error("Error updating notifications:",f),window.$toast&&window.$toast.error("Erreur lors de la mise Ã  jour des notifications","âŒ Erreur")}finally{d.value=!1}},c=async()=>{try{const f=await P("/user/2fa/toggle",{enabled:!_.two_factor_enabled});if(f&&f.success)_.two_factor_enabled=!_.two_factor_enabled,window.$toast&&window.$toast.success(`Authentification Ã  deux facteurs ${_.two_factor_enabled?"activÃ©e":"dÃ©sactivÃ©e"}`,"âœ… SÃ©curitÃ© mise Ã  jour");else throw new Error(f?.message||"Erreur lors de la modification")}catch(f){console.error("Error toggling two-factor authentication:",f),window.$toast&&window.$toast.error("Erreur lors de la modification de l'authentification Ã  deux facteurs","âŒ Erreur")}},H=async f=>{try{const i=await P(`/user/sessions/${f}/revoke`);if(i&&i.success)x.value=x.value.filter(T=>T.id!==f),window.$toast&&window.$toast.success("Session rÃ©voquÃ©e avec succÃ¨s","âœ… SÃ©curitÃ©");else throw new Error(i?.message||"Erreur lors de la rÃ©vocation")}catch(i){console.error("Error revoking session:",i),window.$toast&&window.$toast.error("Erreur lors de la rÃ©vocation de la session","âŒ Erreur")}},M=()=>`https://ui-avatars.com/api/?name=${encodeURIComponent((_.first_name||"")+"+"+(_.last_name||""))}&background=3b82f6&color=ffffff&size=128`,E=async f=>{console.log("Avatar upload success:",f),_.avatar_url=f.avatar_url,window.$toast&&window.$toast.success("Photo de profil mise Ã  jour avec succÃ¨s","âœ… Avatar"),await u()},l=f=>{console.error("Avatar upload error:",f),window.$toast&&window.$toast.error("Erreur lors de l'upload de l'avatar","âŒ Erreur")},u=async()=>{try{const f=await A("/user/profile");if(console.log("Profile API response:",f),f&&f.success&&f.data&&f.data.user){const i=f.data.user;Object.assign(_,i),Object.assign(k,{first_name:i.first_name||"",last_name:i.last_name||"",email:i.email||"",phone:i.phone||"",birth_date:i.birth_date||"",gender:i.gender||""}),Object.assign(V,{address:i.address||"",city:i.city||"",postal_code:i.postal_code||"",country_id:i.country_id||null}),console.log("User data loaded:",i),console.log("Personal form:",k),console.log("Address form:",V),setTimeout(()=>{g.value&&k.phone&&g.value.setNumber(k.phone)},100)}else if(f&&f.data){const i=f.data;Object.assign(_,i),Object.assign(k,{first_name:i.first_name||"",last_name:i.last_name||"",email:i.email||"",phone:i.phone||"",birth_date:i.birth_date||"",gender:i.gender||""}),Object.assign(V,{address:i.address||"",city:i.city||"",postal_code:i.postal_code||"",country_id:i.country_id||null}),setTimeout(()=>{g.value&&k.phone&&g.value.setNumber(k.phone)},100)}}catch(f){console.error("Error loading user profile:",f)}},J=async()=>{try{const f=await A("/countries");f&&f.data&&(q.value=f.data)}catch(f){console.error("Error loading countries:",f)}},z=async()=>{try{const f=await A("/user/preferences");if(f&&f.data&&f.data.preferences){const i=f.data.preferences;i.email_notifications&&(n.draw_results.email=i.email_notifications.lottery_results||!0,n.new_lottery.email=i.email_notifications.new_lotteries||!0,n.ending_soon.email=i.email_notifications.ending_soon||!0,n.profile_update.email=i.email_notifications.account_updates||!0,n.login.email=i.email_notifications.login_alerts||!0),i.sms_notifications&&(n.draw_results.sms=i.sms_notifications.lottery_results||!1,n.new_lottery.sms=i.sms_notifications.new_lotteries||!1,n.ending_soon.sms=i.sms_notifications.ending_soon||!1,n.profile_update.sms=i.sms_notifications.account_updates||!1,n.login.sms=i.sms_notifications.login_alerts||!1)}}catch(f){console.error("Error loading user preferences:",f)}},G=f=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(f)),ne=async()=>{try{const f=await A("/user/sessions");f&&f.data&&f.data.sessions&&(x.value=f.data.sessions.map(i=>({id:i.id,device_name:i.user_agent?.includes("Mobile")?"Mobile":"Desktop",device_type:i.user_agent?.includes("Mobile")?"mobile":"desktop",location:`${i.city||"Inconnue"}, ${i.country||"Inconnue"}`,last_active:i.last_activity,is_current:i.is_current})))}catch(f){console.error("Error loading sessions:",f)}};return Y(async()=>{await Promise.all([u(),J(),z(),ne()])}),(f,i)=>(s(),o("div",null,[i[36]||(i[36]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Mon profil"),e("p",{class:"mt-2 text-gray-600"},"GÃ©rez vos informations personnelles et prÃ©fÃ©rences")],-1)),e("div",go,[e("div",vo,[e("div",xo,[e("div",yo,[$(tt,{"current-avatar-url":_.avatar_url||M(),"upload-endpoint":"/user/avatar","field-name":"avatar","alt-text":`Photo de profil de ${_.first_name} ${_.last_name}`,"help-text":"Cliquez pour modifier votre photo de profil","max-size-m-b":5,onSuccess:E,onError:l},null,8,["current-avatar-url","alt-text"]),e("h3",bo,t(_.first_name)+" "+t(_.last_name),1),e("p",fo,t(_.email),1)]),e("nav",_o,[(s(),o(U,null,O(F,T=>e("button",{key:T.key,onClick:K=>D.value=T.key,class:B(["w-full flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors",D.value===T.key?"bg-blue-50 text-blue-600 border-r-2 border-blue-600":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"])},[(s(),Z($e(T.icon),{class:"w-5 h-5 mr-3"})),L(" "+t(T.label),1)],10,ho)),64))])])]),e("div",wo,[D.value==="personal"?(s(),o("div",$o,[i[19]||(i[19]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Informations personnelles",-1)),e("form",{onSubmit:de(r,["prevent"])},[e("div",ko,[e("div",null,[i[12]||(i[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[L(" PrÃ©nom "),e("span",{class:"text-red-500"},"*")],-1)),I(e("input",{"onUpdate:modelValue":i[0]||(i[0]=T=>k.first_name=T),type:"text",required:"",placeholder:"Votre prÃ©nom",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[Q,k.first_name]])]),e("div",null,[i[13]||(i[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[L(" Nom "),e("span",{class:"text-red-500"},"*")],-1)),I(e("input",{"onUpdate:modelValue":i[1]||(i[1]=T=>k.last_name=T),type:"text",required:"",placeholder:"Votre nom de famille",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[Q,k.last_name]])]),e("div",null,[i[14]||(i[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[L(" Email "),e("span",{class:"text-red-500"},"*")],-1)),I(e("input",{"onUpdate:modelValue":i[2]||(i[2]=T=>k.email=T),type:"email",required:"",placeholder:"votre@email.com",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[Q,k.email]])]),e("div",null,[i[15]||(i[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"TÃ©lÃ©phone",-1)),$(it,{ref_key:"phoneInputRef",ref:g,modelValue:k.phone,"onUpdate:modelValue":i[3]||(i[3]=T=>k.phone=T),class:"w-full","initial-country":"ga","preferred-countries":["ga","cm","ci","cg","cf","td","gq","bf","bj","tg","fr","ca"]},null,8,["modelValue"])]),e("div",null,[i[16]||(i[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de naissance",-1)),I(e("input",{"onUpdate:modelValue":i[4]||(i[4]=T=>k.birth_date=T),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[Q,k.birth_date]])]),e("div",null,[i[18]||(i[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Genre",-1)),I(e("select",{"onUpdate:modelValue":i[5]||(i[5]=T=>k.gender=T),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},i[17]||(i[17]=[e("option",{value:""},"SÃ©lectionner...",-1),e("option",{value:"male"},"Homme",-1),e("option",{value:"female"},"Femme",-1),e("option",{value:"other"},"Autre",-1)]),512),[[W,k.gender]])])]),e("div",Co,[e("button",{type:"submit",disabled:a.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400"},[a.value?(s(),o("span",Eo,"Mise Ã  jour...")):(s(),o("span",Po,"Mettre Ã  jour"))],8,jo)])],32)])):p("",!0),D.value==="address"?(s(),o("div",Mo,[i[25]||(i[25]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Adresse",-1)),e("form",{onSubmit:de(v,["prevent"])},[e("div",Ao,[e("div",null,[i[20]||(i[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Adresse",-1)),I(e("input",{"onUpdate:modelValue":i[6]||(i[6]=T=>V.address=T),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[Q,V.address]])]),e("div",To,[e("div",null,[i[21]||(i[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Ville",-1)),I(e("input",{"onUpdate:modelValue":i[7]||(i[7]=T=>V.city=T),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[Q,V.city]])]),e("div",null,[i[22]||(i[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Code postal",-1)),I(e("input",{"onUpdate:modelValue":i[8]||(i[8]=T=>V.postal_code=T),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[Q,V.postal_code]])])]),e("div",null,[i[24]||(i[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Pays",-1)),e("div",Do,[L(t(_.country?.name||"Non spÃ©cifiÃ©")+" ",1),i[23]||(i[23]=e("div",{class:"text-xs text-gray-500 mt-1"},"Le pays n'est pas modifiable aprÃ¨s l'inscription",-1))])])]),e("div",So,[e("button",{type:"submit",disabled:C.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400"},[C.value?(s(),o("span",Vo,"Mise Ã  jour...")):(s(),o("span",Fo,"Mettre Ã  jour"))],8,Ro)])],32)])):p("",!0),D.value==="security"?(s(),o("div",No,[i[32]||(i[32]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"SÃ©curitÃ©",-1)),e("div",qo,[e("div",Io,[i[29]||(i[29]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Changer le mot de passe",-1)),e("form",{onSubmit:de(w,["prevent"]),class:"space-y-4"},[e("div",null,[i[26]||(i[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mot de passe actuel",-1)),I(e("input",{"onUpdate:modelValue":i[9]||(i[9]=T=>h.current_password=T),type:"password",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[Q,h.current_password]])]),e("div",null,[i[27]||(i[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nouveau mot de passe",-1)),I(e("input",{"onUpdate:modelValue":i[10]||(i[10]=T=>h.new_password=T),type:"password",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[Q,h.new_password]])]),e("div",null,[i[28]||(i[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Confirmer le nouveau mot de passe",-1)),I(e("input",{"onUpdate:modelValue":i[11]||(i[11]=T=>h.confirm_password=T),type:"password",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[Q,h.confirm_password]])]),e("button",{type:"submit",disabled:j.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400"},[j.value?(s(),o("span",Uo,"Mise Ã  jour...")):(s(),o("span",zo,"Changer le mot de passe"))],8,Lo)],32)]),e("div",Bo,[e("div",Oo,[i[30]||(i[30]=e("div",null,[e("h3",{class:"text-lg font-medium text-gray-900"},"Authentification Ã  deux facteurs"),e("p",{class:"text-sm text-gray-600 mt-1"},"Ajoutez une couche de sÃ©curitÃ© supplÃ©mentaire Ã  votre compte")],-1)),e("button",{onClick:c,class:B(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",_.two_factor_enabled?"bg-blue-600":"bg-gray-200"])},[e("span",{class:B(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",_.two_factor_enabled?"translate-x-5":"translate-x-0"])},null,2)],2)])]),e("div",null,[i[31]||(i[31]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Sessions de connexion",-1)),e("div",Go,[(s(!0),o(U,null,O(x.value,T=>(s(),o("div",{key:T.id,class:"flex justify-between items-center p-4 border border-gray-200 rounded-lg"},[e("div",Ho,[T.device_type==="mobile"?(s(),Z(m(Ke),{key:0,class:"w-6 h-6 text-gray-600 mr-3"})):(s(),Z(m(Qe),{key:1,class:"w-6 h-6 text-gray-600 mr-3"})),e("div",null,[e("p",Xo,t(T.device_name),1),e("p",Ko,t(T.location)+" â€¢ "+t(G(T.last_active)),1)])]),e("div",Qo,[T.is_current?(s(),o("span",Wo," Session actuelle ")):p("",!0),T.is_current?p("",!0):(s(),o("button",{key:1,onClick:K=>H(T.id),class:"text-sm text-red-600 hover:text-red-700"}," RÃ©voquer ",8,Jo))])]))),128))])])])])):p("",!0),D.value==="notifications"?(s(),o("div",Zo,[i[35]||(i[35]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"PrÃ©fÃ©rences de notification",-1)),e("form",{onSubmit:de(y,["prevent"])},[e("div",Yo,[(s(),o(U,null,O(b,T=>e("div",{key:T.key,class:"border-b border-gray-200 pb-6 last:border-b-0 last:pb-0"},[e("h3",er,t(T.title),1),e("div",tr,[(s(!0),o(U,null,O(T.notifications,K=>(s(),o("div",{key:K.key,class:"flex justify-between items-start"},[e("div",sr,[e("p",or,t(K.title),1),e("p",rr,t(K.description),1)]),e("div",lr,[e("label",ar,[I(e("input",{"onUpdate:modelValue":ee=>n[K.key].email=ee,type:"checkbox",class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,8,nr),[[Ee,n[K.key].email]]),i[33]||(i[33]=e("span",{class:"ml-2 text-sm text-gray-700"},"Email",-1))]),e("label",ir,[I(e("input",{"onUpdate:modelValue":ee=>n[K.key].sms=ee,type:"checkbox",class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,8,dr),[[Ee,n[K.key].sms]]),i[34]||(i[34]=e("span",{class:"ml-2 text-sm text-gray-700"},"SMS",-1))])])]))),128))])])),64))]),e("div",ur,[e("button",{type:"submit",disabled:d.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400"},[d.value?(s(),o("span",mr,"Mise Ã  jour...")):(s(),o("span",pr,"Sauvegarder les prÃ©fÃ©rences"))],8,cr)])],32)])):p("",!0)])])]))}},gr={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},vr={class:"flex items-center"},xr={class:"ml-4"},yr={class:"text-sm font-medium text-gray-600"},br={class:"text-2xl font-bold text-gray-900"},fr={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-6"},_r={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},hr={class:"flex items-end"},wr={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},$r={class:"flex"},kr={class:"ml-3"},Cr={class:"mt-2 text-sm text-red-700"},jr={class:"mt-4"},Er={key:1,class:"text-center py-12"},Pr={key:2,class:"text-center py-12"},Mr={class:"text-lg font-medium text-gray-900 mb-2"},Ar={class:"text-gray-600 mb-4"},Tr={key:3,class:"space-y-4"},Dr={class:"p-6"},Sr={class:"flex items-start space-x-4"},Rr={class:"flex-shrink-0"},Vr=["src","alt"],Fr={class:"flex-1 min-w-0"},Nr={class:"flex justify-between items-start mb-2"},qr={class:"text-lg font-semibold text-gray-900"},Ir={class:"text-sm text-gray-600"},Lr={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4"},Ur={class:"text-sm font-semibold text-gray-900"},zr={class:"text-sm font-semibold text-gray-900"},Br={class:"text-sm font-semibold text-gray-900"},Or={class:"text-sm font-semibold text-gray-900"},Gr={class:"mb-4"},Hr={class:"flex flex-wrap gap-2"},Xr={key:0,class:"mb-4"},Kr={class:"flex justify-between text-xs text-gray-600 mb-1"},Qr={class:"w-full bg-gray-200 rounded-full h-2"},Wr={key:1,class:"bg-blue-50 p-4 rounded-lg mb-4"},Jr={class:"flex items-center mb-2"},Zr={class:"text-sm text-blue-800"},Yr={class:"text-sm text-blue-800"},el={key:0,class:"mt-3"},tl=["onClick","disabled"],sl={key:1,class:"mt-3"},ol={class:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800"},rl={key:2,class:"bg-red-50 p-4 rounded-lg mb-4"},ll={class:"flex items-center mb-2"},al={class:"text-sm text-red-800"},nl={class:"text-sm text-red-800"},il={class:"flex justify-between items-center"},dl={class:"text-sm text-gray-500"},ul={class:"flex space-x-2"},cl=["onClick","disabled"],ml={key:4,class:"text-center mt-8"},X0={__name:"MyTickets",setup(R){const{filteredTickets:A,stats:N,filters:P,hasMore:D,loading:a,error:C,loadTickets:j,loadMore:d,claimPrize:g,downloadTicket:F,resetFilters:_,formatCurrency:k,formatDate:V,getRemainingTime:h,getStatusLabel:q}=Ne(),x={TicketIcon:te,TrophyIcon:ae,CurrencyDollarIcon:Ae,ClockIcon:ye},b=async r=>{try{await g(r),console.log("Prix rÃ©clamÃ© avec succÃ¨s")}catch(v){console.error("Erreur lors de la rÃ©clamation du prix:",v),window.$toast&&window.$toast.error("Erreur lors de la rÃ©clamation du prix. Veuillez rÃ©essayer.","Erreur")}},n=async r=>{try{await F(r)}catch(v){console.error("Erreur lors du tÃ©lÃ©chargement:",v),window.$toast&&window.$toast.error("Erreur lors du tÃ©lÃ©chargement. Veuillez rÃ©essayer.","Erreur")}};return Y(()=>{j()}),(r,v)=>{const w=le("router-link");return s(),o("div",null,[v[25]||(v[25]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Mes tickets"),e("p",{class:"mt-2 text-gray-600"},"Suivez vos participations aux tombolas")],-1)),e("div",gr,[(s(!0),o(U,null,O(m(N),y=>(s(),o("div",{key:y.label,class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},[e("div",vr,[e("div",{class:B(["p-3 rounded-lg",y.color])},[(s(),Z($e(x[y.icon]),{class:"w-6 h-6 text-white"}))],2),e("div",xr,[e("p",yr,t(y.label),1),e("p",br,t(y.value),1)])])]))),128))]),e("div",fr,[e("div",_r,[e("div",null,[v[6]||(v[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rechercher",-1)),I(e("input",{"onUpdate:modelValue":v[0]||(v[0]=y=>m(P).search=y),type:"text",placeholder:"Nom du produit...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m(P).search]])]),e("div",null,[v[8]||(v[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),I(e("select",{"onUpdate:modelValue":v[1]||(v[1]=y=>m(P).status=y),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},v[7]||(v[7]=[re('<option value="">Tous les statuts</option><option value="active">En cours</option><option value="won">GagnÃ©</option><option value="lost">Perdu</option><option value="pending">En attente</option>',5)]),512),[[W,m(P).status]])]),e("div",null,[v[10]||(v[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"PÃ©riode",-1)),I(e("select",{"onUpdate:modelValue":v[2]||(v[2]=y=>m(P).period=y),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},v[9]||(v[9]=[e("option",{value:""},"Toutes les pÃ©riodes",-1),e("option",{value:"week"},"Cette semaine",-1),e("option",{value:"month"},"Ce mois",-1),e("option",{value:"quarter"},"Ce trimestre",-1)]),512),[[W,m(P).period]])]),e("div",hr,[e("button",{onClick:v[3]||(v[3]=(...y)=>m(_)&&m(_)(...y)),class:"w-full px-4 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"}," RÃ©initialiser ")])])]),m(C)?(s(),o("div",wr,[e("div",$r,[$(m(Pe),{class:"h-5 w-5 text-red-400"}),e("div",kr,[v[11]||(v[11]=e("h3",{class:"text-sm font-medium text-red-800"}," Erreur de chargement ",-1)),e("div",Cr,[e("p",null,t(m(C)),1)]),e("div",jr,[e("button",{onClick:v[4]||(v[4]=y=>m(j)()),class:"text-sm bg-red-100 text-red-800 px-3 py-1 rounded-md hover:bg-red-200 transition-colors"}," RÃ©essayer ")])])])])):p("",!0),m(a)?(s(),o("div",Er,v[12]||(v[12]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement de vos tickets...",-1)]))):m(A).length===0?(s(),o("div",Pr,[$(m(te),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e("h3",Mr,t(m(A).length===0&&!m(P).search&&!m(P).status&&!m(P).period?"Aucun ticket achetÃ©":"Aucun rÃ©sultat trouvÃ©"),1),e("p",Ar,t(m(A).length===0&&!m(P).search&&!m(P).status&&!m(P).period?"Vous n'avez pas encore participÃ© Ã  des tombolas":"Essayez de modifier vos filtres de recherche"),1),m(A).length===0&&!m(P).search&&!m(P).status&&!m(P).period?(s(),Z(w,{key:0,to:"/customer/products",class:"inline-block bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"},{default:X(()=>v[13]||(v[13]=[L(" DÃ©couvrir les produits ",-1)])),_:1,__:[13]})):p("",!0)])):(s(),o("div",Tr,[(s(!0),o(U,null,O(m(A),y=>(s(),o("div",{key:y.id,class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},[e("div",Dr,[e("div",Sr,[e("div",Rr,[e("img",{src:y.product.image_url||y.product.main_image||y.product.image,alt:y.product.title,class:"w-20 h-20 rounded-lg object-cover"},null,8,Vr)]),e("div",Fr,[e("div",Nr,[e("div",null,[e("h3",qr,t(y.product.title),1),e("p",Ir,t(y.product.description),1)]),e("span",{class:B(["px-3 py-1 text-sm font-medium rounded-full",y.status==="won"?"bg-blue-100 text-blue-800":y.status==="lost"?"bg-red-100 text-red-800":y.status==="active"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"])},t(m(q)(y.status)),3)]),e("div",Lr,[e("div",null,[v[14]||(v[14]=e("p",{class:"text-xs text-gray-500"},"Tickets achetÃ©s",-1)),e("p",Ur,t(y.quantity),1)]),e("div",null,[v[15]||(v[15]=e("p",{class:"text-xs text-gray-500"},"Total payÃ©",-1)),e("p",zr,t(m(k)(y.total_price)),1)]),e("div",null,[v[16]||(v[16]=e("p",{class:"text-xs text-gray-500"},"Date d'achat",-1)),e("p",Br,t(m(V)(y.purchased_at)),1)]),e("div",null,[v[17]||(v[17]=e("p",{class:"text-xs text-gray-500"},"Tirage",-1)),e("p",Or,t(m(V)(y.lottery.draw_date)),1)])]),e("div",Gr,[v[18]||(v[18]=e("p",{class:"text-xs text-gray-500 mb-2"},"Vos numÃ©ros de tickets",-1)),e("div",Hr,[(s(!0),o(U,null,O(y.ticket_numbers,c=>(s(),o("span",{key:c,class:B(["px-2 py-1 text-xs font-mono rounded border",y.winning_number===c?"bg-blue-100 text-blue-800 border-blue-300":"bg-gray-50 text-gray-700 border-gray-300"])}," #"+t(c),3))),128))])]),y.status==="active"?(s(),o("div",Xr,[e("div",Kr,[v[19]||(v[19]=e("span",null,"Progression de la tombola",-1)),e("span",null,t(y.lottery.progress)+"%",1)]),e("div",Qr,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:ke({width:y.lottery.progress+"%"})},null,4)])])):p("",!0),y.status==="won"?(s(),o("div",Wr,[e("div",Jr,[$(m(ae),{class:"w-5 h-5 text-blue-600 mr-2"}),v[20]||(v[20]=e("p",{class:"font-semibold text-blue-900"},"FÃ©licitations ! Vous avez gagnÃ© !",-1))]),e("p",Zr,"NumÃ©ro gagnant: #"+t(y.winning_number),1),e("p",Yr,"Tirage effectuÃ© le "+t(m(V)(y.lottery.draw_date)),1),y.prize_claimed?(s(),o("div",sl,[e("span",ol,[$(m(he),{class:"w-4 h-4 mr-1"}),v[21]||(v[21]=L(" Prix rÃ©clamÃ© ",-1))])])):(s(),o("div",el,[e("button",{onClick:c=>b(y.id),disabled:m(a),class:"bg-blue-600 text-white px-4 py-2 rounded-md text-sm hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},t(m(a)?"RÃ©clamation...":"RÃ©clamer mon prix"),9,tl)]))])):p("",!0),y.status==="lost"?(s(),o("div",rl,[e("div",ll,[$(m(Pe),{class:"w-5 h-5 text-red-600 mr-2"}),v[22]||(v[22]=e("p",{class:"font-semibold text-red-900"},"Pas de chance cette fois-ci",-1))]),e("p",al,"NumÃ©ro gagnant: #"+t(y.winning_number),1),e("p",nl,"Tirage effectuÃ© le "+t(m(V)(y.lottery.draw_date)),1)])):p("",!0),e("div",il,[e("div",dl,t(m(h)(y.lottery.draw_date,y.status)),1),e("div",ul,[$(w,{to:`/customer/products/${y.product.id}`,class:"text-sm text-blue-600 hover:text-blue-700 font-medium"},{default:X(()=>v[23]||(v[23]=[L(" Voir le produit ",-1)])),_:2,__:[23]},1032,["to"]),e("button",{onClick:c=>n(y.id),disabled:m(a),class:"text-sm text-gray-600 hover:text-gray-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed"},t(m(a)?"TÃ©lÃ©chargement...":"TÃ©lÃ©charger"),9,cl)])])])])])]))),128))])),!m(a)&&m(A).length>0&&m(D)?(s(),o("div",ml,[e("button",{onClick:v[5]||(v[5]=(...y)=>m(d)&&m(d)(...y)),class:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-blue-600 bg-blue-50 hover:bg-blue-100"},[v[24]||(v[24]=L(" Charger plus de tickets ",-1)),$(m(We),{class:"ml-2 w-5 h-5"})])])):p("",!0)])}}},pl={class:"min-h-screen bg-gray-50 py-8"},gl={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},vl={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},xl={class:"flex items-center justify-between"},yl={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},bl={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},fl={class:"flex items-center"},_l={class:"text-2xl font-bold text-gray-900"},hl={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},wl={class:"flex items-center"},$l={class:"text-2xl font-bold text-gray-900"},kl={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Cl={class:"flex items-center"},jl={class:"text-2xl font-bold text-gray-900"},El={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Pl={class:"flex items-center"},Ml={class:"text-2xl font-bold text-gray-900"},Al={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-8"},Tl={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Dl={class:"flex items-center space-x-4"},Sl={class:"text-sm text-gray-500"},Rl={key:0,class:"text-center py-12"},Vl={key:1,class:"text-center py-12"},Fl={key:2,class:"space-y-4"},Nl={class:"flex items-start justify-between"},ql={class:"flex-1"},Il={class:"flex items-center space-x-3 mb-2"},Ll={class:"font-mono text-sm text-gray-600"},Ul={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800"},zl={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},Bl={class:"text-lg font-semibold text-gray-900"},Ol={class:"text-sm font-medium"},Gl={class:"text-sm"},Hl={key:0,class:"bg-gray-50 rounded-lg p-3 mb-4"},Xl={class:"font-medium"},Kl={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4"},Ql={class:"text-sm text-red-700 mt-1"},Wl={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4"},Jl={class:"text-sm text-blue-700 mt-1"},Zl={class:"flex space-x-2 ml-4"},Yl=["onClick"],ea=["onClick"],ta={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},sa={class:"flex items-center justify-center min-h-screen px-4"},oa={class:"relative bg-white rounded-lg max-w-lg w-full"},ra={class:"p-6"},la={class:"flex items-center justify-between mb-4"},aa={class:"space-y-4"},na=["value"],ia={class:"flex justify-end space-x-3 mt-6"},da=["disabled"],ua={key:1,class:"fixed inset-0 z-50 overflow-y-auto"},ca={class:"flex items-center justify-center min-h-screen px-4"},ma={class:"relative bg-white rounded-lg max-w-2xl w-full max-h-screen overflow-y-auto"},pa={class:"p-6"},ga={class:"flex items-center justify-between mb-6"},va={class:"space-y-6"},xa={class:"grid grid-cols-2 gap-4"},ya={class:"font-mono font-medium"},ba={class:"grid grid-cols-2 gap-4"},fa={class:"text-xl font-semibold text-blue-600"},_a={class:"bg-gray-50 rounded-lg p-4"},ha={class:"grid grid-cols-2 gap-4"},wa={class:"font-mono"},$a={key:0,class:"bg-blue-50 rounded-lg p-4"},ka={class:"mt-2"},Ca={class:"space-y-2"},ja={class:"flex justify-between"},Ea={class:"text-sm"},Pa={key:0,class:"flex justify-between"},Ma={class:"text-sm"},Aa={key:1,class:"flex justify-between"},Ta={class:"text-sm"},Da={key:2,class:"flex justify-between"},Sa={class:"text-sm"},K0={__name:"Refunds",setup(R){const{get:A,post:N}=se(),P=S([]),D=S({}),a=S(!1),C=S(""),j=S(!1),d=S(!1),g=S(null),F=S([]),_=S({transaction_id:"",reason:"",notes:""}),k=async()=>{a.value=!0;try{const E=new URLSearchParams({limit:50});C.value&&E.append("status",C.value);const l=await A(`/refunds?${E}`);P.value=l.data.refunds||[],D.value=l.data.stats||{}}catch(E){console.error("Error loading refunds:",E)}finally{a.value=!1}},V=async()=>{try{const E=await A("/transactions?status=completed&limit=100");F.value=E.data.transactions?.filter(l=>!l.has_refund)||[]}catch(E){console.error("Error loading transactions:",E)}},h=async()=>{d.value=!0;try{const E=await N("/refunds",_.value);P.value.unshift(E.data.refund),D.value.total_refunds=(D.value.total_refunds||0)+1,D.value.pending_refunds=(D.value.pending_refunds||0)+1,_.value={transaction_id:"",reason:"",notes:""},j.value=!1,window.$toast&&window.$toast.success("Demande de remboursement crÃ©Ã©e avec succÃ¨s!","âœ… Demande crÃ©Ã©e")}catch(E){console.error("Error creating refund:",E),window.$toast&&window.$toast.error("Erreur lors de la crÃ©ation de la demande","âŒ Erreur")}finally{d.value=!1}},q=async E=>{if(confirm("ÃŠtes-vous sÃ»r de vouloir annuler cette demande ?"))try{await N(`/refunds/${E.id}/cancel`);const l=P.value.findIndex(u=>u.id===E.id);l!==-1&&(P.value[l].status="rejected",P.value[l].rejection_reason="AnnulÃ© par l'utilisateur"),window.$toast&&window.$toast.success("Demande annulÃ©e avec succÃ¨s","âœ… Annulation")}catch(l){console.error("Error cancelling refund:",l),window.$toast&&window.$toast.error("Erreur lors de l'annulation","âŒ Erreur")}},x=E=>{g.value=E},b=()=>{j.value=!1,_.value={transaction_id:"",reason:"",notes:""}},n=()=>{C.value="",k()},r=E=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(E||0)+" FCFA",v=E=>E?E>=1e6?(E/1e6).toFixed(1)+"M":E>=1e3?(E/1e3).toFixed(0)+"K":E.toString():"0",w=E=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(E)),y=E=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",processed:"bg-purple-100 text-purple-800",completed:"bg-blue-100 text-blue-800",rejected:"bg-red-100 text-red-800",failed:"bg-red-100 text-red-800"})[E]||"bg-gray-100 text-gray-800",c=E=>({pending:"â³ En attente",approved:"âœ… ApprouvÃ©",processed:"ðŸ”„ En traitement",completed:"âœ… TerminÃ©",rejected:"âŒ RejetÃ©",failed:"âŒ Ã‰chec"})[E]||E,H=E=>({insufficient_participants:"Participants insuffisants",lottery_cancelled:"Tombola annulÃ©e",accidental_purchase:"Achat accidentel",changed_mind:"Changement d'avis",duplicate_purchase:"Achat en double",technical_issue:"ProblÃ¨me technique",system_error:"Erreur systÃ¨me",other:"Autre"})[E]||E,M=E=>({mobile_money:"Mobile Money",bank_transfer:"Virement bancaire",wallet_credit:"CrÃ©dit portefeuille"})[E]||E;return Y(async()=>{await Promise.all([k(),V()])}),(E,l)=>(s(),o("div",pl,[e("div",gl,[e("div",vl,[e("div",xl,[l[8]||(l[8]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"ðŸ’¸ Mes Remboursements"),e("p",{class:"text-gray-600 mt-1"},"GÃ©rez vos demandes de remboursement")],-1)),e("button",{onClick:l[0]||(l[0]=u=>j.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"}," âž• Nouvelle demande ")])]),e("div",yl,[e("div",bl,[e("div",fl,[l[10]||(l[10]=e("div",{class:"p-3 rounded-full bg-blue-100 text-blue-600 mr-4"}," ðŸ’° ",-1)),e("div",null,[e("div",_l,t(D.value.total_refunds||0),1),l[9]||(l[9]=e("div",{class:"text-sm text-gray-600"},"Remboursements",-1))])])]),e("div",hl,[e("div",wl,[l[12]||(l[12]=e("div",{class:"p-3 rounded-full bg-blue-100 text-blue-600 mr-4"}," âœ… ",-1)),e("div",null,[e("div",$l,t(v(D.value.total_amount_refunded)),1),l[11]||(l[11]=e("div",{class:"text-sm text-gray-600"},"Montant remboursÃ©",-1))])])]),e("div",kl,[e("div",Cl,[l[14]||(l[14]=e("div",{class:"p-3 rounded-full bg-yellow-100 text-yellow-600 mr-4"}," â³ ",-1)),e("div",null,[e("div",jl,t(D.value.pending_refunds||0),1),l[13]||(l[13]=e("div",{class:"text-sm text-gray-600"},"En attente",-1))])])]),e("div",El,[e("div",Pl,[l[16]||(l[16]=e("div",{class:"p-3 rounded-full bg-red-100 text-red-600 mr-4"}," X ",-1)),e("div",null,[e("div",Ml,t(D.value.rejected_refunds||0),1),l[15]||(l[15]=e("div",{class:"text-sm text-gray-600"},"RejetÃ©es",-1))])])])]),e("div",Al,[e("div",Tl,[e("div",Dl,[I(e("select",{"onUpdate:modelValue":l[1]||(l[1]=u=>C.value=u),onChange:k,class:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},l[17]||(l[17]=[re('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="approved">ApprouvÃ©</option><option value="processed">TraitÃ©</option><option value="completed">TerminÃ©</option><option value="rejected">RejetÃ©</option>',6)]),544),[[W,C.value]]),e("button",{onClick:n,class:"px-3 py-2 text-gray-600 hover:text-gray-800 text-sm"}," RÃ©initialiser ")]),e("div",Sl,t(P.value.length)+" remboursement(s) ",1)])]),a.value?(s(),o("div",Rl,l[18]||(l[18]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement des remboursements...",-1)]))):P.value.length===0?(s(),o("div",Vl,[$(m(Je),{class:"mx-auto h-16 w-16 text-gray-400 mb-4"}),l[19]||(l[19]=e("h3",{class:"text-xl font-medium text-gray-900 mb-2"},"Aucun remboursement",-1)),l[20]||(l[20]=e("p",{class:"text-gray-600 mb-6"},"Vous n'avez pas encore de demande de remboursement.",-1)),e("button",{onClick:l[2]||(l[2]=u=>j.value=!0),class:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Faire une demande ")])):(s(),o("div",Fl,[(s(!0),o(U,null,O(P.value,u=>(s(),o("div",{key:u.id,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow"},[e("div",Nl,[e("div",ql,[e("div",Il,[e("span",Ll,t(u.refund_number),1),e("span",{class:B(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",y(u.status)])},t(c(u.status)),3),u.auto_processed?(s(),o("span",Ul," ðŸ¤– Automatique ")):p("",!0)]),e("div",zl,[e("div",null,[l[21]||(l[21]=e("div",{class:"text-sm text-gray-600"},"Montant",-1)),e("div",Bl,t(r(u.amount)),1)]),e("div",null,[l[22]||(l[22]=e("div",{class:"text-sm text-gray-600"},"Raison",-1)),e("div",Ol,t(H(u.reason)),1)]),e("div",null,[l[23]||(l[23]=e("div",{class:"text-sm text-gray-600"},"Date de demande",-1)),e("div",Gl,t(w(u.created_at)),1)])]),u.lottery?(s(),o("div",Hl,[l[24]||(l[24]=e("div",{class:"text-sm text-gray-600"},"Tombola concernÃ©e",-1)),e("div",Xl,t(u.lottery.lottery_number)+" - "+t(u.lottery.product_title),1)])):p("",!0),u.rejection_reason?(s(),o("div",Kl,[l[25]||(l[25]=e("div",{class:"text-sm font-medium text-red-800"},"Raison du rejet",-1)),e("div",Ql,t(u.rejection_reason),1)])):p("",!0),u.notes?(s(),o("div",Wl,[l[26]||(l[26]=e("div",{class:"text-sm font-medium text-blue-800"},"Notes",-1)),e("div",Jl,t(u.notes),1)])):p("",!0)]),e("div",Zl,[e("button",{onClick:J=>x(u),class:"px-3 py-2 text-blue-600 hover:text-blue-700 text-sm font-medium"}," DÃ©tails ",8,Yl),u.status==="pending"?(s(),o("button",{key:0,onClick:J=>q(u),class:"px-3 py-2 text-red-600 hover:text-red-700 text-sm font-medium"}," Annuler ",8,ea)):p("",!0)])])]))),128))]))]),j.value?(s(),o("div",ta,[e("div",sa,[e("div",{class:"fixed inset-0 bg-black/20",onClick:b}),e("div",oa,[e("div",ra,[e("div",la,[l[27]||(l[27]=e("h3",{class:"text-lg font-semibold"},"Nouvelle demande de remboursement",-1)),e("button",{onClick:b,class:"text-gray-400 hover:text-gray-600"},[$(m(ge),{class:"w-6 h-6"})])]),e("form",{onSubmit:de(h,["prevent"])},[e("div",aa,[e("div",null,[l[29]||(l[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Transaction Ã  rembourser",-1)),I(e("select",{"onUpdate:modelValue":l[3]||(l[3]=u=>_.value.transaction_id=u),required:"",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},[l[28]||(l[28]=e("option",{value:""},"SÃ©lectionnez une transaction",-1)),(s(!0),o(U,null,O(F.value,u=>(s(),o("option",{key:u.id,value:u.id},t(u.reference)+" - "+t(r(u.amount))+" "+t(u.lottery?`(${u.lottery.lottery_number})`:""),9,na))),128))],512),[[W,_.value.transaction_id]])]),e("div",null,[l[31]||(l[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Raison du remboursement",-1)),I(e("select",{"onUpdate:modelValue":l[4]||(l[4]=u=>_.value.reason=u),required:"",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},l[30]||(l[30]=[re('<option value="">SÃ©lectionnez une raison</option><option value="accidental_purchase">Achat accidentel</option><option value="changed_mind">Changement d&#39;avis</option><option value="duplicate_purchase">Achat en double</option><option value="technical_issue">ProblÃ¨me technique</option><option value="other">Autre</option>',6)]),512),[[W,_.value.reason]])]),e("div",null,[l[32]||(l[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Explication (optionnel)",-1)),I(e("textarea",{"onUpdate:modelValue":l[5]||(l[5]=u=>_.value.notes=u),rows:"3",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"DÃ©crivez votre situation..."},null,512),[[Q,_.value.notes]])])]),e("div",ia,[e("button",{type:"button",onClick:b,class:"px-4 py-2 text-gray-700 bg-gray-200 hover:bg-gray-300 rounded-lg"}," Annuler "),e("button",{type:"submit",disabled:d.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},t(d.value?"CrÃ©ation...":"CrÃ©er la demande"),9,da)])],32)])])])])):p("",!0),g.value?(s(),o("div",ua,[e("div",ca,[e("div",{class:"fixed inset-0 bg-black/20",onClick:l[6]||(l[6]=u=>g.value=null)}),e("div",ma,[e("div",pa,[e("div",ga,[l[33]||(l[33]=e("h3",{class:"text-lg font-semibold"},"DÃ©tails du remboursement",-1)),e("button",{onClick:l[7]||(l[7]=u=>g.value=null),class:"text-gray-400 hover:text-gray-600"},[$(m(ge),{class:"w-6 h-6"})])]),e("div",va,[e("div",xa,[e("div",null,[l[34]||(l[34]=e("div",{class:"text-sm text-gray-600"},"NumÃ©ro",-1)),e("div",ya,t(g.value.refund_number),1)]),e("div",null,[l[35]||(l[35]=e("div",{class:"text-sm text-gray-600"},"Statut",-1)),e("span",{class:B(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",y(g.value.status)])},t(c(g.value.status)),3)])]),e("div",ba,[e("div",null,[l[36]||(l[36]=e("div",{class:"text-sm text-gray-600"},"Montant",-1)),e("div",fa,t(r(g.value.amount)),1)]),e("div",null,[l[37]||(l[37]=e("div",{class:"text-sm text-gray-600"},"MÃ©thode de remboursement",-1)),e("div",null,t(M(g.value.refund_method)),1)])]),e("div",_a,[l[40]||(l[40]=e("h4",{class:"font-medium text-gray-900 mb-3"},"Transaction originale",-1)),e("div",ha,[e("div",null,[l[38]||(l[38]=e("div",{class:"text-sm text-gray-600"},"RÃ©fÃ©rence",-1)),e("div",wa,t(g.value.transaction.reference),1)]),e("div",null,[l[39]||(l[39]=e("div",{class:"text-sm text-gray-600"},"Montant",-1)),e("div",null,t(r(g.value.transaction.amount)),1)])])]),g.value.lottery?(s(),o("div",$a,[l[43]||(l[43]=e("h4",{class:"font-medium text-gray-900 mb-3"},"Tombola concernÃ©e",-1)),e("div",null,[l[41]||(l[41]=e("div",{class:"text-sm text-gray-600"},"NumÃ©ro",-1)),e("div",null,t(g.value.lottery.lottery_number),1)]),e("div",ka,[l[42]||(l[42]=e("div",{class:"text-sm text-gray-600"},"Produit",-1)),e("div",null,t(g.value.lottery.product_title),1)])])):p("",!0),e("div",null,[l[48]||(l[48]=e("h4",{class:"font-medium text-gray-900 mb-3"},"Chronologie",-1)),e("div",Ca,[e("div",ja,[l[44]||(l[44]=e("span",{class:"text-sm text-gray-600"},"Demande crÃ©Ã©e",-1)),e("span",Ea,t(w(g.value.created_at)),1)]),g.value.approved_at?(s(),o("div",Pa,[l[45]||(l[45]=e("span",{class:"text-sm text-gray-600"},"ApprouvÃ©",-1)),e("span",Ma,t(w(g.value.approved_at)),1)])):p("",!0),g.value.processed_at?(s(),o("div",Aa,[l[46]||(l[46]=e("span",{class:"text-sm text-gray-600"},"TraitÃ©",-1)),e("span",Ta,t(w(g.value.processed_at)),1)])):p("",!0),g.value.rejected_at?(s(),o("div",Da,[l[47]||(l[47]=e("span",{class:"text-sm text-gray-600"},"RejetÃ©",-1)),e("span",Sa,t(w(g.value.rejected_at)),1)])):p("",!0)])])])])])])])):p("",!0)]))}},Ra={class:"order-tracking"},Va={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},Fa={class:"bg-white rounded-lg shadow p-6"},Na={class:"flex items-center"},qa={class:"ml-4"},Ia={class:"text-2xl font-semibold text-gray-900"},La={class:"bg-white rounded-lg shadow p-6"},Ua={class:"flex items-center"},za={class:"ml-4"},Ba={class:"text-2xl font-semibold text-gray-900"},Oa={class:"bg-white rounded-lg shadow p-6"},Ga={class:"flex items-center"},Ha={class:"ml-4"},Xa={class:"text-2xl font-semibold text-gray-900"},Ka={class:"bg-white rounded-lg shadow p-6"},Qa={class:"flex items-center"},Wa={class:"ml-4"},Ja={class:"text-2xl font-semibold text-gray-900"},Za={class:"bg-white rounded-lg shadow p-6 mb-8"},Ya={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},en={class:"flex items-end"},tn={class:"bg-white rounded-lg shadow overflow-hidden"},sn={key:0,class:"p-8 text-center"},on={key:1,class:"p-8 text-center"},rn={key:2},ln={class:"px-6 py-4"},an={class:"flex justify-between items-start"},nn={class:"flex-1"},dn={class:"flex items-center space-x-3 mb-2"},un={class:"text-lg font-medium text-gray-900"},cn={class:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full"},mn={class:"text-sm text-gray-600 mb-2"},pn={key:0},gn={class:"flex items-center space-x-4 text-sm text-gray-500"},vn={key:0},xn={class:"flex space-x-2"},yn={key:3,class:"px-6 py-4 border-t border-gray-200 bg-gray-50"},bn={class:"flex justify-between items-center"},fn={class:"text-sm text-gray-600"},_n={class:"flex space-x-1"},hn=["disabled"],wn=["onClick"],$n=["disabled"],kn={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},Cn={class:"relative top-20 mx-auto p-5 border w-11/12 max-w-4xl shadow-lg rounded-md bg-white"},jn={class:"mt-3"},En={key:0},Pn={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Mn={class:"space-y-2"},An={class:"flex justify-between"},Tn={class:"text-sm font-medium"},Dn={class:"flex justify-between"},Sn={class:"flex justify-between"},Rn={class:"text-sm"},Vn={class:"flex justify-between"},Fn={class:"text-sm font-medium"},Nn={class:"flex justify-between"},qn={class:"text-sm"},In={class:"flex justify-between"},Ln={class:"text-sm"},Un={key:0,class:"flex justify-between"},zn={class:"text-sm"},Bn={key:0},On={class:"border rounded-lg p-4"},Gn={class:"font-medium"},Hn={class:"text-sm text-gray-600 mt-1"},Xn={key:1,class:"mt-6"},Kn={class:"border rounded-lg p-4"},Qn={class:"font-medium"},Wn={class:"text-sm text-gray-600 mt-2"},Jn={key:0},Zn={key:0,class:"mt-6"},Yn={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ei={class:"flex justify-between items-start"},ti={class:"font-medium"},si={class:"text-sm text-gray-600"},oi={class:"text-right"},ri={key:0,class:"text-sm text-green-600 mt-1"},li={__name:"OrderTracking",setup(R){const{apiRequest:A}=se(),{showError:N}=ve(),P=S([]),D=S({total_orders:0,completed_orders:0,pending_orders:0,total_tickets_purchased:0}),a=S(null),C=S(!1),j=S(!1),d=S(null),g=oe({search:"",status:"",type:""}),F=async()=>{try{const n=await A("/api/orders/stats","GET");D.value=n.data}catch(n){console.error("Erreur lors du chargement des statistiques:",n)}},_=async(n=1)=>{C.value=!0;try{const r=new URLSearchParams({page:n,per_page:10});g.search&&r.append("q",g.search),g.status&&r.append("status",g.status),g.type&&r.append("type",g.type);const v=await A(`/api/orders?${r.toString()}`,"GET");P.value=v.data,a.value=v.pagination}catch(r){N("Erreur lors du chargement des commandes"),console.error("Erreur:",r)}finally{C.value=!1}},k=()=>{j.value=!1,d.value=null},V=n=>({completed:"ComplÃ©tÃ©",pending:"En attente",payment_initiated:"Paiement initiÃ©",failed:"Ã‰chouÃ©",paid:"PayÃ©",refunded:"RemboursÃ©"})[n]||n,h=n=>({ticket_purchase:"Achat de billet",direct_purchase:"Achat direct"})[n]||n,q=n=>`px-2 py-1 text-xs rounded-full font-medium ${{completed:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",payment_initiated:"bg-blue-100 text-blue-800",failed:"bg-red-100 text-red-800",paid:"bg-green-100 text-green-800",refunded:"bg-gray-100 text-gray-800"}[n]||"bg-gray-100 text-gray-800"}`,x=n=>new Date(n).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),b=()=>{if(!a.value)return[];const n=a.value.current_page,r=a.value.last_page,v=[];for(let w=Math.max(1,n-2);w<=Math.min(r,n+2);w++)v.push(w);return v};return De(()=>[g.status,g.type],()=>{_(1)},{deep:!0}),Y(()=>{F(),_()}),(n,r)=>{const v=le("router-link");return s(),o("div",Ra,[r[37]||(r[37]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Suivi de mes commandes"),e("p",{class:"text-gray-600"},"Suivez l'Ã©tat de vos commandes et billets de loterie")],-1)),e("div",Va,[e("div",Fa,[e("div",Na,[r[8]||(r[8]=e("div",{class:"p-3 rounded-full bg-blue-100"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})])],-1)),e("div",qa,[r[7]||(r[7]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Commandes",-1)),e("p",Ia,t(D.value.total_orders),1)])])]),e("div",La,[e("div",Ua,[r[10]||(r[10]=e("div",{class:"p-3 rounded-full bg-green-100"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",za,[r[9]||(r[9]=e("p",{class:"text-sm font-medium text-gray-600"},"ComplÃ©tÃ©es",-1)),e("p",Ba,t(D.value.completed_orders),1)])])]),e("div",Oa,[e("div",Ga,[r[12]||(r[12]=e("div",{class:"p-3 rounded-full bg-yellow-100"},[e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",Ha,[r[11]||(r[11]=e("p",{class:"text-sm font-medium text-gray-600"},"En attente",-1)),e("p",Xa,t(D.value.pending_orders),1)])])]),e("div",Ka,[e("div",Qa,[r[14]||(r[14]=e("div",{class:"p-3 rounded-full bg-purple-100"},[e("svg",{class:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})])],-1)),e("div",Wa,[r[13]||(r[13]=e("p",{class:"text-sm font-medium text-gray-600"},"Billets AchetÃ©s",-1)),e("p",Ja,t(D.value.total_tickets_purchased),1)])])])]),e("div",Za,[e("div",Ya,[e("div",null,[r[15]||(r[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Recherche",-1)),I(e("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=w=>g.search=w),placeholder:"NumÃ©ro de commande ou ticket...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyup:r[1]||(r[1]=Se(w=>_(1),["enter"]))},null,544),[[Q,g.search]])]),e("div",null,[r[17]||(r[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),I(e("select",{"onUpdate:modelValue":r[2]||(r[2]=w=>g.status=w),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},r[16]||(r[16]=[re('<option value="" data-v-448be14d>Tous les statuts</option><option value="completed" data-v-448be14d>ComplÃ©tÃ©</option><option value="pending" data-v-448be14d>En attente</option><option value="payment_initiated" data-v-448be14d>Paiement initiÃ©</option><option value="failed" data-v-448be14d>Ã‰chouÃ©</option>',5)]),512),[[W,g.status]])]),e("div",null,[r[19]||(r[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type",-1)),I(e("select",{"onUpdate:modelValue":r[3]||(r[3]=w=>g.type=w),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},r[18]||(r[18]=[e("option",{value:""},"Tous les types",-1),e("option",{value:"ticket_purchase"},"Achat de billet",-1),e("option",{value:"direct_purchase"},"Achat direct",-1)]),512),[[W,g.type]])]),e("div",en,[e("button",{onClick:r[4]||(r[4]=w=>_(1)),class:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-200"}," Rechercher ")])])]),e("div",tn,[r[23]||(r[23]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h2",{class:"text-lg font-medium text-gray-900"},"Mes commandes")],-1)),C.value?(s(),o("div",sn,r[20]||(r[20]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"text-gray-500 mt-4"},"Chargement des commandes...",-1)]))):P.value.length===0?(s(),o("div",on,r[21]||(r[21]=[e("svg",{class:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2 2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-4.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 009.586 13H7"})],-1),e("p",{class:"text-gray-500"},"Aucune commande trouvÃ©e",-1)]))):(s(),o("div",rn,[(s(!0),o(U,null,O(P.value,w=>(s(),o("div",{key:w.id,class:"border-b border-gray-200 hover:bg-gray-50 transition duration-200"},[e("div",ln,[e("div",an,[e("div",nn,[e("div",dn,[e("h3",un,"#"+t(w.transaction_id),1),e("span",{class:B(q(w.status))},t(V(w.status)),3),e("span",cn,t(h(w.type)),1)]),e("div",mn,[L(t(w.product?w.product.name:"Produit supprimÃ©")+" ",1),w.lottery?(s(),o("span",pn," - Loterie #"+t(w.lottery.lottery_number),1)):p("",!0)]),e("div",gn,[e("span",null,t(x(w.created_at)),1),e("span",null,t(w.amount)+" "+t(w.currency),1),w.quantity?(s(),o("span",vn,t(w.quantity)+" billet(s)",1)):p("",!0)])]),e("div",xn,[$(v,{to:{name:"customer.order.detail",params:{id:w.transaction_id}},class:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"},{default:X(()=>r[22]||(r[22]=[L(" DÃ©tails ",-1)])),_:2,__:[22]},1032,["to"])])])])]))),128))])),a.value&&a.value.last_page>1?(s(),o("div",yn,[e("div",bn,[e("div",fn," Affichage de "+t((a.value.current_page-1)*a.value.per_page+1)+" Ã  "+t(Math.min(a.value.current_page*a.value.per_page,a.value.total))+" sur "+t(a.value.total)+" rÃ©sultats ",1),e("div",_n,[e("button",{onClick:r[5]||(r[5]=w=>_(a.value.current_page-1)),disabled:a.value.current_page<=1,class:"px-3 py-1 border rounded text-gray-700 hover:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed"}," PrÃ©cÃ©dent ",8,hn),(s(!0),o(U,null,O(b(),w=>(s(),o("button",{key:w,onClick:y=>_(w),class:B(["px-3 py-1 border rounded",w===a.value.current_page?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"])},t(w),11,wn))),128)),e("button",{onClick:r[6]||(r[6]=w=>_(a.value.current_page+1)),disabled:a.value.current_page>=a.value.last_page,class:"px-3 py-1 border rounded text-gray-700 hover:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed"}," Suivant ",8,$n)])])])):p("",!0)]),j.value?(s(),o("div",kn,[e("div",Cn,[e("div",jn,[e("div",{class:"flex justify-between items-center mb-4"},[r[25]||(r[25]=e("h3",{class:"text-lg font-medium text-gray-900"},"DÃ©tails de la commande",-1)),e("button",{onClick:k,class:"text-gray-400 hover:text-gray-600"},r[24]||(r[24]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),d.value?(s(),o("div",En,[e("div",Pn,[e("div",null,[r[33]||(r[33]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Informations de la commande",-1)),e("dl",Mn,[e("div",An,[r[26]||(r[26]=e("dt",{class:"text-sm text-gray-600"},"RÃ©fÃ©rence:",-1)),e("dd",Tn,t(d.value.transaction_id),1)]),e("div",Dn,[r[27]||(r[27]=e("dt",{class:"text-sm text-gray-600"},"Statut:",-1)),e("dd",null,[e("span",{class:B(q(d.value.status))},t(V(d.value.status)),3)])]),e("div",Sn,[r[28]||(r[28]=e("dt",{class:"text-sm text-gray-600"},"Type:",-1)),e("dd",Rn,t(h(d.value.type)),1)]),e("div",Vn,[r[29]||(r[29]=e("dt",{class:"text-sm text-gray-600"},"Montant:",-1)),e("dd",Fn,t(d.value.amount)+" "+t(d.value.currency),1)]),e("div",Nn,[r[30]||(r[30]=e("dt",{class:"text-sm text-gray-600"},"MÃ©thode de paiement:",-1)),e("dd",qn,t(d.value.payment_method||"Non spÃ©cifiÃ©"),1)]),e("div",In,[r[31]||(r[31]=e("dt",{class:"text-sm text-gray-600"},"Date de crÃ©ation:",-1)),e("dd",Ln,t(x(d.value.created_at)),1)]),d.value.completed_at?(s(),o("div",Un,[r[32]||(r[32]=e("dt",{class:"text-sm text-gray-600"},"Date de completion:",-1)),e("dd",zn,t(x(d.value.completed_at)),1)])):p("",!0)])]),e("div",null,[d.value.product?(s(),o("div",Bn,[r[34]||(r[34]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Produit",-1)),e("div",On,[e("h5",Gn,t(d.value.product.name),1),e("p",Hn,t(d.value.product.description||""),1)])])):p("",!0),d.value.lottery?(s(),o("div",Xn,[r[35]||(r[35]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Loterie",-1)),e("div",Kn,[e("h5",Qn,t(d.value.lottery.title),1),e("div",Wn,[e("p",null,"NumÃ©ro: "+t(d.value.lottery.lottery_number),1),e("p",null,"Prix du billet: "+t(d.value.lottery.ticket_price)+" "+t(d.value.currency),1),e("p",null,"Billets vendus: "+t(d.value.lottery.sold_tickets)+"/"+t(d.value.lottery.max_tickets),1),d.value.lottery.draw_date?(s(),o("p",Jn,"Date du tirage: "+t(x(d.value.lottery.draw_date)),1)):p("",!0)])])])):p("",!0)])]),d.value.tickets&&d.value.tickets.length>0?(s(),o("div",Zn,[r[36]||(r[36]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Billets de loterie",-1)),e("div",Yn,[(s(!0),o(U,null,O(d.value.tickets,w=>(s(),o("div",{key:w.id,class:B(["border rounded-lg p-4",w.is_winner?"bg-green-50 border-green-200":"bg-gray-50"])},[e("div",ei,[e("div",null,[e("p",ti,t(w.ticket_number),1),e("p",si,t(w.price_paid)+" "+t(d.value.currency),1)]),e("div",oi,[e("span",{class:B(q(w.status))},t(V(w.status)),3),w.is_winner?(s(),o("p",ri,"ðŸŽ‰ Gagnant!")):p("",!0)])])],2))),128))])])):p("",!0)])):p("",!0)])])])):p("",!0)])}}},Q0=me(li,[["__scopeId","data-v-448be14d"]]),ai={class:"payments-page"},ni={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},ii={class:"bg-white rounded-lg shadow p-6"},di={class:"flex items-center"},ui={class:"ml-4"},ci={class:"text-2xl font-semibold text-gray-900"},mi={class:"bg-white rounded-lg shadow p-6"},pi={class:"flex items-center"},gi={class:"ml-4"},vi={class:"text-2xl font-semibold text-gray-900"},xi={class:"bg-white rounded-lg shadow p-6"},yi={class:"flex items-center"},bi={class:"ml-4"},fi={class:"text-2xl font-semibold text-gray-900"},_i={class:"bg-white rounded-lg shadow p-6"},hi={class:"flex items-center"},wi={class:"ml-4"},$i={class:"text-2xl font-semibold text-gray-900"},ki={class:"bg-white rounded-lg shadow p-6 mb-8"},Ci={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ji={class:"flex items-end"},Ei={class:"bg-white rounded-lg shadow overflow-hidden"},Pi={key:0,class:"p-8 text-center"},Mi={key:1,class:"p-8 text-center"},Ai={key:2},Ti={class:"px-6 py-4"},Di={class:"flex justify-between items-start"},Si={class:"flex-1"},Ri={class:"flex items-center space-x-3 mb-2"},Vi={class:"text-lg font-medium text-gray-900"},Fi={class:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full"},Ni={class:"text-sm text-gray-600 mb-2"},qi={key:0},Ii={key:1},Li={key:2},Ui={class:"flex items-center space-x-4 text-sm text-gray-500"},zi={key:0},Bi={key:0,class:"mt-2 text-xs text-orange-600"},Oi={class:"flex space-x-2"},Gi=["onClick"],Hi={key:3,class:"px-6 py-4 border-t border-gray-200 bg-gray-50"},Xi={class:"flex justify-between items-center"},Ki={class:"text-sm text-gray-600"},Qi={class:"flex space-x-1"},Wi=["disabled"],Ji=["onClick"],Zi=["disabled"],Yi={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},ed={class:"relative top-20 mx-auto p-5 border w-11/12 max-w-2xl shadow-lg rounded-md bg-white"},td={class:"mt-3"},sd={key:0},od={class:"grid grid-cols-1 gap-6"},rd={class:"space-y-2"},ld={class:"flex justify-between"},ad={class:"text-sm font-medium"},nd={class:"flex justify-between"},id={class:"flex justify-between"},dd={class:"text-sm font-medium"},ud={class:"flex justify-between"},cd={class:"text-sm"},md={key:0,class:"flex justify-between"},pd={class:"text-sm"},gd={class:"flex justify-between"},vd={class:"text-sm"},xd={key:1,class:"flex justify-between"},yd={class:"text-sm"},bd={key:2,class:"flex justify-between"},fd={class:"text-sm"},_d={key:0},hd={class:"border rounded-lg p-4 bg-gray-50"},wd={class:"font-medium"},$d={class:"text-sm text-gray-600 mt-1"},kd={class:"mt-2 text-xs text-gray-500"},Cd={__name:"Payments",setup(R){const A=pe(),{apiRequest:N}=se(),{showError:P}=ve(),D=S([]),a=S({successful_payments:0,pending_payments:0,failed_payments:0,total_amount:0}),C=S(null),j=S(!1),d=S(!1),g=S(null),F=oe({search:"",status:"",method:""}),_=async()=>{try{const y=await N("/api/payments/stats","GET");y.success&&(a.value=y.data)}catch(y){console.error("Erreur lors du chargement des statistiques:",y);try{const c=await N("/api/orders/stats","GET");c.success&&(a.value={successful_payments:c.data.completed_orders,pending_payments:c.data.pending_orders,failed_payments:c.data.failed_orders,total_amount:c.data.total_amount_spent||0})}catch(c){console.error("Erreur lors du chargement des statistiques de fallback:",c)}}},k=async(y=1)=>{j.value=!0;try{const c=new URLSearchParams({page:y,per_page:10});F.search&&c.append("search",F.search),F.status&&c.append("status",F.status),F.method&&c.append("method",F.method);try{const H=await N(`/api/payments?${c.toString()}`,"GET");H.success&&(D.value=H.data,C.value=H.pagination)}catch(H){console.log("API paiements non disponible, utilisation de l'API commandes:",H);const M=await N(`/api/orders?${c.toString()}`,"GET");M.success&&(D.value=M.data.map(E=>({id:E.id,billing_id:E.external_transaction_id,amount:E.amount,status:E.status==="completed"?"paid":E.status,payment_method:E.payment_method||"airtel_money",phone_number:E.phone_number,transaction_id:E.transaction_id,transaction:E,created_at:E.created_at,updated_at:E.updated_at,timeout_at:E.status==="pending"?E.expires_at:null})),C.value=M.pagination)}}catch(c){P("Erreur lors du chargement des paiements"),console.error("Erreur:",c)}finally{j.value=!1}},V=y=>{A.push({name:"payment.phone",query:{transaction_id:y,retry:"true"}})},h=()=>{d.value=!1,g.value=null},q=y=>({paid:"PayÃ©",pending:"En attente",payment_initiated:"Paiement initiÃ©",failed:"Ã‰chouÃ©",expired:"ExpirÃ©",completed:"PayÃ©"})[y]||y,x=y=>({airtel_money:"Airtel Money",moov_money:"Moov Money"})[y]||y||"Non spÃ©cifiÃ©",b=y=>({ticket_purchase:"Achat de billet",direct_purchase:"Achat direct"})[y]||y,n=y=>`px-2 py-1 text-xs rounded-full font-medium ${{paid:"bg-green-100 text-green-800",completed:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",payment_initiated:"bg-blue-100 text-blue-800",failed:"bg-red-100 text-red-800",expired:"bg-gray-100 text-gray-800"}[y]||"bg-gray-100 text-gray-800"}`,r=y=>new Date(y).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),v=y=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(y||0).replace("XAF","FCFA"),w=()=>{if(!C.value)return[];const y=C.value.current_page,c=C.value.last_page,H=[];for(let M=Math.max(1,y-2);M<=Math.min(c,y+2);M++)H.push(M);return H};return De(()=>[F.status,F.method],()=>{k(1)},{deep:!0}),Y(()=>{_(),k()}),(y,c)=>{const H=le("router-link");return s(),o("div",ai,[c[36]||(c[36]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Mes Paiements"),e("p",{class:"text-gray-600"},"Consultez l'historique de vos paiements et transactions")],-1)),e("div",ni,[e("div",ii,[e("div",di,[c[8]||(c[8]=e("div",{class:"p-3 rounded-full bg-green-100"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",ui,[c[7]||(c[7]=e("p",{class:"text-sm font-medium text-gray-600"},"Paiements RÃ©ussis",-1)),e("p",ci,t(a.value.successful_payments),1)])])]),e("div",mi,[e("div",pi,[c[10]||(c[10]=e("div",{class:"p-3 rounded-full bg-yellow-100"},[e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",gi,[c[9]||(c[9]=e("p",{class:"text-sm font-medium text-gray-600"},"En Attente",-1)),e("p",vi,t(a.value.pending_payments),1)])])]),e("div",xi,[e("div",yi,[c[12]||(c[12]=e("div",{class:"p-3 rounded-full bg-red-100"},[e("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),e("div",bi,[c[11]||(c[11]=e("p",{class:"text-sm font-medium text-gray-600"},"Ã‰chouÃ©s",-1)),e("p",fi,t(a.value.failed_payments),1)])])]),e("div",_i,[e("div",hi,[c[14]||(c[14]=e("div",{class:"p-3 rounded-full bg-blue-100"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1)),e("div",wi,[c[13]||(c[13]=e("p",{class:"text-sm font-medium text-gray-600"},"Total PayÃ©",-1)),e("p",$i,t(v(a.value.total_amount)),1)])])])]),e("div",ki,[e("div",Ci,[e("div",null,[c[15]||(c[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Recherche",-1)),I(e("input",{type:"text","onUpdate:modelValue":c[0]||(c[0]=M=>F.search=M),placeholder:"RÃ©fÃ©rence ou ID de paiement...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyup:c[1]||(c[1]=Se(M=>k(1),["enter"]))},null,544),[[Q,F.search]])]),e("div",null,[c[17]||(c[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),I(e("select",{"onUpdate:modelValue":c[2]||(c[2]=M=>F.status=M),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},c[16]||(c[16]=[re('<option value="" data-v-55c0b806>Tous les statuts</option><option value="paid" data-v-55c0b806>PayÃ©</option><option value="pending" data-v-55c0b806>En attente</option><option value="failed" data-v-55c0b806>Ã‰chouÃ©</option><option value="expired" data-v-55c0b806>ExpirÃ©</option>',5)]),512),[[W,F.status]])]),e("div",null,[c[19]||(c[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"MÃ©thode",-1)),I(e("select",{"onUpdate:modelValue":c[3]||(c[3]=M=>F.method=M),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},c[18]||(c[18]=[e("option",{value:""},"Toutes les mÃ©thodes",-1),e("option",{value:"airtel_money"},"Airtel Money",-1),e("option",{value:"moov_money"},"Moov Money",-1)]),512),[[W,F.method]])]),e("div",ji,[e("button",{onClick:c[4]||(c[4]=M=>k(1)),class:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-200"}," Rechercher ")])])]),e("div",Ei,[c[23]||(c[23]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h2",{class:"text-lg font-medium text-gray-900"},"Historique des paiements")],-1)),j.value?(s(),o("div",Pi,c[20]||(c[20]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"text-gray-500 mt-4"},"Chargement des paiements...",-1)]))):D.value.length===0?(s(),o("div",Mi,c[21]||(c[21]=[e("svg",{class:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("p",{class:"text-gray-500"},"Aucun paiement trouvÃ©",-1)]))):(s(),o("div",Ai,[(s(!0),o(U,null,O(D.value,M=>(s(),o("div",{key:M.id,class:"border-b border-gray-200 hover:bg-gray-50 transition duration-200"},[e("div",Ti,[e("div",Di,[e("div",Si,[e("div",Ri,[e("h3",Vi,"#"+t(M.billing_id||M.id),1),e("span",{class:B(n(M.status))},t(q(M.status)),3),e("span",Fi,t(x(M.payment_method)),1)]),e("div",Ni,[M.transaction&&M.transaction.product?(s(),o("span",qi,t(M.transaction.product.name),1)):M.transaction&&M.transaction.lottery?(s(),o("span",Ii," Loterie #"+t(M.transaction.lottery.lottery_number),1)):(s(),o("span",Li," Paiement "))]),e("div",Ui,[e("span",null,t(r(M.created_at)),1),e("span",null,t(v(M.amount)),1),M.phone_number?(s(),o("span",zi,t(M.phone_number),1)):p("",!0)]),M.status==="pending"&&M.timeout_at?(s(),o("div",Bi," Expire le "+t(r(M.timeout_at)),1)):p("",!0)]),e("div",Oi,[$(H,{to:{name:"customer.payment.detail",params:{id:M.id}},class:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"},{default:X(()=>c[22]||(c[22]=[L(" DÃ©tails ",-1)])),_:2,__:[22]},1032,["to"]),M.status==="expired"&&M.transaction_id?(s(),o("button",{key:0,onClick:E=>V(M.transaction_id),class:"bg-orange-600 text-white px-3 py-1 rounded text-sm hover:bg-orange-700"}," Relancer ",8,Gi)):p("",!0)])])])]))),128))])),C.value&&C.value.last_page>1?(s(),o("div",Hi,[e("div",Xi,[e("div",Ki," Affichage de "+t((C.value.current_page-1)*C.value.per_page+1)+" Ã  "+t(Math.min(C.value.current_page*C.value.per_page,C.value.total))+" sur "+t(C.value.total)+" rÃ©sultats ",1),e("div",Qi,[e("button",{onClick:c[5]||(c[5]=M=>k(C.value.current_page-1)),disabled:C.value.current_page<=1,class:"px-3 py-1 border rounded text-gray-700 hover:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed"}," PrÃ©cÃ©dent ",8,Wi),(s(!0),o(U,null,O(w(),M=>(s(),o("button",{key:M,onClick:E=>k(M),class:B(["px-3 py-1 border rounded",M===C.value.current_page?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"])},t(M),11,Ji))),128)),e("button",{onClick:c[6]||(c[6]=M=>k(C.value.current_page+1)),disabled:C.value.current_page>=C.value.last_page,class:"px-3 py-1 border rounded text-gray-700 hover:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed"}," Suivant ",8,Zi)])])])):p("",!0)]),d.value?(s(),o("div",Yi,[e("div",ed,[e("div",td,[e("div",{class:"flex justify-between items-center mb-4"},[c[25]||(c[25]=e("h3",{class:"text-lg font-medium text-gray-900"},"DÃ©tails du paiement",-1)),e("button",{onClick:h,class:"text-gray-400 hover:text-gray-600"},c[24]||(c[24]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),g.value?(s(),o("div",sd,[e("div",od,[e("div",null,[c[34]||(c[34]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Informations du paiement",-1)),e("dl",rd,[e("div",ld,[c[26]||(c[26]=e("dt",{class:"text-sm text-gray-600"},"ID de paiement:",-1)),e("dd",ad,t(g.value.billing_id||g.value.id),1)]),e("div",nd,[c[27]||(c[27]=e("dt",{class:"text-sm text-gray-600"},"Statut:",-1)),e("dd",null,[e("span",{class:B(n(g.value.status))},t(q(g.value.status)),3)])]),e("div",id,[c[28]||(c[28]=e("dt",{class:"text-sm text-gray-600"},"Montant:",-1)),e("dd",dd,t(v(g.value.amount)),1)]),e("div",ud,[c[29]||(c[29]=e("dt",{class:"text-sm text-gray-600"},"MÃ©thode:",-1)),e("dd",cd,t(x(g.value.payment_method)),1)]),g.value.phone_number?(s(),o("div",md,[c[30]||(c[30]=e("dt",{class:"text-sm text-gray-600"},"TÃ©lÃ©phone:",-1)),e("dd",pd,"+241 "+t(g.value.phone_number),1)])):p("",!0),e("div",gd,[c[31]||(c[31]=e("dt",{class:"text-sm text-gray-600"},"Date de crÃ©ation:",-1)),e("dd",vd,t(r(g.value.created_at)),1)]),g.value.updated_at?(s(),o("div",xd,[c[32]||(c[32]=e("dt",{class:"text-sm text-gray-600"},"DerniÃ¨re mise Ã  jour:",-1)),e("dd",yd,t(r(g.value.updated_at)),1)])):p("",!0),g.value.timeout_at?(s(),o("div",bd,[c[33]||(c[33]=e("dt",{class:"text-sm text-gray-600"},"Expiration:",-1)),e("dd",fd,t(r(g.value.timeout_at)),1)])):p("",!0)])]),g.value.transaction?(s(),o("div",_d,[c[35]||(c[35]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Transaction associÃ©e",-1)),e("div",hd,[e("p",wd,t(g.value.transaction.reference),1),e("p",$d,t(g.value.transaction.description||"Aucune description"),1),e("div",kd," Type: "+t(b(g.value.transaction.type)),1)])])):p("",!0)])])):p("",!0)])])])):p("",!0)])}}},W0=me(Cd,[["__scopeId","data-v-55c0b806"]]),jd={class:"order-detail"},Ed={key:0,class:"flex justify-center items-center min-h-64"},Pd={key:1,class:"text-center py-12"},Md={class:"text-gray-600 mb-4"},Ad={key:2},Td={class:"mb-8"},Dd={class:"flex items-center justify-between"},Sd={class:"text-3xl font-bold text-gray-900"},Rd={class:"text-gray-600 mt-2"},Vd={class:"flex items-center space-x-3"},Fd={class:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8"},Nd={class:"lg:col-span-2 space-y-6"},qd={class:"bg-white rounded-lg shadow p-6"},Id={class:"space-y-4"},Ld={class:"flex items-center"},Ud={class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},zd={class:"ml-4"},Bd={class:"text-sm text-gray-500"},Od={key:0,class:"flex items-center"},Gd={class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},Hd={class:"ml-4"},Xd={class:"text-sm text-gray-500"},Kd={key:1,class:"flex items-center"},Qd={class:"flex-shrink-0 w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center"},Wd={class:"ml-4"},Jd={class:"text-sm text-gray-500"},Zd={key:2,class:"flex items-center"},Yd={class:"flex-shrink-0 w-8 h-8 bg-red-100 rounded-full flex items-center justify-center"},eu={class:"ml-4"},tu={class:"text-sm text-gray-500"},su={key:0,class:"text-sm text-gray-500"},ou={class:"bg-white rounded-lg shadow p-6"},ru={key:0,class:"flex items-start space-x-4 mb-6"},lu={class:"flex-shrink-0 w-16 h-16 bg-gray-200 rounded-lg overflow-hidden"},au=["src","alt"],nu={key:1,class:"w-full h-full flex items-center justify-center"},iu={class:"flex-1"},du={class:"text-lg font-medium text-gray-900"},uu={class:"text-sm text-gray-600 mt-1"},cu={class:"mt-2 flex items-center space-x-4 text-sm text-gray-500"},mu={key:0},pu={key:1,class:"border rounded-lg p-4 bg-blue-50"},gu={class:"flex items-center mb-3"},vu={class:"text-lg font-medium text-gray-900"},xu={class:"grid grid-cols-2 gap-4 text-sm"},yu={class:"font-medium ml-2"},bu={class:"font-medium ml-2"},fu={class:"font-medium ml-2"},_u={key:0},hu={class:"font-medium ml-2"},wu={key:0,class:"mt-3 p-3 bg-green-100 rounded-lg"},$u={class:"flex items-center"},ku={class:"text-sm font-medium text-green-800"},Cu={key:0,class:"bg-white rounded-lg shadow p-6"},ju={class:"text-lg font-semibold text-gray-900 mb-4"},Eu={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Pu={class:"flex justify-between items-start"},Mu={class:"font-medium text-gray-900"},Au={class:"text-sm text-gray-600"},Tu={class:"text-right"},Du={key:0,class:"mt-1"},Su={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},Ru={key:0,class:"mt-2 text-xs text-gray-500"},Vu={class:"space-y-6"},Fu={class:"bg-white rounded-lg shadow p-6"},Nu={class:"space-y-3"},qu={class:"flex justify-between text-sm"},Iu={class:"font-medium"},Lu={class:"border-t pt-3"},Uu={class:"flex justify-between"},zu={class:"text-base font-medium text-gray-900"},Bu={class:"bg-white rounded-lg shadow p-6"},Ou={class:"space-y-3 text-sm"},Gu={class:"font-medium font-mono"},Hu={key:0},Xu={class:"font-medium"},Ku={key:1},Qu={class:"font-medium"},Wu={class:"bg-white rounded-lg shadow p-6"},Ju={class:"space-y-3"},Zu={__name:"OrderDetail",setup(R){const A=Ce(),N=pe(),{apiRequest:P}=se(),{showSuccess:D}=ve(),a=S(null),C=S(!0),j=S(null),d=async()=>{try{C.value=!0;const b=A.params.id,n=await P(`/api/orders/${b}`,"GET");n.success?a.value=n.data:j.value=n.message||"Commande non trouvÃ©e"}catch(b){console.error("Erreur lors du chargement de la commande:",b),j.value="Erreur lors du chargement de la commande"}finally{C.value=!1}},g=()=>{N.push({name:"payment.phone",query:{transaction_id:a.value.transaction_id,retry:"true"}})},F=()=>{D("FonctionnalitÃ© de tÃ©lÃ©chargement en cours de dÃ©veloppement")},_=b=>({completed:"ComplÃ©tÃ©",pending:"En attente",payment_initiated:"Paiement initiÃ©",failed:"Ã‰chouÃ©",paid:"PayÃ©",refunded:"RemboursÃ©"})[b]||b,k=b=>({lottery:"Loterie",direct:"Achat direct"})[b]||b,V=b=>({airtel_money:"Airtel Money",moov_money:"Moov Money"})[b]||b||"Non spÃ©cifiÃ©",h=b=>`px-2 py-1 text-xs rounded-full font-medium ${{completed:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",payment_initiated:"bg-blue-100 text-blue-800",failed:"bg-red-100 text-red-800",paid:"bg-green-100 text-green-800",refunded:"bg-gray-100 text-gray-800"}[b]||"bg-gray-100 text-gray-800"}`,q=b=>b?new Date(b).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Non dÃ©fini",x=b=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(b||0).replace("XAF","FCFA");return Y(()=>{d()}),(b,n)=>{const r=le("router-link");return s(),o("div",jd,[C.value?(s(),o("div",Ed,n[1]||(n[1]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)]))):j.value?(s(),o("div",Pd,[n[3]||(n[3]=e("svg",{class:"w-16 h-16 text-red-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),n[4]||(n[4]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Commande introuvable",-1)),e("p",Md,t(j.value),1),$(r,{to:"/customer/orders",class:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700"},{default:X(()=>n[2]||(n[2]=[L(" Retour aux commandes ",-1)])),_:1,__:[2]})])):a.value?(s(),o("div",Ad,[e("div",Td,[e("div",Dd,[e("div",null,[e("h1",Sd,"Commande #"+t(a.value.transaction_id),1),e("p",Rd,t(q(a.value.created_at)),1)]),e("div",Vd,[e("span",{class:B(h(a.value.status))},t(_(a.value.status)),3),e("button",{onClick:n[0]||(n[0]=v=>b.$router.go(-1)),class:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 transition-colors"},[$(m(je),{class:"w-4 h-4 inline mr-2"}),n[5]||(n[5]=L(" Retour ",-1))])])])]),e("div",Fd,[e("div",Nd,[e("div",qd,[n[10]||(n[10]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Statut de la commande",-1)),e("div",Id,[e("div",Ld,[e("div",Ud,[$(m(ue),{class:"w-5 h-5 text-green-600"})]),e("div",zd,[n[6]||(n[6]=e("p",{class:"text-sm font-medium text-gray-900"},"Commande crÃ©Ã©e",-1)),e("p",Bd,t(q(a.value.created_at)),1)])]),a.value.paid_at||a.value.completed_at?(s(),o("div",Od,[e("div",Gd,[$(m(ue),{class:"w-5 h-5 text-green-600"})]),e("div",Hd,[n[7]||(n[7]=e("p",{class:"text-sm font-medium text-gray-900"},"Paiement confirmÃ©",-1)),e("p",Xd,t(q(a.value.completed_at||a.value.paid_at)),1)])])):p("",!0),a.value.status==="pending"?(s(),o("div",Kd,[e("div",Qd,[$(m(ye),{class:"w-5 h-5 text-yellow-600"})]),e("div",Wd,[n[8]||(n[8]=e("p",{class:"text-sm font-medium text-gray-900"},"En attente de paiement",-1)),e("p",Jd,"Expire le "+t(q(a.value.expires_at)),1)])])):p("",!0),a.value.status==="failed"?(s(),o("div",Zd,[e("div",Yd,[$(m(ge),{class:"w-5 h-5 text-red-600"})]),e("div",eu,[n[9]||(n[9]=e("p",{class:"text-sm font-medium text-gray-900"},"Paiement Ã©chouÃ©",-1)),e("p",tu,t(a.value.failure_reason||"Raison non spÃ©cifiÃ©e"),1),a.value.failed_at?(s(),o("p",su,t(q(a.value.failed_at)),1)):p("",!0)])])):p("",!0)])]),e("div",ou,[n[15]||(n[15]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"DÃ©tails de l'achat",-1)),a.value.product?(s(),o("div",ru,[e("div",lu,[a.value.product.image?(s(),o("img",{key:0,src:a.value.product.image,alt:a.value.product.name,class:"w-full h-full object-cover"},null,8,au)):(s(),o("div",nu,[$(m(xe),{class:"w-8 h-8 text-gray-400"})]))]),e("div",iu,[e("h3",du,t(a.value.product.name),1),e("p",uu,t(a.value.product.description),1),e("div",cu,[e("span",null,"Mode: "+t(k(a.value.product.sale_mode)),1),a.value.quantity?(s(),o("span",mu,"QuantitÃ©: "+t(a.value.quantity),1)):p("",!0)])])])):p("",!0),a.value.lottery?(s(),o("div",pu,[e("div",gu,[$(m(te),{class:"w-5 h-5 text-blue-600 mr-2"}),e("h3",vu,t(a.value.lottery.title),1)]),e("div",xu,[e("div",null,[n[11]||(n[11]=e("span",{class:"text-gray-600"},"NumÃ©ro de loterie:",-1)),e("span",yu,t(a.value.lottery.lottery_number),1)]),e("div",null,[n[12]||(n[12]=e("span",{class:"text-gray-600"},"Prix du billet:",-1)),e("span",bu,t(x(a.value.lottery.ticket_price)),1)]),e("div",null,[n[13]||(n[13]=e("span",{class:"text-gray-600"},"Billets vendus:",-1)),e("span",fu,t(a.value.lottery.sold_tickets)+"/"+t(a.value.lottery.max_tickets),1)]),a.value.lottery.draw_date?(s(),o("div",_u,[n[14]||(n[14]=e("span",{class:"text-gray-600"},"Date du tirage:",-1)),e("span",hu,t(q(a.value.lottery.draw_date)),1)])):p("",!0)]),a.value.lottery.winner_ticket_number?(s(),o("div",wu,[e("div",$u,[$(m(ae),{class:"w-5 h-5 text-green-600 mr-2"}),e("span",ku," Billet gagnant: "+t(a.value.lottery.winner_ticket_number),1)])])):p("",!0)])):p("",!0)]),a.value.tickets&&a.value.tickets.length>0?(s(),o("div",Cu,[e("h2",ju," Billets de loterie ("+t(a.value.tickets.length)+") ",1),e("div",Eu,[(s(!0),o(U,null,O(a.value.tickets,v=>(s(),o("div",{key:v.id,class:B(["border rounded-lg p-4 transition-colors",v.is_winner?"bg-green-50 border-green-200 ring-2 ring-green-500":"bg-gray-50 border-gray-200"])},[e("div",Pu,[e("div",null,[e("p",Mu,t(v.ticket_number),1),e("p",Au,t(x(v.price_paid)),1)]),e("div",Tu,[e("span",{class:B(h(v.status))},t(_(v.status)),3),v.is_winner?(s(),o("div",Du,[e("span",Su,[$(m(ae),{class:"w-3 h-3 mr-1"}),n[16]||(n[16]=L(" Gagnant ",-1))])])):p("",!0)])]),v.purchased_at?(s(),o("div",Ru," AchetÃ© le "+t(q(v.purchased_at)),1)):p("",!0)],2))),128))])])):p("",!0)]),e("div",Vu,[e("div",Fu,[n[19]||(n[19]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"RÃ©sumÃ© financier",-1)),e("dl",Nu,[e("div",qu,[n[17]||(n[17]=e("dt",{class:"text-gray-600"},"Sous-total:",-1)),e("dd",Iu,t(x(a.value.amount)),1)]),e("div",Lu,[e("div",Uu,[n[18]||(n[18]=e("dt",{class:"text-base font-medium text-gray-900"},"Total:",-1)),e("dd",zu,t(x(a.value.amount)),1)])])])]),e("div",Bu,[n[23]||(n[23]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Informations de paiement",-1)),e("dl",Ou,[e("div",null,[n[20]||(n[20]=e("dt",{class:"text-gray-600"},"RÃ©fÃ©rence:",-1)),e("dd",Gu,t(a.value.reference),1)]),a.value.payment_method?(s(),o("div",Hu,[n[21]||(n[21]=e("dt",{class:"text-gray-600"},"MÃ©thode:",-1)),e("dd",Xu,t(V(a.value.payment_method)),1)])):p("",!0),a.value.phone_number?(s(),o("div",Ku,[n[22]||(n[22]=e("dt",{class:"text-gray-600"},"TÃ©lÃ©phone:",-1)),e("dd",Qu,"+241 "+t(a.value.phone_number),1)])):p("",!0)])]),e("div",Wu,[n[27]||(n[27]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Actions",-1)),e("div",Ju,[a.value.status==="failed"?(s(),o("button",{key:0,onClick:g,class:"w-full bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors"},[$(m(Re),{class:"w-4 h-4 inline mr-2"}),n[24]||(n[24]=L(" RÃ©essayer le paiement ",-1))])):p("",!0),e("button",{onClick:F,class:"w-full bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 transition-colors"},[$(m(Ve),{class:"w-4 h-4 inline mr-2"}),n[25]||(n[25]=L(" TÃ©lÃ©charger le reÃ§u ",-1))]),$(r,{to:"/customer/orders",class:"w-full block text-center bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors"},{default:X(()=>n[26]||(n[26]=[L(" Voir toutes les commandes ",-1)])),_:1,__:[26]})])])])])])):p("",!0)])}}},J0=me(Zu,[["__scopeId","data-v-c1888059"]]),Yu="/build/assets/am-CfOZUG_l.png",ec="/build/assets/mm-BaxcDjGZ.png",tc={class:"payment-detail"},sc={key:0,class:"flex justify-center items-center min-h-64"},oc={key:1,class:"text-center py-12"},rc={class:"text-gray-600 mb-4"},lc={key:2},ac={class:"mb-8"},nc={class:"flex items-center justify-between"},ic={class:"text-3xl font-bold text-gray-900"},dc={class:"text-gray-600 mt-2"},uc={class:"flex items-center space-x-3"},cc={class:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8"},mc={class:"lg:col-span-2 space-y-6"},pc={class:"bg-white rounded-lg shadow p-6"},gc={class:"space-y-4"},vc={class:"flex items-center"},xc={class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},yc={class:"ml-4"},bc={class:"text-sm text-gray-500"},fc={key:0,class:"flex items-center"},_c={class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},hc={class:"ml-4"},wc={class:"text-sm text-gray-500"},$c={key:1,class:"flex items-center"},kc={class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},Cc={class:"ml-4"},jc={class:"text-sm text-gray-500"},Ec={key:2,class:"flex items-center"},Pc={class:"flex-shrink-0 w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center"},Mc={key:3,class:"flex items-center"},Ac={class:"flex-shrink-0 w-8 h-8 bg-red-100 rounded-full flex items-center justify-center"},Tc={class:"ml-4"},Dc={class:"text-sm font-medium text-gray-900"},Sc={key:0,class:"text-sm text-gray-500"},Rc={class:"bg-white rounded-lg shadow p-6"},Vc={class:"flex items-center space-x-4"},Fc={class:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center"},Nc=["src","alt"],qc={class:"text-lg font-medium text-gray-900"},Ic={key:0,class:"text-sm text-gray-600"},Lc={key:1,class:"text-sm text-gray-500"},Uc={key:0,class:"bg-white rounded-lg shadow p-6"},zc={key:0,class:"flex items-start space-x-4 mb-4"},Bc={class:"flex-shrink-0 w-16 h-16 bg-gray-200 rounded-lg overflow-hidden"},Oc=["src","alt"],Gc={key:1,class:"w-full h-full flex items-center justify-center"},Hc={class:"flex-1"},Xc={class:"text-lg font-medium text-gray-900"},Kc={class:"text-sm text-gray-600 mt-1"},Qc={class:"mt-2 flex items-center space-x-4 text-sm text-gray-500"},Wc={key:0},Jc={key:1,class:"border rounded-lg p-4 bg-blue-50"},Zc={class:"flex items-center mb-3"},Yc={class:"text-lg font-medium text-gray-900"},e0={class:"grid grid-cols-2 gap-4 text-sm"},t0={class:"font-medium ml-2"},s0={class:"font-medium ml-2"},o0={key:2,class:"mt-4"},r0={class:"text-md font-medium text-gray-900 mb-3"},l0={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},a0={class:"flex justify-between items-center"},n0={class:"font-medium"},i0={class:"flex items-center space-x-2"},d0={key:1,class:"bg-white rounded-lg shadow p-6"},u0={class:"bg-gray-50 rounded-lg p-4"},c0={class:"text-sm text-gray-700 whitespace-pre-wrap"},m0={class:"space-y-6"},p0={class:"bg-white rounded-lg shadow p-6"},g0={class:"space-y-3"},v0={class:"flex justify-between text-sm"},x0={class:"font-medium"},y0={class:"flex justify-between text-sm"},b0={class:"font-medium"},f0={class:"border-t pt-3"},_0={class:"flex justify-between"},h0={class:"text-base font-medium text-gray-900"},w0={class:"bg-white rounded-lg shadow p-6"},$0={class:"space-y-3 text-sm"},k0={key:0},C0={class:"font-medium font-mono break-all"},j0={key:1},E0={class:"font-medium font-mono"},P0={key:2},M0={class:"font-medium font-mono break-all"},A0={key:3},T0={class:"font-medium"},D0={key:4},S0={class:"font-medium"},R0={class:"bg-white rounded-lg shadow p-6"},V0={class:"space-y-3"},F0={__name:"PaymentDetail",setup(R){const A=Ce(),N=pe(),{apiRequest:P}=se(),{showSuccess:D}=ve(),a=S(null),C=S(!0),j=S(null),d=async()=>{try{C.value=!0;const n=A.params.id,r=await P(`/api/payments/${n}`,"GET");r.success?a.value=r.data:j.value=r.message||"Paiement non trouvÃ©"}catch(n){console.error("Erreur lors du chargement du paiement:",n),j.value="Erreur lors du chargement du paiement"}finally{C.value=!1}},g=()=>{a.value.transaction&&N.push({name:"payment.phone",query:{transaction_id:a.value.transaction.transaction_id,retry:"true"}})},F=()=>{a.value.transaction&&N.push({name:"customer.order.detail",params:{id:a.value.transaction.transaction_id}})},_=()=>{D("FonctionnalitÃ© de tÃ©lÃ©chargement en cours de dÃ©veloppement")},k=n=>({paid:"PayÃ©",pending:"En attente",failed:"Ã‰chouÃ©",expired:"ExpirÃ©",processed:"TraitÃ©"})[n]||n,V=n=>({airtel_money:"Airtel Money",moov_money:"Moov Money"})[n]||n||"Non spÃ©cifiÃ©",h=n=>({airtel_money:Yu,moov_money:ec})[n],q=(n,r=!1)=>`${r?"px-1 py-0.5 text-xs":"px-2 py-1 text-xs"} rounded-full font-medium ${{paid:"bg-green-100 text-green-800",processed:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",failed:"bg-red-100 text-red-800",expired:"bg-gray-100 text-gray-800"}[n]||"bg-gray-100 text-gray-800"}`,x=n=>n?new Date(n).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Non dÃ©fini",b=n=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(n||0).replace("XAF","FCFA");return Y(()=>{d()}),(n,r)=>{const v=le("router-link");return s(),o("div",tc,[C.value?(s(),o("div",sc,r[1]||(r[1]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)]))):j.value?(s(),o("div",oc,[r[3]||(r[3]=e("svg",{class:"w-16 h-16 text-red-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),r[4]||(r[4]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Paiement introuvable",-1)),e("p",rc,t(j.value),1),$(v,{to:"/customer/payments",class:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700"},{default:X(()=>r[2]||(r[2]=[L(" Retour aux paiements ",-1)])),_:1,__:[2]})])):a.value?(s(),o("div",lc,[e("div",ac,[e("div",nc,[e("div",null,[e("h1",ic," Paiement #"+t(a.value.ebilling_id||a.value.id),1),e("p",dc,t(x(a.value.created_at)),1)]),e("div",uc,[e("span",{class:B(q(a.value.status))},t(k(a.value.status)),3),e("button",{onClick:r[0]||(r[0]=w=>n.$router.go(-1)),class:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 transition-colors"},[$(m(je),{class:"w-4 h-4 inline mr-2"}),r[5]||(r[5]=L(" Retour ",-1))])])])]),e("div",cc,[e("div",mc,[e("div",pc,[r[10]||(r[10]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Statut du paiement",-1)),e("div",gc,[e("div",vc,[e("div",xc,[$(m(ue),{class:"w-5 h-5 text-green-600"})]),e("div",yc,[r[6]||(r[6]=e("p",{class:"text-sm font-medium text-gray-900"},"Paiement initiÃ©",-1)),e("p",bc,t(x(a.value.created_at)),1)])]),a.value.paid_at?(s(),o("div",fc,[e("div",_c,[$(m(ue),{class:"w-5 h-5 text-green-600"})]),e("div",hc,[r[7]||(r[7]=e("p",{class:"text-sm font-medium text-gray-900"},"Paiement confirmÃ©",-1)),e("p",wc,t(x(a.value.paid_at)),1)])])):p("",!0),a.value.processed_at?(s(),o("div",$c,[e("div",kc,[$(m(ue),{class:"w-5 h-5 text-green-600"})]),e("div",Cc,[r[8]||(r[8]=e("p",{class:"text-sm font-medium text-gray-900"},"Paiement traitÃ©",-1)),e("p",jc,t(x(a.value.processed_at)),1)])])):p("",!0),a.value.status==="pending"?(s(),o("div",Ec,[e("div",Pc,[$(m(ye),{class:"w-5 h-5 text-yellow-600"})]),r[9]||(r[9]=e("div",{class:"ml-4"},[e("p",{class:"text-sm font-medium text-gray-900"},"En attente de confirmation"),e("p",{class:"text-sm text-gray-500"},"Veuillez confirmer sur votre tÃ©lÃ©phone")],-1))])):p("",!0),a.value.status==="failed"||a.value.status==="expired"?(s(),o("div",Mc,[e("div",Ac,[$(m(ge),{class:"w-5 h-5 text-red-600"})]),e("div",Tc,[e("p",Dc,t(a.value.status==="expired"?"Paiement expirÃ©":"Paiement Ã©chouÃ©"),1),a.value.gateway_response&&a.value.gateway_response.failure_reason?(s(),o("p",Sc,t(a.value.gateway_response.failure_reason),1)):p("",!0)])])):p("",!0)])]),e("div",Rc,[r[11]||(r[11]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"MÃ©thode de paiement",-1)),e("div",Vc,[e("div",Fc,[h(a.value.payment_method)?(s(),o("img",{key:0,src:h(a.value.payment_method),alt:V(a.value.payment_method),class:"w-12 h-12 object-contain"},null,8,Nc)):(s(),Z(m(Ze),{key:1,class:"w-8 h-8 text-gray-400"}))]),e("div",null,[e("h3",qc,t(V(a.value.payment_method)),1),a.value.customer_phone?(s(),o("p",Ic," +241 "+t(a.value.customer_phone),1)):p("",!0),a.value.gateway?(s(),o("p",Lc," Via "+t(a.value.gateway.display_name),1)):p("",!0)])])]),a.value.transaction?(s(),o("div",Uc,[r[14]||(r[14]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Transaction associÃ©e",-1)),a.value.transaction.product?(s(),o("div",zc,[e("div",Bc,[a.value.transaction.product.image?(s(),o("img",{key:0,src:a.value.transaction.product.image,alt:a.value.transaction.product.name,class:"w-full h-full object-cover"},null,8,Oc)):(s(),o("div",Gc,[$(m(xe),{class:"w-8 h-8 text-gray-400"})]))]),e("div",Hc,[e("h3",Xc,t(a.value.transaction.product.name),1),e("p",Kc,t(a.value.transaction.product.description),1),e("div",Qc,[e("span",null,"RÃ©fÃ©rence: "+t(a.value.transaction.reference),1),a.value.transaction.quantity?(s(),o("span",Wc,"QuantitÃ©: "+t(a.value.transaction.quantity),1)):p("",!0)])])])):p("",!0),a.value.transaction.lottery?(s(),o("div",Jc,[e("div",Zc,[$(m(te),{class:"w-5 h-5 text-blue-600 mr-2"}),e("h3",Yc,t(a.value.transaction.lottery.title),1)]),e("div",e0,[e("div",null,[r[12]||(r[12]=e("span",{class:"text-gray-600"},"NumÃ©ro de loterie:",-1)),e("span",t0,t(a.value.transaction.lottery.lottery_number),1)]),e("div",null,[r[13]||(r[13]=e("span",{class:"text-gray-600"},"Prix du billet:",-1)),e("span",s0,t(b(a.value.transaction.lottery.ticket_price)),1)])])])):p("",!0),a.value.transaction.tickets&&a.value.transaction.tickets.length>0?(s(),o("div",o0,[e("h3",r0," Billets achetÃ©s ("+t(a.value.transaction.tickets.length)+") ",1),e("div",l0,[(s(!0),o(U,null,O(a.value.transaction.tickets,w=>(s(),o("div",{key:w.id,class:B(["border rounded-lg p-3 text-sm",w.is_winner?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"])},[e("div",a0,[e("span",n0,t(w.ticket_number),1),e("div",i0,[e("span",{class:B(q(w.status,!0))},t(k(w.status)),3),w.is_winner?(s(),Z(m(ae),{key:0,class:"w-4 h-4 text-green-600"})):p("",!0)])])],2))),128))])])):p("",!0)])):p("",!0),a.value.gateway_response?(s(),o("div",d0,[r[15]||(r[15]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"RÃ©ponse de la passerelle",-1)),e("div",u0,[e("pre",c0,t(JSON.stringify(a.value.gateway_response,null,2)),1)])])):p("",!0)]),e("div",m0,[e("div",p0,[r[19]||(r[19]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"RÃ©sumÃ© du paiement",-1)),e("dl",g0,[e("div",v0,[r[16]||(r[16]=e("dt",{class:"text-gray-600"},"Montant:",-1)),e("dd",x0,t(b(a.value.amount)),1)]),e("div",y0,[r[17]||(r[17]=e("dt",{class:"text-gray-600"},"Devise:",-1)),e("dd",b0,t(a.value.currency||"XAF"),1)]),e("div",f0,[e("div",_0,[r[18]||(r[18]=e("dt",{class:"text-base font-medium text-gray-900"},"Total:",-1)),e("dd",h0,t(b(a.value.amount)),1)])])])]),e("div",w0,[r[25]||(r[25]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"DÃ©tails techniques",-1)),e("dl",$0,[a.value.reference?(s(),o("div",k0,[r[20]||(r[20]=e("dt",{class:"text-gray-600"},"RÃ©fÃ©rence:",-1)),e("dd",C0,t(a.value.reference),1)])):p("",!0),a.value.ebilling_id?(s(),o("div",j0,[r[21]||(r[21]=e("dt",{class:"text-gray-600"},"ID E-Billing:",-1)),e("dd",E0,t(a.value.ebilling_id),1)])):p("",!0),a.value.external_transaction_id?(s(),o("div",P0,[r[22]||(r[22]=e("dt",{class:"text-gray-600"},"ID Transaction externe:",-1)),e("dd",M0,t(a.value.external_transaction_id),1)])):p("",!0),a.value.customer_name?(s(),o("div",A0,[r[23]||(r[23]=e("dt",{class:"text-gray-600"},"Nom du client:",-1)),e("dd",T0,t(a.value.customer_name),1)])):p("",!0),a.value.customer_email?(s(),o("div",D0,[r[24]||(r[24]=e("dt",{class:"text-gray-600"},"Email:",-1)),e("dd",S0,t(a.value.customer_email),1)])):p("",!0)])]),e("div",R0,[r[30]||(r[30]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Actions",-1)),e("div",V0,[a.value.status==="failed"||a.value.status==="expired"?(s(),o("button",{key:0,onClick:g,class:"w-full bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors"},[$(m(Re),{class:"w-4 h-4 inline mr-2"}),r[26]||(r[26]=L(" RÃ©essayer le paiement ",-1))])):p("",!0),a.value.transaction?(s(),o("button",{key:1,onClick:F,class:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors"},[$(m(Ye),{class:"w-4 h-4 inline mr-2"}),r[27]||(r[27]=L(" Voir la commande ",-1))])):p("",!0),e("button",{onClick:_,class:"w-full bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 transition-colors"},[$(m(Ve),{class:"w-4 h-4 inline mr-2"}),r[28]||(r[28]=L(" TÃ©lÃ©charger le reÃ§u ",-1))]),$(v,{to:"/customer/payments",class:"w-full block text-center bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors"},{default:X(()=>r[29]||(r[29]=[L(" Voir tous les paiements ",-1)])),_:1,__:[29]})])])])])])):p("",!0)])}}},Z0=me(F0,[["__scopeId","data-v-bf89ffba"]]);export{Q0 as O,it as P,B0 as _,Yu as a,O0 as b,G0 as c,H0 as d,X0 as e,K0 as f,W0 as g,J0 as h,Z0 as i,ec as m};
