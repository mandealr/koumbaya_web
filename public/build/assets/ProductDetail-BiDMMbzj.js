import{r as g,c as M,j as O,b as u,l as b,e,g as a,u as d,a0 as Z,t as r,w as P,h as H,i as m,aD as J,v as T,aZ as W,a_ as X,aR as Y,s as ee,F as te,y as se,G as oe,aI as re,aL as le,aj as ae,x as ie,U as y,V as _,$ as de,K as ne,q as ue,o as c,aw as V}from"./vendor-Diu_jut8.js";import{_ as ce,u as me,a as pe}from"./app-Pl_o16T6.js";const ge={class:"product-detail"},ve={key:0,class:"min-h-screen flex items-center justify-center"},xe={key:1,class:"min-h-screen flex items-center justify-center"},be={class:"text-center max-w-md mx-auto px-4"},ye={class:"mb-6"},fe={class:"text-gray-600 mb-6"},_e={class:"space-y-3"},he={key:2,class:"space-y-6"},we={class:"flex items-center justify-between"},ke={class:"flex items-center space-x-3 mb-2"},$e={class:"text-3xl font-bold text-gray-900"},je={class:"flex space-x-3"},Ce={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Pe={class:"lg:col-span-2 space-y-6"},De={class:"bg-white rounded-xl shadow-sm border"},Ee={class:"p-6"},Se={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Me={class:"md:col-span-2"},Te={class:"flex space-x-6"},Ve={class:"flex-shrink-0"},qe=["src","alt"],Re={class:"flex-1"},Ae={class:"text-xl font-semibold text-gray-900 mb-2"},Fe={class:"text-gray-600 mb-4"},Ie={class:"grid grid-cols-2 gap-4"},Ne={class:"text-lg font-semibold text-gray-900"},Ue={class:"text-lg font-semibold text-gray-900"},Be={class:"text-lg font-semibold text-gray-900"},Le={class:"text-lg font-semibold text-gray-900"},ze={class:"bg-white rounded-xl shadow-sm border"},Ge={class:"p-6"},Qe={class:"flex items-center space-x-4"},Ke={class:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center"},Oe={class:"font-semibold text-gray-900"},Ze={class:"text-sm text-gray-600"},He={class:"text-sm text-gray-500"},Je={class:"mt-4 grid grid-cols-2 gap-4"},We={class:"text-sm text-gray-900"},Xe={class:"text-sm text-gray-900"},Ye={key:0,class:"bg-white rounded-xl shadow-sm border"},et={class:"p-6"},tt={class:"space-y-4"},st={class:"flex justify-between items-start"},ot={class:"font-semibold text-gray-900"},rt={class:"text-sm text-gray-600 mt-1"},lt={class:"flex items-center space-x-4 mt-2 text-sm text-gray-500"},at={class:"text-right"},it={class:"space-y-6"},dt={class:"bg-white rounded-xl shadow-sm border"},nt={class:"p-6 space-y-4"},ut={class:"flex justify-between"},ct={class:"text-sm font-medium text-gray-900"},mt={class:"flex justify-between"},pt={class:"text-sm font-medium text-gray-900"},gt={class:"flex justify-between"},vt={class:"text-sm font-medium text-gray-900"},xt={class:"flex justify-between"},bt={class:"text-sm font-medium text-gray-900"},yt={class:"bg-white rounded-xl shadow-sm border"},ft={class:"p-6 space-y-4"},_t={class:"text-sm text-gray-900"},ht={class:"text-sm text-gray-900"},wt={class:"text-sm font-mono text-gray-900"},kt={class:"bg-white rounded-xl shadow-sm border"},$t={class:"p-6 space-y-3"},jt={key:3,class:"fixed inset-0 bg-black/40 overflow-y-auto h-full w-full z-50"},Ct={class:"relative top-20 mx-auto p-5 border w-11/12 max-w-3xl shadow-lg rounded-md bg-white"},Pt={class:"mt-3"},Dt={class:"flex justify-between items-center mb-4"},Et={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},St={class:"md:col-span-2"},Mt={class:"md:col-span-2"},Tt={class:"flex justify-end space-x-3 mt-6"},Vt=["disabled"],qt={__name:"ProductDetail",setup(Rt){const q=ne(),h=ue(),{get:R,put:A,patch:F,delete:I}=me(),{showSuccess:w,showError:p}=pe(),s=g(null),k=g(!1),v=g(""),x=g(!1),f=g(!1),i=g({name:"",description:"",price:0,quantity:0,status:"active"}),N=M(()=>s.value?.lotteries?s.value.lotteries.reduce((o,t)=>o+(t.sold_tickets||0),0):0),U=M(()=>s.value?.lotteries?s.value.lotteries.reduce((o,t)=>o+(t.sold_tickets||0)*(t.ticket_price||0),0):0),$=async()=>{k.value=!0,v.value="";try{const o=await R(`/admin/products/${q.params.id}`);o.success?(s.value=o.data.product,i.value={name:s.value.name,description:s.value.description||"",price:s.value.price,quantity:s.value.quantity||0,status:s.value.status}):v.value=o.message||"Erreur lors du chargement du produit"}catch(o){console.error("Erreur lors du chargement du produit:",o),v.value=o.response?.data?.message||"Erreur lors du chargement du produit"}finally{k.value=!1}},B=()=>{x.value=!0},L=async()=>{f.value=!0;try{const o=await A(`/admin/products/${s.value.id}`,i.value);o.success?(w("Produit mis à jour avec succès"),x.value=!1,await $()):p(o.message||"Erreur lors de la mise à jour")}catch(o){console.error("Erreur lors de la mise à jour:",o),p(o.response?.data?.message||"Erreur lors de la mise à jour")}finally{f.value=!1}},D=async()=>{const o=s.value.status==="active"?"inactive":"active",t=o==="active"?"activer":"désactiver";if(confirm(`Êtes-vous sûr de vouloir ${t} ce produit ?`))try{const n=await F(`/admin/products/${s.value.id}/status`,{status:o});n.success?(w(`Produit ${t==="activer"?"activé":"désactivé"} avec succès`),s.value.status=o):p(n.message||`Erreur lors de la ${t}`)}catch(n){console.error("Erreur lors du changement de statut:",n),p(n.response?.data?.message||`Erreur lors de la ${t}`)}},z=async()=>{if(confirm("Êtes-vous sûr de vouloir supprimer ce produit ? Cette action est irréversible."))try{const o=await I(`/admin/products/${s.value.id}`);o.success?(w("Produit supprimé avec succès"),h.push("/admin/products")):p(o.message||"Erreur lors de la suppression")}catch(o){console.error("Erreur lors de la suppression:",o),p(o.response?.data?.message||"Erreur lors de la suppression")}},G=()=>{h.push(`/admin/lotteries/create?product_id=${s.value.id}`)},Q=()=>{h.push(`/admin/orders?product_id=${s.value.id}`)},j=o=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(o||0)+" FCFA",C=o=>o?new Date(o).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Non définie",E=o=>({active:"Actif",inactive:"Inactif",out_of_stock:"Rupture de stock",completed:"Terminé",cancelled:"Annulé",pending:"En attente"})[o]||o,S=o=>`px-3 py-1 rounded-full text-sm font-medium ${{active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",out_of_stock:"bg-red-100 text-red-800",completed:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800"}[o]||"bg-gray-100 text-gray-800"}`,K=o=>({physical:"Produit physique",digital:"Produit numérique",service:"Service",lottery:"Tombola"})[o]||o||"Non spécifié";return O(()=>{$()}),(o,t)=>{const n=H("router-link");return c(),u("div",ge,[k.value?(c(),u("div",ve,t[7]||(t[7]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),e("p",{class:"text-gray-600 mt-4 text-lg"},"Chargement du produit...")],-1)]))):v.value?(c(),u("div",xe,[e("div",be,[e("div",ye,[a(d(Z),{class:"w-20 h-20 text-red-500 mx-auto mb-4"}),t[8]||(t[8]=e("h2",{class:"text-3xl font-bold text-gray-900 mb-2"},"Produit introuvable",-1)),e("p",fe,r(v.value),1)]),e("div",_e,[a(n,{to:"/admin/products",class:"block bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors"},{default:P(()=>[a(d(V),{class:"w-5 h-5 inline mr-2"}),t[9]||(t[9]=m(" Retour aux produits ",-1))]),_:1,__:[9]}),e("button",{onClick:$,class:"block w-full bg-gray-200 text-gray-700 px-6 py-3 rounded-md hover:bg-gray-300 transition-colors"},[a(d(J),{class:"w-5 h-5 inline mr-2"}),t[10]||(t[10]=m(" Réessayer ",-1))])])])])):s.value?(c(),u("div",he,[e("div",we,[e("div",null,[e("div",ke,[a(n,{to:"/admin/products",class:"text-gray-500 hover:text-gray-700"},{default:P(()=>[a(d(V),{class:"w-5 h-5"})]),_:1}),e("h1",$e,r(s.value.name),1),e("span",{class:T(S(s.value.status))},r(E(s.value.status)),3)]),t[11]||(t[11]=e("p",{class:"text-gray-600"},"Gérer et visualiser les détails de ce produit",-1))]),e("div",je,[s.value.status==="active"?(c(),u("button",{key:0,onClick:D,class:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"},[a(d(W),{class:"w-4 h-4 mr-2 inline"}),t[12]||(t[12]=m(" Désactiver ",-1))])):b("",!0),s.value.status==="inactive"?(c(),u("button",{key:1,onClick:D,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"},[a(d(X),{class:"w-4 h-4 mr-2 inline"}),t[13]||(t[13]=m(" Activer ",-1))])):b("",!0),e("button",{onClick:B,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},[a(d(Y),{class:"w-4 h-4 mr-2 inline"}),t[14]||(t[14]=m(" Modifier ",-1))])])]),e("div",Ce,[e("div",Pe,[e("div",De,[t[19]||(t[19]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Informations du produit")],-1)),e("div",Ee,[e("div",Se,[e("div",Me,[e("div",Te,[e("div",Ve,[e("img",{src:s.value.image_url||s.value.main_image||"/images/products/placeholder.jpg",alt:s.value.name,class:"w-48 h-48 object-cover rounded-lg border"},null,8,qe)]),e("div",Re,[e("h4",Ae,r(s.value.name),1),e("p",Fe,r(s.value.description||"Aucune description disponible"),1),e("div",Ie,[e("div",null,[t[15]||(t[15]=e("p",{class:"text-sm font-medium text-gray-500"},"Prix",-1)),e("p",Ne,r(j(s.value.price)),1)]),e("div",null,[t[16]||(t[16]=e("p",{class:"text-sm font-medium text-gray-500"},"Catégorie",-1)),e("p",Ue,r(s.value.category?.name||"Sans catégorie"),1)]),e("div",null,[t[17]||(t[17]=e("p",{class:"text-sm font-medium text-gray-500"},"Quantité",-1)),e("p",Be,r(s.value.quantity||0),1)]),e("div",null,[t[18]||(t[18]=e("p",{class:"text-sm font-medium text-gray-500"},"Type",-1)),e("p",Le,r(K(s.value.type)),1)])])])])])])])]),e("div",ze,[t[22]||(t[22]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Informations du marchand")],-1)),e("div",Ge,[e("div",Qe,[e("div",Ke,[a(d(ee),{class:"w-6 h-6 text-gray-600"})]),e("div",null,[e("p",Oe,r(s.value.user?.first_name)+" "+r(s.value.user?.last_name),1),e("p",Ze,r(s.value.user?.email),1),e("p",He,r(s.value.user?.phone||"Téléphone non renseigné"),1)])]),e("div",Je,[e("div",null,[t[20]||(t[20]=e("p",{class:"text-sm font-medium text-gray-500"},"Statut du marchand",-1)),e("p",We,r(s.value.user?.is_active?"Actif":"Inactif"),1)]),e("div",null,[t[21]||(t[21]=e("p",{class:"text-sm font-medium text-gray-500"},"Rôle",-1)),e("p",Xe,r(s.value.user?.roles?.[0]?.name||"Client"),1)])])])]),s.value.lotteries&&s.value.lotteries.length>0?(c(),u("div",Ye,[t[24]||(t[24]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Tombolas associées")],-1)),e("div",et,[e("div",tt,[(c(!0),u(te,null,se(s.value.lotteries,l=>(c(),u("div",{key:l.id,class:"border rounded-lg p-4 hover:bg-gray-50"},[e("div",st,[e("div",null,[e("h4",ot,r(l.title),1),e("p",rt,r(l.description),1),e("div",lt,[e("span",null,r(l.sold_tickets||0)+"/"+r(l.max_tickets)+" tickets",1),e("span",null,r(j(l.ticket_price))+"/ticket",1),e("span",null,r(C(l.draw_date)),1)])]),e("div",at,[e("span",{class:T(S(l.status))},r(E(l.status)),3),a(n,{to:`/admin/lotteries/${l.id}`,class:"block mt-2 text-blue-600 hover:text-blue-800 text-sm"},{default:P(()=>t[23]||(t[23]=[m(" Voir détails → ",-1)])),_:2,__:[23]},1032,["to"])])])]))),128))])])])):b("",!0)]),e("div",it,[e("div",dt,[t[29]||(t[29]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Statistiques")],-1)),e("div",nt,[e("div",ut,[t[25]||(t[25]=e("span",{class:"text-sm text-gray-600"},"Vues",-1)),e("span",ct,r(s.value.views_count||0),1)]),e("div",mt,[t[26]||(t[26]=e("span",{class:"text-sm text-gray-600"},"Tombolas créées",-1)),e("span",pt,r(s.value.lotteries?.length||0),1)]),e("div",gt,[t[27]||(t[27]=e("span",{class:"text-sm text-gray-600"},"Tickets vendus",-1)),e("span",vt,r(N.value),1)]),e("div",xt,[t[28]||(t[28]=e("span",{class:"text-sm text-gray-600"},"Revenus générés",-1)),e("span",bt,r(j(U.value)),1)])])]),e("div",yt,[t[33]||(t[33]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Métadonnées")],-1)),e("div",ft,[e("div",null,[t[30]||(t[30]=e("p",{class:"text-sm font-medium text-gray-500"},"Date de création",-1)),e("p",_t,r(C(s.value.created_at)),1)]),e("div",null,[t[31]||(t[31]=e("p",{class:"text-sm font-medium text-gray-500"},"Dernière modification",-1)),e("p",ht,r(C(s.value.updated_at)),1)]),e("div",null,[t[32]||(t[32]=e("p",{class:"text-sm font-medium text-gray-500"},"ID Produit",-1)),e("p",wt,"#"+r(s.value.id),1)])])]),e("div",kt,[t[37]||(t[37]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Actions")],-1)),e("div",$t,[e("button",{onClick:G,class:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},[a(d(oe),{class:"w-4 h-4 mr-2"}),t[34]||(t[34]=m(" Créer une tombola ",-1))]),e("button",{onClick:Q,class:"w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},[a(d(re),{class:"w-4 h-4 mr-2"}),t[35]||(t[35]=m(" Voir les commandes ",-1))]),e("button",{onClick:z,class:"w-full flex items-center justify-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"},[a(d(le),{class:"w-4 h-4 mr-2"}),t[36]||(t[36]=m(" Supprimer le produit ",-1))])])])])])])):b("",!0),x.value?(c(),u("div",jt,[e("div",Ct,[e("div",Pt,[e("div",Dt,[t[38]||(t[38]=e("h3",{class:"text-lg font-medium text-gray-900"},"Modifier le produit",-1)),e("button",{onClick:t[0]||(t[0]=l=>x.value=!1),class:"text-gray-400 hover:text-gray-600"},[a(d(ae),{class:"w-6 h-6"})])]),e("form",{onSubmit:ie(L,["prevent"])},[e("div",Et,[e("div",St,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom du produit",-1)),y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>i.value.name=l),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[_,i.value.name]])]),e("div",Mt,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),y(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>i.value.description=l),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[_,i.value.description]])]),e("div",null,[t[41]||(t[41]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prix",-1)),y(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>i.value.price=l),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[_,i.value.price]])]),e("div",null,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Quantité",-1)),y(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>i.value.quantity=l),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[_,i.value.quantity]])]),e("div",null,[t[44]||(t[44]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),y(e("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>i.value.status=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},t[43]||(t[43]=[e("option",{value:"active"},"Actif",-1),e("option",{value:"inactive"},"Inactif",-1),e("option",{value:"out_of_stock"},"Rupture de stock",-1)]),512),[[de,i.value.status]])])]),e("div",Tt,[e("button",{type:"button",onClick:t[6]||(t[6]=l=>x.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"}," Annuler "),e("button",{type:"submit",disabled:f.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},r(f.value?"Mise à jour...":"Mettre à jour"),9,Vt)])],32)])])])):b("",!0)])}}},It=ce(qt,[["__scopeId","data-v-56d7ef91"]]);export{It as default};
