import{r as T,c as f,P as ne,z as W,g as l,w as E,b as u,l as p,e,T as R,i as y,u as d,G as F,t as a,aj as le,at as J,a0 as I,ah as re,a1 as O,ag as ie,aV as de,o as r,O as ue,x as ce,U,V as B,K as me,j as ve,h as ge,v as pe,a7 as xe,aR as _e,D as ye,I as fe,A as be,ak as we,a6 as G,s as he,an as ke,aF as $e,b3 as De,F as Te,y as je,aw as Me}from"./vendor-jx2CZFIM.js";import{_ as Ce,a as K}from"./app-BFPRRNjy.js";const Ne={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Pe={class:"flex items-center justify-center min-h-screen px-4 text-center sm:block sm:p-0"},Ee={key:0,"data-modal-content":"",class:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle bg-white shadow-xl transform transition-all rounded-xl relative"},Fe={class:"flex items-center justify-between mb-6"},Ae={class:"text-lg font-semibold text-gray-900 flex items-center"},Le={key:0,class:"text-center py-8"},Ve={class:"text-sm text-gray-500"},Se={key:1,class:"text-center py-6"},qe={class:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},ze={class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},Re={class:"text-lg font-bold text-green-900"},Ie={class:"text-sm text-green-700"},Oe={key:2,class:"text-center py-6"},Ue={class:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},Be={class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4"},Ge={class:"text-red-800"},We={key:3,class:"space-y-4"},Je={class:"bg-gray-50 rounded-lg p-4"},Ke={class:"font-semibold text-gray-900 mb-2"},He={class:"grid grid-cols-2 gap-4 text-sm"},Qe={class:"font-medium ml-1"},Xe={class:"font-medium ml-1"},Ye={class:"font-medium ml-1"},Ze={class:"font-medium ml-1"},et={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},tt={class:"font-medium text-blue-900 mb-2 flex items-center"},st={class:"text-sm text-blue-800 space-y-1"},at={key:0,class:"flex items-center"},ot={key:1,class:"flex items-center"},nt={key:2,class:"flex items-center"},lt={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},rt={class:"flex"},it={key:4,class:"flex justify-end gap-3 mt-6"},dt=["disabled"],ut={__name:"LotteryDrawModal",props:{show:{type:Boolean,default:!1},lottery:{type:Object,required:!0}},emits:["close","drawn"],setup(v,{emit:j}){const b=v,s=j,{post:w}=K(),g=T(!1),c=T(null),h=T(""),m=f(()=>b.lottery.sold_tickets===b.lottery.max_tickets),k=f(()=>b.lottery.min_participants||1),N=f(()=>m.value&&b.lottery.participants_count>=k.value),P=()=>{g.value||(s("close"),setTimeout(()=>{c.value=null,h.value=""},300))},A=_=>new Intl.NumberFormat("fr-FR").format(_||0)+" FCFA",V=async()=>{if(N.value){g.value=!0,c.value=null;try{h.value="Vérification des conditions...",await new Promise(n=>setTimeout(n,500)),h.value="Récupération des tickets éligibles...",await new Promise(n=>setTimeout(n,500)),h.value="Sélection aléatoire du gagnant...",await new Promise(n=>setTimeout(n,1e3));const _=await w(`/lotteries/${b.lottery.id}/draw`);_.success!==!1?(c.value={success:!0,lottery:_.lottery,winning_ticket:_.winning_ticket,verification_hash:_.verification_hash},h.value="Tirage terminé avec succès !",s("drawn",c.value)):c.value={success:!1,error:_.error||"Une erreur est survenue lors du tirage"}}catch(_){c.value={success:!1,error:_.response?.data?.error||_.message||"Une erreur inattendue s'est produite"}}finally{g.value=!1}}};return ne(()=>b.show,_=>{_||setTimeout(()=>{c.value=null,h.value=""},300)}),(_,n)=>(r(),W(de,{to:"body"},[l(R,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:E(()=>[v.show?(r(),u("div",Ne,[e("div",Pe,[l(R,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:E(()=>[v.show?(r(),u("div",{key:0,"data-modal-backdrop":"",class:"fixed inset-0 bg-black/40 transition-opacity",onClick:n[0]||(n[0]=S=>!g.value&&P())})):p("",!0)]),_:1}),n[15]||(n[15]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),l(R,{"enter-active-class":"ease-out duration-300","enter-from-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to-class":"opacity-100 translate-y-0 sm:scale-100","leave-active-class":"ease-in duration-200","leave-from-class":"opacity-100 translate-y-0 sm:scale-100","leave-to-class":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:E(()=>[v.show?(r(),u("div",Ee,[e("div",Fe,[e("h3",Ae,[l(d(F),{class:"w-6 h-6 text-purple-600 mr-2"}),y(" "+a(g.value?"Tirage en cours...":"Effectuer le tirage"),1)]),g.value?p("",!0):(r(),u("button",{key:0,onClick:P,class:"text-gray-400 hover:text-gray-600"},[l(d(le),{class:"w-6 h-6"})]))]),g.value?(r(),u("div",Le,[n[1]||(n[1]=e("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600 mx-auto mb-4"},null,-1)),n[2]||(n[2]=e("p",{class:"text-gray-600 mb-2"},"Sélection du gagnant en cours...",-1)),e("p",Ve,a(h.value),1)])):c.value&&c.value.success?(r(),u("div",Se,[e("div",qe,[l(d(J),{class:"w-8 h-8 text-green-600"})]),n[4]||(n[4]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-2"},"🎉 Tirage terminé !",-1)),e("div",ze,[n[3]||(n[3]=e("p",{class:"text-green-800 font-medium"},"Gagnant :",-1)),e("p",Re,a(c.value.winning_ticket.user.first_name)+" "+a(c.value.winning_ticket.user.last_name),1),e("p",Ie,"Ticket N° "+a(c.value.winning_ticket.ticket_number),1)]),n[5]||(n[5]=e("p",{class:"text-sm text-gray-600 mb-4"},"Le gagnant a été automatiquement notifié par email.",-1))])):c.value&&!c.value.success?(r(),u("div",Oe,[e("div",Ue,[l(d(I),{class:"w-8 h-8 text-red-600"})]),n[6]||(n[6]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-2"},"Erreur lors du tirage",-1)),e("div",Be,[e("p",Ge,a(c.value.error||"Une erreur inattendue s'est produite"),1)])])):(r(),u("div",We,[e("div",Je,[e("h4",Ke,a(v.lottery.title),1),e("div",He,[e("div",null,[n[7]||(n[7]=e("span",{class:"text-gray-600"},"Participants :",-1)),e("span",Qe,a(v.lottery.participants_count),1)]),e("div",null,[n[8]||(n[8]=e("span",{class:"text-gray-600"},"Tickets vendus :",-1)),e("span",Xe,a(v.lottery.sold_tickets)+"/"+a(v.lottery.max_tickets),1)]),e("div",null,[n[9]||(n[9]=e("span",{class:"text-gray-600"},"Valeur du lot :",-1)),e("span",Ye,a(A(v.lottery.product_value)),1)]),e("div",null,[n[10]||(n[10]=e("span",{class:"text-gray-600"},"Revenus générés :",-1)),e("span",Ze,a(A(v.lottery.total_revenue)),1)])])]),e("div",et,[e("h5",tt,[l(d(re),{class:"w-5 h-5 mr-2"}),n[11]||(n[11]=y(" Conditions de tirage ",-1))]),e("ul",st,[m.value?(r(),u("li",at,[l(d(O),{class:"w-4 h-4 text-green-600 mr-2"}),n[12]||(n[12]=y(" Tous les tickets sont vendus ",-1))])):p("",!0),v.lottery.participants_count>=k.value?(r(),u("li",ot,[l(d(O),{class:"w-4 h-4 text-green-600 mr-2"}),y(" Minimum de participants atteint ("+a(v.lottery.participants_count)+"/"+a(k.value)+") ",1)])):(r(),u("li",nt,[l(d(ie),{class:"w-4 h-4 text-red-600 mr-2"}),y(" Participants insuffisants ("+a(v.lottery.participants_count)+"/"+a(k.value)+") ",1)]))])]),e("div",lt,[e("div",rt,[l(d(I),{class:"w-5 h-5 text-yellow-600 mr-2 mt-0.5"}),n[13]||(n[13]=e("div",{class:"text-sm text-yellow-800"},[e("p",{class:"font-medium mb-1"},"⚠️ Action irréversible"),e("p",null,"Une fois le tirage effectué, il ne pourra plus être modifié. Le gagnant sera automatiquement notifié et le produit sera marqué comme vendu.")],-1))])])])),g.value?p("",!0):(r(),u("div",it,[e("button",{onClick:P,class:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"},a(c.value?"Fermer":"Annuler"),1),c.value?p("",!0):(r(),u("button",{key:0,onClick:V,disabled:!N.value,class:"px-6 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center"},[l(d(F),{class:"w-4 h-4 mr-2"}),n[14]||(n[14]=y(" Effectuer le tirage ",-1))],8,dt))]))])):p("",!0)]),_:1})])])):p("",!0)]),_:1})]))}},ct=Ce(ut,[["__scopeId","data-v-36f4d6f8"]]),mt={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},vt={class:"flex items-center justify-center min-h-screen px-4 text-center"},gt={class:"koumbaya-card inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle bg-white shadow-xl transform transition-all"},pt={class:"koumbaya-form-group"},xt={class:"koumbaya-form-group"},_t={__name:"LotteryExtendModal",props:{show:{type:Boolean,default:!1},lottery:{type:Object,default:()=>({})}},emits:["close","submit"],setup(v,{emit:j}){const b=v,s=j,w=ue({newDrawDate:"",reason:""}),g=()=>{s("close")},c=()=>{s("submit",{lotteryId:b.lottery.id,...w})};return(h,m)=>v.show?(r(),u("div",mt,[e("div",vt,[e("div",{class:"fixed inset-0 bg-gray-600 bg-opacity-40 transition-opacity",onClick:g}),e("div",gt,[m[5]||(m[5]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Prolonger la tombola")],-1)),e("form",{onSubmit:ce(c,["prevent"]),class:"koumbaya-card-body space-y-4"},[e("div",pt,[m[2]||(m[2]=e("label",{class:"koumbaya-label"},"Nouvelle date de tirage",-1)),U(e("input",{"onUpdate:modelValue":m[0]||(m[0]=k=>w.newDrawDate=k),type:"datetime-local",required:"",class:"koumbaya-input"},null,512),[[B,w.newDrawDate]])]),e("div",xt,[m[3]||(m[3]=e("label",{class:"koumbaya-label"},"Raison de la prolongation",-1)),U(e("textarea",{"onUpdate:modelValue":m[1]||(m[1]=k=>w.reason=k),rows:"3",class:"koumbaya-input",placeholder:"Expliquez pourquoi vous prolongez cette tombola...",required:""},null,512),[[B,w.reason]])]),e("div",{class:"koumbaya-card-footer"},[e("div",{class:"flex gap-4"},[e("button",{type:"button",onClick:g,class:"koumbaya-btn koumbaya-btn-outline flex-1"}," Annuler "),m[4]||(m[4]=e("button",{type:"submit",class:"koumbaya-btn koumbaya-btn-primary flex-1"}," Prolonger ",-1))])])],32)])])])):p("",!0)}},yt={class:"space-y-6"},ft={class:"flex justify-between items-start"},bt={class:"flex items-center space-x-3 mb-2"},wt={class:"text-3xl font-bold text-gray-900"},ht={class:"flex space-x-3"},kt={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},$t={class:"bg-white p-6 rounded-xl shadow-sm border"},Dt={class:"flex items-center"},Tt={class:"p-3 bg-blue-100 rounded-lg"},jt={class:"ml-4"},Mt={class:"text-2xl font-bold text-gray-900"},Ct={class:"bg-white p-6 rounded-xl shadow-sm border"},Nt={class:"flex items-center"},Pt={class:"p-3 bg-blue-100 rounded-lg"},Et={class:"ml-4"},Ft={class:"text-2xl font-bold text-gray-900"},At={class:"bg-white p-6 rounded-xl shadow-sm border"},Lt={class:"flex items-center"},Vt={class:"p-3 bg-purple-100 rounded-lg"},St={class:"ml-4"},qt={class:"text-2xl font-bold text-gray-900"},zt={class:"bg-white p-6 rounded-xl shadow-sm border"},Rt={class:"flex items-center"},It={class:"p-3 bg-yellow-100 rounded-lg"},Ot={class:"ml-4"},Ut={class:"text-2xl font-bold text-gray-900"},Bt={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Gt={class:"lg:col-span-2 space-y-6"},Wt={class:"bg-white rounded-xl shadow-sm border overflow-hidden"},Jt={class:"p-6"},Kt={class:"flex space-x-6"},Ht={class:"flex-shrink-0"},Qt=["src","alt"],Xt={class:"flex-1"},Yt={class:"text-xl font-semibold text-gray-900 mb-2"},Zt={class:"text-gray-600 mb-4"},es={class:"grid grid-cols-2 gap-4"},ts={class:"text-lg font-semibold text-gray-900"},ss={class:"text-lg font-semibold text-gray-900"},as={class:"text-lg font-semibold text-gray-900"},os={class:"text-lg font-semibold text-gray-900"},ns={class:"bg-white rounded-xl shadow-sm border"},ls={class:"p-6"},rs={class:"space-y-4"},is={class:"flex justify-between items-center mb-2"},ds={class:"text-sm text-gray-500"},us={class:"w-full bg-gray-200 rounded-full h-2"},cs={class:"flex justify-between items-center mb-2"},ms={class:"text-sm text-gray-500"},vs={class:"text-xs text-gray-600"},gs={key:0},ps={class:"flex justify-between items-center mb-2"},xs={class:"text-sm text-gray-500"},_s={class:"w-full bg-gray-200 rounded-full h-2"},ys={class:"mt-6 grid grid-cols-3 gap-4 text-center"},fs={class:"p-4 bg-blue-50 rounded-lg"},bs={class:"text-2xl font-bold text-blue-600"},ws={class:"p-4 bg-blue-50 rounded-lg"},hs={class:"text-2xl font-bold text-blue-600"},ks={class:"p-4 bg-yellow-50 rounded-lg"},$s={class:"text-2xl font-bold text-yellow-600"},Ds={key:0,class:"bg-green-50 border border-green-200 rounded-xl p-4"},Ts={class:"flex items-center space-x-3"},js={class:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center"},Ms={class:"text-sm text-green-600"},Cs={key:1,class:"bg-white rounded-xl shadow-sm border"},Ns={class:"px-6 py-4 border-b border-gray-200"},Ps={class:"text-lg font-semibold text-gray-900 flex items-center"},Es={class:"p-6"},Fs={class:"flex items-center space-x-4"},As={class:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center"},Ls={class:"flex-1"},Vs={class:"font-semibold text-gray-900"},Ss={class:"text-sm font-medium text-green-600"},qs={class:"text-sm text-gray-600"},zs={class:"space-y-6"},Rs={class:"bg-white rounded-xl shadow-sm border"},Is={class:"p-6 space-y-3"},Os={class:"bg-white rounded-xl shadow-sm border"},Us={class:"px-6 py-4 border-b border-gray-200"},Bs={class:"flex justify-between items-center"},Gs={class:"p-6"},Ws={class:"space-y-3"},Js={class:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center"},Ks={class:"text-sm font-medium text-gray-600"},Hs={class:"flex-1 min-w-0"},Qs={class:"text-sm font-medium text-gray-900 truncate"},Xs={class:"text-xs text-gray-500"},Ys={class:"text-sm text-gray-500"},Zs={class:"bg-white rounded-xl shadow-sm border"},ea={class:"p-6"},ta={class:"space-y-4"},sa={class:"flex justify-between"},aa={class:"text-sm font-medium text-gray-900"},oa={class:"flex justify-between"},na={class:"text-sm font-medium text-gray-900"},la={class:"flex justify-between"},ra={class:"text-sm font-medium text-gray-900"},ia={class:"flex justify-between"},da={class:"text-sm font-medium text-blue-600"},ma={__name:"LotteryView",setup(v){const j=me(),{get:b}=K(),s=T({id:j.params.id,title:"",description:"",status:"",product_value:0,ticket_price:0,category:"",participants_count:0,tickets_sold:0,total_revenue:0,max_participants:0,revenue_target:0,end_date:"",created_at:"",views_count:0,winner:null,draw_date:null,product:null,lottery_number:"",max_tickets:0,sold_tickets:0,progress_percentage:0}),w=T([]),g=T(!1),c=T(!1),h=T(!1),m=f(()=>s.value.max_tickets?Math.min(s.value.sold_tickets/s.value.max_tickets*100,100):0),k=f(()=>s.value.revenue_target?Math.min(s.value.total_revenue/s.value.revenue_target*100,100):0),N=f(()=>!s.value.views_count||s.value.views_count===0?0:(s.value.participants_count/s.value.views_count*100).toFixed(1)),P=f(()=>s.value.participants_count===0?0:s.value.total_revenue/s.value.participants_count),A=f(()=>{const o=s.value.product_value;return((s.value.total_revenue-o)/o*100).toFixed(1)}),V=f(()=>{if(!s.value.end_date)return"Non définie";try{const o=new Date,t=new Date(s.value.end_date);if(isNaN(t.getTime()))return"Date invalide";const x=t-o;if(x<=0)return"Terminée";const i=Math.floor(x/(1e3*60*60*24)),$=Math.floor(x%(1e3*60*60*24)/(1e3*60*60));return i>0?`${i}j ${$}h`:`${$}h`}catch(o){return console.error("Error calculating time remaining:",o),"Erreur de calcul"}}),_=f(()=>{if(!s.value.end_date)return 0;try{const o=new Date,t=new Date(s.value.end_date);if(isNaN(t.getTime()))return 0;const x=t-o;return x<=0?0:Math.ceil(x/(1e3*60*60*24))}catch(o){return console.error("Error calculating days remaining:",o),0}}),n=f(()=>{try{const o=s.value.status==="active",t=!s.value.winning_ticket_number,x=s.value.sold_tickets>=s.value.max_tickets;let i=!1;if(s.value.draw_date){const $=new Date(s.value.draw_date);isNaN($.getTime())||(i=$<=new Date)}return o&&t&&(x||i)}catch(o){return console.error("Error calculating canDraw:",o),!1}}),S=f(()=>{try{const o=s.value.status==="active",t=!s.value.winning_ticket_number,x=s.value.sold_tickets>=s.value.max_tickets;let i=!1;if(s.value.draw_date){const $=new Date(s.value.draw_date);isNaN($.getTime())||(i=$>new Date)}return o&&t&&x&&i}catch(o){return console.error("Error calculating canDrawManually:",o),!1}}),H=o=>({active:"Active",completed:"Terminée",pending:"En attente",paused:"En pause",cancelled:"Annulée"})[o]||o,M=o=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(o||0)+" FCFA",q=o=>{if(!o)return"Non définie";try{const t=new Date(o);return isNaN(t.getTime())?"Date invalide":new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}catch(t){return console.error("Error formatting date:",t),"Erreur de format"}},Q=()=>{const o=`${window.location.origin}/lottery/${s.value.id}`;navigator.clipboard.writeText(o),window.$toast&&window.$toast.success("Lien de partage copié dans le presse-papiers!","✅ Partage")},X=()=>{window.$toast&&window.$toast.info("Fonctionnalité de téléchargement en cours de développement","🚀 En développement")},Y=()=>{window.$toast&&window.$toast.info("Mise en pause de la tombola...","⏸️ Pause")},Z=()=>{g.value=!0},ee=o=>{console.log("Tirage terminé:",o),o&&o.success&&o.lottery&&(s.value={...s.value,...o.lottery,status:"completed",is_drawn:!0,winner_user_id:o.winning_ticket?.user_id,winning_ticket_number:o.winning_ticket?.ticket_number,winner:o.winning_ticket?.user,draw_date:new Date().toISOString()}),setTimeout(()=>{z()},1e3),setTimeout(()=>{g.value=!1},3e3)},te=()=>{c.value=!1,z()},z=async()=>{try{const o=await b(`/lotteries/${j.params.id}`);if(o?.lottery){const t=o.lottery;console.log("LotteryData:",t),console.log("Available keys:",Object.keys(t));const x=new Set,i=t.paid_tickets||t.paidTickets||t.tickets||[];console.log("PaidTickets:",i),console.log("PaidTickets length:",i.length),i.forEach(D=>{D.user?.id&&x.add(D.user.id)});const $=x.size,se=(t.sold_tickets||0)*(t.ticket_price||0),L=new Map;i.forEach(D=>{if(D.user?.id){const C=D.user.id,oe=`${D.user.first_name||""} ${D.user.last_name||""}`.trim();L.has(C)?L.get(C).tickets_count++:L.set(C,{id:C,name:oe||"Utilisateur anonyme",participated_at:D.created_at||new Date().toISOString(),tickets_count:1})}});const ae=Array.from(L.values()).sort((D,C)=>new Date(C.participated_at)-new Date(D.participated_at)).slice(0,5);s.value={...s.value,id:t.id,title:t.title,description:t.description||"",status:t.status,lottery_number:t.lottery_number,ticket_price:t.ticket_price||0,max_tickets:t.max_tickets||0,sold_tickets:t.sold_tickets||0,progress_percentage:t.progress_percentage||0,draw_date:t.draw_date,created_at:t.created_at,tickets_sold:t.sold_tickets||0,participants_count:$,total_revenue:se,max_participants:t.max_tickets||0,end_date:t.draw_date,revenue_target:t.revenue_target||null,views_count:t.views_count||0,product:t.product,product_value:t.product?.price||0,category:t.product?.category?.name||"",winner:t.winner||null,winning_ticket_number:t.winning_ticket_number||null},w.value=ae}}catch(o){console.error("Erreur lors du chargement de la tombola:",o),window.$toast&&window.$toast.error("Erreur lors du chargement des données de la tombola")}};return ve(()=>{z()}),(o,t)=>{const x=ge("router-link");return r(),u("div",yt,[e("div",ft,[e("div",null,[e("div",bt,[l(x,{to:"/merchant/lotteries",class:"text-gray-500 hover:text-gray-700"},{default:E(()=>[l(d(Me),{class:"w-5 h-5"})]),_:1}),e("h1",wt,a(s.value.title),1),e("span",{class:pe(["px-3 py-1 rounded-full text-sm font-medium",s.value.status==="active"||s.value.status==="completed"?"bg-blue-100 text-blue-800":s.value.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},a(H(s.value.status)),3)]),t[5]||(t[5]=e("p",{class:"text-gray-600"},"Gérez votre tombola et suivez les participations",-1))]),e("div",ht,[s.value.status==="active"?(r(),u("button",{key:0,onClick:t[0]||(t[0]=i=>c.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center whitespace-nowrap"},[l(d(xe),{class:"w-4 h-4 mr-2 flex-shrink-0"}),t[6]||(t[6]=y(" Prolonger ",-1))])):p("",!0),s.value.status==="active"&&n.value?(r(),u("button",{key:1,onClick:t[1]||(t[1]=i=>g.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center whitespace-nowrap"},[l(d(F),{class:"w-4 h-4 mr-2 flex-shrink-0"}),t[7]||(t[7]=y(" Effectuer le tirage ",-1))])):p("",!0),s.value.status!=="completed"?(r(),u("button",{key:2,onClick:t[2]||(t[2]=i=>h.value=!0),class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 flex items-center whitespace-nowrap"},[l(d(_e),{class:"w-4 h-4 mr-2 flex-shrink-0"}),t[8]||(t[8]=y(" Modifier ",-1))])):p("",!0)])]),e("div",kt,[e("div",$t,[e("div",Dt,[e("div",Tt,[l(d(ye),{class:"w-6 h-6 text-blue-600"})]),e("div",jt,[t[9]||(t[9]=e("p",{class:"text-sm font-medium text-gray-600"},"Participants",-1)),e("p",Mt,a(s.value.participants_count),1)])])]),e("div",Ct,[e("div",Nt,[e("div",Pt,[l(d(fe),{class:"w-6 h-6 text-blue-600"})]),e("div",Et,[t[10]||(t[10]=e("p",{class:"text-sm font-medium text-gray-600"},"Revenus générés",-1)),e("p",Ft,a(M(s.value.total_revenue)),1)])])]),e("div",At,[e("div",Lt,[e("div",Vt,[l(d(be),{class:"w-6 h-6 text-purple-600"})]),e("div",St,[t[11]||(t[11]=e("p",{class:"text-sm font-medium text-gray-600"},"Tickets vendus",-1)),e("p",qt,a(s.value.tickets_sold),1)])])]),e("div",zt,[e("div",Rt,[e("div",It,[l(d(we),{class:"w-6 h-6 text-yellow-600"})]),e("div",Ot,[t[12]||(t[12]=e("p",{class:"text-sm font-medium text-gray-600"},"Temps restant",-1)),e("p",Ut,a(V.value),1)])])])]),e("div",Bt,[e("div",Gt,[e("div",Wt,[t[17]||(t[17]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Informations du produit")],-1)),e("div",Jt,[e("div",Kt,[e("div",Ht,[e("img",{src:s.value.product?.image_url||s.value.product?.main_image||s.value.product?.image||"/images/products/placeholder.jpg",alt:s.value.title,class:"w-32 h-32 object-cover rounded-lg"},null,8,Qt)]),e("div",Xt,[e("h4",Yt,a(s.value.title),1),e("p",Zt,a(s.value.description),1),e("div",es,[e("div",null,[t[13]||(t[13]=e("p",{class:"text-sm font-medium text-gray-500"},"Valeur du produit",-1)),e("p",ts,a(M(s.value.product_value)),1)]),e("div",null,[t[14]||(t[14]=e("p",{class:"text-sm font-medium text-gray-500"},"Prix du ticket",-1)),e("p",ss,a(M(s.value.ticket_price)),1)]),e("div",null,[t[15]||(t[15]=e("p",{class:"text-sm font-medium text-gray-500"},"Catégorie",-1)),e("p",as,a(s.value.category?.name||s.value.category||"Sans catégorie"),1)]),e("div",null,[t[16]||(t[16]=e("p",{class:"text-sm font-medium text-gray-500"},"Date de fin",-1)),e("p",os,a(q(s.value.end_date)),1)])])])])])]),e("div",ns,[t[24]||(t[24]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Progression")],-1)),e("div",ls,[e("div",rs,[e("div",null,[e("div",is,[t[18]||(t[18]=e("span",{class:"text-sm font-medium text-gray-700"},"Objectif de tickets",-1)),e("span",ds,a(s.value.sold_tickets)+" / "+a(s.value.max_tickets),1)]),e("div",us,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:G({width:m.value+"%"})},null,4)])]),e("div",null,[e("div",cs,[t[19]||(t[19]=e("span",{class:"text-sm font-medium text-gray-700"},"Participants uniques",-1)),e("span",ms,a(s.value.participants_count)+" personnes",1)]),e("div",vs," Moyenne: "+a(s.value.participants_count>0?(s.value.sold_tickets/s.value.participants_count).toFixed(1):0)+" tickets/personne ",1)]),s.value.revenue_target?(r(),u("div",gs,[e("div",ps,[t[20]||(t[20]=e("span",{class:"text-sm font-medium text-gray-700"},"Objectif de revenus",-1)),e("span",xs,a(M(s.value.total_revenue))+" / "+a(M(s.value.revenue_target)),1)]),e("div",_s,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:G({width:k.value+"%"})},null,4)])])):p("",!0)]),e("div",ys,[e("div",fs,[e("p",bs,a(m.value)+"%",1),t[21]||(t[21]=e("p",{class:"text-sm text-blue-600"},"Tickets vendus",-1))]),e("div",ws,[e("p",hs,a(N.value)+"%",1),t[22]||(t[22]=e("p",{class:"text-sm text-blue-600"},"Conversion",-1))]),e("div",ks,[e("p",$s,a(_.value),1),t[23]||(t[23]=e("p",{class:"text-sm text-yellow-600"},"Jours restants",-1))])])])]),S.value?(r(),u("div",Ds,[e("div",Ts,[e("div",js,[l(d(F),{class:"w-5 h-5 text-green-600"})]),e("div",null,[t[25]||(t[25]=e("h4",{class:"text-md font-semibold text-green-800"},"Tirage possible !",-1)),e("p",Ms," Tous les tickets sont vendus ("+a(s.value.sold_tickets)+"/"+a(s.value.max_tickets)+'). Vous pouvez effectuer le tirage maintenant dans "Actions rapides". ',1)])])])):p("",!0),s.value.winner?(r(),u("div",Cs,[e("div",Ns,[e("h3",Ps,[l(d(J),{class:"w-5 h-5 text-yellow-500 mr-2"}),t[26]||(t[26]=y(" Gagnant ",-1))])]),e("div",Es,[e("div",Fs,[e("div",As,[l(d(he),{class:"w-6 h-6 text-yellow-600"})]),e("div",Ls,[e("p",Vs,a(s.value.winner.first_name)+" "+a(s.value.winner.last_name),1),e("p",Ss,"Ticket N° "+a(s.value.winning_ticket_number),1),e("p",qs,"Tirage effectué le "+a(q(s.value.draw_date)),1)])]),t[27]||(t[27]=e("div",{class:"mt-4 p-4 bg-yellow-50 rounded-lg"},[e("p",{class:"text-sm text-yellow-800"}," Félicitations ! Le gagnant a été contacté automatiquement par email. ")],-1))])])):p("",!0)]),e("div",zs,[e("div",Rs,[t[32]||(t[32]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Actions rapides")],-1)),e("div",Is,[e("button",{onClick:Q,class:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},[l(d(ke),{class:"w-4 h-4 mr-2"}),t[28]||(t[28]=y(" Partager la tombola ",-1))]),e("button",{onClick:X,class:"w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},[l(d($e),{class:"w-4 h-4 mr-2"}),t[29]||(t[29]=y(" Télécharger le rapport ",-1))]),S.value?(r(),u("button",{key:0,onClick:Z,class:"w-full flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"},[l(d(F),{class:"w-4 h-4 mr-2"}),t[30]||(t[30]=y(" Effectuer le tirage maintenant ",-1))])):p("",!0),s.value.status==="active"?(r(),u("button",{key:1,onClick:Y,class:"w-full flex items-center justify-center px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"},[l(d(De),{class:"w-4 h-4 mr-2"}),t[31]||(t[31]=y(" Mettre en pause ",-1))])):p("",!0)])]),e("div",Os,[e("div",Us,[e("div",Bs,[t[34]||(t[34]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Participants récents",-1)),l(x,{to:`/merchant/lotteries/${s.value.id}/participants`,class:"text-sm text-blue-600 hover:text-blue-700"},{default:E(()=>t[33]||(t[33]=[y(" Voir tout ",-1)])),_:1,__:[33]},8,["to"])])]),e("div",Gs,[e("div",Ws,[(r(!0),u(Te,null,je(w.value,i=>(r(),u("div",{key:i.id,class:"flex items-center space-x-3"},[e("div",Js,[e("span",Ks,a(i.name.charAt(0)),1)]),e("div",Hs,[e("p",Qs,a(i.name),1),e("p",Xs,a(q(i.participated_at)),1)]),e("div",Ys,a(i.tickets_count)+" ticket"+a(i.tickets_count>1?"s":""),1)]))),128))])])]),e("div",Zs,[t[39]||(t[39]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Statistiques")],-1)),e("div",ea,[e("div",ta,[e("div",sa,[t[35]||(t[35]=e("span",{class:"text-sm text-gray-600"},"Vues de la tombola",-1)),e("span",aa,a(s.value.views_count||"N/A"),1)]),e("div",oa,[t[36]||(t[36]=e("span",{class:"text-sm text-gray-600"},"Taux de conversion",-1)),e("span",na,a(N.value)+"%",1)]),e("div",la,[t[37]||(t[37]=e("span",{class:"text-sm text-gray-600"},"Panier moyen",-1)),e("span",ra,a(M(P.value)),1)]),e("div",ia,[t[38]||(t[38]=e("span",{class:"text-sm text-gray-600"},"Retour sur investissement",-1)),e("span",da,"+"+a(A.value)+"%",1)])])])])])]),l(ct,{show:g.value,lottery:s.value,onClose:t[3]||(t[3]=i=>g.value=!1),onDrawn:ee},null,8,["show","lottery"]),c.value?(r(),W(_t,{key:0,lottery:s.value,onClose:t[4]||(t[4]=i=>c.value=!1),onExtended:te},null,8,["lottery"])):p("",!0)])}}};export{ma as default};
