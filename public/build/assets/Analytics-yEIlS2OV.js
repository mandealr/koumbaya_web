import{b as o,o as a,e,c as y,j as A,t as i,p as P,q as b,v as E,G as T,F,n as M,r as f,g as L,A as N,E as U,f as z,B as q,u as d,i as _}from"./vendor-CTxEzfV9.js";import{M as R,m as O,n as G,a as J,j as K,e as Z,f as H}from"./app-DvkRZ2ih.js";function Q(n,c){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 6 9 12.75l4.286-4.286a11.948 11.948 0 0 1 4.306 6.43l.776 2.898m0 0 3.182-5.511m-3.182 5.51-5.511-3.181"})])}function W(n,c){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 18 9 11.25l4.306 4.306a11.95 11.95 0 0 1 5.814-5.518l2.74-1.22m0 0-5.94-2.281m5.94 2.28-2.28 5.941"})])}function Y(n,c){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10.5 6a7.5 7.5 0 1 0 7.5 7.5h-7.5V6Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 10.5H21A7.5 7.5 0 0 0 13.5 3v7.5Z"})])}const ee={class:"koumbaya-card group hover:scale-105 transition-all duration-300 cursor-pointer"},te={class:"koumbaya-card-body"},se={key:0,class:"flex items-center justify-center h-24"},ae={key:1,class:"flex items-center justify-between"},oe={class:"flex-1"},re={class:"space-y-1"},ne={class:"text-sm font-medium text-gray-600 group-hover:text-gray-700 transition-colors"},le={class:"text-3xl font-bold text-gray-900 group-hover:text-koumbaya-primary transition-colors"},ie={key:0,class:"flex items-center mt-2 space-x-1"},de={class:"text-sm text-gray-500"},ce={key:2,class:"mt-4"},ue={class:"flex justify-between text-xs text-gray-500 mb-1"},ge={class:"w-full bg-gray-200 rounded-full h-2"},me={key:3,class:"flex gap-2 mt-4"},he=["onClick"],B={__name:"StatsCard",props:{title:{type:String,required:!0},value:{type:[Number,String],required:!0},icon:{type:[Object,Function],required:!0},change:{type:Number,default:void 0},period:{type:String,default:"mois dernier"},color:{type:String,default:"blue",validator:n=>["blue","green","orange","red","purple","indigo"].includes(n)},format:{type:String,default:"number",validator:n=>["number","currency","percentage"].includes(n)},showProgress:{type:Boolean,default:!1},progressValue:{type:Number,default:void 0},progressTarget:{type:Number,default:100},actions:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["action"],setup(n,{emit:c}){const l=n,u=c,m=y(()=>{const v=l.value;switch(l.format){case"currency":return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(v).replace("XAF","FCFA");case"percentage":return`${v}%`;default:return new Intl.NumberFormat("fr-FR").format(v)}}),x=y(()=>l.change===void 0?R:l.change>0?O:l.change<0?G:R),h=y(()=>l.change===void 0?"text-gray-400":l.change>0?"text-blue-600":l.change<0?"text-red-600":"text-gray-400"),g={blue:{iconBg:"bg-blue-100 group-hover:bg-blue-200",iconColor:"text-blue-600",progress:"bg-gradient-to-r from-blue-500 to-blue-600"},green:{iconBg:"bg-blue-100 group-hover:bg-blue-200",iconColor:"text-blue-600",progress:"bg-gradient-to-r from-blue-500 to-blue-600"},orange:{iconBg:"bg-orange-100 group-hover:bg-orange-200",iconColor:"text-orange-600",progress:"bg-gradient-to-r from-orange-500 to-orange-600"},red:{iconBg:"bg-red-100 group-hover:bg-red-200",iconColor:"text-red-600",progress:"bg-gradient-to-r from-red-500 to-red-600"},purple:{iconBg:"bg-purple-100 group-hover:bg-purple-200",iconColor:"text-purple-600",progress:"bg-gradient-to-r from-purple-500 to-purple-600"},indigo:{iconBg:"bg-indigo-100 group-hover:bg-indigo-200",iconColor:"text-indigo-600",progress:"bg-gradient-to-r from-indigo-500 to-indigo-600"}},w=y(()=>g[l.color]?.iconBg||g.blue.iconBg),k=y(()=>g[l.color]?.iconColor||g.blue.iconColor),C=y(()=>g[l.color]?.progress||g.blue.progress),p=y(()=>!l.showProgress||l.progressValue===void 0?0:Math.min(l.progressValue/l.progressTarget*100,100)),V=v=>{u("action",v)};return(v,j)=>(a(),o("div",ee,[e("div",te,[n.loading?(a(),o("div",se,j[0]||(j[0]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):(a(),o("div",ae,[e("div",oe,[e("div",re,[e("p",ne,i(n.title),1),e("p",le,i(m.value),1)]),n.change!==void 0?(a(),o("div",ie,[(a(),P(E(x.value),{class:b([h.value,"w-4 h-4"])},null,8,["class"])),e("span",{class:b([h.value,"text-sm font-medium"])},i(Math.abs(n.change))+"% ",3),e("span",de," vs "+i(n.period||"mois dernier"),1)])):A("",!0)]),e("div",{class:b([w.value,"p-4 rounded-xl group-hover:scale-110 transition-transform duration-300"])},[(a(),P(E(n.icon),{class:b([k.value,"w-8 h-8"])},null,8,["class"]))],2)])),n.showProgress&&n.progressValue!==void 0?(a(),o("div",ce,[e("div",ue,[e("span",null,"Objectif: "+i(n.progressTarget),1),e("span",null,i(Math.round(p.value))+"%",1)]),e("div",ge,[e("div",{class:b([C.value,"h-2 rounded-full transition-all duration-500"]),style:T({width:p.value+"%"})},null,6)])])):A("",!0),n.actions?.length?(a(),o("div",me,[(a(!0),o(F,null,M(n.actions,$=>(a(),o("button",{key:$.label,onClick:S=>V($),class:b(["flex-1 text-xs px-3 py-1.5 rounded-lg font-medium transition-all duration-200",$.primary?"bg-koumbaya-primary text-white hover:bg-koumbaya-primary-dark":"bg-gray-100 text-gray-600 hover:bg-gray-200"])},i($.label),11,he))),128))])):A("",!0)])]))}};function pe(n,c){return a(),o("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M7.5 6v.75H5.513c-.96 0-1.764.724-1.865 1.679l-1.263 12A1.875 1.875 0 0 0 4.25 22.5h15.5a1.875 1.875 0 0 0 1.865-2.071l-1.263-12a1.875 1.875 0 0 0-1.865-1.679H16.5V6a4.5 4.5 0 1 0-9 0ZM12 3a3 3 0 0 0-3 3v.75h6V6a3 3 0 0 0-3-3Zm-3 8.25a3 3 0 1 0 6 0v-.75a.75.75 0 0 1 1.5 0v.75a4.5 4.5 0 1 1-9 0v-.75a.75.75 0 0 1 1.5 0v.75Z","clip-rule":"evenodd"})])}const ve={class:"px-6"},ye={class:"mb-6"},be={class:"bg-white rounded-lg shadow p-4"},xe={class:"flex flex-col sm:flex-row gap-4"},fe={class:"flex-1"},_e={key:0,class:"flex gap-4"},we={class:"flex items-end"},ke=["disabled"],Ce={key:0},$e={key:1},Ae={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},je={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},Be={class:"koumbaya-card"},Fe={class:"koumbaya-card-body"},Me={key:0,class:"h-64 bg-gradient-to-br from-blue-50 to-blue-50 rounded-lg flex items-center justify-center"},Pe={key:1,class:"h-64"},Ve={class:"h-full flex items-end justify-between space-x-2 p-4"},Se={class:"text-xs text-gray-600 mt-2"},De={class:"text-xs font-medium text-gray-900"},Ne={key:2,class:"h-64 bg-gradient-to-br from-blue-50 to-blue-50 rounded-lg flex items-center justify-center"},Te={class:"text-center"},Ee={class:"koumbaya-card"},qe={class:"koumbaya-card-body"},Re={key:0,class:"h-64 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg flex items-center justify-center"},Ze={key:1,class:"h-64 overflow-y-auto"},He={class:"space-y-3"},Ie={class:"font-medium text-gray-900"},Xe={class:"text-sm text-gray-600"},Le={class:"text-right"},Ue={class:"font-medium text-gray-900"},ze={key:2,class:"h-64 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg flex items-center justify-center"},Oe={class:"text-center"},Ge={class:"koumbaya-card"},Je={class:"koumbaya-card-body"},Ke={key:0,class:"flex justify-center items-center h-32"},Qe={key:1,class:"overflow-x-auto"},We={class:"min-w-full divide-y divide-gray-200"},Ye={class:"bg-white divide-y divide-gray-200"},et={class:"px-6 py-4 whitespace-nowrap"},tt={class:"flex items-center"},st={class:"flex-shrink-0 h-10 w-10"},at=["src","alt"],ot={class:"ml-4"},rt={class:"text-sm font-medium text-gray-900"},nt={class:"text-sm text-gray-500"},lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},it={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},dt={class:"px-6 py-4 whitespace-nowrap"},ct={class:"flex items-center"},ut={key:3,class:"text-sm text-gray-500"},gt={key:2,class:"text-center py-8"},pt={__name:"Analytics",setup(n){const{loading:c,get:l}=J(),u=f({}),m=f([]),x=f([]),h=f([]),g=f("this_month"),w=f(""),k=f(""),C=y(()=>{const r={period:g.value};return g.value==="custom"&&(w.value&&(r.start_date=w.value),k.value&&(r.end_date=k.value)),r}),p=async()=>{try{await Promise.all([V(),v(),j(),$()])}catch(r){console.error("Erreur lors du chargement des analytics:",r)}},V=async()=>{try{const r=await l("/merchant/dashboard/stats",{params:C.value});u.value=r}catch(r){console.error("Erreur lors du chargement des stats:",r),u.value={}}},v=async()=>{try{const r=await l("/merchant/dashboard/sales-chart",{params:C.value});m.value=r.data||[]}catch(r){console.error("Erreur lors du chargement du graphique des ventes:",r),m.value=[]}},j=async()=>{try{const r=await l("/merchant/dashboard/top-products",{params:C.value});x.value=r.data||[]}catch(r){console.error("Erreur lors du chargement des top produits:",r),x.value=[]}},$=async()=>{try{const r=await l("/merchant/dashboard/lottery-performance",{params:C.value});h.value=r.data||[]}catch(r){console.error("Erreur lors du chargement de la performance des tombolas:",r),h.value=[]}},S=r=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(r||0).replace("XAF","FCFA"),I=r=>r?new Date(r).toLocaleDateString("fr-FR",{month:"short",day:"numeric"}):"";return L(()=>{p()}),(r,s)=>(a(),o("div",ve,[s[17]||(s[17]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Analytiques"),e("p",{class:"mt-2 text-gray-600"},"Analyse de vos performances de vente")],-1)),e("div",ye,[e("div",be,[e("div",xe,[e("div",fe,[s[4]||(s[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Période",-1)),N(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>g.value=t),onChange:p,class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},s[3]||(s[3]=[z('<option value="today">Aujourd&#39;hui</option><option value="yesterday">Hier</option><option value="this_week">Cette semaine</option><option value="last_week">Semaine dernière</option><option value="this_month">Ce mois</option><option value="last_month">Mois dernier</option><option value="this_year">Cette année</option><option value="custom">Période personnalisée</option>',8)]),544),[[U,g.value]])]),g.value==="custom"?(a(),o("div",_e,[e("div",null,[s[5]||(s[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date début",-1)),N(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>w.value=t),onChange:p,type:"date",class:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,544),[[q,w.value]])]),e("div",null,[s[6]||(s[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date fin",-1)),N(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>k.value=t),onChange:p,type:"date",class:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,544),[[q,k.value]])])])):A("",!0),e("div",we,[e("button",{onClick:p,disabled:d(c),class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"},[d(c)?(a(),o("span",Ce,"Chargement...")):(a(),o("span",$e,"Actualiser"))],8,ke)])])])]),e("div",Ae,[_(B,{title:"Revenus Totaux",value:u.value.total_revenue||0,format:"currency",change:u.value.revenue_change||0,color:"green",icon:d(K),loading:d(c),actions:[{label:"Détails",primary:!0}]},null,8,["value","change","icon","loading"]),_(B,{title:"Ventes ce mois",value:u.value.monthly_sales||0,change:u.value.sales_change||0,color:"blue",icon:d(pe),loading:d(c),"show-progress":!0,"progress-value":u.value.monthly_sales||0,"progress-target":u.value.sales_target||200},null,8,["value","change","icon","loading","progress-value","progress-target"]),_(B,{title:"Produits Actifs",value:u.value.active_products||0,change:u.value.products_change||0,color:"purple",icon:d(Z),loading:d(c)},null,8,["value","change","icon","loading"]),_(B,{title:"Taux Conversion",value:u.value.conversion_rate||0,format:"percentage",change:u.value.conversion_change||0,color:"orange",icon:d(H),loading:d(c)},null,8,["value","change","icon","loading"])]),e("div",je,[e("div",Be,[s[9]||(s[9]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Évolution des Ventes")],-1)),e("div",Fe,[d(c)?(a(),o("div",Me,s[7]||(s[7]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e("p",{class:"text-gray-500"},"Chargement...")],-1)]))):m.value&&m.value.length>0?(a(),o("div",Pe,[e("div",Ve,[(a(!0),o(F,null,M(m.value.slice(-7),(t,X)=>(a(),o("div",{key:X,class:"flex-1 flex flex-col items-center"},[e("div",{class:"w-full bg-blue-200 rounded-t",style:T({height:`${Math.max(10,t.sales/Math.max(...m.value.map(D=>D.sales))*180)}px`})},[e("div",{class:"w-full bg-blue-600 rounded-t",style:T({height:`${Math.max(5,t.sales/Math.max(...m.value.map(D=>D.sales))*180)}px`})},null,4)],4),e("span",Se,i(I(t.date)),1),e("span",De,i(t.sales),1)]))),128))])])):(a(),o("div",Ne,[e("div",Te,[_(d(H),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s[8]||(s[8]=e("p",{class:"text-gray-500"},"Aucune donnée disponible",-1))])]))])]),e("div",Ee,[s[12]||(s[12]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Performance des Tombolas")],-1)),e("div",qe,[d(c)?(a(),o("div",Re,s[10]||(s[10]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),e("p",{class:"text-gray-500"},"Chargement...")],-1)]))):h.value&&h.value.length>0?(a(),o("div",Ze,[e("div",He,[(a(!0),o(F,null,M(h.value.slice(0,5),t=>(a(),o("div",{key:t.id,class:"flex items-center justify-between p-3 bg-gray-100 rounded-lg"},[e("div",null,[e("h4",Ie,i(t.name),1),e("p",Xe,i(t.tickets_sold)+" tickets vendus",1)]),e("div",Le,[e("p",Ue,i(S(t.revenue)),1),e("p",{class:b(["text-sm",t.performance_change>=0?"text-green-600":"text-red-600"])},i(t.performance_change>=0?"+":"")+i(t.performance_change)+"% ",3)])]))),128))])])):(a(),o("div",ze,[e("div",Oe,[_(d(Y),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s[11]||(s[11]=e("p",{class:"text-gray-500"},"Aucune tombola disponible",-1))])]))])])]),e("div",Ge,[s[16]||(s[16]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Top Produits")],-1)),e("div",Je,[d(c)?(a(),o("div",Ke,s[13]||(s[13]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("span",{class:"ml-2 text-gray-600"},"Chargement des produits...",-1)]))):x.value&&x.value.length>0?(a(),o("div",Qe,[e("table",We,[s[14]||(s[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Produit "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ventes "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Revenus "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tendance ")])],-1)),e("tbody",Ye,[(a(!0),o(F,null,M(x.value,t=>(a(),o("tr",{key:t.id},[e("td",et,[e("div",tt,[e("div",st,[e("img",{src:t.image_url||t.main_image||t.image||"/images/products/placeholder.jpg",alt:t.name,class:"h-10 w-10 rounded-lg object-cover bg-gray-100"},null,8,at)]),e("div",ot,[e("div",rt,i(t.name),1),e("div",nt,i(t.category?.name||t.category||"Sans catégorie"),1)])])]),e("td",lt,i(t.sales_count||t.sales||0),1),e("td",it,i(S(t.total_revenue||t.revenue||0)),1),e("td",dt,[e("div",ct,[(t.trend||t.performance_change||0)>0?(a(),P(d(W),{key:0,class:"w-4 h-4 text-green-500 mr-1"})):(t.trend||t.performance_change||0)<0?(a(),P(d(Q),{key:1,class:"w-4 h-4 text-red-500 mr-1"})):A("",!0),(t.trend||t.performance_change||0)!==0?(a(),o("span",{key:2,class:b([(t.trend||t.performance_change||0)>0?"text-green-600":"text-red-600","text-sm font-medium"])},i(Math.abs(t.trend||t.performance_change||0))+"% ",3)):(a(),o("span",ut,"-"))])])]))),128))])])])):(a(),o("div",gt,[_(d(Z),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s[15]||(s[15]=e("p",{class:"text-gray-500"},"Aucun produit trouvé pour cette période",-1))]))])])]))}};export{pt as default};
