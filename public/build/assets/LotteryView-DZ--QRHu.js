import{r as T,c as y,P as ae,b as c,l as f,o as u,e,g as r,i as _,u as i,G as P,t as o,aj as ne,at as W,a0 as R,ah as re,a1 as I,ag as le,O as ie,x as de,U as O,V as B,K as ue,j as ce,z as me,w as U,h as ge,v as ve,a7 as pe,aR as xe,D as _e,I as fe,A as ye,ak as be,a6 as G,s as we,an as he,aF as ke,b3 as $e,F as De,y as Te,aw as je}from"./vendor-jx2CZFIM.js";import{a as J}from"./app-DpTCSKEG.js";const Ee={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Ce={class:"flex items-center justify-center min-h-screen px-4 text-center sm:block sm:p-0"},Me={class:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle bg-white shadow-xl transform transition-all rounded-xl"},Ne={class:"flex items-center justify-between mb-6"},Pe={class:"text-lg font-semibold text-gray-900 flex items-center"},Fe={key:0,class:"text-center py-8"},Ae={class:"text-sm text-gray-500"},Ve={key:1,class:"text-center py-6"},Le={class:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},Se={class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},ze={class:"text-lg font-bold text-green-900"},qe={class:"text-sm text-green-700"},Re={key:2,class:"text-center py-6"},Ie={class:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},Oe={class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4"},Be={class:"text-red-800"},Ue={key:3,class:"space-y-4"},Ge={class:"bg-gray-50 rounded-lg p-4"},We={class:"font-semibold text-gray-900 mb-2"},Je={class:"grid grid-cols-2 gap-4 text-sm"},Ke={class:"font-medium ml-1"},He={class:"font-medium ml-1"},Qe={class:"font-medium ml-1"},Xe={class:"font-medium ml-1"},Ye={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Ze={class:"font-medium text-blue-900 mb-2 flex items-center"},et={class:"text-sm text-blue-800 space-y-1"},tt={key:0,class:"flex items-center"},st={key:1,class:"flex items-center"},ot={key:2,class:"flex items-center"},at={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},nt={class:"flex"},rt={key:4,class:"flex justify-end gap-3 mt-6"},lt=["disabled"],V=1,it={__name:"LotteryDrawModal",props:{show:{type:Boolean,default:!1},lottery:{type:Object,default:()=>({})}},emits:["close","drawn"],setup(x,{emit:j}){const $=x,s=j,{post:b}=J(),m=T(!1),d=T(null),w=T(""),g=y(()=>$.lottery.sold_tickets>=$.lottery.max_tickets),D=y(()=>g.value&&$.lottery.participants_count>=V),M=p=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(p||0)+" FCFA",N=()=>{m.value||s("close")},L=async()=>{if(D.value){m.value=!0,d.value=null;try{w.value="Vérification des conditions...",await new Promise(n=>setTimeout(n,500)),w.value="Collecte des tickets participants...",await new Promise(n=>setTimeout(n,800)),w.value="Génération du tirage aléatoire vérifiable...",await new Promise(n=>setTimeout(n,1e3)),w.value="Sélection du gagnant...";const p=await b(`/lotteries/${$.lottery.id}/draw`);if(p.success!==!1)d.value={success:!0,lottery:p.lottery,winning_ticket:p.winning_ticket,verification_hash:p.verification_hash},s("drawn",d.value),window.$toast&&window.$toast.success("Tirage effectué avec succès !","🎉 Gagnant sélectionné");else throw new Error(p.error||"Erreur lors du tirage")}catch(p){console.error("Erreur lors du tirage:",p),d.value={success:!1,error:p.response?.data?.error||p.message||"Une erreur inattendue s'est produite"},window.$toast&&window.$toast.error(d.value.error,"❌ Erreur de tirage")}finally{m.value=!1,w.value=""}}};return ae(()=>$.show,p=>{p||setTimeout(()=>{m.value=!1,d.value=null,w.value=""},300)}),(p,n)=>x.show?(u(),c("div",Ee,[e("div",Ce,[e("div",{class:"fixed inset-0 bg-gray-600 bg-opacity-50 transition-opacity",onClick:n[0]||(n[0]=z=>!m.value&&N())}),e("div",Me,[e("div",Ne,[e("h3",Pe,[r(i(P),{class:"w-6 h-6 text-purple-600 mr-2"}),_(" "+o(m.value?"Tirage en cours...":"Effectuer le tirage"),1)]),m.value?f("",!0):(u(),c("button",{key:0,onClick:N,class:"text-gray-400 hover:text-gray-600"},[r(i(ne),{class:"w-6 h-6"})]))]),m.value?(u(),c("div",Fe,[n[1]||(n[1]=e("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600 mx-auto mb-4"},null,-1)),n[2]||(n[2]=e("p",{class:"text-gray-600 mb-2"},"Sélection du gagnant en cours...",-1)),e("p",Ae,o(w.value),1)])):d.value&&d.value.success?(u(),c("div",Ve,[e("div",Le,[r(i(W),{class:"w-8 h-8 text-green-600"})]),n[4]||(n[4]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-2"},"🎉 Tirage terminé !",-1)),e("div",Se,[n[3]||(n[3]=e("p",{class:"text-green-800 font-medium"},"Gagnant :",-1)),e("p",ze,o(d.value.winning_ticket.user.first_name)+" "+o(d.value.winning_ticket.user.last_name),1),e("p",qe,"Ticket N° "+o(d.value.winning_ticket.ticket_number),1)]),n[5]||(n[5]=e("p",{class:"text-sm text-gray-600 mb-4"},"Le gagnant a été automatiquement notifié par email.",-1))])):d.value&&!d.value.success?(u(),c("div",Re,[e("div",Ie,[r(i(R),{class:"w-8 h-8 text-red-600"})]),n[6]||(n[6]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-2"},"Erreur lors du tirage",-1)),e("div",Oe,[e("p",Be,o(d.value.error||"Une erreur inattendue s'est produite"),1)])])):(u(),c("div",Ue,[e("div",Ge,[e("h4",We,o(x.lottery.title),1),e("div",Je,[e("div",null,[n[7]||(n[7]=e("span",{class:"text-gray-600"},"Participants :",-1)),e("span",Ke,o(x.lottery.participants_count),1)]),e("div",null,[n[8]||(n[8]=e("span",{class:"text-gray-600"},"Tickets vendus :",-1)),e("span",He,o(x.lottery.sold_tickets)+"/"+o(x.lottery.max_tickets),1)]),e("div",null,[n[9]||(n[9]=e("span",{class:"text-gray-600"},"Valeur du lot :",-1)),e("span",Qe,o(M(x.lottery.product_value)),1)]),e("div",null,[n[10]||(n[10]=e("span",{class:"text-gray-600"},"Revenus générés :",-1)),e("span",Xe,o(M(x.lottery.total_revenue)),1)])])]),e("div",Ye,[e("h5",Ze,[r(i(re),{class:"w-5 h-5 mr-2"}),n[11]||(n[11]=_(" Conditions de tirage ",-1))]),e("ul",et,[g.value?(u(),c("li",tt,[r(i(I),{class:"w-4 h-4 text-green-600 mr-2"}),n[12]||(n[12]=_(" Tous les tickets sont vendus ",-1))])):f("",!0),x.lottery.participants_count>=V?(u(),c("li",st,[r(i(I),{class:"w-4 h-4 text-green-600 mr-2"}),_(" Minimum de participants atteint ("+o(x.lottery.participants_count)+"/"+o(V)+") ",1)])):(u(),c("li",ot,[r(i(le),{class:"w-4 h-4 text-red-600 mr-2"}),_(" Participants insuffisants ("+o(x.lottery.participants_count)+"/"+o(V)+") ",1)]))])]),e("div",at,[e("div",nt,[r(i(R),{class:"w-5 h-5 text-yellow-600 mr-2 mt-0.5"}),n[13]||(n[13]=e("div",{class:"text-sm text-yellow-800"},[e("p",{class:"font-medium mb-1"},"⚠️ Action irréversible"),e("p",null,"Une fois le tirage effectué, il ne pourra plus être modifié. Le gagnant sera automatiquement notifié et le produit sera marqué comme vendu.")],-1))])])])),m.value?f("",!0):(u(),c("div",rt,[e("button",{onClick:N,class:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"},o(d.value?"Fermer":"Annuler"),1),d.value?f("",!0):(u(),c("button",{key:0,onClick:L,disabled:!D.value,class:"px-6 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center"},[r(i(P),{class:"w-4 h-4 mr-2"}),n[14]||(n[14]=_(" Effectuer le tirage ",-1))],8,lt))]))])])])):f("",!0)}},dt={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},ut={class:"flex items-center justify-center min-h-screen px-4 text-center"},ct={class:"koumbaya-card inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle bg-white shadow-xl transform transition-all"},mt={class:"koumbaya-form-group"},gt={class:"koumbaya-form-group"},vt={__name:"LotteryExtendModal",props:{show:{type:Boolean,default:!1},lottery:{type:Object,default:()=>({})}},emits:["close","submit"],setup(x,{emit:j}){const $=x,s=j,b=ie({newDrawDate:"",reason:""}),m=()=>{s("close")},d=()=>{s("submit",{lotteryId:$.lottery.id,...b})};return(w,g)=>x.show?(u(),c("div",dt,[e("div",ut,[e("div",{class:"fixed inset-0 bg-gray-600 bg-opacity-40 transition-opacity",onClick:m}),e("div",ct,[g[5]||(g[5]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Prolonger la tombola")],-1)),e("form",{onSubmit:de(d,["prevent"]),class:"koumbaya-card-body space-y-4"},[e("div",mt,[g[2]||(g[2]=e("label",{class:"koumbaya-label"},"Nouvelle date de tirage",-1)),O(e("input",{"onUpdate:modelValue":g[0]||(g[0]=D=>b.newDrawDate=D),type:"datetime-local",required:"",class:"koumbaya-input"},null,512),[[B,b.newDrawDate]])]),e("div",gt,[g[3]||(g[3]=e("label",{class:"koumbaya-label"},"Raison de la prolongation",-1)),O(e("textarea",{"onUpdate:modelValue":g[1]||(g[1]=D=>b.reason=D),rows:"3",class:"koumbaya-input",placeholder:"Expliquez pourquoi vous prolongez cette tombola...",required:""},null,512),[[B,b.reason]])]),e("div",{class:"koumbaya-card-footer"},[e("div",{class:"flex gap-4"},[e("button",{type:"button",onClick:m,class:"koumbaya-btn koumbaya-btn-outline flex-1"}," Annuler "),g[4]||(g[4]=e("button",{type:"submit",class:"koumbaya-btn koumbaya-btn-primary flex-1"}," Prolonger ",-1))])])],32)])])])):f("",!0)}},pt={class:"space-y-6"},xt={class:"flex justify-between items-start"},_t={class:"flex items-center space-x-3 mb-2"},ft={class:"text-3xl font-bold text-gray-900"},yt={class:"flex space-x-3"},bt={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},wt={class:"bg-white p-6 rounded-xl shadow-sm border"},ht={class:"flex items-center"},kt={class:"p-3 bg-blue-100 rounded-lg"},$t={class:"ml-4"},Dt={class:"text-2xl font-bold text-gray-900"},Tt={class:"bg-white p-6 rounded-xl shadow-sm border"},jt={class:"flex items-center"},Et={class:"p-3 bg-blue-100 rounded-lg"},Ct={class:"ml-4"},Mt={class:"text-2xl font-bold text-gray-900"},Nt={class:"bg-white p-6 rounded-xl shadow-sm border"},Pt={class:"flex items-center"},Ft={class:"p-3 bg-purple-100 rounded-lg"},At={class:"ml-4"},Vt={class:"text-2xl font-bold text-gray-900"},Lt={class:"bg-white p-6 rounded-xl shadow-sm border"},St={class:"flex items-center"},zt={class:"p-3 bg-yellow-100 rounded-lg"},qt={class:"ml-4"},Rt={class:"text-2xl font-bold text-gray-900"},It={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Ot={class:"lg:col-span-2 space-y-6"},Bt={class:"bg-white rounded-xl shadow-sm border overflow-hidden"},Ut={class:"p-6"},Gt={class:"flex space-x-6"},Wt={class:"flex-shrink-0"},Jt=["src","alt"],Kt={class:"flex-1"},Ht={class:"text-xl font-semibold text-gray-900 mb-2"},Qt={class:"text-gray-600 mb-4"},Xt={class:"grid grid-cols-2 gap-4"},Yt={class:"text-lg font-semibold text-gray-900"},Zt={class:"text-lg font-semibold text-gray-900"},es={class:"text-lg font-semibold text-gray-900"},ts={class:"text-lg font-semibold text-gray-900"},ss={class:"bg-white rounded-xl shadow-sm border"},os={class:"p-6"},as={class:"space-y-4"},ns={class:"flex justify-between items-center mb-2"},rs={class:"text-sm text-gray-500"},ls={class:"w-full bg-gray-200 rounded-full h-2"},is={class:"flex justify-between items-center mb-2"},ds={class:"text-sm text-gray-500"},us={class:"text-xs text-gray-600"},cs={key:0},ms={class:"flex justify-between items-center mb-2"},gs={class:"text-sm text-gray-500"},vs={class:"w-full bg-gray-200 rounded-full h-2"},ps={class:"mt-6 grid grid-cols-3 gap-4 text-center"},xs={class:"p-4 bg-blue-50 rounded-lg"},_s={class:"text-2xl font-bold text-blue-600"},fs={class:"p-4 bg-blue-50 rounded-lg"},ys={class:"text-2xl font-bold text-blue-600"},bs={class:"p-4 bg-yellow-50 rounded-lg"},ws={class:"text-2xl font-bold text-yellow-600"},hs={key:0,class:"bg-green-50 border border-green-200 rounded-xl p-4"},ks={class:"flex items-center space-x-3"},$s={class:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center"},Ds={class:"text-sm text-green-600"},Ts={key:1,class:"bg-white rounded-xl shadow-sm border"},js={class:"px-6 py-4 border-b border-gray-200"},Es={class:"text-lg font-semibold text-gray-900 flex items-center"},Cs={class:"p-6"},Ms={class:"flex items-center space-x-4"},Ns={class:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center"},Ps={class:"font-semibold text-gray-900"},Fs={class:"text-sm text-gray-600"},As={class:"space-y-6"},Vs={class:"bg-white rounded-xl shadow-sm border"},Ls={class:"p-6 space-y-3"},Ss={class:"bg-white rounded-xl shadow-sm border"},zs={class:"px-6 py-4 border-b border-gray-200"},qs={class:"flex justify-between items-center"},Rs={class:"p-6"},Is={class:"space-y-3"},Os={class:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center"},Bs={class:"text-sm font-medium text-gray-600"},Us={class:"flex-1 min-w-0"},Gs={class:"text-sm font-medium text-gray-900 truncate"},Ws={class:"text-xs text-gray-500"},Js={class:"text-sm text-gray-500"},Ks={class:"bg-white rounded-xl shadow-sm border"},Hs={class:"p-6"},Qs={class:"space-y-4"},Xs={class:"flex justify-between"},Ys={class:"text-sm font-medium text-gray-900"},Zs={class:"flex justify-between"},eo={class:"text-sm font-medium text-gray-900"},to={class:"flex justify-between"},so={class:"text-sm font-medium text-gray-900"},oo={class:"flex justify-between"},ao={class:"text-sm font-medium text-blue-600"},lo={__name:"LotteryView",setup(x){const j=ue(),{get:$}=J(),s=T({id:j.params.id,title:"",description:"",status:"",product_value:0,ticket_price:0,category:"",participants_count:0,tickets_sold:0,total_revenue:0,max_participants:0,revenue_target:0,end_date:"",created_at:"",views_count:0,product_image:"",winner:null,draw_date:null,product:null,lottery_number:"",max_tickets:0,sold_tickets:0,progress_percentage:0}),b=T([]),m=T(!1),d=T(!1),w=T(!1),g=y(()=>s.value.max_tickets?Math.min(s.value.sold_tickets/s.value.max_tickets*100,100):0),D=y(()=>s.value.revenue_target?Math.min(s.value.total_revenue/s.value.revenue_target*100,100):0),M=y(()=>!s.value.views_count||s.value.views_count===0?0:(s.value.participants_count/s.value.views_count*100).toFixed(1)),N=y(()=>s.value.participants_count===0?0:s.value.total_revenue/s.value.participants_count),L=y(()=>{const a=s.value.product_value;return((s.value.total_revenue-a)/a*100).toFixed(1)}),p=y(()=>{if(!s.value.end_date)return"Non définie";try{const a=new Date,t=new Date(s.value.end_date);if(isNaN(t.getTime()))return"Date invalide";const v=t-a;if(v<=0)return"Terminée";const l=Math.floor(v/(1e3*60*60*24)),h=Math.floor(v%(1e3*60*60*24)/(1e3*60*60));return l>0?`${l}j ${h}h`:`${h}h`}catch(a){return console.error("Error calculating time remaining:",a),"Erreur de calcul"}}),n=y(()=>{if(!s.value.end_date)return 0;try{const a=new Date,t=new Date(s.value.end_date);if(isNaN(t.getTime()))return 0;const v=t-a;return v<=0?0:Math.ceil(v/(1e3*60*60*24))}catch(a){return console.error("Error calculating days remaining:",a),0}}),z=y(()=>{try{const a=s.value.status==="active",t=!s.value.winning_ticket_number,v=s.value.sold_tickets>=s.value.max_tickets;let l=!1;if(s.value.draw_date){const h=new Date(s.value.draw_date);isNaN(h.getTime())||(l=h<=new Date)}return a&&t&&(v||l)}catch(a){return console.error("Error calculating canDraw:",a),!1}}),q=y(()=>{try{const a=s.value.status==="active",t=!s.value.winning_ticket_number,v=s.value.sold_tickets>=s.value.max_tickets;let l=!1;if(s.value.draw_date){const h=new Date(s.value.draw_date);isNaN(h.getTime())||(l=h>new Date)}return a&&t&&v&&l}catch(a){return console.error("Error calculating canDrawManually:",a),!1}}),K=a=>({active:"Active",completed:"Terminée",pending:"En attente",paused:"En pause",cancelled:"Annulée"})[a]||a,E=a=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(a||0)+" FCFA",F=a=>{if(!a)return"Non définie";try{const t=new Date(a);return isNaN(t.getTime())?"Date invalide":new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}catch(t){return console.error("Error formatting date:",t),"Erreur de format"}},H=()=>{const a=`${window.location.origin}/lottery/${s.value.id}`;navigator.clipboard.writeText(a),window.$toast&&window.$toast.success("Lien de partage copié dans le presse-papiers!","✅ Partage")},Q=()=>{window.$toast&&window.$toast.info("Fonctionnalité de téléchargement en cours de développement","🚀 En développement")},X=()=>{window.$toast&&window.$toast.info("Mise en pause de la tombola...","⏸️ Pause")},Y=()=>{const a=n.value,v=`Tous les tickets sont vendus ! Voulez-vous effectuer le tirage maintenant ?

⏰ Date prévue : ${s.value.draw_date?F(s.value.draw_date):"Non définie"}
📅 Tirage anticipé de ${a} jour${a>1?"s":""}

Cette action est irréversible.`;confirm(v)&&(m.value=!0)},Z=a=>{console.log("Tirage terminé:",a),a&&a.success&&a.lottery&&(s.value={...s.value,...a.lottery,status:"completed",is_drawn:!0,winner_user_id:a.winning_ticket?.user_id,winner_ticket_number:a.winning_ticket?.ticket_number,winner:a.winning_ticket?.user,draw_date:new Date().toISOString()}),setTimeout(()=>{S()},1e3),setTimeout(()=>{m.value=!1},3e3)},ee=()=>{d.value=!1,S()},S=async()=>{try{const a=await $(`/lotteries/${j.params.id}`);if(a?.lottery){const t=a.lottery;console.log("LotteryData:",t),console.log("Available keys:",Object.keys(t));const v=new Set,l=t.paid_tickets||t.paidTickets||t.tickets||[];console.log("PaidTickets:",l),console.log("PaidTickets length:",l.length),l.forEach(k=>{k.user?.id&&v.add(k.user.id)});const h=v.size,te=(t.sold_tickets||0)*(t.ticket_price||0),A=new Map;l.forEach(k=>{if(k.user?.id){const C=k.user.id,oe=`${k.user.first_name||""} ${k.user.last_name||""}`.trim();A.has(C)?A.get(C).tickets_count++:A.set(C,{id:C,name:oe||"Utilisateur anonyme",participated_at:k.created_at||new Date().toISOString(),tickets_count:1})}});const se=Array.from(A.values()).sort((k,C)=>new Date(C.participated_at)-new Date(k.participated_at)).slice(0,5);s.value={...s.value,id:t.id,title:t.title,description:t.description||"",status:t.status,lottery_number:t.lottery_number,ticket_price:t.ticket_price||0,max_tickets:t.max_tickets||0,sold_tickets:t.sold_tickets||0,progress_percentage:t.progress_percentage||0,draw_date:t.draw_date,created_at:t.created_at,tickets_sold:t.sold_tickets||0,participants_count:h,total_revenue:te,max_participants:t.max_tickets||0,end_date:t.draw_date,revenue_target:t.revenue_target||null,views_count:t.views_count||0,product:t.product,product_value:t.product?.price||0,category:t.product?.category?.name||"",product_image:t.product?.image_url||t.product?.image||"",winner:t.winner||null,winning_ticket_number:t.winning_ticket_number||null},b.value=se}}catch(a){console.error("Erreur lors du chargement de la tombola:",a),window.$toast&&window.$toast.error("Erreur lors du chargement des données de la tombola")}};return ce(()=>{S()}),(a,t)=>{const v=ge("router-link");return u(),c("div",pt,[e("div",xt,[e("div",null,[e("div",_t,[r(v,{to:"/merchant/lotteries",class:"text-gray-500 hover:text-gray-700"},{default:U(()=>[r(i(je),{class:"w-5 h-5"})]),_:1}),e("h1",ft,o(s.value.title),1),e("span",{class:ve(["px-3 py-1 rounded-full text-sm font-medium",s.value.status==="active"||s.value.status==="completed"?"bg-blue-100 text-blue-800":s.value.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},o(K(s.value.status)),3)]),t[5]||(t[5]=e("p",{class:"text-gray-600"},"Gérez votre tombola et suivez les participations",-1))]),e("div",yt,[s.value.status==="active"?(u(),c("button",{key:0,onClick:t[0]||(t[0]=l=>d.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center whitespace-nowrap"},[r(i(pe),{class:"w-4 h-4 mr-2 flex-shrink-0"}),t[6]||(t[6]=_(" Prolonger ",-1))])):f("",!0),s.value.status==="active"&&z.value?(u(),c("button",{key:1,onClick:t[1]||(t[1]=l=>m.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center whitespace-nowrap"},[r(i(P),{class:"w-4 h-4 mr-2 flex-shrink-0"}),t[7]||(t[7]=_(" Effectuer le tirage ",-1))])):f("",!0),e("button",{onClick:t[2]||(t[2]=l=>w.value=!0),class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 flex items-center whitespace-nowrap"},[r(i(xe),{class:"w-4 h-4 mr-2 flex-shrink-0"}),t[8]||(t[8]=_(" Modifier ",-1))])])]),e("div",bt,[e("div",wt,[e("div",ht,[e("div",kt,[r(i(_e),{class:"w-6 h-6 text-blue-600"})]),e("div",$t,[t[9]||(t[9]=e("p",{class:"text-sm font-medium text-gray-600"},"Participants",-1)),e("p",Dt,o(s.value.participants_count),1)])])]),e("div",Tt,[e("div",jt,[e("div",Et,[r(i(fe),{class:"w-6 h-6 text-blue-600"})]),e("div",Ct,[t[10]||(t[10]=e("p",{class:"text-sm font-medium text-gray-600"},"Revenus générés",-1)),e("p",Mt,o(E(s.value.total_revenue)),1)])])]),e("div",Nt,[e("div",Pt,[e("div",Ft,[r(i(ye),{class:"w-6 h-6 text-purple-600"})]),e("div",At,[t[11]||(t[11]=e("p",{class:"text-sm font-medium text-gray-600"},"Tickets vendus",-1)),e("p",Vt,o(s.value.tickets_sold),1)])])]),e("div",Lt,[e("div",St,[e("div",zt,[r(i(be),{class:"w-6 h-6 text-yellow-600"})]),e("div",qt,[t[12]||(t[12]=e("p",{class:"text-sm font-medium text-gray-600"},"Temps restant",-1)),e("p",Rt,o(p.value),1)])])])]),e("div",It,[e("div",Ot,[e("div",Bt,[t[17]||(t[17]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Informations du produit")],-1)),e("div",Ut,[e("div",Gt,[e("div",Wt,[e("img",{src:s.value.product_image||"/images/products/placeholder.jpg",alt:s.value.title,class:"w-32 h-32 object-cover rounded-lg"},null,8,Jt)]),e("div",Kt,[e("h4",Ht,o(s.value.title),1),e("p",Qt,o(s.value.description),1),e("div",Xt,[e("div",null,[t[13]||(t[13]=e("p",{class:"text-sm font-medium text-gray-500"},"Valeur du produit",-1)),e("p",Yt,o(E(s.value.product_value)),1)]),e("div",null,[t[14]||(t[14]=e("p",{class:"text-sm font-medium text-gray-500"},"Prix du ticket",-1)),e("p",Zt,o(E(s.value.ticket_price)),1)]),e("div",null,[t[15]||(t[15]=e("p",{class:"text-sm font-medium text-gray-500"},"Catégorie",-1)),e("p",es,o(s.value.category?.name||s.value.category||"Sans catégorie"),1)]),e("div",null,[t[16]||(t[16]=e("p",{class:"text-sm font-medium text-gray-500"},"Date de fin",-1)),e("p",ts,o(F(s.value.end_date)),1)])])])])])]),e("div",ss,[t[24]||(t[24]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Progression")],-1)),e("div",os,[e("div",as,[e("div",null,[e("div",ns,[t[18]||(t[18]=e("span",{class:"text-sm font-medium text-gray-700"},"Objectif de tickets",-1)),e("span",rs,o(s.value.sold_tickets)+" / "+o(s.value.max_tickets),1)]),e("div",ls,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:G({width:g.value+"%"})},null,4)])]),e("div",null,[e("div",is,[t[19]||(t[19]=e("span",{class:"text-sm font-medium text-gray-700"},"Participants uniques",-1)),e("span",ds,o(s.value.participants_count)+" personnes",1)]),e("div",us," Moyenne: "+o(s.value.participants_count>0?(s.value.sold_tickets/s.value.participants_count).toFixed(1):0)+" tickets/personne ",1)]),s.value.revenue_target?(u(),c("div",cs,[e("div",ms,[t[20]||(t[20]=e("span",{class:"text-sm font-medium text-gray-700"},"Objectif de revenus",-1)),e("span",gs,o(E(s.value.total_revenue))+" / "+o(E(s.value.revenue_target)),1)]),e("div",vs,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:G({width:D.value+"%"})},null,4)])])):f("",!0)]),e("div",ps,[e("div",xs,[e("p",_s,o(g.value)+"%",1),t[21]||(t[21]=e("p",{class:"text-sm text-blue-600"},"Tickets vendus",-1))]),e("div",fs,[e("p",ys,o(M.value)+"%",1),t[22]||(t[22]=e("p",{class:"text-sm text-blue-600"},"Conversion",-1))]),e("div",bs,[e("p",ws,o(n.value),1),t[23]||(t[23]=e("p",{class:"text-sm text-yellow-600"},"Jours restants",-1))])])])]),q.value?(u(),c("div",hs,[e("div",ks,[e("div",$s,[r(i(P),{class:"w-5 h-5 text-green-600"})]),e("div",null,[t[25]||(t[25]=e("h4",{class:"text-md font-semibold text-green-800"},"Tirage possible !",-1)),e("p",Ds," Tous les tickets sont vendus ("+o(s.value.sold_tickets)+"/"+o(s.value.max_tickets)+'). Vous pouvez effectuer le tirage maintenant dans "Actions rapides". ',1)])])])):f("",!0),s.value.winner?(u(),c("div",Ts,[e("div",js,[e("h3",Es,[r(i(W),{class:"w-5 h-5 text-yellow-500 mr-2"}),t[26]||(t[26]=_(" Gagnant ",-1))])]),e("div",Cs,[e("div",Ms,[e("div",Ns,[r(i(we),{class:"w-6 h-6 text-yellow-600"})]),e("div",null,[e("p",Ps,o(s.value.winner.name),1),e("p",Fs,"Tirage effectué le "+o(F(s.value.draw_date)),1)])]),t[27]||(t[27]=e("div",{class:"mt-4 p-4 bg-yellow-50 rounded-lg"},[e("p",{class:"text-sm text-yellow-800"}," Félicitations ! Le gagnant a été contacté automatiquement par email. ")],-1))])])):f("",!0)]),e("div",As,[e("div",Vs,[t[32]||(t[32]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Actions rapides")],-1)),e("div",Ls,[e("button",{onClick:H,class:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},[r(i(he),{class:"w-4 h-4 mr-2"}),t[28]||(t[28]=_(" Partager la tombola ",-1))]),e("button",{onClick:Q,class:"w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},[r(i(ke),{class:"w-4 h-4 mr-2"}),t[29]||(t[29]=_(" Télécharger le rapport ",-1))]),q.value?(u(),c("button",{key:0,onClick:Y,class:"w-full flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"},[r(i(P),{class:"w-4 h-4 mr-2"}),t[30]||(t[30]=_(" Effectuer le tirage maintenant ",-1))])):f("",!0),s.value.status==="active"?(u(),c("button",{key:1,onClick:X,class:"w-full flex items-center justify-center px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"},[r(i($e),{class:"w-4 h-4 mr-2"}),t[31]||(t[31]=_(" Mettre en pause ",-1))])):f("",!0)])]),e("div",Ss,[e("div",zs,[e("div",qs,[t[34]||(t[34]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Participants récents",-1)),r(v,{to:`/merchant/lotteries/${s.value.id}/participants`,class:"text-sm text-blue-600 hover:text-blue-700"},{default:U(()=>t[33]||(t[33]=[_(" Voir tout ",-1)])),_:1,__:[33]},8,["to"])])]),e("div",Rs,[e("div",Is,[(u(!0),c(De,null,Te(b.value,l=>(u(),c("div",{key:l.id,class:"flex items-center space-x-3"},[e("div",Os,[e("span",Bs,o(l.name.charAt(0)),1)]),e("div",Us,[e("p",Gs,o(l.name),1),e("p",Ws,o(F(l.participated_at)),1)]),e("div",Js,o(l.tickets_count)+" ticket"+o(l.tickets_count>1?"s":""),1)]))),128))])])]),e("div",Ks,[t[39]||(t[39]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Statistiques")],-1)),e("div",Hs,[e("div",Qs,[e("div",Xs,[t[35]||(t[35]=e("span",{class:"text-sm text-gray-600"},"Vues de la tombola",-1)),e("span",Ys,o(s.value.views_count||"N/A"),1)]),e("div",Zs,[t[36]||(t[36]=e("span",{class:"text-sm text-gray-600"},"Taux de conversion",-1)),e("span",eo,o(M.value)+"%",1)]),e("div",to,[t[37]||(t[37]=e("span",{class:"text-sm text-gray-600"},"Panier moyen",-1)),e("span",so,o(E(N.value)),1)]),e("div",oo,[t[38]||(t[38]=e("span",{class:"text-sm text-gray-600"},"Retour sur investissement",-1)),e("span",ao,"+"+o(L.value)+"%",1)])])])])])]),r(it,{show:m.value,lottery:s.value,onClose:t[3]||(t[3]=l=>m.value=!1),onDrawn:Z},null,8,["show","lottery"]),d.value?(u(),me(vt,{key:0,lottery:s.value,onClose:t[4]||(t[4]=l=>d.value=!1),onExtended:ee},null,8,["lottery"])):f("",!0)])}}};export{lo as default};
