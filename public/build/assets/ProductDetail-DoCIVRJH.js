import{r as c,c as E,j as Q,b as n,l as j,e as t,g as i,u as d,a1 as G,t as r,w as C,h as O,i as m,aD as W,x as S,aR as H,v as J,F as K,z as X,aI as Y,aL as Z,aj as tt,y as et,V as x,W as f,a0 as st,L as ot,s as rt,o as u,aw as T}from"./vendor-dZUSqucC.js";import{_ as lt,a as at,b as it}from"./app-d382hh_R.js";const dt={class:"product-detail"},nt={key:0,class:"min-h-screen flex items-center justify-center"},ut={key:1,class:"min-h-screen flex items-center justify-center"},ct={class:"text-center max-w-md mx-auto px-4"},mt={class:"mb-6"},pt={class:"text-gray-600 mb-6"},gt={class:"space-y-3"},xt={key:2,class:"space-y-6"},vt={class:"flex items-center justify-between"},bt={class:"flex items-center space-x-3 mb-2"},yt={class:"text-3xl font-bold text-gray-900"},ft={class:"flex space-x-3"},_t={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ht={class:"lg:col-span-2 space-y-6"},wt={class:"bg-white rounded-xl shadow-sm border"},kt={class:"p-6"},jt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ct={class:"md:col-span-2"},$t={class:"flex space-x-6"},Dt={class:"flex-shrink-0"},Pt=["src","alt"],Mt={class:"flex-1"},Et={class:"text-xl font-semibold text-gray-900 mb-2"},St={class:"text-gray-600 mb-4"},Tt={class:"grid grid-cols-2 gap-4"},Vt={class:"text-lg font-semibold text-gray-900"},Rt={class:"text-lg font-semibold text-gray-900"},qt={class:"text-lg font-semibold text-gray-900"},Ft={class:"text-lg font-semibold text-gray-900"},At={class:"bg-white rounded-xl shadow-sm border"},It={class:"p-6"},Nt={class:"flex items-center space-x-4"},Ut={class:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center"},Bt={class:"font-semibold text-gray-900"},Lt={class:"text-sm text-gray-600"},zt={class:"text-sm text-gray-500"},Qt={class:"mt-4 grid grid-cols-2 gap-4"},Gt={class:"text-sm text-gray-900"},Ot={class:"text-sm text-gray-900"},Wt={key:0,class:"bg-white rounded-xl shadow-sm border"},Ht={class:"p-6"},Jt={class:"space-y-4"},Kt={class:"flex justify-between items-start"},Xt={class:"font-semibold text-gray-900"},Yt={class:"text-sm text-gray-600 mt-1"},Zt={class:"flex items-center space-x-4 mt-2 text-sm text-gray-500"},te={class:"text-right"},ee={class:"space-y-6"},se={class:"bg-white rounded-xl shadow-sm border"},oe={class:"p-6 space-y-4"},re={class:"flex justify-between"},le={class:"text-sm font-medium text-gray-900"},ae={class:"flex justify-between"},ie={class:"text-sm font-medium text-gray-900"},de={class:"flex justify-between"},ne={class:"text-sm font-medium text-gray-900"},ue={class:"flex justify-between"},ce={class:"text-sm font-medium text-gray-900"},me={class:"bg-white rounded-xl shadow-sm border"},pe={class:"p-6 space-y-4"},ge={class:"text-sm text-gray-900"},xe={class:"text-sm text-gray-900"},ve={class:"text-sm font-mono text-gray-900"},be={class:"bg-white rounded-xl shadow-sm border"},ye={class:"p-6 space-y-3"},fe={key:3,class:"fixed inset-0 bg-black/40 overflow-y-auto h-full w-full z-50"},_e={class:"relative top-20 mx-auto p-5 border w-11/12 max-w-3xl shadow-lg rounded-md bg-white"},he={class:"mt-3"},we={class:"flex justify-between items-center mb-4"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},je={class:"md:col-span-2"},Ce={class:"md:col-span-2"},$e={class:"flex justify-end space-x-3 mt-6"},De=["disabled"],Pe={__name:"ProductDetail",setup(Me){const V=ot(),$=rt(),{get:R,put:q,delete:F}=at(),{showSuccess:D,showError:v}=it(),s=c(null),_=c(!1),p=c(""),g=c(!1),b=c(!1),a=c({name:"",description:"",price:0,quantity:0,status:"active"}),A=E(()=>s.value?.lotteries?s.value.lotteries.reduce((o,e)=>o+(e.sold_tickets||0),0):0),I=E(()=>s.value?.lotteries?s.value.lotteries.reduce((o,e)=>o+(e.sold_tickets||0)*(e.ticket_price||0),0):0),h=async()=>{_.value=!0,p.value="";try{const o=await R(`/admin/products/${V.params.id}`);o.success?(s.value=o.data.product,a.value={name:s.value.name,description:s.value.description||"",price:s.value.price,quantity:s.value.quantity||0,status:s.value.status}):p.value=o.message||"Erreur lors du chargement du produit"}catch(o){console.error("Erreur lors du chargement du produit:",o),p.value=o.response?.data?.message||"Erreur lors du chargement du produit"}finally{_.value=!1}},N=()=>{g.value=!0},U=async()=>{b.value=!0;try{const o=await q(`/admin/products/${s.value.id}`,a.value);o.success?(D("Produit mis à jour avec succès"),g.value=!1,await h()):v(o.message||"Erreur lors de la mise à jour")}catch(o){console.error("Erreur lors de la mise à jour:",o),v(o.response?.data?.message||"Erreur lors de la mise à jour")}finally{b.value=!1}},B=async()=>{if(confirm("Êtes-vous sûr de vouloir supprimer ce produit ? Cette action est irréversible."))try{const o=await F(`/admin/products/${s.value.id}`);o.success?(D("Produit supprimé avec succès"),$.push("/admin/products")):v(o.message||"Erreur lors de la suppression")}catch(o){console.error("Erreur lors de la suppression:",o),v(o.response?.data?.message||"Erreur lors de la suppression")}},L=()=>{$.push(`/admin/orders?product_id=${s.value.id}`)},w=o=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(o||0)+" FCFA",k=o=>o?new Date(o).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Non définie",P=o=>({active:"Actif",inactive:"Inactif",out_of_stock:"Rupture de stock",completed:"Terminé",cancelled:"Annulé",pending:"En attente"})[o]||o,M=o=>`px-3 py-1 rounded-full text-sm font-medium ${{active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",out_of_stock:"bg-red-100 text-red-800",completed:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800"}[o]||"bg-gray-100 text-gray-800"}`,z=o=>({physical:"Produit physique",digital:"Produit numérique",service:"Service",lottery:"Tombola"})[o]||o||"Non spécifié";return Q(()=>{h()}),(o,e)=>{const y=O("router-link");return u(),n("div",dt,[_.value?(u(),n("div",nt,e[7]||(e[7]=[t("div",{class:"text-center"},[t("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),t("p",{class:"text-gray-600 mt-4 text-lg"},"Chargement du produit...")],-1)]))):p.value?(u(),n("div",ut,[t("div",ct,[t("div",mt,[i(d(G),{class:"w-20 h-20 text-red-500 mx-auto mb-4"}),e[8]||(e[8]=t("h2",{class:"text-3xl font-bold text-gray-900 mb-2"},"Produit introuvable",-1)),t("p",pt,r(p.value),1)]),t("div",gt,[i(y,{to:"/admin/products",class:"block bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors"},{default:C(()=>[i(d(T),{class:"w-5 h-5 inline mr-2"}),e[9]||(e[9]=m(" Retour aux produits ",-1))]),_:1,__:[9]}),t("button",{onClick:h,class:"block w-full bg-gray-200 text-gray-700 px-6 py-3 rounded-md hover:bg-gray-300 transition-colors"},[i(d(W),{class:"w-5 h-5 inline mr-2"}),e[10]||(e[10]=m(" Réessayer ",-1))])])])])):s.value?(u(),n("div",xt,[t("div",vt,[t("div",null,[t("div",bt,[i(y,{to:"/admin/products",class:"text-gray-500 hover:text-gray-700"},{default:C(()=>[i(d(T),{class:"w-5 h-5"})]),_:1}),t("h1",yt,r(s.value.name),1),t("span",{class:S(M(s.value.status))},r(P(s.value.status)),3)]),e[11]||(e[11]=t("p",{class:"text-gray-600"},"Gérer et visualiser les détails de ce produit",-1))]),t("div",ft,[t("button",{onClick:N,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},[i(d(H),{class:"w-4 h-4 mr-2 inline"}),e[12]||(e[12]=m(" Modifier ",-1))])])]),t("div",_t,[t("div",ht,[t("div",wt,[e[17]||(e[17]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Informations du produit")],-1)),t("div",kt,[t("div",jt,[t("div",Ct,[t("div",$t,[t("div",Dt,[t("img",{src:s.value.image_url||s.value.main_image||"/images/products/placeholder.jpg",alt:s.value.name,class:"w-48 h-48 object-cover rounded-lg border"},null,8,Pt)]),t("div",Mt,[t("h4",Et,r(s.value.name),1),t("p",St,r(s.value.description||"Aucune description disponible"),1),t("div",Tt,[t("div",null,[e[13]||(e[13]=t("p",{class:"text-sm font-medium text-gray-500"},"Prix",-1)),t("p",Vt,r(w(s.value.price)),1)]),t("div",null,[e[14]||(e[14]=t("p",{class:"text-sm font-medium text-gray-500"},"Catégorie",-1)),t("p",Rt,r(s.value.category?.name||"Sans catégorie"),1)]),t("div",null,[e[15]||(e[15]=t("p",{class:"text-sm font-medium text-gray-500"},"Quantité",-1)),t("p",qt,r(s.value.quantity||0),1)]),t("div",null,[e[16]||(e[16]=t("p",{class:"text-sm font-medium text-gray-500"},"Type",-1)),t("p",Ft,r(z(s.value.type)),1)])])])])])])])]),t("div",At,[e[20]||(e[20]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Informations du marchand")],-1)),t("div",It,[t("div",Nt,[t("div",Ut,[i(d(J),{class:"w-6 h-6 text-gray-600"})]),t("div",null,[t("p",Bt,r(s.value.user?.first_name)+" "+r(s.value.user?.last_name),1),t("p",Lt,r(s.value.user?.email),1),t("p",zt,r(s.value.user?.phone||"Téléphone non renseigné"),1)])]),t("div",Qt,[t("div",null,[e[18]||(e[18]=t("p",{class:"text-sm font-medium text-gray-500"},"Statut du marchand",-1)),t("p",Gt,r(s.value.user?.is_active?"Actif":"Inactif"),1)]),t("div",null,[e[19]||(e[19]=t("p",{class:"text-sm font-medium text-gray-500"},"Rôle",-1)),t("p",Ot,r(s.value.user?.roles?.[0]?.name||"Client"),1)])])])]),s.value.lotteries&&s.value.lotteries.length>0?(u(),n("div",Wt,[e[22]||(e[22]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Tombolas associées")],-1)),t("div",Ht,[t("div",Jt,[(u(!0),n(K,null,X(s.value.lotteries,l=>(u(),n("div",{key:l.id,class:"border rounded-lg p-4 hover:bg-gray-50"},[t("div",Kt,[t("div",null,[t("h4",Xt,r(l.title),1),t("p",Yt,r(l.description),1),t("div",Zt,[t("span",null,r(l.sold_tickets||0)+"/"+r(l.max_tickets)+" tickets",1),t("span",null,r(w(l.ticket_price))+"/ticket",1),t("span",null,r(k(l.draw_date)),1)])]),t("div",te,[t("span",{class:S(M(l.status))},r(P(l.status)),3),i(y,{to:`/admin/lotteries/${l.id}`,class:"block mt-2 text-blue-600 hover:text-blue-800 text-sm"},{default:C(()=>e[21]||(e[21]=[m(" Voir détails → ",-1)])),_:2,__:[21]},1032,["to"])])])]))),128))])])])):j("",!0)]),t("div",ee,[t("div",se,[e[27]||(e[27]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Statistiques")],-1)),t("div",oe,[t("div",re,[e[23]||(e[23]=t("span",{class:"text-sm text-gray-600"},"Vues",-1)),t("span",le,r(s.value.views_count||0),1)]),t("div",ae,[e[24]||(e[24]=t("span",{class:"text-sm text-gray-600"},"Tombolas créées",-1)),t("span",ie,r(s.value.lotteries?.length||0),1)]),t("div",de,[e[25]||(e[25]=t("span",{class:"text-sm text-gray-600"},"Tickets vendus",-1)),t("span",ne,r(A.value),1)]),t("div",ue,[e[26]||(e[26]=t("span",{class:"text-sm text-gray-600"},"Revenus générés",-1)),t("span",ce,r(w(I.value)),1)])])]),t("div",me,[e[31]||(e[31]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Métadonnées")],-1)),t("div",pe,[t("div",null,[e[28]||(e[28]=t("p",{class:"text-sm font-medium text-gray-500"},"Date de création",-1)),t("p",ge,r(k(s.value.created_at)),1)]),t("div",null,[e[29]||(e[29]=t("p",{class:"text-sm font-medium text-gray-500"},"Dernière modification",-1)),t("p",xe,r(k(s.value.updated_at)),1)]),t("div",null,[e[30]||(e[30]=t("p",{class:"text-sm font-medium text-gray-500"},"ID Produit",-1)),t("p",ve,"#"+r(s.value.id),1)])])]),t("div",be,[e[34]||(e[34]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Actions")],-1)),t("div",ye,[t("button",{onClick:L,class:"w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},[i(d(Y),{class:"w-4 h-4 mr-2"}),e[32]||(e[32]=m(" Voir les commandes ",-1))]),t("button",{onClick:B,class:"w-full flex items-center justify-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"},[i(d(Z),{class:"w-4 h-4 mr-2"}),e[33]||(e[33]=m(" Supprimer le produit ",-1))])])])])])])):j("",!0),g.value?(u(),n("div",fe,[t("div",_e,[t("div",he,[t("div",we,[e[35]||(e[35]=t("h3",{class:"text-lg font-medium text-gray-900"},"Modifier le produit",-1)),t("button",{onClick:e[0]||(e[0]=l=>g.value=!1),class:"text-gray-400 hover:text-gray-600"},[i(d(tt),{class:"w-6 h-6"})])]),t("form",{onSubmit:et(U,["prevent"])},[t("div",ke,[t("div",je,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom du produit",-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.name=l),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[f,a.value.name]])]),t("div",Ce,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),x(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.description=l),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[f,a.value.description]])]),t("div",null,[e[38]||(e[38]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prix",-1)),x(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.price=l),type:"number",step:"0.01",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:""},null,512),[[f,a.value.price]])]),t("div",null,[e[39]||(e[39]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Quantité",-1)),x(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.quantity=l),type:"number",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,512),[[f,a.value.quantity]])]),t("div",null,[e[41]||(e[41]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),x(t("select",{"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.status=l),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},e[40]||(e[40]=[t("option",{value:"active"},"Actif",-1),t("option",{value:"inactive"},"Inactif",-1),t("option",{value:"out_of_stock"},"Rupture de stock",-1)]),512),[[st,a.value.status]])])]),t("div",$e,[t("button",{type:"button",onClick:e[6]||(e[6]=l=>g.value=!1),class:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"}," Annuler "),t("button",{type:"submit",disabled:b.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},r(b.value?"Mise à jour...":"Mettre à jour"),9,De)])],32)])])])):j("",!0)])}}},Te=lt(Pe,[["__scopeId","data-v-192805d0"]]);export{Te as default};
