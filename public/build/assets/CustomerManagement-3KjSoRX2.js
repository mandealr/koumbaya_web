import{r as g,c as D,j as P,b as i,e,t as l,V as b,a1 as $,a7 as w,f as E,l as j,F as k,z as C,i as m,o as n,x as V}from"./vendor-HurWl8Tx.js";import{c as _}from"./app-Bc6yMBle.js";const B={class:"p-6"},I={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},L={class:"bg-white rounded-lg shadow p-4"},T={class:"text-2xl font-bold text-gray-900"},R={class:"bg-white rounded-lg shadow p-4"},U={class:"text-2xl font-bold text-green-600"},F={class:"bg-white rounded-lg shadow p-4"},G={class:"text-2xl font-bold text-red-600"},H={class:"bg-white rounded-lg shadow p-4"},O={class:"text-2xl font-bold text-blue-600"},q={class:"bg-white rounded-lg shadow p-4"},J={class:"text-2xl font-bold text-yellow-600"},K={class:"bg-white rounded-lg shadow p-4 mb-6"},Q={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},W={class:"bg-white rounded-lg shadow overflow-hidden"},X={key:0,class:"text-center py-12"},Y={key:1,class:"text-center py-12"},Z={class:"text-red-600"},ee={key:2,class:"text-center py-12"},te={key:3},se={class:"min-w-full divide-y divide-gray-200"},ae={class:"bg-white divide-y divide-gray-200"},oe={class:"px-6 py-4 whitespace-nowrap"},le={class:"flex items-center"},ie={key:0,class:"flex-shrink-0 h-10 w-10"},ne=["src","alt"],re={key:1,class:"flex-shrink-0 h-10 w-10 bg-gray-200 rounded-full flex items-center justify-center"},de={class:"text-gray-600 font-medium"},ue={class:"ml-4"},ce={class:"text-sm font-medium text-gray-900"},pe={class:"text-sm text-gray-500"},ge={class:"px-6 py-4 whitespace-nowrap"},ve={class:"text-sm text-gray-900"},xe={class:"text-sm text-gray-500"},me={class:"px-6 py-4 whitespace-nowrap"},fe={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"},ye={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"},be={class:"px-6 py-4 whitespace-nowrap"},_e={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800"},he={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800"},we={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ke={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},Ce=["onClick"],Ve={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Me={class:"flex-1 flex justify-between sm:hidden"},Se=["disabled"],Ae=["disabled"],Ne={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},ze={class:"text-sm text-gray-700"},De={class:"font-medium"},Pe={class:"font-medium"},$e={class:"font-medium"},Ee={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},je=["disabled"],Be=["onClick"],Ie=["disabled"],Ue={__name:"CustomerManagement",setup(Le){const f=g([]),d=g({}),o=g({total:0,per_page:15,current_page:1,last_page:1,from:0,to:0}),y=g(!1),v=g(""),r=g({search:"",status:"",sort_by:"created_at",sort_order:"desc",page:1,per_page:15}),u=async()=>{y.value=!0,v.value="";try{const a=new URLSearchParams;r.value.search&&a.append("search",r.value.search),r.value.status&&a.append("status",r.value.status),a.append("sort_by",r.value.sort_by),a.append("sort_order",r.value.sort_order),a.append("page",r.value.page),a.append("per_page",r.value.per_page);const t=await _.get(`/admin/customers?${a.toString()}`);f.value=t.data.data?.customers||[],o.value=t.data.data?.pagination||o.value}catch(a){v.value=a.response?.data?.message||"Erreur lors du chargement des clients",console.error("Error fetching customers:",a)}finally{y.value=!1}},x=a=>{a<1||a>o.value.last_page||(r.value.page=a,u())},M=D(()=>{const a=[],t=o.value.current_page,s=o.value.last_page,c=2;for(let p=Math.max(2,t-c);p<=Math.min(s-1,t+c);p++)a.push(p);return t-c>2&&a.unshift("..."),t+c<s-1&&a.push("..."),a.unshift(1),s>1&&a.push(s),a.filter((p,N,z)=>p==="..."||z.indexOf(p)===N)}),h=async()=>{try{const a=await _.get("/admin/customers/statistics");d.value=a.data.stats||{}}catch(a){console.error("Error fetching statistics:",a)}},S=async a=>{try{const t=await _.post(`/admin/customers/${a.id}/toggle-status`);t.data.success&&(a.is_active=t.data.is_active,await h())}catch(t){v.value=t.response?.data?.message||"Erreur lors du changement de statut",console.error("Error toggling status:",t)}},A=a=>a?new Date(a).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"-";return P(()=>{u(),h()}),(a,t)=>(n(),i("div",B,[t[26]||(t[26]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-900"},"Liste des clients (Particuliers)"),e("p",{class:"text-gray-600 mt-1"},'Gérer tous les utilisateurs avec le rôle "particulier"')],-1)),e("div",I,[e("div",L,[t[7]||(t[7]=e("div",{class:"text-sm text-gray-500"},"Total",-1)),e("div",T,l(d.value.total||0),1)]),e("div",R,[t[8]||(t[8]=e("div",{class:"text-sm text-gray-500"},"Actifs",-1)),e("div",U,l(d.value.active||0),1)]),e("div",F,[t[9]||(t[9]=e("div",{class:"text-sm text-gray-500"},"Inactifs",-1)),e("div",G,l(d.value.inactive||0),1)]),e("div",H,[t[10]||(t[10]=e("div",{class:"text-sm text-gray-500"},"Vérifiés",-1)),e("div",O,l(d.value.verified||0),1)]),e("div",q,[t[11]||(t[11]=e("div",{class:"text-sm text-gray-500"},"Non vérifiés",-1)),e("div",J,l(d.value.unverified||0),1)])]),e("div",K,[e("div",Q,[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Recherche",-1)),b(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>r.value.search=s),type:"text",placeholder:"Nom, email, téléphone...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onInput:u},null,544),[[$,r.value.search]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Statut",-1)),b(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>r.value.status=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:u},t[13]||(t[13]=[E('<option value="">Tous</option><option value="active">Actifs</option><option value="inactive">Inactifs</option><option value="verified">Vérifiés</option><option value="unverified">Non vérifiés</option>',5)]),544),[[w,r.value.status]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Trier par",-1)),b(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>r.value.sort_by=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:u},t[15]||(t[15]=[e("option",{value:"created_at"},"Date de création",-1),e("option",{value:"first_name"},"Prénom",-1),e("option",{value:"last_name"},"Nom",-1),e("option",{value:"email"},"Email",-1)]),544),[[w,r.value.sort_by]])])])]),e("div",W,[y.value?(n(),i("div",X,t[17]||(t[17]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},null,-1),e("p",{class:"mt-2 text-gray-600"},"Chargement...",-1)]))):v.value?(n(),i("div",Y,[e("p",Z,l(v.value),1),e("button",{onClick:u,class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," Réessayer ")])):f.value.length===0?(n(),i("div",ee,t[18]||(t[18]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Aucun client trouvé",-1),e("p",{class:"mt-1 text-sm text-gray-500"},"Aucun client ne correspond aux filtres sélectionnés.",-1)]))):(n(),i("div",te,[e("table",se,[t[19]||(t[19]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Client"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contact"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Statut"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Vérification"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Inscrit le"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",ae,[(n(!0),i(k,null,C(f.value,s=>(n(),i("tr",{key:s.id},[e("td",oe,[e("div",le,[s.avatar_url?(n(),i("div",ie,[e("img",{class:"h-10 w-10 rounded-full",src:s.avatar_url,alt:s.first_name},null,8,ne)])):(n(),i("div",re,[e("span",de,l(s.first_name?.charAt(0))+l(s.last_name?.charAt(0)),1)])),e("div",ue,[e("div",ce,l(s.first_name)+" "+l(s.last_name),1),e("div",pe,"ID: "+l(s.id),1)])])]),e("td",ge,[e("div",ve,l(s.email),1),e("div",xe,l(s.phone),1)]),e("td",me,[s.is_active?(n(),i("span",fe," Actif ")):(n(),i("span",ye," Inactif "))]),e("td",be,[s.email_verified_at?(n(),i("span",_e," Vérifié ")):(n(),i("span",he," Non vérifié "))]),e("td",we,l(A(s.created_at)),1),e("td",ke,[e("button",{onClick:c=>S(s),class:V([s.is_active?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900","mr-3"])},l(s.is_active?"Désactiver":"Activer"),11,Ce)])]))),128))])]),o.value.total>0?(n(),i("div",Ve,[e("div",Me,[e("button",{onClick:t[3]||(t[3]=s=>x(o.value.current_page-1)),disabled:o.value.current_page===1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50"}," Précédent ",8,Se),e("button",{onClick:t[4]||(t[4]=s=>x(o.value.current_page+1)),disabled:o.value.current_page===o.value.last_page,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50"}," Suivant ",8,Ae)]),e("div",Ne,[e("div",null,[e("p",ze,[t[20]||(t[20]=m(" Affichage de ",-1)),e("span",De,l(o.value.from),1),t[21]||(t[21]=m(" à ",-1)),e("span",Pe,l(o.value.to),1),t[22]||(t[22]=m(" sur ",-1)),e("span",$e,l(o.value.total),1),t[23]||(t[23]=m(" résultats ",-1))])]),e("div",null,[e("nav",Ee,[e("button",{onClick:t[5]||(t[5]=s=>x(o.value.current_page-1)),disabled:o.value.current_page===1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50"},t[24]||(t[24]=[e("span",{class:"sr-only"},"Précédent",-1),e("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)]),8,je),(n(!0),i(k,null,C(M.value,s=>(n(),i("button",{key:s,onClick:c=>x(s),class:V([s===o.value.current_page?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50","relative inline-flex items-center px-4 py-2 border text-sm font-medium"])},l(s),11,Be))),128)),e("button",{onClick:t[6]||(t[6]=s=>x(o.value.current_page+1)),disabled:o.value.current_page===o.value.last_page,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50"},t[25]||(t[25]=[e("span",{class:"sr-only"},"Suivant",-1),e("svg",{class:"h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)]),8,Ie)])])])])):j("",!0)]))])]))}};export{Ue as default};
