import{r as p,c as S,Y as Ee,j as Fe,Z as Ae,b as i,e,l as b,g as v,i as _,x as w,u as g,aK as $e,t as r,aM as Oe,F as Y,z as G,V as P,U as Te,a1 as K,a7 as re,f as Ie,M as Q,aq as oe,A as W,W as Z,a9 as H,an as ne,ac as Me,o as l,aP as Le,aQ as Pe,v as Ve,a4 as je,b8 as Re,at as Ne,ad as Be,P as ze}from"./vendor-SRkmFKSE.js";import{a as Ue,b as qe,g as Je}from"./app-BhGdYAKw.js";function Ye(){const{get:O,put:V,loading:j,error:B}=Ue(),T=p([]),D=p([]),f=p([{label:"Total commandes",value:"0",change:0,color:"bg-blue-500",icon:"ShoppingBagIcon"},{label:"Revenus total",value:"0 FCFA",change:0,color:"bg-green-500",icon:"CurrencyDollarIcon"},{label:"En attente",value:"0",change:0,color:"bg-yellow-500",icon:"ClockIcon"},{label:"Termin√©es",value:"0",change:0,color:"bg-green-500",icon:"CheckIcon"}]),I=p([]),R=p([]),N=async()=>{try{const o=await O("/stats/merchant/orders");if(o&&o.success){const n=o.data.stats;f.value=[{label:"Total commandes",value:n.total_orders.toString(),change:n.total_orders_change||0,color:"bg-blue-500",icon:"ShoppingBagIcon"},{label:"Revenus total",value:h(n.total_revenue),change:n.revenue_change||0,color:"bg-green-500",icon:"CurrencyDollarIcon"},{label:"En attente",value:n.pending_orders.toString(),change:n.pending_change||0,color:"bg-yellow-500",icon:"ClockIcon"},{label:"Termin√©es",value:n.paid_orders.toString(),change:n.paid_change||0,color:"bg-green-500",icon:"CheckIcon"}],I.value=o.data.recent_orders||[],R.value=o.data.monthly_revenue||[]}}catch(o){console.error("Erreur lors du chargement des statistiques de commandes:",o)}},z=async(o={})=>{try{const n={page:1,per_page:50,...o},A=await O("/merchant/orders",{params:n});A&&A.success&&(T.value=A.data||[])}catch(n){console.error("Erreur lors du chargement des commandes:",n),T.value=[]}},u=async()=>{try{const o=await O("/merchant/products",{params:{per_page:100}});o&&o.success&&(D.value=o.data.data||o.data||[])}catch(o){console.error("Erreur lors du chargement des produits:",o),D.value=[]}},M=async o=>{try{return await V(`/orders/${o.order_number}/confirm`)}catch(n){throw console.error("Erreur lors de la confirmation:",n),n}},k=async o=>{try{return await V(`/orders/${o.order_number}/cancel`)}catch(n){throw console.error("Erreur lors de l'annulation:",n),n}},d=async(o="csv")=>{try{return await O(`/merchant/orders/export?format=${o}`)}catch(n){throw console.error("Erreur lors de l'export:",n),n}},m=S(()=>[{label:"Total commandes",value:f.value[0]?.value||"0",color:"bg-blue-500",icon:"ShoppingBagIcon"},{label:"Revenus total",value:f.value[1]?.value||"0 FCFA",color:"bg-green-500",icon:"CurrencyDollarIcon"},{label:"En attente",value:f.value[2]?.value||"0",color:"bg-yellow-500",icon:"ClockIcon"},{label:"Termin√©es",value:f.value[3]?.value||"0",color:"bg-green-500",icon:"CheckIcon"}]),C=S(()=>[{name:"Pay√©es",value:parseInt(f.value[3]?.value||"0"),color:"#10B981"},{name:"En attente",value:parseInt(f.value[2]?.value||"0"),color:"#F59E0B"},{name:"Annul√©es",value:0,color:"#EF4444"}]),x=N,h=o=>{const n=parseFloat(o)||0;return n>=1e6?(n/1e6).toFixed(1)+"M FCFA":n>=1e3?(n/1e3).toFixed(0)+"k FCFA":n.toLocaleString("fr-FR")+" FCFA"};return{orders:T,products:D,orderStats:f,stats:m,recentOrders:I,monthlyRevenue:R,statusDistribution:C,loading:j,error:B,loadStats:N,loadOrders:z,loadProducts:u,loadOrderStats:x,confirmOrder:M,cancelOrder:k,exportOrders:d,formatCurrency:h,formatDate:o=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(o)),getStatusLabel:o=>({paid:"Pay√©e",pending:"En attente",cancelled:"Annul√©e",failed:"√âchou√©e",refunded:"Rembours√©e"})[o]||o,getStatusColor:o=>({paid:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",cancelled:"bg-red-100 text-red-800",failed:"bg-red-100 text-red-800",refunded:"bg-gray-100 text-gray-800"})[o]||"bg-gray-100 text-gray-800",formatMonthYear:(o,n)=>`${["Jan","F√©v","Mar","Avr","Mai","Jun","Jul","Ao√ª","Sep","Oct","Nov","D√©c"][o-1]} ${n}`}}const Ge={class:"space-y-6"},Ke={class:"flex items-center justify-between"},Qe={class:"flex space-x-3"},We=["disabled"],Ze={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},He={class:"flex items-center justify-between"},Xe={class:"text-sm font-medium text-gray-600"},et={class:"text-2xl font-bold text-gray-900 mt-1"},tt={class:"mt-4 pt-4 border-t border-gray-100"},st={class:"flex items-center text-xs"},at={class:"bg-white rounded-xl shadow-lg border border-gray-100 p-6"},rt={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},ot={class:"relative"},nt=["value"],lt={class:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden"},it={key:0,class:"flex justify-center py-12"},ct={key:1,class:"text-center py-12"},dt={key:2,class:"overflow-x-auto"},ut={class:"min-w-full"},mt={class:"bg-white divide-y divide-gray-200"},gt={class:"px-6 py-4 whitespace-nowrap"},pt={class:"text-sm font-medium text-gray-900"},xt={class:"text-sm text-gray-500"},ft={class:"px-6 py-4 whitespace-nowrap"},vt={class:"flex items-center"},bt={class:"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center"},yt={class:"ml-3"},ht={class:"text-sm font-medium text-gray-900"},_t={class:"text-sm text-gray-500"},wt={class:"px-6 py-4 whitespace-nowrap"},kt={class:"flex items-center"},Ct=["src","alt"],St={class:"ml-3"},Dt={class:"text-sm font-medium text-gray-900"},Et={class:"text-sm text-gray-500"},Ft={class:"px-6 py-4 whitespace-nowrap"},At={class:"flex items-center space-x-2"},$t={class:"text-sm text-gray-900"},Ot={class:"text-sm text-gray-500"},Tt={key:0,class:"ml-2"},It={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},Mt={key:1,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600"},Lt={class:"px-6 py-4 whitespace-nowrap"},Pt={class:"text-sm font-semibold text-gray-900"},Vt={class:"text-sm text-gray-500"},jt={class:"px-6 py-4 whitespace-nowrap"},Rt={class:"px-6 py-4 whitespace-nowrap"},Nt={class:"text-sm text-gray-900"},Bt={class:"text-sm text-gray-500"},zt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ut={class:"flex items-center space-x-2"},qt=["onClick"],Jt={key:0,class:"relative"},Yt=["onChange","value"],Gt=["onClick"],Kt=["onClick"],Qt=["onClick","disabled"],Wt={class:"bg-white px-6 py-3 border-t border-gray-200 flex items-center justify-between"},Zt={class:"text-sm text-gray-700"},Ht={class:"font-medium"},Xt={class:"font-medium"},es={class:"font-medium"},ts={class:"flex space-x-2"},ss=["disabled"],as=["disabled"],rs={key:0,class:"fixed inset-0 bg-black/40 overflow-y-auto h-full w-full z-50"},os={class:"relative top-20 mx-auto p-5 border w-11/12 max-w-md shadow-lg rounded-xl bg-white"},ns={class:"flex items-center justify-between mb-6"},ls={key:0,class:"space-y-4"},is={class:"text-center"},cs={class:"mt-3 text-center"},ds={class:"text-lg font-medium text-gray-900"},us={class:"mt-2 text-sm text-gray-500"},ms={class:"flex space-x-3 justify-end"},gs=["disabled"],ps={key:0},xs={key:1},fs={key:1,class:"fixed inset-0 bg-black/40 overflow-y-auto h-full w-full z-50"},vs={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-2/3 lg:w-1/2 shadow-lg rounded-xl bg-white"},bs={class:"flex items-center justify-between mb-6"},ys={key:0,class:"space-y-6"},hs={class:"grid grid-cols-2 gap-4"},_s={class:"text-sm text-gray-900"},ws={class:"text-sm text-gray-900"},ks={class:"text-sm text-gray-900 font-semibold"},Cs={class:"bg-gray-50 p-4 rounded-lg"},Ss={class:"grid grid-cols-2 gap-4"},Ds={class:"text-sm text-gray-900"},Es={class:"text-sm text-gray-900"},Fs={class:"bg-gray-50 p-4 rounded-lg"},As={class:"text-sm text-gray-700"},$s={class:"text-xs text-gray-500 mt-1"},Os={class:"mt-6 flex justify-end space-x-3"},Ms={__name:"Orders",setup(O){const{orders:V,products:j,orderStats:B,loading:T,loadStats:D,loadOrders:f,loadProducts:I,confirmOrder:R,cancelOrder:N,exportOrders:z}=Ye(),u=qe(),M=p(!1),k=p(!1),d=p(null),m=p(null),C=p(!1),x=p(1),h=p(10),E=p(!1),L=p(null),c=Ee({search:"",status:"",product:"",startDate:"",endDate:""}),F=S(()=>{let s=V.value;if(c.search){const t=c.search.toLowerCase();s=s.filter(a=>a.order_number.toLowerCase().includes(t)||a.customer_name.toLowerCase().includes(t)||a.product_name.toLowerCase().includes(t))}return c.status&&(s=s.filter(t=>t.status===c.status)),c.product&&(s=s.filter(t=>t.product_name.includes(j.value.find(a=>a.id==c.product)?.name||""))),c.startDate&&(s=s.filter(t=>new Date(t.created_at)>=new Date(c.startDate))),c.endDate&&(s=s.filter(t=>new Date(t.created_at)<=new Date(c.endDate))),s}),o=S(()=>Math.ceil(F.value.length/h.value)),n=S(()=>{const s=(x.value-1)*h.value,t=s+h.value;return F.value.slice(s,t)}),A=S(()=>(x.value-1)*h.value+1),le=S(()=>{const s=x.value*h.value;return Math.min(s,F.value.length)}),$=async()=>{x.value=1,await U()},U=async()=>{try{await f(c)}catch{u.error("Erreur lors du chargement des commandes")}},ie=()=>{x.value>1&&x.value--},ce=()=>{x.value<o.value&&x.value++},X=s=>({pending:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800",awaiting_payment:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",paid:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",shipping:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",fulfilled:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",cancelled:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800",confirmed:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",completed:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800"})[s]||"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-800",ee=s=>({pending:"En attente",awaiting_payment:"En attente de paiement",paid:"Pay√©",shipping:"En cours de livraison",fulfilled:"Livr√©",cancelled:"Annul√©",confirmed:"Confirm√©",completed:"Termin√©"})[s]||s,te=s=>new Date(s).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}),de=s=>new Date(s).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),ue=s=>{d.value=s,M.value=!0},q=()=>{M.value=!1,d.value=null},se=s=>{m.value={order:s,action:"confirm",title:"Confirmer la commande",message:`Voulez-vous confirmer la commande ${s.order_number} ?`,confirmText:"Confirmer",confirmClass:"bg-green-600 hover:bg-green-700"},k.value=!0},me=s=>{m.value={order:s,action:"cancel",title:"Annuler la commande",message:`Voulez-vous annuler la commande ${s.order_number} ? Cette action est irr√©versible.`,confirmText:"Annuler la commande",confirmClass:"bg-red-600 hover:bg-red-700"},k.value=!0},ge=(s,t)=>{t!==s.status&&(m.value={order:s,newStatus:t},k.value=!0)},pe=async()=>{if(!m.value)return;C.value=!0;const{order:s,action:t,newStatus:a}=m.value;try{if(t==="confirm")await R(s),u.success("Commande confirm√©e avec succ√®s !");else if(t==="cancel")await N(s),u.success("Commande annul√©e");else{const y={paid:"pay√©",fulfilled:"en cours de livraison"};await Je(s.order_number,a,`Statut chang√© vers ${y[a]} par le marchand`),u.success(`Commande marqu√©e comme ${y[a]}`)}J(),q(),await U()}catch{t==="confirm"?u.error("Erreur lors de la confirmation"):t==="cancel"?u.error("Erreur lors de l'annulation"):u.error("Erreur lors du changement de statut")}finally{C.value=!1}},J=()=>{k.value=!1,m.value=null,C.value=!1},xe=s=>({paid:"Pay√©",fulfilled:"En cours de livraison"})[s]||s,fe=s=>s.action==="confirm"?"Confirmer la commande":s.action==="cancel"?"Annuler la commande":"Changer le statut",ve=s=>s.title?s.message:`Commande ${s.order.order_number} - Nouveau statut : ${xe(s.newStatus)}`,be=s=>s.action==="confirm"?H:s.action==="cancel"?ne:s.newStatus==="fulfilled"?Me:H,ye=s=>s.action==="confirm"?"bg-green-100 text-green-600":s.action==="cancel"?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600",he=s=>s.confirmClass?s.confirmClass:s.action==="confirm"?"bg-green-600 hover:bg-green-700":s.action==="cancel"?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700",_e=s=>s.confirmText?s.confirmText:"Confirmer",we=s=>s.action==="confirm"?"Confirmation...":s.action==="cancel"?"Annulation...":"Changement...",ke=async()=>{E.value=!0;try{await Promise.all([D(),U(),I()]),u.success("Commandes actualis√©es")}catch{u.error("Erreur lors de l'actualisation")}finally{E.value=!1}},Ce=async()=>{try{await z("csv"),u.success("Export des commandes d√©marr√©")}catch{u.error("Erreur lors de l'export des commandes")}},Se=async s=>{L.value=s.order_number;try{const t=await fetch(`/api/merchant/orders/${s.order_number}/send-delivery-reminder`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),a=await t.json();t.ok&&a.success?u.success("Rappel envoy√© au client avec succ√®s"):u.error(a.error||"Erreur lors de l'envoi du rappel")}catch(t){console.error("Erreur envoi rappel:",t),u.error("Erreur lors de l'envoi du rappel")}finally{L.value=null}};Fe(async()=>{try{await Promise.all([D(),f(),I()])}catch(s){console.error("Erreur lors du chargement initial:",s),u.error("Erreur lors du chargement des donn√©es")}});let ae=null;Ae(()=>c.search,s=>{clearTimeout(ae),ae=setTimeout(()=>{$()},500)});const De=s=>({ShoppingBagIcon:Q,CurrencyDollarIcon:ze,ClockIcon:Be,CheckIcon:Ne})[s]||Q;return(s,t)=>(l(),i("div",Ge,[e("div",Ke,[t[7]||(t[7]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Mes Commandes"),e("p",{class:"mt-2 text-gray-600"},"Suivez et g√©rez toutes vos ventes de tickets de tombola")],-1)),e("div",Qe,[e("button",{onClick:ke,disabled:E.value,class:"inline-flex items-center px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors disabled:opacity-50"},[v(g($e),{class:w(["w-4 h-4 mr-2",{"animate-spin":E.value}])},null,8,["class"]),_(" "+r(E.value?"Actualisation...":"Actualiser"),1)],8,We),e("button",{onClick:Ce,class:"inline-flex items-center px-4 py-2 bg-[#0099cc] hover:bg-[#0088bb] text-white rounded-lg transition-colors"},[v(g(Oe),{class:"w-4 h-4 mr-2"}),t[6]||(t[6]=_(" Exporter ",-1))])])]),e("div",Ze,[(l(!0),i(Y,null,G(g(B),a=>(l(),i("div",{key:a.label,class:"bg-white p-6 rounded-xl shadow-lg border border-gray-100"},[e("div",He,[e("div",null,[e("p",Xe,r(a.label),1),e("p",et,r(a.value),1)]),e("div",{class:w(["p-3 rounded-xl",a.color])},[(l(),W(Z(De(a.icon)),{class:"w-6 h-6 text-white"}))],2)]),e("div",tt,[e("div",st,[e("span",{class:w(["inline-flex items-center px-2 py-1 rounded-full font-medium",a.change>=0?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"])},[(l(),W(Z(a.change>=0?g(Le):g(Pe)),{class:"w-3 h-3 mr-1"})),_(" "+r(Math.abs(a.change))+"% ",1)],2),t[8]||(t[8]=e("span",{class:"ml-2 text-gray-500"},"vs semaine derni√®re",-1))])])]))),128))]),e("div",at,[e("div",rt,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rechercher",-1)),e("div",ot,[v(g(Te),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),P(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>c.search=a),type:"text",placeholder:"ID, client, produit...",class:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black",onInput:$},null,544),[[K,c.search]])])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),P(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>c.status=a),onChange:$,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},t[10]||(t[10]=[Ie('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="awaiting_payment">En attente de paiement</option><option value="paid">Pay√©</option><option value="shipping">En cours de livraison</option><option value="fulfilled">Livr√©</option><option value="cancelled">Annul√©</option>',7)]),544),[[re,c.status]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Produit",-1)),P(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>c.product=a),onChange:$,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},[t[12]||(t[12]=e("option",{value:""},"Tous les produits",-1)),(l(!0),i(Y,null,G(g(j),a=>(l(),i("option",{key:a.id,value:a.id},r(a.name),9,nt))),128))],544),[[re,c.product]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date d√©but",-1)),P(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>c.startDate=a),type:"date",onChange:$,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},null,544),[[K,c.startDate]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date fin",-1)),P(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>c.endDate=a),type:"date",onChange:$,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},null,544),[[K,c.endDate]])])])]),e("div",lt,[t[25]||(t[25]=e("div",{class:"px-6 py-4 border-b border-gray-200 bg-gray-50"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Commandes r√©centes")],-1)),g(T)?(l(),i("div",it,t[16]||(t[16]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#0099cc]"},null,-1)]))):F.value.length===0?(l(),i("div",ct,[v(g(Q),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t[17]||(t[17]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Aucune commande",-1)),t[18]||(t[18]=e("p",{class:"text-gray-600"},"Aucune commande ne correspond √† vos crit√®res.",-1))])):(l(),i("div",dt,[e("table",ut,[t[20]||(t[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Commande "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Client "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Produit "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tickets "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Montant "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",mt,[(l(!0),i(Y,null,G(n.value,a=>(l(),i("tr",{key:a.id,class:"hover:bg-gray-50 transition-colors"},[e("td",gt,[e("div",null,[e("div",pt,"#"+r(a.order_number),1),e("div",xt,r(a.payment_method),1)])]),e("td",ft,[e("div",vt,[e("div",bt,[v(g(Ve),{class:"w-5 h-5 text-gray-600"})]),e("div",yt,[e("div",ht,r(a.customer_name),1),e("div",_t,r(a.customer_email),1)])])]),e("td",wt,[e("div",kt,[e("img",{class:"h-12 w-12 rounded-lg object-cover",src:a.product_image,alt:a.product_name},null,8,Ct),e("div",St,[e("div",Dt,r(a.product_name),1),e("div",Et,r((a.ticket_price||0).toLocaleString())+" FCFA/ticket",1)])])]),e("td",Ft,[e("div",At,[e("div",null,[e("div",$t,r(a.tickets_count||0)+" tickets",1),e("div",Ot,r(a.tickets_count||0)+" ticket"+r((a.tickets_count||0)>1?"s":"")+" achet√©"+r((a.tickets_count||0)>1?"s":""),1)]),a.type==="lottery"?(l(),i("div",Tt,[a.has_winning_ticket?(l(),i("span",It," üèÜ Gagnant ")):(l(),i("span",Mt," Non gagnant "))])):b("",!0)])]),e("td",Lt,[e("div",Pt,r((a.total_amount||0).toLocaleString())+" FCFA",1),e("div",Vt,r(a.currency),1)]),e("td",jt,[e("span",{class:w(X(a.status))},r(ee(a.status)),3)]),e("td",Rt,[e("div",Nt,r(te(a.created_at)),1),e("div",Bt,r(de(a.created_at)),1)]),e("td",zt,[e("div",Ut,[e("button",{onClick:y=>ue(a),class:"text-[#0099cc] hover:text-[#0088bb] transition-colors",title:"Voir d√©tails"},[v(g(je),{class:"w-4 h-4"})],8,qt),a.status==="paid"||a.status==="fulfilled"?(l(),i("div",Jt,[e("select",{onChange:y=>ge(a,y.target.value),class:"text-sm border border-gray-300 rounded px-2 py-1 bg-white",value:a.status},t[19]||(t[19]=[e("option",{value:"paid"},"Pay√©",-1),e("option",{value:"fulfilled"},"En cours de livraison",-1)]),40,Yt)])):b("",!0),a.status==="pending"?(l(),i("button",{key:1,onClick:y=>se(a),class:"text-blue-600 hover:text-blue-800 transition-colors",title:"Confirmer"},[v(g(H),{class:"w-4 h-4"})],8,Gt)):b("",!0),["pending","confirmed"].includes(a.status)?(l(),i("button",{key:2,onClick:y=>me(a),class:"text-red-600 hover:text-red-800 transition-colors",title:"Annuler"},[v(g(ne),{class:"w-4 h-4"})],8,Kt)):b("",!0),["paid","shipping"].includes(a.status)?(l(),i("button",{key:3,onClick:y=>Se(a),disabled:L.value===a.order_number,class:"text-orange-500 hover:text-orange-700 transition-colors disabled:opacity-50",title:"Envoyer un rappel de livraison au client"},[v(g(Re),{class:w(["w-4 h-4",{"animate-pulse":L.value===a.order_number}])},null,8,["class"])],8,Qt)):b("",!0)])])]))),128))])])])),e("div",Wt,[e("div",Zt,[t[21]||(t[21]=_(" Affichage de ",-1)),e("span",Ht,r(A.value),1),t[22]||(t[22]=_(" √† ",-1)),e("span",Xt,r(le.value),1),t[23]||(t[23]=_(" sur ",-1)),e("span",es,r(F.value.length),1),t[24]||(t[24]=_(" r√©sultats ",-1))]),e("div",ts,[e("button",{onClick:ie,disabled:x.value===1,class:"px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed"}," Pr√©c√©dent ",8,ss),e("button",{onClick:ce,disabled:x.value===o.value,class:"px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed"}," Suivant ",8,as)])])]),k.value?(l(),i("div",rs,[e("div",os,[e("div",ns,[t[26]||(t[26]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Confirmer le changement",-1)),e("button",{onClick:J,class:"text-gray-400 hover:text-gray-600"},[v(g(oe),{class:"w-6 h-6"})])]),m.value?(l(),i("div",ls,[e("div",is,[e("div",{class:w(["mx-auto flex items-center justify-center h-12 w-12 rounded-full",ye(m.value)])},[(l(),W(Z(be(m.value)),{class:"h-6 w-6"}))],2),e("div",cs,[e("p",ds,r(fe(m.value)),1),e("p",us,r(ve(m.value)),1)])]),e("div",ms,[e("button",{onClick:J,class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors"}," Annuler "),e("button",{onClick:pe,disabled:C.value,class:w([he(m.value),"px-4 py-2 text-white rounded-lg transition-colors disabled:opacity-50"])},[C.value?(l(),i("span",ps,r(we(m.value)),1)):(l(),i("span",xs,r(_e(m.value)),1))],10,gs)])])):b("",!0)])])):b("",!0),M.value?(l(),i("div",fs,[e("div",vs,[e("div",bs,[t[27]||(t[27]=e("h3",{class:"text-lg font-semibold text-gray-900"},"D√©tails de la commande",-1)),e("button",{onClick:q,class:"text-gray-400 hover:text-gray-600"},[v(g(oe),{class:"w-6 h-6"})])]),d.value?(l(),i("div",ys,[e("div",hs,[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"N¬∞ de commande",-1)),e("p",_s,r(d.value.order_number),1)]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date",-1)),e("p",ws,r(te(d.value.created_at)),1)]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700"},"Statut",-1)),e("span",{class:w(X(d.value.status))},r(ee(d.value.status)),3)]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700"},"Montant",-1)),e("p",ks,r((d.value.total_amount||0).toLocaleString())+" FCFA",1)])]),e("div",null,[t[34]||(t[34]=e("h4",{class:"text-md font-semibold text-gray-900 mb-3"},"Informations client",-1)),e("div",Cs,[e("div",Ss,[e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nom",-1)),e("p",Ds,r(d.value.customer_name),1)]),e("div",null,[t[33]||(t[33]=e("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),e("p",Es,r(d.value.customer_email),1)])])])]),e("div",null,[t[35]||(t[35]=e("h4",{class:"text-md font-semibold text-gray-900 mb-3"},"Tickets achet√©s",-1)),e("div",Fs,[e("p",As,[e("strong",null,r(d.value.tickets_count||0)+" ticket"+r((d.value.tickets_count||0)>1?"s":""),1),_(" achet√©"+r((d.value.tickets_count||0)>1?"s":"")+" pour "+r(d.value.product_name||"Produit inconnu"),1)]),e("p",$s," Prix unitaire : "+r((d.value.ticket_price||0).toLocaleString())+" FCFA/ticket ",1)])])])):b("",!0),e("div",Os,[e("button",{onClick:q,class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300"}," Fermer "),d.value?.status==="pending"?(l(),i("button",{key:0,onClick:t[5]||(t[5]=a=>se(d.value)),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Confirmer la commande ")):b("",!0)])])])):b("",!0)]))}};export{Ms as default};
