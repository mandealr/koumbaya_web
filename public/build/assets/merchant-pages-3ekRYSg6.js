import{u as me,f as Je,e as We,g as He}from"./utils-CcZu3SrZ.js";import{_ as $e,a as we}from"./common-components-C44zC4g7.js";import{r as L,o as ue,i as l,j as e,n as f,ad as ee,ae as ve,F as G,l as J,u,p as ye,t as s,e as he,g as pe,f as be,h as Ve,x as o,X as ke,y as N,z as se,A as ce,q as T,B as De,C as Me,D as ae,c as Q,ac as Xe,k as $,H as V,a7 as Le,I as R,J as le,m as ge,S as _e,T as ze,w as Ee,N as fe,P as Ue,aC as Ce,O as Ie,aD as Qe,aE as Ze,Q as Ke,aF as Ae,L as de,ao as Pe,a as je,M as Fe,ax as xe,aB as Se,aG as Ye,al as Oe,E as Re,G as et,W as Ne,aa as Te,a8 as tt,R as qe,ai as st,a4 as ot,K as rt,aH as lt,aI as at,aJ as nt,aK as it,aL as dt,aM as ut,a3 as ct,a1 as mt}from"./vue-core-BXnTE0w7.js";import{u as Be}from"./admin-pages-C_NGfial.js";import{P as Ge}from"./customer-pages-BE3vdabU.js";const pt={class:"space-y-6"},gt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"},xt={class:"flex items-center"},bt={class:"flex items-center"},ft={class:"flex items-center"},vt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},yt={class:"flex items-center justify-between"},_t={class:"text-sm font-medium text-gray-600"},ht={class:"text-3xl font-bold text-gray-900 mt-2"},wt={class:"mt-4 pt-4 border-t border-gray-100"},$t={class:"flex items-center text-sm"},kt={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Ct={class:"lg:col-span-2 bg-white p-6 rounded-xl shadow-lg border border-gray-100"},Pt={class:"flex items-center justify-between mb-6"},jt={class:"flex space-x-2"},Ft=["onClick"],Dt={class:"h-64 bg-gradient-to-br from-[#0099cc]/10 to-cyan-100 rounded-lg flex items-center justify-center"},Mt={class:"text-center"},Et={class:"text-gray-400 text-sm"},St={class:"mt-6 grid grid-cols-3 gap-4"},Tt={class:"text-center"},At={class:"text-2xl font-bold text-[#0099cc]"},Vt={class:"text-center"},Lt={class:"text-2xl font-bold text-blue-600"},zt={class:"text-center"},Ut={class:"text-2xl font-bold text-purple-600"},It={class:"space-y-6"},Ot={class:"bg-white p-6 rounded-xl shadow-lg border border-gray-100"},Rt={class:"flex items-center justify-between mb-4"},Nt={class:"space-y-3"},qt={class:"flex items-center space-x-3"},Bt={class:"w-10 h-10 bg-[#0099cc]/10 rounded-full flex items-center justify-center"},Gt={class:"font-medium text-gray-900"},Jt={class:"text-sm text-gray-500"},Wt={class:"text-right"},Ht={class:"font-semibold text-gray-900"},Xt={class:"bg-white p-6 rounded-xl shadow-lg border border-gray-100"},Qt={class:"flex items-center justify-between mb-4"},Zt={class:"space-y-3"},Kt={class:"flex-shrink-0 w-6 h-6 bg-[#0099cc] text-white text-xs font-bold rounded-full flex items-center justify-center"},Yt={class:"flex-1 min-w-0"},es={class:"font-medium text-gray-900 truncate"},ts={class:"flex items-center space-x-2 text-sm text-gray-500"},ss={__name:"Dashboard",setup(te){const{get:U}=me(),I=L("30j"),g=L([]),A=L({}),h=L([]),v=L([]),z=async()=>{try{const F=await U("/merchant/dashboard/stats");if(F&&F.data){const i=F.data;g.value=[{label:"Revenus du mois",value:a(i.monthly_revenue||0),change:i.revenue_change||0,icon:he,color:"bg-[#0099cc]"},{label:"Commandes",value:i.total_orders||0,change:i.orders_change||0,icon:pe,color:"bg-blue-500"},{label:"Produits actifs",value:i.active_products||0,change:i.products_change||0,icon:be,color:"bg-yellow-500"},{label:"Clients",value:i.total_customers||0,change:i.customers_change||0,icon:Ve,color:"bg-purple-500"}],A.value={totalSales:i.total_sales||0,totalOrders:i.total_orders||0,avgOrder:i.average_order||0}}}catch(F){console.error("Erreur lors du chargement des statistiques:",F)}},w=async()=>{try{const F=await U("/merchant/dashboard/recent-transactions");F&&F.data&&Array.isArray(F.data)?h.value=F.data.map(i=>({id:i.id,product_name:i.product?.title||i.product?.name||"Produit inconnu",customer_name:(i.user?.name||i.user?.first_name+" "+i.user?.last_name||"Client inconnu").trim(),amount:parseFloat(i.amount||0),status:i.status||"pending",created_at:i.created_at?new Date(i.created_at):new Date})):h.value=[]}catch(F){console.error("Erreur lors du chargement des commandes récentes:",F),h.value=[]}},D=async()=>{try{const F=await U("/merchant/dashboard/top-products");F&&F.data&&Array.isArray(F.data)?v.value=F.data.map(i=>({id:i.id,name:i.title||i.name||"Produit sans nom",sales:i.tickets_sold||i.sales_count||0,growth:i.growth_percentage||0,image:i.image_url||i.image||"/images/products/placeholder.jpg"})):v.value=[]}catch(F){console.error("Erreur lors du chargement des produits populaires:",F),v.value=[]}},a=F=>new Intl.NumberFormat("fr-FR").format(F),_=F=>({completed:"Terminé",pending:"En attente",processing:"En cours",cancelled:"Annulé"})[F]||F;return ue(async()=>{await Promise.all([z(),w(),D()])}),(F,i)=>{const k=ve("router-link");return o(),l("div",pt,[i[13]||(i[13]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Tableau de Bord Vendeur"),e("p",{class:"mt-2 text-gray-600"},"Suivez vos ventes, gérez vos produits et analysez vos performances")],-1)),e("div",gt,[f(k,{to:"/merchant/products/create",class:"bg-gradient-to-r from-[#0099cc] to-[#0088bb] text-white p-6 rounded-xl hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl"},{default:ee(()=>[e("div",xt,[f(u(ke),{class:"w-8 h-8 mr-4"}),i[0]||(i[0]=e("div",null,[e("h3",{class:"text-lg font-semibold"},"Nouveau Produit"),e("p",{class:"text-blue-100 text-sm"},"Publier un produit")],-1))])]),_:1}),f(k,{to:"/merchant/orders",class:"bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 rounded-xl hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl"},{default:ee(()=>[e("div",bt,[f(u(pe),{class:"w-8 h-8 mr-4"}),i[1]||(i[1]=e("div",null,[e("h3",{class:"text-lg font-semibold"},"Commandes"),e("p",{class:"text-blue-100 text-sm"},"Suivre les ventes")],-1))])]),_:1}),f(k,{to:"/merchant/analytics",class:"bg-gradient-to-r from-purple-500 to-purple-600 text-white p-6 rounded-xl hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl"},{default:ee(()=>[e("div",ft,[f(u(ye),{class:"w-8 h-8 mr-4"}),i[2]||(i[2]=e("div",null,[e("h3",{class:"text-lg font-semibold"},"Analytiques"),e("p",{class:"text-purple-100 text-sm"},"Voir les stats")],-1))])]),_:1})]),e("div",vt,[(o(!0),l(G,null,J(g.value,c=>(o(),l("div",{key:c.label,class:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-200"},[e("div",yt,[e("div",null,[e("p",_t,s(c.label),1),e("p",ht,s(c.value),1)]),e("div",{class:N(["p-4 rounded-xl",c.color])},[(o(),se(ce(c.icon),{class:"w-8 h-8 text-white"}))],2)]),e("div",wt,[e("div",$t,[e("span",{class:N(["font-medium flex items-center px-2 py-1 rounded-full text-xs",c.change>=0?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"])},[(o(),se(ce(c.change>=0?u(De):u(Me)),{class:"w-3 h-3 mr-1"})),T(" "+s(Math.abs(c.change))+"% ",1)],2),i[3]||(i[3]=e("span",{class:"ml-2 text-gray-500"},"vs mois dernier",-1))])])]))),128))]),e("div",kt,[e("div",Ct,[e("div",Pt,[i[4]||(i[4]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Évolution des Ventes",-1)),e("div",jt,[(o(),l(G,null,J(["7j","30j","90j"],c=>e("button",{key:c,onClick:j=>I.value=c,class:N(["px-3 py-1 rounded-lg text-sm font-medium transition-all",I.value===c?"bg-[#0099cc] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"])},s(c),11,Ft)),64))])]),e("div",Dt,[e("div",Mt,[f(u(ye),{class:"w-16 h-16 text-[#0099cc] mx-auto mb-4"}),i[5]||(i[5]=e("p",{class:"text-gray-600 font-medium"},"Graphique des ventes",-1)),e("p",Et,"Données des derniers "+s(I.value),1)])]),e("div",St,[e("div",Tt,[e("p",At,s(a(A.value.totalSales||0)),1),i[6]||(i[6]=e("p",{class:"text-sm text-gray-600"},"Ventes totales (FCFA)",-1))]),e("div",Vt,[e("p",Lt,s(A.value.totalOrders||0),1),i[7]||(i[7]=e("p",{class:"text-sm text-gray-600"},"Commandes",-1))]),e("div",zt,[e("p",Ut,s(a(A.value.avgOrder||0)),1),i[8]||(i[8]=e("p",{class:"text-sm text-gray-600"},"Panier moyen (FCFA)",-1))])])]),e("div",It,[e("div",Ot,[e("div",Rt,[i[10]||(i[10]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Commandes récentes",-1)),f(k,{to:"/merchant/orders",class:"text-[#0099cc] hover:text-[#0088bb] text-sm font-medium"},{default:ee(()=>i[9]||(i[9]=[T(" Voir tout → ",-1)])),_:1,__:[9]})]),e("div",Nt,[(o(!0),l(G,null,J(h.value,c=>(o(),l("div",{key:c.id,class:"flex items-center justify-between p-3 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors"},[e("div",qt,[e("div",Bt,[f(u(pe),{class:"w-5 h-5 text-[#0099cc]"})]),e("div",null,[e("p",Gt,s(c.product_name),1),e("p",Jt,s(c.customer_name),1)])]),e("div",Wt,[e("p",Ht,s(a(c.amount||0))+" FCFA",1),e("span",{class:N(["inline-block px-2 py-1 text-xs font-medium rounded-full",c.status==="completed"?"bg-blue-100 text-blue-800":c.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},s(_(c.status)),3)])]))),128))])]),e("div",Xt,[e("div",Qt,[i[12]||(i[12]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Produits populaires",-1)),f(k,{to:"/merchant/products",class:"text-[#0099cc] hover:text-[#0088bb] text-sm font-medium"},{default:ee(()=>i[11]||(i[11]=[T(" Gérer → ",-1)])),_:1,__:[11]})]),e("div",Zt,[(o(!0),l(G,null,J(v.value,(c,j)=>(o(),l("div",{key:c.id,class:"flex items-center space-x-3"},[e("div",Kt,s(j+1),1),f($e,{src:c.image_url||c.main_image||c.image,alt:c.name,"container-class":"w-12 h-12 rounded-lg","image-class":"w-12 h-12 rounded-lg object-cover","fallback-class":"w-12 h-12 rounded-lg","fallback-text":"Photo"},null,8,["src","alt"]),e("div",Yt,[e("p",es,s(c.name),1),e("div",ts,[e("span",null,s(c.sales)+" ventes",1),e("span",{class:N(["font-medium",c.growth>=0?"text-blue-600":"text-red-600"])},s(c.growth>=0?"+":"")+s(c.growth)+"% ",3)])])]))),128))])])])])])}}},X0=Object.freeze(Object.defineProperty({__proto__:null,default:ss},Symbol.toStringTag,{value:"Module"})),os={class:"space-y-6"},rs={class:"flex items-center justify-between"},ls={class:"flex space-x-3"},as={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},ns={class:"flex items-center justify-between"},is={class:"text-sm font-medium text-gray-600"},ds={class:"text-2xl font-bold text-gray-900 mt-1"},us={class:"mt-4 pt-4 border-t border-gray-100"},cs={class:"flex items-center text-xs"},ms={class:"bg-white rounded-xl shadow-lg border border-gray-100 p-6"},ps={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},gs={class:"relative"},xs=["value"],bs={key:0,class:"flex justify-center py-12"},fs={key:1,class:"text-center py-12"},vs={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 relative"},ys={class:"relative h-48 bg-gray-200"},_s={class:"absolute top-3 left-3"},hs={class:"absolute top-3 right-3 flex flex-col gap-2"},ws={class:"bg-black/50 text-white px-2 py-1 rounded-lg text-xs font-medium"},$s={class:"p-6 relative"},ks={class:"flex items-start justify-between mb-3"},Cs={class:"text-lg font-semibold text-gray-900 line-clamp-2"},Ps={class:"text-right ml-2"},js={class:"text-lg font-bold text-[#0099cc]"},Fs={class:"text-gray-600 text-sm mb-4 line-clamp-2"},Ds={class:"space-y-3 mb-4"},Ms={key:0,class:"text-center py-2"},Es={key:1},Ss={class:"flex justify-between text-sm"},Ts={class:"font-medium"},As={class:"w-full bg-gray-200 rounded-full h-2"},Vs={class:"flex justify-between text-xs text-gray-500"},Ls={key:0},zs={class:"grid grid-cols-2 gap-4 mb-4 text-center"},Us={class:"bg-green-50 p-3 rounded-lg"},Is={class:"text-green-700 font-semibold text-lg"},Os={class:"bg-blue-50 p-3 rounded-lg"},Rs={key:0,class:"text-blue-700 font-semibold text-lg"},Ns={key:1,class:"text-blue-700 font-semibold text-lg"},qs={key:2,class:"text-blue-600 text-xs"},Bs={key:3,class:"text-blue-600 text-xs"},Gs={class:"flex space-x-2"},Js=["onClick"],Ws=["onClick"],Hs=["onClick"],Xs={class:"relative z-10"},Qs=["onClick","data-product-id"],Zs={key:0,"data-dropdown-menu":"",class:"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-xl border border-gray-200 z-[9999]"},Ks=["onClick"],Ys=["onClick"],eo=["onClick"],to={key:3,class:"fixed inset-0 bg-black/20 overflow-y-auto h-full w-full z-50"},so={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-2/3 lg:w-1/2 shadow-lg rounded-xl bg-white max-h-[80vh] overflow-y-auto"},oo={class:"flex items-center justify-between mb-6"},ro={key:0,class:"space-y-6"},lo={key:0},ao={class:"grid grid-cols-3 gap-2"},no={class:"grid grid-cols-2 gap-4"},io={class:"text-sm text-gray-900"},uo={class:"text-sm text-gray-900"},co={class:"text-sm text-gray-900 font-semibold"},mo={class:"text-sm text-gray-900"},po={key:0},go={class:"text-sm text-gray-900 font-semibold"},xo={class:"text-sm text-gray-900 bg-gray-100 p-3 rounded-lg"},bo={key:1},fo={class:"grid grid-cols-3 gap-4 text-center"},vo={class:"bg-[#0099cc]/10 p-4 rounded-lg"},yo={class:"text-2xl font-bold text-[#0099cc]"},_o={class:"bg-blue-100 p-4 rounded-lg"},ho={class:"text-2xl font-bold text-blue-600"},wo={class:"bg-purple-100 p-4 rounded-lg"},$o={class:"text-2xl font-bold text-purple-600"},ko={key:2,class:"bg-green-50 border border-green-200 rounded-lg p-4"},Co={class:"mt-6 flex justify-end space-x-3"},Po={__name:"Products",setup(te){const U=Ee(),{get:I,post:g,put:A,delete:h,loading:v}=me(),z=L(!1),w=L(null),D=L(null),a=ae({search:"",category:"",status:"",saleMode:"",sortBy:"date_desc"}),_=L([]),F=L([]),i=L([]),k=Q(()=>i.value),c=async()=>{await X()},j=y=>({draft:"bg-gray-100 text-gray-800 px-3 py-1 text-xs font-medium rounded-full",active:"bg-blue-100 text-blue-800 px-3 py-1 text-xs font-medium rounded-full",completed:"bg-blue-100 text-blue-800 px-3 py-1 text-xs font-medium rounded-full",cancelled:"bg-red-100 text-red-800 px-3 py-1 text-xs font-medium rounded-full"})[y]||"bg-gray-100 text-gray-800 px-3 py-1 text-xs font-medium rounded-full",p=y=>({draft:"Brouillon",active:"Actif",completed:"Terminé",cancelled:"Annulé"})[y]||y,P=y=>({direct:"bg-green-100 text-green-800 px-2 py-1 text-xs font-medium rounded-lg",lottery:"bg-purple-100 text-purple-800 px-2 py-1 text-xs font-medium rounded-lg"})[y]||"bg-gray-100 text-gray-800 px-2 py-1 text-xs font-medium rounded-lg",E=y=>{const d={direct:"Vente directe",lottery:"Tombola"};return d[y]||d.direct},M=y=>({new:"Neuf",like_new:"Comme neuf",good:"Bon état",fair:"État correct"})[y]||y,W=y=>new Intl.NumberFormat("fr-FR").format(y||0),Z=y=>y?new Date(y).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}):"",H=y=>{w.value=y,z.value=!0,D.value=null},O=()=>{z.value=!1,w.value=null},m=y=>{U.push(`/merchant/products/${y.id}/edit`)},X=async()=>{try{const y=new URLSearchParams;y.append("my_products","1"),a.search&&y.append("search",a.search),a.category&&y.append("category_id",a.category),a.status&&y.append("status",a.status),a.saleMode&&y.append("sale_mode",a.saleMode),a.sortBy&&y.append("sort_by",a.sortBy);const d=await I(`/products?${y.toString()}`);d&&d.data&&d.data.products&&Array.isArray(d.data.products)?i.value=d.data.products.map(Y=>({...Y,lottery:Y.lottery||null,ticket_price:parseFloat(Y.ticket_price||0),price:parseFloat(Y.price||0),progress:Y.lottery?Math.round((Y.lottery.sold_tickets||0)/(Y.lottery.total_tickets||1)*100):0})):i.value=[]}catch(y){console.error("Error loading products:",y)}},B=async()=>{try{const y=await I("/categories");y&&y.categories&&(_.value=y.categories)}catch(y){console.error("Error loading categories:",y)}},oe=async()=>{try{const y=await I("/merchant/dashboard/stats");if(y&&y.data){const d=y.data;F.value=[{label:"Produits actifs",value:d.active_products||0,change:d.products_change||0,icon:be,color:"bg-[#0099cc]"},{label:"Total revenus",value:x(d.total_revenue||0),change:d.revenue_change||0,icon:he,color:"bg-blue-500"},{label:"Tickets vendus",value:d.tickets_sold||0,change:d.tickets_change||0,icon:pe,color:"bg-purple-500"},{label:"Taux succès",value:(d.success_rate||0)+"%",change:d.success_change||0,icon:ze,color:"bg-yellow-500"}]}}catch(y){console.error("Error loading product stats:",y)}},re=async y=>{const d=y.sale_mode==="lottery"?"tombola":"produit",Y=`Publier ${d==="tombola"?"la":"le"} ${d} "${y.title||y.name}" ?`;if(confirm(Y))try{let r;if(y.sale_mode==="lottery"){if(!y.ticket_price||y.ticket_price<100){window.$toast&&window.$toast.error("Le prix du ticket doit être défini et supérieur à 100 FCFA","❌ Erreur");return}r=await g(`/products/${y.id}/create-lottery`,{duration_days:7})}else r=await A(`/products/${y.id}`,{status:"active"});if(r&&(r.success||r.product)){if(await X(),window.$toast){const t=y.sale_mode==="lottery"?"Tombola publiée avec succès !":"Produit publié avec succès !";window.$toast.success(t,"✅ Publication")}}else throw new Error(r?.message||"Erreur lors de la publication")}catch(r){console.error("Error publishing product:",r);let t="Erreur lors de la publication";r.response?.data?.error?t=r.response.data.error:r.response?.data?.message?t=r.response.data.message:r.message&&(t=r.message),window.$toast&&window.$toast.error(t,"❌ Erreur")}},C=async y=>{try{const d=await g("/products",{title:(y.title||y.name)+" (Copie)",description:y.description,price:y.price||y.value,category_id:y.category_id,image:y.image});if(d&&d.success)await X(),window.$toast&&window.$toast.success("Produit dupliqué avec succès !","✅ Duplication");else throw new Error(d?.message||"Erreur lors de la duplication")}catch(d){console.error("Error duplicating product:",d),window.$toast&&window.$toast.error("Erreur lors de la duplication","❌ Erreur")}D.value=null},n=y=>{U.push(`/merchant/analytics?product=${y.id}`),D.value=null},q=async y=>{if(confirm(`Supprimer définitivement "${y.title||y.name}" ? Cette action est irréversible.`)){try{const d=await h(`/products/${y.id}`);if(d&&d.success)await X(),window.$toast&&window.$toast.success("Produit supprimé","✅ Suppression");else throw new Error(d?.message||"Erreur lors de la suppression")}catch(d){console.error("Error deleting product:",d),window.$toast&&window.$toast.error("Erreur lors de la suppression","❌ Erreur")}D.value=null}},x=y=>new Intl.NumberFormat("fr-FR").format(y),K=y=>{D.value=D.value===y?null:y},ie=y=>{const d=y.target.closest("[data-dropdown-menu]"),Y=y.target.closest("[data-product-id]");!d&&!Y&&(D.value=null)};return ue(async()=>{document.addEventListener("click",ie),await Promise.all([X(),B(),oe()])}),Xe(()=>{document.removeEventListener("click",ie)}),(y,d)=>{const Y=ve("router-link");return o(),l("div",os,[e("div",rs,[d[6]||(d[6]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Mes Produits"),e("p",{class:"mt-2 text-gray-600"},"Gérez vos produits et suivez vos tombolas en cours")],-1)),e("div",ls,[f(Y,{to:"/merchant/products/create",class:"inline-flex items-center px-6 py-3 bg-[#0099cc] hover:bg-[#0088bb] text-white rounded-xl font-semibold transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"},{default:ee(()=>[f(u(ke),{class:"w-5 h-5 mr-2"}),d[5]||(d[5]=T(" Nouveau Produit ",-1))]),_:1,__:[5]})])]),e("div",as,[(o(!0),l(G,null,J(F.value,r=>(o(),l("div",{key:r.label,class:"bg-white p-6 rounded-xl shadow-lg border border-gray-100"},[e("div",ns,[e("div",null,[e("p",is,s(r.label),1),e("p",ds,s(r.value),1)]),e("div",{class:N(["p-3 rounded-xl",r.color])},[(o(),se(ce(r.icon),{class:"w-6 h-6 text-white"}))],2)]),e("div",us,[e("div",cs,[e("span",{class:N(["inline-flex items-center px-2 py-1 rounded-full font-medium",r.change>=0?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"])},[(o(),se(ce(r.change>=0?u(De):u(Me)),{class:"w-3 h-3 mr-1"})),T(" "+s(Math.abs(r.change))+"% ",1)],2),d[7]||(d[7]=e("span",{class:"ml-2 text-gray-500"},"ce mois",-1))])])]))),128))]),e("div",ms,[e("div",ps,[e("div",null,[d[8]||(d[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rechercher",-1)),e("div",gs,[f(u(Le),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),V(e("input",{"onUpdate:modelValue":d[0]||(d[0]=r=>a.search=r),type:"text",placeholder:"Nom du produit...",class:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black",onInput:c},null,544),[[R,a.search]])])]),e("div",null,[d[10]||(d[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Catégorie",-1)),V(e("select",{"onUpdate:modelValue":d[1]||(d[1]=r=>a.category=r),onChange:c,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},[d[9]||(d[9]=e("option",{value:""},"Toutes les catégories",-1)),(o(!0),l(G,null,J(_.value,r=>(o(),l("option",{key:r.id,value:r.id},s(r.name),9,xs))),128))],544),[[le,a.category]])]),e("div",null,[d[12]||(d[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),V(e("select",{"onUpdate:modelValue":d[2]||(d[2]=r=>a.status=r),onChange:c,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},d[11]||(d[11]=[ge('<option value="">Tous les statuts</option><option value="draft">Brouillon</option><option value="active">Actif</option><option value="completed">Terminé</option><option value="cancelled">Annulé</option>',5)]),544),[[le,a.status]])]),e("div",null,[d[14]||(d[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mode de vente",-1)),V(e("select",{"onUpdate:modelValue":d[3]||(d[3]=r=>a.saleMode=r),onChange:c,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},d[13]||(d[13]=[e("option",{value:""},"Tous les modes",-1),e("option",{value:"direct"},"Vente directe",-1),e("option",{value:"lottery"},"Tombola",-1)]),544),[[le,a.saleMode]])]),e("div",null,[d[16]||(d[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Trier par",-1)),V(e("select",{"onUpdate:modelValue":d[4]||(d[4]=r=>a.sortBy=r),onChange:c,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},d[15]||(d[15]=[ge('<option value="date_desc">Date de création (récent)</option><option value="date_asc">Date de création (ancien)</option><option value="price_desc">Prix (élevé à bas)</option><option value="price_asc">Prix (bas à élevé)</option><option value="name_asc">Nom (A-Z)</option><option value="name_desc">Nom (Z-A)</option><option value="popularity">Popularité</option>',7)]),544),[[le,a.sortBy]])])])]),u(v)?(o(),l("div",bs,d[17]||(d[17]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#0099cc]"},null,-1)]))):k.value.length===0?(o(),l("div",fs,[f(u(be),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d[19]||(d[19]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Aucun produit",-1)),d[20]||(d[20]=e("p",{class:"text-gray-600 mb-6"},"Vous n'avez pas encore de produits. Créez votre premier produit !",-1)),f(Y,{to:"/merchant/products/create",class:"inline-flex items-center px-6 py-3 bg-[#0099cc] hover:bg-[#0088bb] text-white rounded-xl font-semibold transition-colors"},{default:ee(()=>[f(u(ke),{class:"w-5 h-5 mr-2"}),d[18]||(d[18]=T(" Créer mon premier produit ",-1))]),_:1,__:[18]})])):(o(),l("div",vs,[(o(!0),l(G,null,J(k.value,r=>(o(),l("div",{key:r.id,class:"bg-white rounded-xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-200 hover:scale-[1.02]"},[e("div",ys,[f($e,{src:r.main_image||r.image_url||r.images&&r.images[0]||null,alt:r.name,"container-class":"w-full h-full","image-class":"w-full h-full object-cover"},null,8,["src","alt"]),e("div",_s,[e("span",{class:N(j(r.status))},s(p(r.status)),3)]),e("div",hs,[e("div",ws,s(r.category?.name||"Sans catégorie"),1),e("div",{class:N(P(r.sale_mode))},s(E(r.sale_mode)),3)])]),e("div",$s,[e("div",ks,[e("h3",Cs,s(r.name),1),e("div",Ps,[e("p",js,s(W(r.price))+" FCFA",1),d[21]||(d[21]=e("p",{class:"text-xs text-gray-500"},"Valeur",-1))])]),e("p",Fs,s(r.description),1),e("div",Ds,[r.sale_mode==="direct"?(o(),l("div",Ms,d[22]||(d[22]=[e("div",{class:"inline-flex items-center px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium"},[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})]),T(" Vente directe ")],-1)]))):r.sale_mode==="lottery"?(o(),l("div",Es,[e("div",Ss,[d[23]||(d[23]=e("span",{class:"text-gray-600"},"Progression",-1)),e("span",Ts,s(r.sold_tickets||0)+"/"+s(r.total_tickets||0),1)]),e("div",As,[e("div",{class:"bg-gradient-to-r from-purple-500 to-purple-600 h-2 rounded-full transition-all duration-500",style:fe({width:r.progress+"%"})},null,4)]),e("div",Vs,[e("span",null,s(r.progress)+"% vendu",1),r.end_date?(o(),l("span",Ls,"Fin: "+s(Z(r.end_date)),1)):$("",!0)])])):$("",!0)]),e("div",zs,[e("div",Us,[e("p",Is,s(W(r.revenue||0)),1),d[24]||(d[24]=e("p",{class:"text-green-600 text-xs"},"Revenus",-1))]),e("div",Os,[r.sale_mode==="lottery"?(o(),l("p",Rs,s(W(r.ticket_price||0)),1)):(o(),l("p",Ns,s(r.stock_quantity||0),1)),r.sale_mode==="lottery"?(o(),l("p",qs,"Prix/ticket")):(o(),l("p",Bs,"Stock"))])]),e("div",Gs,[e("button",{onClick:t=>H(r),class:"flex-1 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors"},[f(u(Ue),{class:"w-4 h-4 inline mr-1"}),d[25]||(d[25]=T(" Voir ",-1))],8,Js),r.status==="draft"?(o(),l("button",{key:0,onClick:t=>re(r),class:"flex-1 px-4 py-2 bg-[#0099cc] hover:bg-[#0088bb] text-white rounded-lg text-sm font-medium transition-colors"},[f(u(Ce),{class:"w-4 h-4 inline mr-1"}),d[26]||(d[26]=T(" Publier ",-1))],8,Ws)):$("",!0),r.status==="active"?(o(),l("button",{key:1,onClick:t=>m(r),class:"flex-1 px-4 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg text-sm font-medium transition-colors"},[f(u(Ie),{class:"w-4 h-4 inline mr-1"}),d[27]||(d[27]=T(" Modifier ",-1))],8,Hs)):$("",!0),e("div",Xs,[e("button",{onClick:t=>K(r.id),"data-product-id":r.id,class:"px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors"},[f(u(Qe),{class:"w-4 h-4"})],8,Qs),D.value===r.id?(o(),l("div",Zs,[e("button",{onClick:t=>C(r),class:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100 rounded-t-lg"},[f(u(Ze),{class:"w-4 h-4 inline mr-2"}),d[28]||(d[28]=T(" Dupliquer ",-1))],8,Ks),e("button",{onClick:t=>n(r),class:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-100"},[f(u(ye),{class:"w-4 h-4 inline mr-2"}),d[29]||(d[29]=T(" Analytiques ",-1))],8,Ys),["draft","active"].includes(r.status)?(o(),l("button",{key:0,onClick:t=>q(r),class:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 rounded-b-lg"},[f(u(Ke),{class:"w-4 h-4 inline mr-2"}),d[30]||(d[30]=T(" Supprimer ",-1))],8,eo)):$("",!0)])):$("",!0)])])])]))),128))])),z.value?(o(),l("div",to,[e("div",so,[e("div",oo,[d[31]||(d[31]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Détails du produit",-1)),e("button",{onClick:O,class:"text-gray-400 hover:text-gray-600"},[f(u(_e),{class:"w-6 h-6"})])]),w.value?(o(),l("div",ro,[w.value.images&&w.value.images.length>0?(o(),l("div",lo,[d[32]||(d[32]=e("h4",{class:"text-md font-semibold text-gray-900 mb-3"},"Images",-1)),e("div",ao,[(o(!0),l(G,null,J(w.value.images.slice(0,6),(r,t)=>(o(),se($e,{key:t,src:r,alt:`Produit ${t+1}`,"container-class":"w-full h-20 rounded-lg","image-class":"w-full h-full object-cover rounded-lg","fallback-class":"w-full h-full rounded-lg"},null,8,["src","alt"]))),128))])])):$("",!0),e("div",no,[e("div",null,[d[33]||(d[33]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nom",-1)),e("p",io,s(w.value.name),1)]),e("div",null,[d[34]||(d[34]=e("label",{class:"block text-sm font-medium text-gray-700"},"Catégorie",-1)),e("p",uo,s(w.value.category?.name||w.value.category||"Sans catégorie"),1)]),e("div",null,[d[35]||(d[35]=e("label",{class:"block text-sm font-medium text-gray-700"},"Valeur",-1)),e("p",co,s(W(w.value.price||w.value.value))+" FCFA",1)]),e("div",null,[d[36]||(d[36]=e("label",{class:"block text-sm font-medium text-gray-700"},"Condition",-1)),e("p",mo,s(M(w.value.condition)),1)]),e("div",null,[d[37]||(d[37]=e("label",{class:"block text-sm font-medium text-gray-700"},"Mode de vente",-1)),e("span",{class:N(P(w.value.sale_mode))},s(E(w.value.sale_mode)),3)]),w.value.sale_mode==="lottery"&&w.value.ticket_price?(o(),l("div",po,[d[38]||(d[38]=e("label",{class:"block text-sm font-medium text-gray-700"},"Prix du ticket",-1)),e("p",go,s(W(w.value.ticket_price))+" FCFA",1)])):$("",!0)]),e("div",null,[d[39]||(d[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),e("p",xo,s(w.value.description),1)]),w.value.sale_mode==="lottery"?(o(),l("div",bo,[d[43]||(d[43]=e("h4",{class:"text-md font-semibold text-gray-900 mb-3"},"Statistiques de la tombola",-1)),e("div",fo,[e("div",vo,[e("p",yo,s(w.value.sold_tickets),1),d[40]||(d[40]=e("p",{class:"text-sm text-gray-600"},"Tickets vendus",-1))]),e("div",_o,[e("p",ho,s(W(w.value.revenue)),1),d[41]||(d[41]=e("p",{class:"text-sm text-gray-600"},"Revenus (FCFA)",-1))]),e("div",wo,[e("p",$o,s(w.value.progress)+"%",1),d[42]||(d[42]=e("p",{class:"text-sm text-gray-600"},"Progression",-1))])])])):w.value.sale_mode==="direct"?(o(),l("div",ko,d[44]||(d[44]=[ge('<div class="flex items-center space-x-3"><div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center"><svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div><div><h4 class="text-md font-semibold text-green-800">Vente directe</h4><p class="text-sm text-green-600">Les clients peuvent acheter ce produit directement sans participer à une tombola.</p></div></div>',1)]))):$("",!0)])):$("",!0),e("div",Co,[e("button",{onClick:O,class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300"}," Fermer "),w.value?(o(),se(Y,{key:0,to:`/merchant/products/${w.value.id}/edit`,class:"px-4 py-2 bg-[#0099cc] text-white rounded-lg hover:bg-[#0088bb]"},{default:ee(()=>d[45]||(d[45]=[T(" Modifier ",-1)])),_:1,__:[45]},8,["to"])):$("",!0)])])])):$("",!0)])}}},Q0=Object.freeze(Object.defineProperty({__proto__:null,default:Po},Symbol.toStringTag,{value:"Module"})),jo={class:"max-w-4xl mx-auto space-y-6"},Fo={class:"flex items-center justify-between"},Do={class:"bg-white rounded-xl shadow-lg border border-gray-100 p-6"},Mo={class:"flex items-center justify-between mb-8"},Eo={class:"flex items-center"},So={key:1},To={class:"ml-3"},Ao={class:"text-xs text-gray-700"},Vo={key:0,class:"bg-white rounded-xl shadow-lg border border-gray-100 p-6"},Lo={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},zo={class:"lg:col-span-2"},Uo={key:0,class:"mt-1 text-sm text-red-600"},Io={key:1,class:"mt-1 text-sm text-orange-600"},Oo={class:"lg:col-span-2"},Ro={key:0,class:"mt-1 text-sm text-red-600"},No={key:1,class:"mt-1 text-sm text-orange-600"},qo=["disabled"],Bo={key:0,disabled:""},Go=["value"],Jo={key:0,class:"mt-1 text-sm text-red-600"},Wo={class:"lg:col-span-2"},Ho={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Xo={class:"flex items-center space-x-3"},Qo={key:0,class:"w-2.5 h-2.5 bg-[#0099cc] rounded-full"},Zo={class:"flex items-center space-x-3"},Ko={key:0,class:"w-2.5 h-2.5 bg-purple-500 rounded-full"},Yo={key:0,class:"mt-1 text-sm text-red-600"},er={key:1,class:"mt-1 text-sm text-orange-600"},tr={key:1,class:"bg-white rounded-xl shadow-lg border border-gray-100 p-6"},sr={class:"space-y-6"},or={class:"text-center"},rr={key:0,class:"grid grid-cols-2 md:grid-cols-4 gap-4"},lr=["src","alt"],ar=["onClick"],nr={key:0,class:"absolute bottom-2 left-2 bg-[#0099cc] text-white text-xs px-2 py-1 rounded-md"},ir={class:"bg-blue-50 border border-blue-200 rounded-xl p-4"},dr={class:"flex items-start space-x-3"},ur={key:2,class:"bg-white rounded-xl shadow-lg border border-gray-100 p-6"},cr={key:0},mr={class:"bg-blue-50 border border-blue-200 rounded-xl p-6 text-center"},pr={class:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"},gr={class:"bg-white rounded-lg p-3"},xr={class:"font-semibold text-[#0099cc]"},br={class:"bg-white rounded-lg p-3"},fr={class:"font-semibold text-gray-800"},vr={key:1},yr={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},_r={key:0,class:"mt-1 text-sm text-red-600"},hr={key:1,class:"mt-1 text-sm text-orange-600"},wr={key:2,class:"text-sm text-gray-700 mt-1"},$r={key:0,class:"mt-1 text-sm text-red-600"},kr={key:1,class:"mt-1 text-sm text-orange-600"},Cr={key:2,class:"text-sm text-gray-700 mt-1"},Pr=["min"],jr={key:0,class:"mt-1 text-sm text-red-600"},Fr={key:1,class:"mt-1 text-sm text-orange-600"},Dr=["max"],Mr={key:0,class:"mt-1 text-sm text-red-600"},Er={key:1,class:"mt-1 text-sm text-orange-600"},Sr={key:2,class:"text-sm text-gray-700 mt-1"},Tr={class:"lg:col-span-2"},Ar={class:"bg-gradient-to-br from-[#0099cc]/10 to-cyan-100 rounded-xl p-6"},Vr={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Lr={class:"text-center"},zr={class:"text-2xl font-bold text-[#0099cc]"},Ur={class:"text-center"},Ir={class:"text-2xl font-bold text-blue-600"},Or={class:"text-center"},Rr={class:"text-2xl font-bold text-purple-600"},Nr={key:3,class:"bg-white rounded-xl shadow-lg border border-gray-100 p-6"},qr={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},Br={class:"space-y-3"},Gr={class:"flex justify-between"},Jr={class:"font-medium"},Wr={class:"flex justify-between"},Hr={class:"font-medium"},Xr={class:"flex justify-between"},Qr={class:"font-medium"},Zr={class:"flex justify-between"},Kr={class:"font-medium"},Yr={class:"flex justify-between"},el={class:"font-medium"},tl={class:"font-semibold text-gray-900 mb-4"},sl={key:0,class:"space-y-3"},ol={class:"flex justify-between"},rl={class:"font-medium"},ll={class:"flex justify-between"},al={class:"font-medium"},nl={class:"flex justify-between border-t pt-3"},il={class:"font-bold text-[#0099cc]"},dl={key:1,class:"space-y-3"},ul={class:"flex justify-between"},cl={class:"font-medium"},ml={class:"flex justify-between"},pl={class:"font-medium"},gl={class:"flex justify-between"},xl={class:"font-medium"},bl={class:"flex justify-between"},fl={class:"font-medium"},vl={class:"flex justify-between border-t pt-3"},yl={class:"font-bold text-[#0099cc]"},_l={class:"mt-8 p-4 bg-gray-100 rounded-xl"},hl={class:"flex items-start space-x-3"},wl={class:"text-sm text-gray-900"},$l={class:"flex justify-between items-center bg-white rounded-xl shadow-lg border border-gray-100 p-6"},kl={key:1},Cl={class:"text-sm text-gray-700"},Pl=["disabled"],jl=["disabled"],Fl={key:0,class:"flex items-center"},Dl={key:1,class:"flex items-center"},Ml={__name:"CreateProduct",setup(te){const U=Ee(),{get:I,post:g,loading:A}=me(),h=L(1),v=L(!1),z=L(null),w=[{id:1,title:"Informations",description:"Détails du produit",icon:je},{id:2,title:"Photos",description:"Images du produit",icon:Pe},{id:3,title:"Tombola",description:"Configuration",icon:Se},{id:4,title:"Publication",description:"Vérification",icon:Ce}],D=L([]),a=ae({name:"",description:"",category_id:"",condition:"",sale_mode:"direct",price:"",location:"",images:[],ticket_price:"",total_tickets:"",min_tickets:"",end_date:"",terms_accepted:!1,duration_days:7}),_=ae({name:"",description:"",category_id:"",condition:"",value:"",location:"",images:"",ticket_price:"",total_tickets:"",min_tickets:"",end_date:""}),F=Q(()=>{const r=new Date;return r.setDate(r.getDate()+1),r.toISOString().slice(0,16)}),i=Q(()=>{const r=(a.ticket_price||0)*(a.total_tickets||0),t=r*.05,b=r-t,S=a.price?Math.round((b-a.price)/a.price*100):0;return{totalRevenue:r,platformFee:t,netRevenue:b,profitMargin:S}}),k=Q(()=>{switch(h.value){case 1:return c();case 2:return!0;case 3:return j();case 4:return a.terms_accepted;default:return!1}}),c=()=>{const r=a.name&&a.description&&a.category_id&&a.condition&&a.sale_mode&&a.price&&a.location&&parseFloat(a.price)>=1e3;return r&&(_.name="",_.description="",_.category_id="",_.condition="",_.price="",_.location=""),r},j=()=>{if(a.sale_mode==="direct")return!0;if(a.sale_mode==="lottery"){const r=a.ticket_price&&a.total_tickets&&a.min_tickets&&a.end_date&&parseFloat(a.ticket_price)>=100&&parseInt(a.total_tickets)>=10&&parseInt(a.min_tickets)>=10&&parseInt(a.min_tickets)<=parseInt(a.total_tickets)&&new Date(a.end_date)>new Date;return r&&(_.ticket_price="",_.total_tickets="",_.min_tickets="",_.end_date=""),r}return!1},p=()=>{k.value&&h.value<w.length&&h.value++},P=()=>{h.value>1&&h.value--},E=()=>{z.value?.click()},M=r=>{const t=Array.from(r.target.files||[]);Z(t)},W=r=>{const t=Array.from(r.dataTransfer.files||[]);Z(t)},Z=r=>{const t=r.filter(b=>b.type.startsWith("image/")?b.size>5242880?(x(`Le fichier ${b.name} est trop volumineux (max 5MB)`),!1):!0:(x(`Le fichier ${b.name} n'est pas une image valide`),!1));if(a.images.length+t.length>10){x("Maximum 10 images autorisées");return}t.forEach(b=>{const S=new FileReader;S.onload=ne=>{a.images.push({file:b,preview:ne.target?.result,name:b.name,size:b.size,type:b.type})},S.onerror=()=>{x(`Erreur lors de la lecture du fichier ${b.name}`)},S.readAsDataURL(b)}),z.value&&(z.value.value="")},H=r=>{a.images.splice(r,1)},O=()=>{},m=r=>new Intl.NumberFormat("fr-FR").format(r||0),X=r=>r?new Date(r).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",B=r=>({new:"Neuf",used:"Occasion",refurbished:"Reconditionné"})[r]||r,oe=async()=>{v.value=!0,re();try{const r=Math.ceil(a.price/a.ticket_price),t={name:a.name,description:a.description,category_id:parseInt(a.category_id),price:parseFloat(a.price),sale_mode:a.sale_mode,images:a.images.map(S=>S.preview)};a.sale_mode==="lottery"&&(t.ticket_price=parseFloat(a.ticket_price),t.min_participants=parseInt(a.min_tickets));const b=await g("/products",t);if(b.product){if(a.sale_mode==="lottery"){const S={duration_days:n()};try{await g(`/products/${b.product.id}/create-lottery`,S),q("Produit et tombola créés avec succès !")}catch(ne){console.error("Error creating lottery:",ne),K("Produit créé mais erreur lors de la création de la tombola")}}else q("Produit créé avec succès !");setTimeout(()=>{U.push("/merchant/products")},1500)}}catch(r){console.error("Error creating product:",r),C(r)}finally{v.value=!1}},re=()=>{Object.keys(_).forEach(r=>{_[r]=""})},C=r=>{if(r.response?.data?.errors){const t=r.response.data.errors;Object.keys(t).forEach(b=>{_[b]!==void 0&&(_[b]=t[b][0])}),x("Veuillez corriger les erreurs dans le formulaire")}else r.response?.data?.message?x(r.response.data.message):x("Une erreur est survenue. Veuillez réessayer.")},n=()=>{if(!a.end_date)return 7;const r=new Date(a.end_date),b=Math.abs(r-new Date),S=Math.ceil(b/(1e3*60*60*24));return Math.min(Math.max(S,1),30)},q=r=>{window.$toast&&window.$toast.success(r,"✅ Succès")},x=r=>{window.$toast&&window.$toast.error(r,"❌ Erreur")},K=r=>{window.$toast&&window.$toast.warning(r,"⚠️ Attention")},ie=()=>{if(a.end_date){const r=new Date(a.end_date),t=new Date,b=new Date;b.setDate(b.getDate()+30),r<=t?_.end_date="La date de fin doit être dans le futur":r>b?_.end_date="La date de fin ne peut pas dépasser 30 jours":_.end_date=""}},y=()=>{a.ticket_price&&(parseFloat(a.ticket_price)<100?_.ticket_price="Le prix minimum est de 100 FCFA":_.ticket_price="")},d=()=>{if(a.total_tickets){const r=parseInt(a.total_tickets);r<10?_.total_tickets="Minimum 10 tickets requis":r>1e4?_.total_tickets="Maximum 10,000 tickets autorisés":_.total_tickets=""}},Y=async()=>{try{const r=await I("/categories");r.categories&&(D.value=r.categories)}catch(r){console.error("Error loading categories:",r),x("Erreur lors du chargement des catégories")}};return ue(()=>{Y(),console.log("CreateProduct page loaded")}),(r,t)=>{const b=ve("router-link");return o(),l("div",jo,[e("div",Fo,[t[15]||(t[15]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Publier un Nouveau Produit"),e("p",{class:"mt-2 text-gray-600"},"Créez votre tombola et mettez votre produit en vente")],-1)),f(b,{to:"/merchant/products",class:"inline-flex items-center px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors"},{default:ee(()=>[f(u(xe),{class:"w-4 h-4 mr-2"}),t[14]||(t[14]=T(" Retour aux produits ",-1))]),_:1,__:[14]})]),e("div",Do,[e("div",Mo,[(o(),l(G,null,J(w,(S,ne)=>e("div",{key:S.id,class:N(["flex items-center",{"flex-1":ne<w.length-1}])},[e("div",Eo,[e("div",{class:N(["flex items-center justify-center w-10 h-10 rounded-full border-2 font-medium text-sm transition-all",h.value>=S.id?"border-[#0099cc] bg-[#0099cc] text-white":"border-gray-300 bg-white text-gray-600"])},[h.value>=S.id?(o(),se(ce(S.icon),{key:0,class:"w-5 h-5"})):(o(),l("span",So,s(S.id),1))],2),e("div",To,[e("p",{class:N(["text-sm font-medium",h.value>=S.id?"text-[#0099cc]":"text-gray-600"])},s(S.title),3),e("p",Ao,s(S.description),1)])]),ne<w.length-1?(o(),l("div",{key:0,class:N(["flex-1 h-0.5 mx-4 transition-all",h.value>S.id?"bg-[#0099cc]":"bg-gray-200"])},null,2)):$("",!0)],2)),64))])]),e("form",{onSubmit:de(oe,["prevent"]),class:"space-y-6"},[h.value===1?(o(),l("div",Vo,[t[27]||(t[27]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Informations de base",-1)),e("div",Lo,[e("div",zo,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nom du produit * ",-1)),V(e("input",{"onUpdate:modelValue":t[0]||(t[0]=S=>a.name=S),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",style:{color:"#5f5f5f"},placeholder:"Ex: iPhone 15 Pro Max 256GB"},null,512),[[R,a.name]]),_.name?(o(),l("p",Uo,s(_.name),1)):a.name&&a.name.length<3?(o(),l("p",Io,"Le nom doit contenir au moins 3 caractères")):$("",!0)]),e("div",Oo,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Description * ",-1)),V(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=S=>a.description=S),rows:"4",required:"",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",style:{color:"#5f5f5f"},placeholder:"Décrivez votre produit en détail..."},null,512),[[R,a.description]]),_.description?(o(),l("p",Ro,s(_.description),1)):a.description&&a.description.length<10?(o(),l("p",No,"La description doit contenir au moins 10 caractères")):$("",!0)]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Catégorie * ",-1)),V(e("select",{"onUpdate:modelValue":t[2]||(t[2]=S=>a.category_id=S),required:"",disabled:u(A),class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all disabled:opacity-50",style:{color:"#5f5f5f"}},[t[18]||(t[18]=e("option",{value:""},"Sélectionner une catégorie",-1)),u(A)?(o(),l("option",Bo,"Chargement des catégories...")):$("",!0),(o(!0),l(G,null,J(D.value,S=>(o(),l("option",{key:S.id,value:S.id},s(S.name),9,Go))),128))],8,qo),[[le,a.category_id]]),_.category_id?(o(),l("p",Jo,s(_.category_id),1)):$("",!0)]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Condition * ",-1)),V(e("select",{"onUpdate:modelValue":t[3]||(t[3]=S=>a.condition=S),required:"",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",style:{color:"#5f5f5f"}},t[20]||(t[20]=[e("option",{value:""},"État du produit",-1),e("option",{value:"new"},"Neuf",-1),e("option",{value:"used"},"Occasion",-1),e("option",{value:"refurbished"},"Reconditionné",-1)]),512),[[le,a.condition]])]),e("div",Wo,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Mode de vente * ",-1)),e("div",Ho,[e("label",{class:N(["flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",{"border-[#0099cc] bg-blue-50":a.sale_mode==="direct"}])},[V(e("input",{type:"radio","onUpdate:modelValue":t[4]||(t[4]=S=>a.sale_mode=S),value:"direct",class:"sr-only"},null,512),[[Ae,a.sale_mode]]),e("div",Xo,[e("div",{class:N(["w-5 h-5 rounded-full border-2 flex items-center justify-center",a.sale_mode==="direct"?"border-[#0099cc]":"border-gray-300"])},[a.sale_mode==="direct"?(o(),l("div",Qo)):$("",!0)],2),t[22]||(t[22]=e("div",null,[e("p",{class:"font-medium text-gray-900"},"Vente directe"),e("p",{class:"text-sm text-gray-700"},"Les clients achètent directement")],-1))])],2),e("label",{class:N(["flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",{"border-purple-500 bg-purple-50":a.sale_mode==="lottery"}])},[V(e("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=S=>a.sale_mode=S),value:"lottery",class:"sr-only"},null,512),[[Ae,a.sale_mode]]),e("div",Zo,[e("div",{class:N(["w-5 h-5 rounded-full border-2 flex items-center justify-center",a.sale_mode==="lottery"?"border-purple-500":"border-gray-300"])},[a.sale_mode==="lottery"?(o(),l("div",Ko)):$("",!0)],2),t[23]||(t[23]=e("div",null,[e("p",{class:"font-medium text-gray-900"},"Tombola"),e("p",{class:"text-sm text-gray-700"},"Les clients achètent des tickets")],-1))])],2)])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Valeur du produit (FCFA) * ",-1)),V(e("input",{"onUpdate:modelValue":t[6]||(t[6]=S=>a.price=S),type:"number",required:"",min:"0",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",style:{color:"#5f5f5f"},placeholder:"Ex: 800000"},null,512),[[R,a.price]]),_.price?(o(),l("p",Yo,s(_.price),1)):a.price&&parseFloat(a.price)<1e3?(o(),l("p",er,"La valeur minimum est de 1000 FCFA")):$("",!0)]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Localisation * ",-1)),V(e("input",{"onUpdate:modelValue":t[7]||(t[7]=S=>a.location=S),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",style:{color:"#5f5f5f"},placeholder:"Ex: Libreville, Gabon"},null,512),[[R,a.location]])])])])):$("",!0),h.value===2?(o(),l("div",tr,[t[32]||(t[32]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Photos du produit",-1)),e("div",sr,[e("div",or,[e("div",{onClick:E,onDragover:t[8]||(t[8]=de(()=>{},["prevent"])),onDrop:de(W,["prevent"]),class:"border-2 border-dashed border-gray-300 rounded-xl p-8 hover:border-[#0099cc] transition-colors cursor-pointer"},[f(u(Pe),{class:"w-16 h-16 text-gray-600 mx-auto mb-4"}),t[28]||(t[28]=e("p",{class:"text-lg font-medium text-gray-700 mb-2"},"Ajoutez des photos",-1)),t[29]||(t[29]=e("p",{class:"text-sm text-gray-700 mb-4"},"Glissez-déposez ou cliquez pour sélectionner",-1)),t[30]||(t[30]=e("div",{class:"flex justify-center"},[e("span",{class:"bg-[#0099cc] text-white px-6 py-2 rounded-lg font-medium hover:bg-[#0088bb] transition-colors"}," Choisir des fichiers ")],-1))],32),e("input",{ref_key:"fileInput",ref:z,type:"file",multiple:"",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:M,class:"hidden"},null,544)]),a.images.length>0?(o(),l("div",rr,[(o(!0),l(G,null,J(a.images,(S,ne)=>(o(),l("div",{key:ne,class:"relative group"},[e("img",{src:S.preview,alt:`Produit ${ne+1}`,class:"w-full h-32 object-cover rounded-xl border border-gray-200"},null,8,lr),e("button",{onClick:q0=>H(ne),type:"button",class:"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},[f(u(_e),{class:"w-4 h-4"})],8,ar),ne===0?(o(),l("div",nr," Photo principale ")):$("",!0)]))),128))])):$("",!0),e("div",ir,[e("div",dr,[f(u(je),{class:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),t[31]||(t[31]=e("div",{class:"text-sm text-blue-700"},[e("p",{class:"font-medium mb-1"},"Conseils pour de bonnes photos :"),e("ul",{class:"space-y-1 text-sm"},[e("li",null,"• Utilisez un bon éclairage naturel"),e("li",null,"• Prenez plusieurs angles du produit"),e("li",null,"• La première image sera la photo principale"),e("li",null,"• Maximum 10 images par produit"),e("li",null,"• Formats acceptés : JPG, PNG, WebP"),e("li",null,"• Taille maximum : 5MB par image")])],-1))])])])])):$("",!0),h.value===3?(o(),l("div",ur,[a.sale_mode==="direct"?(o(),l("div",cr,[t[37]||(t[37]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Configuration de vente directe",-1)),e("div",mr,[t[35]||(t[35]=ge('<div class="flex items-center justify-center space-x-3 mb-4"><div class="w-12 h-12 bg-[#0099cc] rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div><div><h3 class="text-lg font-semibold text-gray-900">Vente directe configurée</h3><p class="text-gray-600">Votre produit sera disponible à l&#39;achat immédiat</p></div></div>',1)),e("div",pr,[e("div",gr,[t[33]||(t[33]=e("p",{class:"text-gray-600"},"Prix de vente",-1)),e("p",xr,s(m(a.price))+" FCFA",1)]),e("div",br,[t[34]||(t[34]=e("p",{class:"text-gray-600"},"Commission plateforme",-1)),e("p",fr,s(m(a.price*.05))+" FCFA (5%)",1)])]),t[36]||(t[36]=e("p",{class:"text-sm text-gray-700 mt-4"}," Les clients pourront acheter votre produit directement au prix affiché. ",-1))])])):a.sale_mode==="lottery"?(o(),l("div",vr,[t[46]||(t[46]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Configuration de la tombola",-1)),e("div",yr,[e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Prix par ticket (FCFA) * ",-1)),V(e("input",{"onUpdate:modelValue":t[9]||(t[9]=S=>a.ticket_price=S),type:"number",required:"",min:"100",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",style:{color:"#5f5f5f"},placeholder:"Ex: 2500",onInput:O,onBlur:y},null,544),[[R,a.ticket_price]]),_.ticket_price?(o(),l("p",_r,s(_.ticket_price),1)):a.ticket_price&&parseFloat(a.ticket_price)<100?(o(),l("p",hr,"Le prix minimum est de 100 FCFA")):(o(),l("p",wr,"Minimum 100 FCFA"))]),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nombre de tickets * ",-1)),V(e("input",{"onUpdate:modelValue":t[10]||(t[10]=S=>a.total_tickets=S),type:"number",required:"",min:"10",max:"10000",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",style:{color:"#5f5f5f"},placeholder:"Ex: 400",onInput:O,onBlur:d},null,544),[[R,a.total_tickets]]),_.total_tickets?(o(),l("p",$r,s(_.total_tickets),1)):a.total_tickets&&(parseInt(a.total_tickets)<10||parseInt(a.total_tickets)>1e4)?(o(),l("p",kr,"Entre 10 et 10,000 tickets")):(o(),l("p",Cr,"Entre 10 et 10,000 tickets"))]),e("div",null,[t[40]||(t[40]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Date de fin de vente * ",-1)),V(e("input",{"onUpdate:modelValue":t[11]||(t[11]=S=>a.end_date=S),type:"datetime-local",required:"",min:F.value,onChange:ie,class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",style:{color:"#5f5f5f"}},null,40,Pr),[[R,a.end_date]]),_.end_date?(o(),l("p",jr,s(_.end_date),1)):a.end_date&&new Date(a.end_date)<=new Date?(o(),l("p",Fr,"La date de fin doit être dans le futur")):$("",!0)]),e("div",null,[t[41]||(t[41]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Tickets minimum pour valider * ",-1)),V(e("input",{"onUpdate:modelValue":t[12]||(t[12]=S=>a.min_tickets=S),type:"number",required:"",max:a.total_tickets,class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",style:{color:"#5f5f5f"},placeholder:"Ex: 200"},null,8,Dr),[[R,a.min_tickets]]),_.min_tickets?(o(),l("p",Mr,s(_.min_tickets),1)):a.min_tickets&&a.total_tickets&&parseInt(a.min_tickets)>parseInt(a.total_tickets)?(o(),l("p",Er,"Ne peut pas dépasser le nombre total de tickets")):(o(),l("p",Sr,"Si pas atteint, remboursement automatique"))]),e("div",Tr,[e("div",Ar,[t[45]||(t[45]=e("h3",{class:"font-semibold text-gray-900 mb-4"},"Aperçu de la tombola",-1)),e("div",Vr,[e("div",Lr,[e("p",zr,s(m(i.value.totalRevenue)),1),t[42]||(t[42]=e("p",{class:"text-sm text-gray-600"},"Revenus potentiels",-1))]),e("div",Ur,[e("p",Ir,s(i.value.profitMargin)+"%",1),t[43]||(t[43]=e("p",{class:"text-sm text-gray-600"},"Marge bénéficiaire",-1))]),e("div",Or,[e("p",Rr,s(m(i.value.platformFee)),1),t[44]||(t[44]=e("p",{class:"text-sm text-gray-600"},"Frais plateforme (5%)",-1))])])])])])])):$("",!0)])):$("",!0),h.value===4?(o(),l("div",Nr,[t[65]||(t[65]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Vérification et publication",-1)),e("div",qr,[e("div",null,[t[52]||(t[52]=e("h3",{class:"font-semibold text-gray-900 mb-4"},"Résumé du produit",-1)),e("div",Br,[e("div",Gr,[t[47]||(t[47]=e("span",{class:"text-gray-800"},"Nom :",-1)),e("span",Jr,s(a.name),1)]),e("div",Wr,[t[48]||(t[48]=e("span",{class:"text-gray-800"},"Valeur :",-1)),e("span",Hr,s(m(a.price))+" FCFA",1)]),e("div",Xr,[t[49]||(t[49]=e("span",{class:"text-gray-800"},"Condition :",-1)),e("span",Qr,s(B(a.condition)),1)]),e("div",Zr,[t[50]||(t[50]=e("span",{class:"text-gray-800"},"Localisation :",-1)),e("span",Kr,s(a.location),1)]),e("div",Yr,[t[51]||(t[51]=e("span",{class:"text-gray-800"},"Photos :",-1)),e("span",el,s(a.images.length)+" image(s)",1)])])]),e("div",null,[e("h3",tl,s(a.sale_mode==="lottery"?"Configuration tombola":"Configuration vente"),1),a.sale_mode==="direct"?(o(),l("div",sl,[t[56]||(t[56]=e("div",{class:"flex justify-between"},[e("span",{class:"text-gray-800"},"Mode de vente :"),e("span",{class:"font-medium text-[#0099cc]"},"Vente directe")],-1)),e("div",ol,[t[53]||(t[53]=e("span",{class:"text-gray-800"},"Prix de vente :",-1)),e("span",rl,s(m(a.price))+" FCFA",1)]),e("div",ll,[t[54]||(t[54]=e("span",{class:"text-gray-800"},"Commission (5%) :",-1)),e("span",al,s(m(a.price*.05))+" FCFA",1)]),e("div",nl,[t[55]||(t[55]=e("span",{class:"text-gray-800"},"Vous recevrez :",-1)),e("span",il,s(m(a.price*.95))+" FCFA",1)])])):a.sale_mode==="lottery"?(o(),l("div",dl,[t[62]||(t[62]=e("div",{class:"flex justify-between"},[e("span",{class:"text-gray-800"},"Mode de vente :"),e("span",{class:"font-medium text-purple-600"},"Tombola")],-1)),e("div",ul,[t[57]||(t[57]=e("span",{class:"text-gray-800"},"Prix/ticket :",-1)),e("span",cl,s(m(a.ticket_price))+" FCFA",1)]),e("div",ml,[t[58]||(t[58]=e("span",{class:"text-gray-800"},"Total tickets :",-1)),e("span",pl,s(a.total_tickets),1)]),e("div",gl,[t[59]||(t[59]=e("span",{class:"text-gray-800"},"Minimum requis :",-1)),e("span",xl,s(a.min_tickets),1)]),e("div",bl,[t[60]||(t[60]=e("span",{class:"text-gray-800"},"Date de fin :",-1)),e("span",fl,s(X(a.end_date)),1)]),e("div",vl,[t[61]||(t[61]=e("span",{class:"text-gray-800"},"Revenus max :",-1)),e("span",yl,s(m(i.value.totalRevenue))+" FCFA",1)])])):$("",!0)])]),e("div",_l,[e("label",hl,[V(e("input",{"onUpdate:modelValue":t[13]||(t[13]=S=>a.terms_accepted=S),type:"checkbox",required:"",class:"mt-1 h-4 w-4 text-[#0099cc] focus:ring-[#0099cc] border-gray-300 rounded"},null,512),[[Fe,a.terms_accepted]]),e("span",wl,[t[63]||(t[63]=T(" J'accepte les ",-1)),t[64]||(t[64]=e("a",{href:"#",class:"text-[#0099cc] hover:underline"},"conditions de vente",-1)),T(" et confirme que toutes les informations sont exactes. Je comprends que Koumbaya prélèvera des frais de 5% sur les revenus "+s(a.sale_mode==="lottery"?"de la tombola":"de la vente")+". ",1)])])])])):$("",!0),e("div",$l,[h.value>1?(o(),l("button",{key:0,onClick:P,type:"button",class:"inline-flex items-center px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors"},[f(u(xe),{class:"w-4 h-4 mr-2"}),t[66]||(t[66]=T(" Précédent ",-1))])):(o(),l("div",kl)),e("div",Cl," Étape "+s(h.value)+" sur "+s(w.length),1),h.value<w.length?(o(),l("button",{key:2,onClick:p,type:"button",class:"inline-flex items-center px-6 py-3 bg-[#0099cc] hover:bg-[#0088bb] text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:!k.value||u(A)},[t[67]||(t[67]=T(" Suivant ",-1)),f(u(Ye),{class:"w-4 h-4 ml-2"})],8,Pl)):$("",!0),h.value===w.length?(o(),l("button",{key:3,type:"submit",disabled:v.value||!k.value||u(A),class:"inline-flex items-center px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors"},[v.value||u(A)?(o(),l("span",Fl,[t[68]||(t[68]=e("div",{class:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"},null,-1)),T(" "+s(v.value?"Publication...":"Chargement..."),1)])):(o(),l("span",Dl,[f(u(Ce),{class:"w-4 h-4 mr-2"}),t[69]||(t[69]=T(" Publier le produit ",-1))]))],8,jl)):$("",!0)])],32)])}}},Z0=Object.freeze(Object.defineProperty({__proto__:null,default:Ml},Symbol.toStringTag,{value:"Module"})),El={class:"max-w-4xl mx-auto space-y-6"},Sl={key:0,class:"flex justify-center items-center py-12"},Tl={key:1,class:"bg-red-50 border border-red-200 rounded-xl p-6 text-center"},Al={class:"text-red-600"},Vl={class:"flex items-center justify-between"},Ll={class:"mt-2 text-gray-600"},zl={class:"bg-white rounded-xl shadow-lg border border-gray-100 p-6"},Ul={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Il={class:"lg:col-span-2"},Ol={key:0,class:"mt-1 text-sm text-red-600"},Rl={class:"lg:col-span-2"},Nl={key:0,class:"mt-1 text-sm text-red-600"},ql=["disabled"],Bl={key:0,disabled:""},Gl=["value"],Jl={key:0,class:"mt-1 text-sm text-red-600"},Wl={key:0,class:"mt-1 text-sm text-red-600"},Hl={class:"lg:col-span-2"},Xl={key:0,class:"mt-1 text-sm text-red-600"},Ql={key:1,class:"mt-1 text-sm text-orange-600"},Zl={key:2,class:"text-sm text-gray-700 mt-1"},Kl={key:0},Yl={key:0,class:"mt-1 text-sm text-red-600"},ea={key:1,class:"text-sm text-gray-700 mt-1"},ta={key:0,class:"mt-1 text-sm text-red-600"},sa={class:"bg-white rounded-xl shadow-lg border border-gray-100 p-6"},oa={key:0,class:"mb-6"},ra={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},la=["src","alt"],aa=["onClick"],na={class:"text-center"},ia={key:1,class:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6"},da=["src","alt"],ua=["onClick"],ca={class:"bg-blue-50 border border-blue-200 rounded-xl p-4 mt-6"},ma={class:"flex items-start space-x-3"},pa={class:"flex justify-between items-center bg-white rounded-xl shadow-lg border border-gray-100 p-6"},ga=["disabled"],xa={key:0,class:"flex items-center"},ba={key:1,class:"flex items-center"},fa={__name:"EditProduct",setup(te){const U=Ee(),I=Oe(),{get:g,put:A,loading:h}=me(),v=Q(()=>I.params.id),z=L(!1),w=L(!0),D=L(!1),a=L(""),_=L(null),F=L(null),i=L([]),k=L([]),c=ae({name:"",description:"",category_id:"",condition:"",sale_mode:"direct",price:"",ticket_price:"",location:"",images:[]}),j=ae({name:"",description:"",category_id:"",condition:"",price:"",ticket_price:"",location:"",images:""}),p=Q(()=>c.name&&c.description&&c.category_id&&c.condition&&c.price&&parseFloat(c.price)>=1e3&&(!_.value||_.value.sale_mode!=="lottery"||c.ticket_price&&parseFloat(c.ticket_price)>=100)),P=async()=>{try{w.value=!0,a.value="";const C=await g("/products?my_products=1");if(C&&C.data&&C.data.products){const n=C.data.products.find(q=>q.id.toString()===v.value.toString());n?(_.value=n,c.name=n.name||"",c.description=n.description||"",c.category_id=n.category_id||"",c.condition=n.condition||"",c.sale_mode=n.sale_mode||"direct",c.price=n.price||"",c.ticket_price=n.ticket_price||"",c.location=n.location||"",n.images&&Array.isArray(n.images)?k.value=[...n.images]:n.main_image?k.value=[n.main_image]:n.image_url&&(k.value=[n.image_url]),D.value=!0):a.value="Ce produit n'existe pas ou ne vous appartient pas"}else a.value="Erreur lors du chargement des produits"}catch(C){console.error("Error loading product:",C),C.response?.status===404?a.value="Produit non trouvé":C.response?.status===403?a.value="Vous n'êtes pas autorisé à modifier ce produit":a.value=`Erreur lors du chargement du produit: ${C.message}`}finally{w.value=!1}},E=async()=>{try{const C=await g("/categories");C.categories&&(i.value=C.categories)}catch(C){console.error("Error loading categories:",C)}},M=()=>{F.value?.click()},W=C=>{const n=Array.from(C.target.files||[]);H(n)},Z=C=>{const n=Array.from(C.dataTransfer.files||[]);H(n)},H=C=>{const n=C.filter(x=>x.type.startsWith("image/")?x.size>5242880?(console.error(`Le fichier ${x.name} est trop volumineux (max 5MB)`),!1):!0:(console.error(`Le fichier ${x.name} n'est pas une image valide`),!1));if(k.value.length+c.images.length+n.length>10){console.error("Maximum 10 images autorisées");return}n.forEach(x=>{const K=new FileReader;K.onload=ie=>{c.images.push({file:x,preview:ie.target?.result,name:x.name,size:x.size,type:x.type})},K.onerror=()=>{console.error(`Erreur lors de la lecture du fichier ${x.name}`)},K.readAsDataURL(x)}),F.value&&(F.value.value="")},O=C=>{c.images.splice(C,1)},m=C=>{k.value.splice(C,1)},X=async()=>{z.value=!0,B();try{const C={name:c.name,description:c.description,category_id:parseInt(c.category_id),price:parseFloat(c.price),condition:c.condition,location:c.location};_.value.sale_mode==="lottery"&&c.ticket_price&&(C.ticket_price=parseFloat(c.ticket_price));const n=[...k.value,...c.images.map(x=>x.preview)];n.length>0&&(C.images=n);const q=await A(`/products/${v.value}`,C);q&&(q.product||q.success)&&(window.$toast&&window.$toast.success("Produit modifié avec succès !","✅ Succès"),setTimeout(()=>{U.push("/merchant/products")},1500))}catch(C){console.error("Error updating product:",C),oe(C)}finally{z.value=!1}},B=()=>{Object.keys(j).forEach(C=>{j[C]=""})},oe=C=>{if(C.response?.data?.errors){const n=C.response.data.errors;Object.keys(n).forEach(q=>{j[q]!==void 0&&(j[q]=n[q][0])}),re("Veuillez corriger les erreurs dans le formulaire")}else C.response?.data?.message?re(C.response.data.message):re("Une erreur est survenue. Veuillez réessayer.")},re=C=>{window.$toast&&window.$toast.error(C,"❌ Erreur")};return ue(async()=>{await Promise.all([P(),E()])}),(C,n)=>{const q=ve("router-link");return o(),l("div",El,[w.value?(o(),l("div",Sl,n[8]||(n[8]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#0099cc]"},null,-1),e("span",{class:"ml-3 text-gray-600"},"Chargement du produit...",-1)]))):a.value?(o(),l("div",Tl,[n[10]||(n[10]=e("h3",{class:"text-lg font-medium text-red-800 mb-2"},"Erreur",-1)),e("p",Al,s(a.value),1),f(q,{to:"/merchant/products",class:"inline-flex items-center px-4 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors mt-4"},{default:ee(()=>[f(u(xe),{class:"w-4 h-4 mr-2"}),n[9]||(n[9]=T(" Retour aux produits ",-1))]),_:1,__:[9]})])):D.value&&_.value?(o(),l(G,{key:2},[e("div",Vl,[e("div",null,[n[11]||(n[11]=e("h1",{class:"text-3xl font-bold text-gray-900"},"Modifier le Produit",-1)),e("p",Ll,'Modifiez les informations de "'+s(_.value.name)+'"',1)]),f(q,{to:"/merchant/products",class:"inline-flex items-center px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors"},{default:ee(()=>[f(u(xe),{class:"w-4 h-4 mr-2"}),n[12]||(n[12]=T(" Retour aux produits ",-1))]),_:1,__:[12]})]),e("form",{onSubmit:de(X,["prevent"]),class:"space-y-6"},[e("div",zl,[n[22]||(n[22]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Informations de base",-1)),e("div",Ul,[e("div",Il,[n[13]||(n[13]=e("label",{class:"block text-sm font-medium text-gray-800 mb-2"}," Nom du produit * ",-1)),V(e("input",{"onUpdate:modelValue":n[0]||(n[0]=x=>c.name=x),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all text-gray-900",placeholder:"Ex: iPhone 15 Pro Max 256GB"},null,512),[[R,c.name]]),j.name?(o(),l("p",Ol,s(j.name),1)):$("",!0)]),e("div",Rl,[n[14]||(n[14]=e("label",{class:"block text-sm font-medium text-gray-800 mb-2"}," Description * ",-1)),V(e("textarea",{"onUpdate:modelValue":n[1]||(n[1]=x=>c.description=x),rows:"4",required:"",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all text-gray-900",placeholder:"Décrivez votre produit en détail..."},null,512),[[R,c.description]]),j.description?(o(),l("p",Nl,s(j.description),1)):$("",!0)]),e("div",null,[n[16]||(n[16]=e("label",{class:"block text-sm font-medium text-gray-800 mb-2"}," Catégorie * ",-1)),V(e("select",{"onUpdate:modelValue":n[2]||(n[2]=x=>c.category_id=x),required:"",disabled:u(h),class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all disabled:opacity-50 text-gray-900"},[n[15]||(n[15]=e("option",{value:""},"Sélectionner une catégorie",-1)),u(h)?(o(),l("option",Bl,"Chargement des catégories...")):$("",!0),(o(!0),l(G,null,J(i.value,x=>(o(),l("option",{key:x.id,value:x.id},s(x.name),9,Gl))),128))],8,ql),[[le,c.category_id]]),j.category_id?(o(),l("p",Jl,s(j.category_id),1)):$("",!0)]),e("div",null,[n[18]||(n[18]=e("label",{class:"block text-sm font-medium text-gray-800 mb-2"}," Condition * ",-1)),V(e("select",{"onUpdate:modelValue":n[3]||(n[3]=x=>c.condition=x),required:"",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all text-gray-900"},n[17]||(n[17]=[e("option",{value:""},"État du produit",-1),e("option",{value:"new"},"Neuf",-1),e("option",{value:"used"},"Occasion",-1),e("option",{value:"refurbished"},"Reconditionné",-1)]),512),[[le,c.condition]]),j.condition?(o(),l("p",Wl,s(j.condition),1)):$("",!0)]),e("div",Hl,[n[19]||(n[19]=e("label",{class:"block text-sm font-medium text-gray-800 mb-2"}," Valeur du produit (FCFA) * ",-1)),V(e("input",{"onUpdate:modelValue":n[4]||(n[4]=x=>c.price=x),type:"number",required:"",min:"1000",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all text-gray-900",placeholder:"Ex: 850000"},null,512),[[R,c.price]]),j.price?(o(),l("p",Xl,s(j.price),1)):c.price&&parseFloat(c.price)<1e3?(o(),l("p",Ql,"Le prix minimum est de 1000 FCFA")):(o(),l("p",Zl,"Prix de vente ou valeur estimée du produit"))]),_.value.sale_mode==="lottery"?(o(),l("div",Kl,[n[20]||(n[20]=e("label",{class:"block text-sm font-medium text-gray-800 mb-2"}," Prix par ticket (FCFA) * ",-1)),V(e("input",{"onUpdate:modelValue":n[5]||(n[5]=x=>c.ticket_price=x),type:"number",required:"",min:"100",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all text-gray-900",placeholder:"Ex: 2500"},null,512),[[R,c.ticket_price]]),j.ticket_price?(o(),l("p",Yl,s(j.ticket_price),1)):(o(),l("p",ea,"Prix que paieront les participants"))])):$("",!0),e("div",null,[n[21]||(n[21]=e("label",{class:"block text-sm font-medium text-gray-800 mb-2"}," Localisation ",-1)),V(e("input",{"onUpdate:modelValue":n[6]||(n[6]=x=>c.location=x),type:"text",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all text-gray-900",placeholder:"Ex: Abidjan, Cocody"},null,512),[[R,c.location]]),j.location?(o(),l("p",ta,s(j.location),1)):$("",!0)])])]),e("div",sa,[n[28]||(n[28]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Images du produit",-1)),k.value.length>0?(o(),l("div",oa,[n[23]||(n[23]=e("h3",{class:"text-sm font-medium text-gray-800 mb-3"},"Images actuelles",-1)),e("div",ra,[(o(!0),l(G,null,J(k.value,(x,K)=>(o(),l("div",{key:`existing-${K}`,class:"relative group"},[e("img",{src:(x.startsWith("data:"),x),alt:`Image ${K+1}`,class:"w-full h-32 object-cover rounded-xl border border-gray-200"},null,8,la),e("button",{onClick:ie=>m(K),type:"button",class:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},[f(u(_e),{class:"w-4 h-4"})],8,aa)]))),128))])])):$("",!0),e("div",na,[e("div",{onClick:M,onDragover:n[7]||(n[7]=de(()=>{},["prevent"])),onDrop:de(Z,["prevent"]),class:"border-2 border-dashed border-gray-300 rounded-xl p-8 hover:border-[#0099cc] transition-colors cursor-pointer"},[f(u(Pe),{class:"w-16 h-16 text-gray-600 mx-auto mb-4"}),n[24]||(n[24]=e("p",{class:"text-lg font-medium text-gray-700 mb-2"},"Ajouter de nouvelles photos",-1)),n[25]||(n[25]=e("p",{class:"text-sm text-gray-700 mb-4"},"Glissez-déposez ou cliquez pour sélectionner",-1)),n[26]||(n[26]=e("div",{class:"flex justify-center"},[e("span",{class:"bg-[#0099cc] text-white px-6 py-2 rounded-lg font-medium hover:bg-[#0088bb] transition-colors"}," Choisir des fichiers ")],-1))],32),e("input",{ref_key:"fileInput",ref:F,type:"file",multiple:"",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:W,class:"hidden"},null,544)]),c.images.length>0?(o(),l("div",ia,[(o(!0),l(G,null,J(c.images,(x,K)=>(o(),l("div",{key:`new-${K}`,class:"relative group"},[e("img",{src:x.preview,alt:`Nouvelle image ${K+1}`,class:"w-full h-32 object-cover rounded-xl border border-gray-200"},null,8,da),e("button",{onClick:ie=>O(K),type:"button",class:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},[f(u(_e),{class:"w-4 h-4"})],8,ua)]))),128))])):$("",!0),e("div",ca,[e("div",ma,[f(u(je),{class:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),n[27]||(n[27]=e("div",{class:"text-sm text-blue-700"},[e("p",{class:"font-medium mb-1"},"Conseils pour de bonnes photos :"),e("ul",{class:"space-y-1 text-sm"},[e("li",null,"• Les images existantes seront conservées si vous n'ajoutez pas de nouvelles images"),e("li",null,"• Utilisez un bon éclairage naturel"),e("li",null,"• Prenez plusieurs angles du produit"),e("li",null,"• Maximum 10 images par produit"),e("li",null,"• Formats acceptés : JPG, PNG, WebP"),e("li",null,"• Taille maximum : 5MB par image")])],-1))])])]),e("div",pa,[f(q,{to:"/merchant/products",class:"inline-flex items-center px-6 py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors"},{default:ee(()=>[f(u(xe),{class:"w-4 h-4 mr-2"}),n[29]||(n[29]=T(" Annuler ",-1))]),_:1,__:[29]}),e("button",{type:"submit",disabled:z.value||!p.value||u(h),class:"inline-flex items-center px-6 py-3 bg-[#0099cc] hover:bg-[#0088bb] disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg transition-colors"},[z.value||u(h)?(o(),l("span",xa,n[30]||(n[30]=[e("div",{class:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"},null,-1),T(" Modification... ",-1)]))):(o(),l("span",ba,[f(u(Se),{class:"w-4 h-4 mr-2"}),n[31]||(n[31]=T(" Enregistrer les modifications ",-1))]))],8,ga)])],32)],64)):$("",!0)])}}},K0=Object.freeze(Object.defineProperty({__proto__:null,default:fa},Symbol.toStringTag,{value:"Module"})),va={class:"space-y-6"},ya={class:"flex items-center justify-between"},_a={class:"flex space-x-3"},ha=["disabled"],wa={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},$a={class:"flex items-center justify-between"},ka={class:"text-sm font-medium text-gray-600"},Ca={class:"text-2xl font-bold text-gray-900 mt-1"},Pa={class:"mt-4 pt-4 border-t border-gray-100"},ja={class:"flex items-center text-xs"},Fa={class:"bg-white rounded-xl shadow-lg border border-gray-100 p-6"},Da={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},Ma={class:"relative"},Ea=["value"],Sa={class:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden"},Ta={key:0,class:"flex justify-center py-12"},Aa={key:1,class:"text-center py-12"},Va={key:2,class:"overflow-x-auto"},La={class:"min-w-full"},za={class:"bg-white divide-y divide-gray-200"},Ua={class:"px-6 py-4 whitespace-nowrap"},Ia={class:"text-sm font-medium text-gray-900"},Oa={class:"text-sm text-gray-500"},Ra={class:"px-6 py-4 whitespace-nowrap"},Na={class:"flex items-center"},qa={class:"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center"},Ba={class:"ml-3"},Ga={class:"text-sm font-medium text-gray-900"},Ja={class:"text-sm text-gray-500"},Wa={class:"px-6 py-4 whitespace-nowrap"},Ha={class:"flex items-center"},Xa=["src","alt"],Qa={class:"ml-3"},Za={class:"text-sm font-medium text-gray-900"},Ka={class:"text-sm text-gray-500"},Ya={class:"px-6 py-4 whitespace-nowrap"},en={class:"text-sm text-gray-900"},tn={class:"text-sm text-gray-500"},sn={class:"px-6 py-4 whitespace-nowrap"},on={class:"text-sm font-semibold text-gray-900"},rn={class:"text-sm text-gray-500"},ln={class:"px-6 py-4 whitespace-nowrap"},an={class:"px-6 py-4 whitespace-nowrap"},nn={class:"text-sm text-gray-900"},dn={class:"text-sm text-gray-500"},un={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},cn={class:"flex items-center space-x-2"},mn=["onClick"],pn=["onClick"],gn=["onClick"],xn={class:"bg-white px-6 py-3 border-t border-gray-200 flex items-center justify-between"},bn={class:"text-sm text-gray-700"},fn={class:"font-medium"},vn={class:"font-medium"},yn={class:"font-medium"},_n={class:"flex space-x-2"},hn=["disabled"],wn=["disabled"],$n={key:0,class:"fixed inset-0 bg-black/20 overflow-y-auto h-full w-full z-50"},kn={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-2/3 lg:w-1/2 shadow-lg rounded-xl bg-white"},Cn={class:"flex items-center justify-between mb-6"},Pn={key:0,class:"space-y-6"},jn={class:"grid grid-cols-2 gap-4"},Fn={class:"text-sm text-gray-900"},Dn={class:"text-sm text-gray-900"},Mn={class:"text-sm text-gray-900 font-semibold"},En={class:"bg-gray-50 p-4 rounded-lg"},Sn={class:"grid grid-cols-2 gap-4"},Tn={class:"text-sm text-gray-900"},An={class:"text-sm text-gray-900"},Vn={class:"bg-gray-50 p-4 rounded-lg"},Ln={class:"text-sm text-gray-700 mb-2"},zn={class:"flex flex-wrap gap-2"},Un={class:"mt-6 flex justify-end space-x-3"},In={__name:"Orders",setup(te){const{orders:U,products:I,orderStats:g,loading:A,loadStats:h,loadOrders:v,loadProducts:z,confirmOrder:w,cancelOrder:D,exportOrders:a}=Je(),_=We(),F=L(!1),i=L(null),k=L(1),c=L(10),j=L(!1),p=ae({search:"",status:"",product:"",startDate:"",endDate:""}),P=Q(()=>{let r=U.value;if(p.search){const t=p.search.toLowerCase();r=r.filter(b=>b.order_number.toLowerCase().includes(t)||b.customer_name.toLowerCase().includes(t)||b.product_name.toLowerCase().includes(t))}return p.status&&(r=r.filter(t=>t.status===p.status)),p.product&&(r=r.filter(t=>t.product_name.includes(I.value.find(b=>b.id==p.product)?.name||""))),p.startDate&&(r=r.filter(t=>new Date(t.created_at)>=new Date(p.startDate))),p.endDate&&(r=r.filter(t=>new Date(t.created_at)<=new Date(p.endDate))),r}),E=Q(()=>Math.ceil(P.value.length/c.value)),M=Q(()=>{const r=(k.value-1)*c.value,t=r+c.value;return P.value.slice(r,t)}),W=Q(()=>(k.value-1)*c.value+1),Z=Q(()=>{const r=k.value*c.value;return Math.min(r,P.value.length)}),H=async()=>{k.value=1,await O()},O=async()=>{try{await v(p)}catch{_.error("Erreur lors du chargement des commandes")}},m=()=>{k.value>1&&k.value--},X=()=>{k.value<E.value&&k.value++},B=r=>({pending:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800",confirmed:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",completed:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",cancelled:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-red-100 text-red-800"})[r]||"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-800",oe=r=>({pending:"En attente",confirmed:"Confirmé",completed:"Terminé",cancelled:"Annulé"})[r]||r,re=r=>new Date(r).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}),C=r=>new Date(r).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}),n=r=>{i.value=r,F.value=!0},q=()=>{F.value=!1,i.value=null},x=async r=>{if(confirm(`Confirmer la commande ${r.order_number} ?`))try{await w(r),_.success("Commande confirmée avec succès !"),q(),await O()}catch{_.error("Erreur lors de la confirmation")}},K=async r=>{if(confirm(`Annuler la commande ${r.order_number} ? Cette action est irréversible.`))try{await D(r),_.success("Commande annulée"),q(),await O()}catch{_.error("Erreur lors de l'annulation")}},ie=async()=>{j.value=!0;try{await Promise.all([h(),O(),z()]),_.success("Commandes actualisées")}catch{_.error("Erreur lors de l'actualisation")}finally{j.value=!1}},y=async()=>{try{await a("csv"),_.success("Export des commandes démarré")}catch{_.error("Erreur lors de l'export des commandes")}};ue(async()=>{try{await Promise.all([h(),v(),z()])}catch(r){console.error("Erreur lors du chargement initial:",r),_.error("Erreur lors du chargement des données")}});let d=null;Re(()=>p.search,r=>{clearTimeout(d),d=setTimeout(()=>{H()},500)});const Y=r=>({ShoppingBagIcon:pe,CurrencyDollarIcon:he,ClockIcon:qe,CheckIcon:Se})[r]||pe;return(r,t)=>(o(),l("div",va,[e("div",ya,[t[7]||(t[7]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Mes Commandes"),e("p",{class:"mt-2 text-gray-600"},"Suivez et gérez toutes vos ventes de tickets de tombola")],-1)),e("div",_a,[e("button",{onClick:ie,disabled:j.value,class:"inline-flex items-center px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors disabled:opacity-50"},[f(u(et),{class:N(["w-4 h-4 mr-2",{"animate-spin":j.value}])},null,8,["class"]),T(" "+s(j.value?"Actualisation...":"Actualiser"),1)],8,ha),e("button",{onClick:y,class:"inline-flex items-center px-4 py-2 bg-[#0099cc] hover:bg-[#0088bb] text-white rounded-lg transition-colors"},[f(u(Ne),{class:"w-4 h-4 mr-2"}),t[6]||(t[6]=T(" Exporter ",-1))])])]),e("div",wa,[(o(!0),l(G,null,J(u(g),b=>(o(),l("div",{key:b.label,class:"bg-white p-6 rounded-xl shadow-lg border border-gray-100"},[e("div",$a,[e("div",null,[e("p",ka,s(b.label),1),e("p",Ca,s(b.value),1)]),e("div",{class:N(["p-3 rounded-xl",b.color])},[(o(),se(ce(Y(b.icon)),{class:"w-6 h-6 text-white"}))],2)]),e("div",Pa,[e("div",ja,[e("span",{class:N(["inline-flex items-center px-2 py-1 rounded-full font-medium",b.change>=0?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"])},[(o(),se(ce(b.change>=0?u(De):u(Me)),{class:"w-3 h-3 mr-1"})),T(" "+s(Math.abs(b.change))+"% ",1)],2),t[8]||(t[8]=e("span",{class:"ml-2 text-gray-500"},"vs semaine dernière",-1))])])]))),128))]),e("div",Fa,[e("div",Da,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rechercher",-1)),e("div",Ma,[f(u(Le),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),V(e("input",{"onUpdate:modelValue":t[0]||(t[0]=b=>p.search=b),type:"text",placeholder:"ID, client, produit...",class:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black",onInput:H},null,544),[[R,p.search]])])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),V(e("select",{"onUpdate:modelValue":t[1]||(t[1]=b=>p.status=b),onChange:H,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},t[10]||(t[10]=[ge('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="confirmed">Confirmé</option><option value="completed">Terminé</option><option value="cancelled">Annulé</option>',5)]),544),[[le,p.status]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Produit",-1)),V(e("select",{"onUpdate:modelValue":t[2]||(t[2]=b=>p.product=b),onChange:H,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},[t[12]||(t[12]=e("option",{value:""},"Tous les produits",-1)),(o(!0),l(G,null,J(u(I),b=>(o(),l("option",{key:b.id,value:b.id},s(b.name),9,Ea))),128))],544),[[le,p.product]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date début",-1)),V(e("input",{"onUpdate:modelValue":t[3]||(t[3]=b=>p.startDate=b),type:"date",onChange:H,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},null,544),[[R,p.startDate]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date fin",-1)),V(e("input",{"onUpdate:modelValue":t[4]||(t[4]=b=>p.endDate=b),type:"date",onChange:H,class:"w-full py-2 px-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent text-black"},null,544),[[R,p.endDate]])])])]),e("div",Sa,[t[24]||(t[24]=e("div",{class:"px-6 py-4 border-b border-gray-200 bg-gray-50"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Commandes récentes")],-1)),u(A)?(o(),l("div",Ta,t[16]||(t[16]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#0099cc]"},null,-1)]))):P.value.length===0?(o(),l("div",Aa,[f(u(pe),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t[17]||(t[17]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Aucune commande",-1)),t[18]||(t[18]=e("p",{class:"text-gray-600"},"Aucune commande ne correspond à vos critères.",-1))])):(o(),l("div",Va,[e("table",La,[t[19]||(t[19]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Commande "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Client "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Produit "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tickets "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Montant "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",za,[(o(!0),l(G,null,J(M.value,b=>(o(),l("tr",{key:b.id,class:"hover:bg-gray-50 transition-colors"},[e("td",Ua,[e("div",null,[e("div",Ia,"#"+s(b.order_number),1),e("div",Oa,s(b.payment_method),1)])]),e("td",Ra,[e("div",Na,[e("div",qa,[f(u(Te),{class:"w-5 h-5 text-gray-600"})]),e("div",Ba,[e("div",Ga,s(b.customer_name),1),e("div",Ja,s(b.customer_email),1)])])]),e("td",Wa,[e("div",Ha,[e("img",{class:"h-12 w-12 rounded-lg object-cover",src:b.product_image,alt:b.product_name},null,8,Xa),e("div",Qa,[e("div",Za,s(b.product_name),1),e("div",Ka,s(b.ticket_price.toLocaleString())+" FCFA/ticket",1)])])]),e("td",Ya,[e("div",en,s(b.tickets_count)+" tickets",1),e("div",tn,"N° "+s(b.ticket_numbers.join(", ")),1)]),e("td",sn,[e("div",on,s(b.total_amount.toLocaleString())+" FCFA",1),e("div",rn,s(b.currency),1)]),e("td",ln,[e("span",{class:N(B(b.status))},s(oe(b.status)),3)]),e("td",an,[e("div",nn,s(re(b.created_at)),1),e("div",dn,s(C(b.created_at)),1)]),e("td",un,[e("div",cn,[e("button",{onClick:S=>n(b),class:"text-[#0099cc] hover:text-[#0088bb] transition-colors",title:"Voir détails"},[f(u(Ue),{class:"w-4 h-4"})],8,mn),b.status==="pending"?(o(),l("button",{key:0,onClick:S=>x(b),class:"text-blue-600 hover:text-blue-800 transition-colors",title:"Confirmer"},[f(u(ze),{class:"w-4 h-4"})],8,pn)):$("",!0),["pending","confirmed"].includes(b.status)?(o(),l("button",{key:1,onClick:S=>K(b),class:"text-red-600 hover:text-red-800 transition-colors",title:"Annuler"},[f(u(tt),{class:"w-4 h-4"})],8,gn)):$("",!0)])])]))),128))])])])),e("div",xn,[e("div",bn,[t[20]||(t[20]=T(" Affichage de ",-1)),e("span",fn,s(W.value),1),t[21]||(t[21]=T(" à ",-1)),e("span",vn,s(Z.value),1),t[22]||(t[22]=T(" sur ",-1)),e("span",yn,s(P.value.length),1),t[23]||(t[23]=T(" résultats ",-1))]),e("div",_n,[e("button",{onClick:m,disabled:k.value===1,class:"px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed"}," Précédent ",8,hn),e("button",{onClick:X,disabled:k.value===E.value,class:"px-3 py-1 bg-gray-100 text-gray-600 rounded-md hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed"}," Suivant ",8,wn)])])]),F.value?(o(),l("div",$n,[e("div",kn,[e("div",Cn,[t[25]||(t[25]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Détails de la commande",-1)),e("button",{onClick:q,class:"text-gray-400 hover:text-gray-600"},[f(u(_e),{class:"w-6 h-6"})])]),i.value?(o(),l("div",Pn,[e("div",jn,[e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700"},"N° de commande",-1)),e("p",Fn,s(i.value.order_number),1)]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date",-1)),e("p",Dn,s(re(i.value.created_at)),1)]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"Statut",-1)),e("span",{class:N(B(i.value.status))},s(oe(i.value.status)),3)]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium text-gray-700"},"Montant",-1)),e("p",Mn,s(i.value.total_amount.toLocaleString())+" FCFA",1)])]),e("div",null,[t[32]||(t[32]=e("h4",{class:"text-md font-semibold text-gray-900 mb-3"},"Informations client",-1)),e("div",En,[e("div",Sn,[e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nom",-1)),e("p",Tn,s(i.value.customer_name),1)]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium text-gray-700"},"Email",-1)),e("p",An,s(i.value.customer_email),1)])])])]),e("div",null,[t[33]||(t[33]=e("h4",{class:"text-md font-semibold text-gray-900 mb-3"},"Tickets achetés",-1)),e("div",Vn,[e("p",Ln,[e("strong",null,s(i.value.tickets_count)+" tickets",1),T(" pour "+s(i.value.product_name),1)]),e("div",zn,[(o(!0),l(G,null,J(i.value.ticket_numbers,b=>(o(),l("span",{key:b,class:"inline-block bg-[#0099cc] text-white px-2 py-1 rounded text-xs font-mono"}," #"+s(b),1))),128))])])])])):$("",!0),e("div",Un,[e("button",{onClick:q,class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300"}," Fermer "),i.value?.status==="pending"?(o(),l("button",{key:0,onClick:t[5]||(t[5]=b=>x(i.value)),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Confirmer la commande ")):$("",!0)])])])):$("",!0)]))}},Y0=Object.freeze(Object.defineProperty({__proto__:null,default:In},Symbol.toStringTag,{value:"Module"})),On={class:"space-y-6"},Rn={class:"sm:flex sm:items-center sm:justify-between"},Nn={class:"mt-4 sm:mt-0"},qn={class:"bg-white p-4 rounded-lg shadow"},Bn={class:"flex flex-col sm:flex-row gap-4"},Gn={class:"flex-1"},Jn={class:"relative"},Wn={class:"sm:w-48"},Hn={class:"grid grid-cols-2 md:grid-cols-5 gap-4"},Xn={class:"bg-white rounded-lg shadow p-4"},Qn={class:"text-2xl font-bold text-gray-900"},Zn={class:"bg-white rounded-lg shadow p-4"},Kn={class:"text-2xl font-bold text-green-600"},Yn={class:"bg-white rounded-lg shadow p-4"},ei={class:"text-2xl font-bold text-yellow-600"},ti={class:"bg-white rounded-lg shadow p-4"},si={class:"text-2xl font-bold text-blue-600"},oi={class:"bg-white rounded-lg shadow p-4"},ri={class:"text-2xl font-bold text-red-600"},li={class:"border-b border-gray-200"},ai={class:"-mb-px flex space-x-8"},ni=["onClick"],ii={key:0,class:"ml-2 bg-gray-100 text-gray-600 py-1 px-2 rounded-full text-xs"},di={key:0,class:"bg-red-50 border border-red-200 rounded-md p-4"},ui={class:"flex"},ci={class:"ml-3"},mi={class:"text-sm text-red-800"},pi={class:"bg-white rounded-lg shadow"},gi={class:"p-6"},xi={key:0,class:"text-center py-12"},bi={key:1,class:"text-center py-12"},fi={key:2},vi={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},yi={class:"h-48 bg-gray-200 relative"},_i={class:"absolute top-2 right-2"},hi={class:"p-4"},wi={class:"flex justify-between items-start mb-2"},$i={class:"font-semibold text-gray-900 truncate"},ki={class:"text-sm text-gray-600 ml-2"},Ci={class:"text-sm text-gray-600 mb-3 line-clamp-2"},Pi={class:"space-y-2 text-sm"},ji={class:"flex justify-between"},Fi={class:"font-medium"},Di={class:"flex justify-between"},Mi={class:"font-medium"},Ei={class:"flex justify-between"},Si={class:"w-full bg-gray-200 rounded-full h-2"},Ti={class:"flex gap-2 mt-4"},Ai=["onClick","disabled"],Vi={key:0,class:"mt-6 flex justify-between items-center"},Li={class:"text-sm text-gray-700"},zi={class:"flex gap-2"},Ui=["disabled"],Ii=["disabled"],Oi={key:1,class:"fixed inset-0 bg-black/20 flex items-center justify-center z-50"},Ri={class:"bg-white rounded-lg p-6 max-w-md w-full mx-4"},Ni={class:"text-sm text-gray-600 mb-6"},qi={class:"flex gap-3 justify-end"},Bi=["disabled"],Gi={key:2,class:"fixed bottom-4 right-4 z-50"},Ji={class:"flex"},Wi={class:"flex-shrink-0"},Hi={key:0,class:"h-5 w-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Xi={key:1,class:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qi={class:"ml-3"},Zi={__name:"LotteriesSimple",setup(te){const{lotteries:U,stats:I,tabs:g,pagination:A,loading:h,error:v,fetchLotteries:z,drawLottery:w,updateFilters:D,searchLotteries:a,changePage:_,canDrawLottery:F,getFormattedStatus:i,getTimeRemaining:k}=He(),c=L("all"),j=L(""),p=L("end_date_asc"),P=L(!1),E=L(null),M=L(null),W=L(!1),Z=L(""),H=L("success");let O=null;const m=()=>{clearTimeout(O),O=setTimeout(()=>{a(j.value)},500)},X=C=>{c.value=C,D({status:C==="all"?null:C,page:1})},B=()=>{D({sortBy:p.value,page:1})},oe=C=>{E.value=C,P.value=!0},re=async()=>{if(E.value){M.value=E.value.id;try{const C=await w(E.value.id);W.value=!0,H.value="success",Z.value=`Tirage effectué avec succès ! Gagnant : ${C.winning_ticket?.user?.first_name} ${C.winning_ticket?.user?.last_name}`,P.value=!1,E.value=null,setTimeout(()=>{W.value=!1},5e3)}catch(C){console.error("Erreur lors du tirage:",C),W.value=!0,H.value="error",Z.value=C.response?.data?.error||"Erreur lors du tirage",setTimeout(()=>{W.value=!1},5e3)}finally{M.value=null}}};return Re(()=>c.value,C=>{D(C!=="all"?{status:C}:{status:null})}),ue(async()=>{try{await z()}catch(C){console.error("Erreur lors du chargement initial:",C),W.value=!0,H.value="error",Z.value="Erreur lors du chargement des tombolas",setTimeout(()=>{W.value=!1},5e3)}}),(C,n)=>{const q=ve("router-link");return o(),l("div",On,[e("div",Rn,[n[6]||(n[6]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Mes Tombolas"),e("p",{class:"mt-2 text-gray-600"},"Gérez vos tombolas et effectuez les tirages")],-1)),e("div",Nn,[f(q,{to:"/merchant/products/create",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700"},{default:ee(()=>n[5]||(n[5]=[T(" Nouvelle tombola ",-1)])),_:1,__:[5]})])]),e("div",qn,[e("div",Bn,[e("div",Gn,[e("div",Jn,[n[7]||(n[7]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),V(e("input",{"onUpdate:modelValue":n[0]||(n[0]=x=>j.value=x),onInput:m,type:"text",placeholder:"Rechercher par numéro, nom ou description...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},null,544),[[R,j.value]])])]),e("div",Wn,[V(e("select",{"onUpdate:modelValue":n[1]||(n[1]=x=>p.value=x),onChange:B,class:"block w-full px-3 py-2 border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"},n[8]||(n[8]=[ge('<option value="end_date_asc">Date de fin (croissant)</option><option value="end_date_desc">Date de fin (décroissant)</option><option value="popularity">Popularité</option><option value="ticket_price_asc">Prix ticket (croissant)</option><option value="ticket_price_desc">Prix ticket (décroissant)</option>',5)]),544),[[le,p.value]])])])]),e("div",Hn,[e("div",Xn,[e("div",Qn,s(u(I).total),1),n[9]||(n[9]=e("div",{class:"text-sm text-gray-600"},"Total",-1))]),e("div",Zn,[e("div",Kn,s(u(I).active),1),n[10]||(n[10]=e("div",{class:"text-sm text-gray-600"},"Actives",-1))]),e("div",Yn,[e("div",ei,s(u(I).pending),1),n[11]||(n[11]=e("div",{class:"text-sm text-gray-600"},"En attente",-1))]),e("div",ti,[e("div",si,s(u(I).completed),1),n[12]||(n[12]=e("div",{class:"text-sm text-gray-600"},"Terminées",-1))]),e("div",oi,[e("div",ri,s(u(I).cancelled),1),n[13]||(n[13]=e("div",{class:"text-sm text-gray-600"},"Annulées",-1))])]),e("div",li,[e("nav",ai,[(o(!0),l(G,null,J(u(g),x=>(o(),l("button",{key:x.key,onClick:K=>X(x.key),class:N(["py-2 px-1 border-b-2 font-medium text-sm",c.value===x.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[T(s(x.label)+" ",1),x.count!==null?(o(),l("span",ii,s(x.count),1)):$("",!0)],10,ni))),128))])]),u(v)?(o(),l("div",di,[e("div",ui,[n[14]||(n[14]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",ci,[e("p",mi,s(u(v)),1)])])])):$("",!0),e("div",pi,[e("div",gi,[u(h)?(o(),l("div",xi,n[15]||(n[15]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement des tombolas...",-1)]))):u(U).length===0?(o(),l("div",bi,[n[17]||(n[17]=e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),n[18]||(n[18]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Aucune tombola",-1)),n[19]||(n[19]=e("p",{class:"text-gray-600 mb-4"},"Vous n'avez pas encore créé de tombolas.",-1)),f(q,{to:"/merchant/products/create",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700"},{default:ee(()=>n[16]||(n[16]=[T(" Créer ma première tombola ",-1)])),_:1,__:[16]})])):(o(),l("div",fi,[e("div",vi,[(o(!0),l(G,null,J(u(U),x=>(o(),l("div",{key:x.id,class:"border rounded-lg overflow-hidden hover:shadow-lg transition-shadow"},[e("div",yi,[f($e,{src:x.product?.main_image||x.product?.image_url||x.product?.image,alt:x.product?.name,"container-class":"h-48 w-full","image-class":"w-full h-full object-cover","fallback-class":"h-48 w-full","fallback-text":"Photo"},null,8,["src","alt"]),e("div",_i,[e("span",{class:N(["px-2 py-1 text-xs font-medium rounded-full",u(i)(x.status).class])},s(u(i)(x.status).label),3)])]),e("div",hi,[e("div",wi,[e("h4",$i,s(x.product?.name||"Produit sans nom"),1),e("span",ki,"#"+s(x.lottery_number),1)]),e("p",Ci,s(x.product?.description),1),e("div",Pi,[e("div",ji,[n[20]||(n[20]=e("span",{class:"text-gray-600"},"Prix du ticket:",-1)),e("span",Fi,s(x.ticket_price)+" XAF",1)]),e("div",Di,[n[21]||(n[21]=e("span",{class:"text-gray-600"},"Tickets vendus:",-1)),e("span",Mi,s(x.sold_tickets||0)+"/"+s(x.total_tickets),1)]),e("div",Ei,[n[22]||(n[22]=e("span",{class:"text-gray-600"},"Temps restant:",-1)),e("span",{class:N(["font-medium",{"text-red-600":u(k)(x.end_date)==="Terminée"}])},s(u(k)(x.end_date)),3)]),e("div",Si,[e("div",{class:"bg-blue-600 h-2 rounded-full",style:fe({width:`${Math.min((x.sold_tickets||0)/x.total_tickets*100,100)}%`})},null,4)])]),e("div",Ti,[f(q,{to:{name:"merchant.lottery.view",params:{id:x.id}},class:"flex-1 text-center px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-100 transition-colors"},{default:ee(()=>n[23]||(n[23]=[T(" Détails ",-1)])),_:2,__:[23]},1032,["to"]),u(F)(x)?(o(),l("button",{key:0,onClick:K=>oe(x),disabled:M.value===x.id,class:"flex-1 px-3 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 transition-colors"},s(M.value===x.id?"Tirage...":"Effectuer le tirage"),9,Ai)):$("",!0)])])]))),128))]),u(A).last_page>1?(o(),l("div",Vi,[e("div",Li," Page "+s(u(A).current_page)+" sur "+s(u(A).last_page)+" ("+s(u(A).total)+" résultats) ",1),e("div",zi,[e("button",{onClick:n[2]||(n[2]=x=>u(_)(u(A).current_page-1)),disabled:u(A).current_page<=1,class:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-100 disabled:bg-gray-100 disabled:cursor-not-allowed"}," Précédent ",8,Ui),e("button",{onClick:n[3]||(n[3]=x=>u(_)(u(A).current_page+1)),disabled:u(A).current_page>=u(A).last_page,class:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-100 disabled:bg-gray-100 disabled:cursor-not-allowed"}," Suivant ",8,Ii)])])):$("",!0)]))])]),P.value?(o(),l("div",Oi,[e("div",Ri,[n[26]||(n[26]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Confirmer le tirage",-1)),e("p",Ni,[n[24]||(n[24]=T(" Êtes-vous sûr de vouloir effectuer le tirage pour la tombola ",-1)),e("strong",null,s(E.value?.product?.name),1),n[25]||(n[25]=T(" ? Cette action est irréversible. ",-1))]),e("div",qi,[e("button",{onClick:n[4]||(n[4]=x=>P.value=!1),class:"px-4 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-100"}," Annuler "),e("button",{onClick:re,disabled:M.value,class:"px-4 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400"},s(M.value?"Tirage...":"Confirmer le tirage"),9,Bi)])])])):$("",!0),W.value?(o(),l("div",Gi,[e("div",{class:N(["rounded-md p-4 shadow-lg",H.value==="success"?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"])},[e("div",Ji,[e("div",Wi,[H.value==="success"?(o(),l("svg",Hi,n[27]||(n[27]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(o(),l("svg",Xi,n[28]||(n[28]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)])))]),e("div",Qi,[e("p",{class:N(["text-sm",H.value==="success"?"text-green-800":"text-red-800"])},s(Z.value),3)])])],2)])):$("",!0)])}}},em=Object.freeze(Object.defineProperty({__proto__:null,default:Zi},Symbol.toStringTag,{value:"Module"})),Ki={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Yi={__name:"LotteryDrawModal",props:{show:{type:Boolean,default:!1},lottery:{type:Object,default:()=>({})}},emits:["close","confirm"],setup(te,{emit:U}){const I=te,g=U,A=()=>{g("close")},h=()=>{g("confirm",I.lottery)};return(v,z)=>te.show?(o(),l("div",Ki,[e("div",{class:"flex items-center justify-center min-h-screen px-4 text-center sm:block sm:p-0"},[e("div",{class:"fixed inset-0 bg-black/20 transition-opacity",onClick:A}),e("div",{class:"koumbaya-card inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle bg-white shadow-xl transform transition-all"},[z[0]||(z[0]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Lancer le tirage")],-1)),z[1]||(z[1]=e("div",{class:"koumbaya-card-body"},[e("p",{class:"koumbaya-text-body"}," Êtes-vous sûr de vouloir lancer le tirage pour cette tombola ? Cette action est irréversible. ")],-1)),e("div",{class:"koumbaya-card-footer"},[e("div",{class:"flex gap-4"},[e("button",{onClick:A,class:"koumbaya-btn koumbaya-btn-outline flex-1"}," Annuler "),e("button",{onClick:h,class:"koumbaya-btn koumbaya-btn-primary flex-1"}," Confirmer ")])])])])])):$("",!0)}},ed={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},td={class:"flex items-center justify-center min-h-screen px-4 text-center"},sd={class:"koumbaya-card inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle bg-white shadow-xl transform transition-all"},od={class:"koumbaya-form-group"},rd={class:"koumbaya-form-group"},ld={__name:"LotteryExtendModal",props:{show:{type:Boolean,default:!1},lottery:{type:Object,default:()=>({})}},emits:["close","submit"],setup(te,{emit:U}){const I=te,g=U,A=ae({newDrawDate:"",reason:""}),h=()=>{g("close")},v=()=>{g("submit",{lotteryId:I.lottery.id,...A})};return(z,w)=>te.show?(o(),l("div",ed,[e("div",td,[e("div",{class:"fixed inset-0 bg-black/20 transition-opacity",onClick:h}),e("div",sd,[w[5]||(w[5]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Prolonger la tombola")],-1)),e("form",{onSubmit:de(v,["prevent"]),class:"koumbaya-card-body space-y-4"},[e("div",od,[w[2]||(w[2]=e("label",{class:"koumbaya-label"},"Nouvelle date de tirage",-1)),V(e("input",{"onUpdate:modelValue":w[0]||(w[0]=D=>A.newDrawDate=D),type:"datetime-local",required:"",class:"koumbaya-input"},null,512),[[R,A.newDrawDate]])]),e("div",rd,[w[3]||(w[3]=e("label",{class:"koumbaya-label"},"Raison de la prolongation",-1)),V(e("textarea",{"onUpdate:modelValue":w[1]||(w[1]=D=>A.reason=D),rows:"3",class:"koumbaya-input",placeholder:"Expliquez pourquoi vous prolongez cette tombola...",required:""},null,512),[[R,A.reason]])]),e("div",{class:"koumbaya-card-footer"},[e("div",{class:"flex gap-4"},[e("button",{type:"button",onClick:h,class:"koumbaya-btn koumbaya-btn-outline flex-1"}," Annuler "),w[4]||(w[4]=e("button",{type:"submit",class:"koumbaya-btn koumbaya-btn-primary flex-1"}," Prolonger ",-1))])])],32)])])])):$("",!0)}},ad={class:"space-y-6"},nd={class:"flex justify-between items-start"},id={class:"flex items-center space-x-3 mb-2"},dd={class:"text-3xl font-bold text-gray-900"},ud={class:"flex space-x-3"},cd={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},md={class:"bg-white p-6 rounded-xl shadow-sm border"},pd={class:"flex items-center"},gd={class:"p-3 bg-blue-100 rounded-lg"},xd={class:"ml-4"},bd={class:"text-2xl font-bold text-gray-900"},fd={class:"bg-white p-6 rounded-xl shadow-sm border"},vd={class:"flex items-center"},yd={class:"p-3 bg-blue-100 rounded-lg"},_d={class:"ml-4"},hd={class:"text-2xl font-bold text-gray-900"},wd={class:"bg-white p-6 rounded-xl shadow-sm border"},$d={class:"flex items-center"},kd={class:"p-3 bg-purple-100 rounded-lg"},Cd={class:"ml-4"},Pd={class:"text-2xl font-bold text-gray-900"},jd={class:"bg-white p-6 rounded-xl shadow-sm border"},Fd={class:"flex items-center"},Dd={class:"p-3 bg-yellow-100 rounded-lg"},Md={class:"ml-4"},Ed={class:"text-2xl font-bold text-gray-900"},Sd={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Td={class:"lg:col-span-2 space-y-6"},Ad={class:"bg-white rounded-xl shadow-sm border overflow-hidden"},Vd={class:"p-6"},Ld={class:"flex space-x-6"},zd={class:"flex-shrink-0"},Ud=["src","alt"],Id={class:"flex-1"},Od={class:"text-xl font-semibold text-gray-900 mb-2"},Rd={class:"text-gray-600 mb-4"},Nd={class:"grid grid-cols-2 gap-4"},qd={class:"text-lg font-semibold text-gray-900"},Bd={class:"text-lg font-semibold text-gray-900"},Gd={class:"text-lg font-semibold text-gray-900"},Jd={class:"text-lg font-semibold text-gray-900"},Wd={class:"bg-white rounded-xl shadow-sm border"},Hd={class:"p-6"},Xd={class:"space-y-4"},Qd={class:"flex justify-between items-center mb-2"},Zd={class:"text-sm text-gray-500"},Kd={class:"w-full bg-gray-200 rounded-full h-2"},Yd={key:0},eu={class:"flex justify-between items-center mb-2"},tu={class:"text-sm text-gray-500"},su={class:"w-full bg-gray-200 rounded-full h-2"},ou={class:"mt-6 grid grid-cols-3 gap-4 text-center"},ru={class:"p-4 bg-blue-50 rounded-lg"},lu={class:"text-2xl font-bold text-blue-600"},au={class:"p-4 bg-blue-50 rounded-lg"},nu={class:"text-2xl font-bold text-blue-600"},iu={class:"p-4 bg-yellow-50 rounded-lg"},du={class:"text-2xl font-bold text-yellow-600"},uu={key:0,class:"bg-white rounded-xl shadow-sm border"},cu={class:"px-6 py-4 border-b border-gray-200"},mu={class:"text-lg font-semibold text-gray-900 flex items-center"},pu={class:"p-6"},gu={class:"flex items-center space-x-4"},xu={class:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center"},bu={class:"font-semibold text-gray-900"},fu={class:"text-sm text-gray-600"},vu={class:"space-y-6"},yu={class:"bg-white rounded-xl shadow-sm border"},_u={class:"p-6 space-y-3"},hu={class:"bg-white rounded-xl shadow-sm border"},wu={class:"px-6 py-4 border-b border-gray-200"},$u={class:"flex justify-between items-center"},ku={class:"p-6"},Cu={class:"space-y-3"},Pu={class:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center"},ju={class:"text-sm font-medium text-gray-600"},Fu={class:"flex-1 min-w-0"},Du={class:"text-sm font-medium text-gray-900 truncate"},Mu={class:"text-xs text-gray-500"},Eu={class:"text-sm text-gray-500"},Su={class:"bg-white rounded-xl shadow-sm border"},Tu={class:"p-6"},Au={class:"space-y-4"},Vu={class:"flex justify-between"},Lu={class:"text-sm font-medium text-gray-900"},zu={class:"flex justify-between"},Uu={class:"text-sm font-medium text-gray-900"},Iu={class:"flex justify-between"},Ou={class:"text-sm font-medium text-gray-900"},Ru={class:"flex justify-between"},Nu={class:"text-sm font-medium text-blue-600"},qu={__name:"LotteryView",setup(te){const U=Oe(),{get:I}=me(),g=L({id:U.params.id,title:"iPhone 15 Pro Max 256GB",description:"Tentez de gagner le dernier iPhone 15 Pro Max dans sa version 256GB, couleur Titane Naturel. Un smartphone révolutionnaire avec une caméra professionnelle.",status:"active",product_value:1599e3,ticket_price:5e3,category:"Électronique",participants_count:156,tickets_sold:203,total_revenue:1015e3,max_participants:300,revenue_target:15e5,end_date:"2024-12-25T23:59:59",created_at:"2024-11-01T10:00:00",views_count:1250,product_image:"/images/products/iphone-15-pro.jpg",winner:null,draw_date:null}),A=L([{id:1,name:"Jean Dupont",participated_at:"2024-11-15T14:30:00",tickets_count:2},{id:2,name:"Marie Martin",participated_at:"2024-11-15T13:45:00",tickets_count:1},{id:3,name:"Paul Durant",participated_at:"2024-11-15T12:20:00",tickets_count:3},{id:4,name:"Sophie Leroy",participated_at:"2024-11-15T11:15:00",tickets_count:1},{id:5,name:"Pierre Moreau",participated_at:"2024-11-15T10:30:00",tickets_count:2}]),h=L(!1),v=L(!1),z=L(!1),w=Q(()=>g.value.max_participants?Math.min(g.value.participants_count/g.value.max_participants*100,100):0),D=Q(()=>g.value.revenue_target?Math.min(g.value.total_revenue/g.value.revenue_target*100,100):0),a=Q(()=>!g.value.views_count||g.value.views_count===0?0:(g.value.participants_count/g.value.views_count*100).toFixed(1)),_=Q(()=>g.value.participants_count===0?0:g.value.total_revenue/g.value.participants_count),F=Q(()=>{const O=g.value.product_value;return((g.value.total_revenue-O)/O*100).toFixed(1)}),i=Q(()=>{const O=new Date,X=new Date(g.value.end_date)-O;if(X<=0)return"Terminée";const B=Math.floor(X/(1e3*60*60*24)),oe=Math.floor(X%(1e3*60*60*24)/(1e3*60*60));return B>0?`${B}j ${oe}h`:`${oe}h`}),k=Q(()=>{const O=new Date,X=new Date(g.value.end_date)-O;return X<=0?0:Math.ceil(X/(1e3*60*60*24))}),c=Q(()=>g.value.participants_count>=10),j=O=>({active:"Active",completed:"Terminée",pending:"En attente",paused:"En pause",cancelled:"Annulée"})[O]||O,p=O=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(O||0)+" FCFA",P=O=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(O)),E=()=>{window.$toast&&window.$toast.info("Fonctionnalité de téléchargement en cours de développement","🚀 En développement")},M=()=>{window.$toast&&window.$toast.info("Mise en pause de la tombola...","⏸️ Pause")},W=()=>{h.value=!1,H()},Z=()=>{v.value=!1,H()},H=async()=>{try{const O=await I(`/merchant/lotteries/${U.params.id}`);O?.data&&(g.value={...g.value,...O.data})}catch(O){console.error("Erreur lors du chargement de la tombola:",O)}};return ue(()=>{H()}),(O,m)=>{const X=ve("router-link");return o(),l("div",ad,[e("div",nd,[e("div",null,[e("div",id,[f(X,{to:"/merchant/lotteries",class:"text-gray-500 hover:text-gray-700"},{default:ee(()=>[f(u(xe),{class:"w-5 h-5"})]),_:1}),e("h1",dd,s(g.value.title),1),e("span",{class:N(["px-3 py-1 rounded-full text-sm font-medium",g.value.status==="active"||g.value.status==="completed"?"bg-blue-100 text-blue-800":g.value.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},s(j(g.value.status)),3)]),m[6]||(m[6]=e("p",{class:"text-gray-600"},"Gérez votre tombola et suivez les participations",-1))]),e("div",ud,[g.value.status==="active"?(o(),l("button",{key:0,onClick:m[0]||(m[0]=B=>v.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center"},[f(u(qe),{class:"w-4 h-4 mr-2"}),m[7]||(m[7]=T(" Prolonger ",-1))])):$("",!0),g.value.status==="active"&&c.value?(o(),l("button",{key:1,onClick:m[1]||(m[1]=B=>h.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center"},[f(u(be),{class:"w-4 h-4 mr-2"}),m[8]||(m[8]=T(" Effectuer le tirage ",-1))])):$("",!0),e("button",{onClick:m[2]||(m[2]=B=>z.value=!0),class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 flex items-center"},[f(u(Ie),{class:"w-4 h-4 mr-2"}),m[9]||(m[9]=T(" Modifier ",-1))])])]),e("div",cd,[e("div",md,[e("div",pd,[e("div",gd,[f(u(Ve),{class:"w-6 h-6 text-blue-600"})]),e("div",xd,[m[10]||(m[10]=e("p",{class:"text-sm font-medium text-gray-600"},"Participants",-1)),e("p",bd,s(g.value.participants_count),1)])])]),e("div",fd,[e("div",vd,[e("div",yd,[f(u(he),{class:"w-6 h-6 text-blue-600"})]),e("div",_d,[m[11]||(m[11]=e("p",{class:"text-sm font-medium text-gray-600"},"Revenus générés",-1)),e("p",hd,s(p(g.value.total_revenue)),1)])])]),e("div",wd,[e("div",$d,[e("div",kd,[f(u(st),{class:"w-6 h-6 text-purple-600"})]),e("div",Cd,[m[12]||(m[12]=e("p",{class:"text-sm font-medium text-gray-600"},"Tickets vendus",-1)),e("p",Pd,s(g.value.tickets_sold),1)])])]),e("div",jd,[e("div",Fd,[e("div",Dd,[f(u(ot),{class:"w-6 h-6 text-yellow-600"})]),e("div",Md,[m[13]||(m[13]=e("p",{class:"text-sm font-medium text-gray-600"},"Temps restant",-1)),e("p",Ed,s(i.value),1)])])])]),e("div",Sd,[e("div",Td,[e("div",Ad,[m[18]||(m[18]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Informations du produit")],-1)),e("div",Vd,[e("div",Ld,[e("div",zd,[e("img",{src:g.value.product_image||"/images/products/placeholder.jpg",alt:g.value.title,class:"w-32 h-32 object-cover rounded-lg"},null,8,Ud)]),e("div",Id,[e("h4",Od,s(g.value.title),1),e("p",Rd,s(g.value.description),1),e("div",Nd,[e("div",null,[m[14]||(m[14]=e("p",{class:"text-sm font-medium text-gray-500"},"Valeur du produit",-1)),e("p",qd,s(p(g.value.product_value)),1)]),e("div",null,[m[15]||(m[15]=e("p",{class:"text-sm font-medium text-gray-500"},"Prix du ticket",-1)),e("p",Bd,s(p(g.value.ticket_price)),1)]),e("div",null,[m[16]||(m[16]=e("p",{class:"text-sm font-medium text-gray-500"},"Catégorie",-1)),e("p",Gd,s(g.value.category?.name||g.value.category||"Sans catégorie"),1)]),e("div",null,[m[17]||(m[17]=e("p",{class:"text-sm font-medium text-gray-500"},"Date de fin",-1)),e("p",Jd,s(P(g.value.end_date)),1)])])])])])]),e("div",Wd,[m[24]||(m[24]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Progression")],-1)),e("div",Hd,[e("div",Xd,[e("div",null,[e("div",Qd,[m[19]||(m[19]=e("span",{class:"text-sm font-medium text-gray-700"},"Objectif de participation",-1)),e("span",Zd,s(g.value.participants_count)+" / "+s(g.value.max_participants||"∞"),1)]),e("div",Kd,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:fe({width:w.value+"%"})},null,4)])]),g.value.revenue_target?(o(),l("div",Yd,[e("div",eu,[m[20]||(m[20]=e("span",{class:"text-sm font-medium text-gray-700"},"Objectif de revenus",-1)),e("span",tu,s(p(g.value.total_revenue))+" / "+s(p(g.value.revenue_target)),1)]),e("div",su,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:fe({width:D.value+"%"})},null,4)])])):$("",!0)]),e("div",ou,[e("div",ru,[e("p",lu,s(w.value)+"%",1),m[21]||(m[21]=e("p",{class:"text-sm text-blue-600"},"Participation",-1))]),e("div",au,[e("p",nu,s(a.value)+"%",1),m[22]||(m[22]=e("p",{class:"text-sm text-blue-600"},"Conversion",-1))]),e("div",iu,[e("p",du,s(k.value),1),m[23]||(m[23]=e("p",{class:"text-sm text-yellow-600"},"Jours restants",-1))])])])]),g.value.winner?(o(),l("div",uu,[e("div",cu,[e("h3",mu,[f(u(rt),{class:"w-5 h-5 text-yellow-500 mr-2"}),m[25]||(m[25]=T(" Gagnant ",-1))])]),e("div",pu,[e("div",gu,[e("div",xu,[f(u(Te),{class:"w-6 h-6 text-yellow-600"})]),e("div",null,[e("p",bu,s(g.value.winner.name),1),e("p",fu,"Tirage effectué le "+s(P(g.value.draw_date)),1)])]),m[26]||(m[26]=e("div",{class:"mt-4 p-4 bg-yellow-50 rounded-lg"},[e("p",{class:"text-sm text-yellow-800"}," Félicitations ! Le gagnant a été contacté automatiquement par email. ")],-1))])])):$("",!0)]),e("div",vu,[e("div",yu,[m[30]||(m[30]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Actions rapides")],-1)),e("div",_u,[e("button",{onClick:m[3]||(m[3]=(...B)=>O.shareLottery&&O.shareLottery(...B)),class:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},[f(u(lt),{class:"w-4 h-4 mr-2"}),m[27]||(m[27]=T(" Partager la tombola ",-1))]),e("button",{onClick:E,class:"w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},[f(u(Ne),{class:"w-4 h-4 mr-2"}),m[28]||(m[28]=T(" Télécharger le rapport ",-1))]),g.value.status==="active"?(o(),l("button",{key:0,onClick:M,class:"w-full flex items-center justify-center px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"},[f(u(at),{class:"w-4 h-4 mr-2"}),m[29]||(m[29]=T(" Mettre en pause ",-1))])):$("",!0)])]),e("div",hu,[e("div",wu,[e("div",$u,[m[32]||(m[32]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Participants récents",-1)),f(X,{to:`/merchant/lotteries/${g.value.id}/participants`,class:"text-sm text-blue-600 hover:text-blue-700"},{default:ee(()=>m[31]||(m[31]=[T(" Voir tout ",-1)])),_:1,__:[31]},8,["to"])])]),e("div",ku,[e("div",Cu,[(o(!0),l(G,null,J(A.value,B=>(o(),l("div",{key:B.id,class:"flex items-center space-x-3"},[e("div",Pu,[e("span",ju,s(B.name.charAt(0)),1)]),e("div",Fu,[e("p",Du,s(B.name),1),e("p",Mu,s(P(B.participated_at)),1)]),e("div",Eu,s(B.tickets_count)+" ticket"+s(B.tickets_count>1?"s":""),1)]))),128))])])]),e("div",Su,[m[37]||(m[37]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Statistiques")],-1)),e("div",Tu,[e("div",Au,[e("div",Vu,[m[33]||(m[33]=e("span",{class:"text-sm text-gray-600"},"Vues de la tombola",-1)),e("span",Lu,s(g.value.views_count||"N/A"),1)]),e("div",zu,[m[34]||(m[34]=e("span",{class:"text-sm text-gray-600"},"Taux de conversion",-1)),e("span",Uu,s(a.value)+"%",1)]),e("div",Iu,[m[35]||(m[35]=e("span",{class:"text-sm text-gray-600"},"Panier moyen",-1)),e("span",Ou,s(p(_.value)),1)]),e("div",Ru,[m[36]||(m[36]=e("span",{class:"text-sm text-gray-600"},"Retour sur investissement",-1)),e("span",Nu,"+"+s(F.value)+"%",1)])])])])])]),h.value?(o(),se(Yi,{key:0,lottery:g.value,onClose:m[4]||(m[4]=B=>h.value=!1),onDrawn:W},null,8,["lottery"])):$("",!0),v.value?(o(),se(ld,{key:1,lottery:g.value,onClose:m[5]||(m[5]=B=>v.value=!1),onExtended:Z},null,8,["lottery"])):$("",!0)])}}},tm=Object.freeze(Object.defineProperty({__proto__:null,default:qu},Symbol.toStringTag,{value:"Module"})),Bu={class:"px-6"},Gu={class:"mb-6"},Ju={class:"bg-white rounded-lg shadow p-4"},Wu={class:"flex flex-col sm:flex-row gap-4"},Hu={class:"flex-1"},Xu={key:0,class:"flex gap-4"},Qu={class:"flex items-end"},Zu=["disabled"],Ku={key:0},Yu={key:1},ec={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},tc={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},sc={class:"koumbaya-card"},oc={class:"koumbaya-card-body"},rc={key:0,class:"h-64 bg-gradient-to-br from-blue-50 to-blue-50 rounded-lg flex items-center justify-center"},lc={key:1,class:"h-64"},ac={class:"h-full flex items-end justify-between space-x-2 p-4"},nc={class:"text-xs text-gray-600 mt-2"},ic={class:"text-xs font-medium text-gray-900"},dc={key:2,class:"h-64 bg-gradient-to-br from-blue-50 to-blue-50 rounded-lg flex items-center justify-center"},uc={class:"text-center"},cc={class:"koumbaya-card"},mc={class:"koumbaya-card-body"},pc={key:0,class:"h-64 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg flex items-center justify-center"},gc={key:1,class:"h-64 overflow-y-auto"},xc={class:"space-y-3"},bc={class:"font-medium text-gray-900"},fc={class:"text-sm text-gray-600"},vc={class:"text-right"},yc={class:"font-medium text-gray-900"},_c={key:2,class:"h-64 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg flex items-center justify-center"},hc={class:"text-center"},wc={class:"koumbaya-card"},$c={class:"koumbaya-card-body"},kc={key:0,class:"flex justify-center items-center h-32"},Cc={key:1,class:"overflow-x-auto"},Pc={class:"min-w-full divide-y divide-gray-200"},jc={class:"bg-white divide-y divide-gray-200"},Fc={class:"px-6 py-4 whitespace-nowrap"},Dc={class:"flex items-center"},Mc={class:"flex-shrink-0 h-10 w-10"},Ec=["src","alt"],Sc={class:"ml-4"},Tc={class:"text-sm font-medium text-gray-900"},Ac={class:"text-sm text-gray-500"},Vc={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},Lc={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},zc={class:"px-6 py-4 whitespace-nowrap"},Uc={class:"flex items-center"},Ic={key:3,class:"text-sm text-gray-500"},Oc={key:2,class:"text-center py-8"},Rc={__name:"Analytics",setup(te){const{loading:U,get:I}=me(),g=L({}),A=L([]),h=L([]),v=L([]),z=L("this_month"),w=L(""),D=L(""),a=Q(()=>{const P={period:z.value};return z.value==="custom"&&(w.value&&(P.start_date=w.value),D.value&&(P.end_date=D.value)),P}),_=async()=>{try{await Promise.all([F(),i(),k(),c()])}catch(P){console.error("Erreur lors du chargement des analytics:",P)}},F=async()=>{try{const P=await I("/merchant/dashboard/stats",{params:a.value});g.value=P}catch(P){console.error("Erreur lors du chargement des stats:",P),g.value={}}},i=async()=>{try{const P=await I("/merchant/dashboard/sales-chart",{params:a.value});A.value=P.data||[]}catch(P){console.error("Erreur lors du chargement du graphique des ventes:",P),A.value=[]}},k=async()=>{try{const P=await I("/merchant/dashboard/top-products",{params:a.value});h.value=P.data||[]}catch(P){console.error("Erreur lors du chargement des top produits:",P),h.value=[]}},c=async()=>{try{const P=await I("/merchant/dashboard/lottery-performance",{params:a.value});v.value=P.data||[]}catch(P){console.error("Erreur lors du chargement de la performance des tombolas:",P),v.value=[]}},j=P=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(P||0).replace("XAF","FCFA"),p=P=>P?new Date(P).toLocaleDateString("fr-FR",{month:"short",day:"numeric"}):"";return ue(()=>{_()}),(P,E)=>(o(),l("div",Bu,[E[17]||(E[17]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Analytiques"),e("p",{class:"mt-2 text-gray-600"},"Analyse de vos performances de vente")],-1)),e("div",Gu,[e("div",Ju,[e("div",Wu,[e("div",Hu,[E[4]||(E[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Période",-1)),V(e("select",{"onUpdate:modelValue":E[0]||(E[0]=M=>z.value=M),onChange:_,class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},E[3]||(E[3]=[ge('<option value="today">Aujourd&#39;hui</option><option value="yesterday">Hier</option><option value="this_week">Cette semaine</option><option value="last_week">Semaine dernière</option><option value="this_month">Ce mois</option><option value="last_month">Mois dernier</option><option value="this_year">Cette année</option><option value="custom">Période personnalisée</option>',8)]),544),[[le,z.value]])]),z.value==="custom"?(o(),l("div",Xu,[e("div",null,[E[5]||(E[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date début",-1)),V(e("input",{"onUpdate:modelValue":E[1]||(E[1]=M=>w.value=M),onChange:_,type:"date",class:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,544),[[R,w.value]])]),e("div",null,[E[6]||(E[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date fin",-1)),V(e("input",{"onUpdate:modelValue":E[2]||(E[2]=M=>D.value=M),onChange:_,type:"date",class:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,544),[[R,D.value]])])])):$("",!0),e("div",Qu,[e("button",{onClick:_,disabled:u(U),class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"},[u(U)?(o(),l("span",Ku,"Chargement...")):(o(),l("span",Yu,"Actualiser"))],8,Zu)])])])]),e("div",ec,[f(we,{title:"Revenus Totaux",value:g.value.total_revenue||0,format:"currency",change:g.value.revenue_change||0,color:"green",icon:u(he),loading:u(U),actions:[{label:"Détails",primary:!0}]},null,8,["value","change","icon","loading"]),f(we,{title:"Ventes ce mois",value:g.value.monthly_sales||0,change:g.value.sales_change||0,color:"blue",icon:u(nt),loading:u(U),"show-progress":!0,"progress-value":g.value.monthly_sales||0,"progress-target":g.value.sales_target||200},null,8,["value","change","icon","loading","progress-value","progress-target"]),f(we,{title:"Produits Actifs",value:g.value.active_products||0,change:g.value.products_change||0,color:"purple",icon:u(be),loading:u(U)},null,8,["value","change","icon","loading"]),f(we,{title:"Taux Conversion",value:g.value.conversion_rate||0,format:"percentage",change:g.value.conversion_change||0,color:"orange",icon:u(ye),loading:u(U)},null,8,["value","change","icon","loading"])]),e("div",tc,[e("div",sc,[E[9]||(E[9]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Évolution des Ventes")],-1)),e("div",oc,[u(U)?(o(),l("div",rc,E[7]||(E[7]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e("p",{class:"text-gray-500"},"Chargement...")],-1)]))):A.value&&A.value.length>0?(o(),l("div",lc,[e("div",ac,[(o(!0),l(G,null,J(A.value.slice(-7),(M,W)=>(o(),l("div",{key:W,class:"flex-1 flex flex-col items-center"},[e("div",{class:"w-full bg-blue-200 rounded-t",style:fe({height:`${Math.max(10,M.sales/Math.max(...A.value.map(Z=>Z.sales))*180)}px`})},[e("div",{class:"w-full bg-blue-600 rounded-t",style:fe({height:`${Math.max(5,M.sales/Math.max(...A.value.map(Z=>Z.sales))*180)}px`})},null,4)],4),e("span",nc,s(p(M.date)),1),e("span",ic,s(M.sales),1)]))),128))])])):(o(),l("div",dc,[e("div",uc,[f(u(ye),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),E[8]||(E[8]=e("p",{class:"text-gray-500"},"Aucune donnée disponible",-1))])]))])]),e("div",cc,[E[12]||(E[12]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Performance des Tombolas")],-1)),e("div",mc,[u(U)?(o(),l("div",pc,E[10]||(E[10]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),e("p",{class:"text-gray-500"},"Chargement...")],-1)]))):v.value&&v.value.length>0?(o(),l("div",gc,[e("div",xc,[(o(!0),l(G,null,J(v.value.slice(0,5),M=>(o(),l("div",{key:M.id,class:"flex items-center justify-between p-3 bg-gray-100 rounded-lg"},[e("div",null,[e("h4",bc,s(M.name),1),e("p",fc,s(M.tickets_sold)+" tickets vendus",1)]),e("div",vc,[e("p",yc,s(j(M.revenue)),1),e("p",{class:N(["text-sm",M.performance_change>=0?"text-green-600":"text-red-600"])},s(M.performance_change>=0?"+":"")+s(M.performance_change)+"% ",3)])]))),128))])])):(o(),l("div",_c,[e("div",hc,[f(u(it),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),E[11]||(E[11]=e("p",{class:"text-gray-500"},"Aucune tombola disponible",-1))])]))])])]),e("div",wc,[E[16]||(E[16]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Top Produits")],-1)),e("div",$c,[u(U)?(o(),l("div",kc,E[13]||(E[13]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("span",{class:"ml-2 text-gray-600"},"Chargement des produits...",-1)]))):h.value&&h.value.length>0?(o(),l("div",Cc,[e("table",Pc,[E[14]||(E[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Produit "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ventes "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Revenus "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tendance ")])],-1)),e("tbody",jc,[(o(!0),l(G,null,J(h.value,M=>(o(),l("tr",{key:M.id},[e("td",Fc,[e("div",Dc,[e("div",Mc,[e("img",{src:M.image_url||M.main_image||M.image||"/images/products/placeholder.jpg",alt:M.name,class:"h-10 w-10 rounded-lg object-cover bg-gray-100"},null,8,Ec)]),e("div",Sc,[e("div",Tc,s(M.name),1),e("div",Ac,s(M.category?.name||M.category||"Sans catégorie"),1)])])]),e("td",Vc,s(M.sales_count||M.sales||0),1),e("td",Lc,s(j(M.total_revenue||M.revenue||0)),1),e("td",zc,[e("div",Uc,[(M.trend||M.performance_change||0)>0?(o(),se(u(dt),{key:0,class:"w-4 h-4 text-green-500 mr-1"})):(M.trend||M.performance_change||0)<0?(o(),se(u(ut),{key:1,class:"w-4 h-4 text-red-500 mr-1"})):$("",!0),(M.trend||M.performance_change||0)!==0?(o(),l("span",{key:2,class:N([(M.trend||M.performance_change||0)>0?"text-green-600":"text-red-600","text-sm font-medium"])},s(Math.abs(M.trend||M.performance_change||0))+"% ",3)):(o(),l("span",Ic,"-"))])])]))),128))])])])):(o(),l("div",Oc,[f(u(be),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),E[15]||(E[15]=e("p",{class:"text-gray-500"},"Aucun produit trouvé pour cette période",-1))]))])])]))}},sm=Object.freeze(Object.defineProperty({__proto__:null,default:Rc},Symbol.toStringTag,{value:"Module"})),Nc={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},qc={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},Bc={class:"lg:col-span-1"},Gc={class:"space-y-2"},Jc=["onClick"],Wc={class:"flex items-center"},Hc={class:"lg:col-span-2"},Xc={class:"bg-white rounded-xl shadow-sm border border-gray-200"},Qc={key:0,class:"p-6"},Zc={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Kc={key:1,class:"p-6"},Yc={class:"space-y-6"},e0={class:"bg-gray-50 rounded-lg p-4"},t0={key:2,class:"p-6"},s0={class:"space-y-6"},o0={class:"flex items-center justify-between"},r0={class:"relative inline-flex items-center cursor-pointer"},l0={class:"flex items-center justify-between"},a0={class:"relative inline-flex items-center cursor-pointer"},n0={__name:"Settings",setup(te){const U=Be(),{put:I}=me(),g=L("account"),A=[{id:"account",name:"Compte",icon:Te},{id:"security",name:"Sécurité",icon:ct},{id:"preferences",name:"Préférences",icon:mt}],h=ae({first_name:"",last_name:"",email:"",phone:""}),v=ae({current_password:"",new_password:"",confirm_password:""}),z=ae({email_notifications:!0,push_notifications:!1}),w=()=>{const F=U.user;F&&(h.first_name=F.first_name||"",h.last_name=F.last_name||"",h.email=F.email||"",h.phone=F.phone||"")},D=async()=>{try{await I("/user/profile",h),await U.refreshUser(),window.$toast&&window.$toast.success("Informations mises à jour avec succès","✅ Mise à jour")}catch(F){console.error("Erreur lors de la mise à jour:",F),window.$toast&&window.$toast.error("Erreur lors de la mise à jour","❌ Erreur")}},a=async()=>{if(v.new_password!==v.confirm_password){window.$toast&&window.$toast.error("Les mots de passe ne correspondent pas","❌ Validation");return}try{await I("/user/password",{current_password:v.current_password,new_password:v.new_password}),v.current_password="",v.new_password="",v.confirm_password="",window.$toast&&window.$toast.success("Mot de passe mis à jour avec succès","✅ Sécurité")}catch(F){console.error("Erreur lors du changement de mot de passe:",F),window.$toast&&window.$toast.error("Erreur lors du changement de mot de passe","❌ Erreur")}},_=async()=>{try{await I("/user/preferences",z),window.$toast&&window.$toast.success("Préférences sauvegardées avec succès","✅ Préférences")}catch(F){console.error("Erreur lors de la sauvegarde:",F),window.$toast&&window.$toast.error("Erreur lors de la sauvegarde des préférences","❌ Erreur")}};return ue(()=>{w()}),(F,i)=>(o(),l("div",Nc,[i[27]||(i[27]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Paramètres"),e("p",{class:"mt-2 text-gray-600"},"Gérez les paramètres de votre compte marchand")],-1)),e("div",qc,[e("div",Bc,[e("nav",Gc,[(o(),l(G,null,J(A,k=>e("button",{key:k.id,onClick:c=>g.value=k.id,class:N(["w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors",g.value===k.id?"bg-blue-100 text-blue-800 border border-blue-200":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"])},[e("div",Wc,[(o(),se(ce(k.icon),{class:"w-5 h-5 mr-3"})),T(" "+s(k.name),1)])],10,Jc)),64))])]),e("div",Hc,[e("div",Xc,[g.value==="account"?(o(),l("div",Qc,[i[14]||(i[14]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-6"},"Informations du compte",-1)),e("form",{onSubmit:de(D,["prevent"]),class:"space-y-6"},[e("div",Zc,[e("div",null,[i[9]||(i[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prénom",-1)),V(e("input",{"onUpdate:modelValue":i[0]||(i[0]=k=>h.first_name=k),type:"text",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"}},null,512),[[R,h.first_name]])]),e("div",null,[i[10]||(i[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom",-1)),V(e("input",{"onUpdate:modelValue":i[1]||(i[1]=k=>h.last_name=k),type:"text",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"}},null,512),[[R,h.last_name]])])]),e("div",null,[i[11]||(i[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email",-1)),V(e("input",{"onUpdate:modelValue":i[2]||(i[2]=k=>h.email=k),type:"email",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"}},null,512),[[R,h.email]])]),e("div",null,[i[12]||(i[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Téléphone",-1)),f(Ge,{modelValue:h.phone,"onUpdate:modelValue":i[3]||(i[3]=k=>h.phone=k),placeholder:"Numéro de téléphone","initial-country":"ga"},null,8,["modelValue"])]),i[13]||(i[13]=e("div",{class:"flex justify-end"},[e("button",{type:"submit",class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"}," Sauvegarder ")],-1))],32)])):$("",!0),g.value==="security"?(o(),l("div",Kc,[i[21]||(i[21]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-6"},"Sécurité",-1)),e("div",Yc,[e("div",e0,[i[19]||(i[19]=e("h4",{class:"font-medium text-gray-900 mb-2"},"Changer le mot de passe",-1)),i[20]||(i[20]=e("p",{class:"text-sm text-gray-600 mb-4"},"Assurez-vous d'utiliser un mot de passe fort et unique.",-1)),e("form",{onSubmit:de(a,["prevent"]),class:"space-y-4"},[e("div",null,[i[15]||(i[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mot de passe actuel",-1)),V(e("input",{"onUpdate:modelValue":i[4]||(i[4]=k=>v.current_password=k),type:"password",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"}},null,512),[[R,v.current_password]])]),e("div",null,[i[16]||(i[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nouveau mot de passe",-1)),V(e("input",{"onUpdate:modelValue":i[5]||(i[5]=k=>v.new_password=k),type:"password",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"}},null,512),[[R,v.new_password]])]),e("div",null,[i[17]||(i[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Confirmer le nouveau mot de passe",-1)),V(e("input",{"onUpdate:modelValue":i[6]||(i[6]=k=>v.confirm_password=k),type:"password",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"}},null,512),[[R,v.confirm_password]])]),i[18]||(i[18]=e("div",{class:"flex justify-end"},[e("button",{type:"submit",class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors"}," Mettre à jour le mot de passe ")],-1))],32)])])])):$("",!0),g.value==="preferences"?(o(),l("div",t0,[i[26]||(i[26]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-6"},"Préférences",-1)),e("div",s0,[e("div",o0,[i[23]||(i[23]=e("div",null,[e("h4",{class:"font-medium text-gray-900"},"Notifications par email"),e("p",{class:"text-sm text-gray-600"},"Recevoir des notifications pour les nouvelles commandes")],-1)),e("label",r0,[V(e("input",{"onUpdate:modelValue":i[7]||(i[7]=k=>z.email_notifications=k),type:"checkbox",class:"sr-only peer"},null,512),[[Fe,z.email_notifications]]),i[22]||(i[22]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"},null,-1))])]),e("div",l0,[i[25]||(i[25]=e("div",null,[e("h4",{class:"font-medium text-gray-900"},"Notifications push"),e("p",{class:"text-sm text-gray-600"},"Recevoir des notifications en temps réel")],-1)),e("label",a0,[V(e("input",{"onUpdate:modelValue":i[8]||(i[8]=k=>z.push_notifications=k),type:"checkbox",class:"sr-only peer"},null,512),[[Fe,z.push_notifications]]),i[24]||(i[24]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"},null,-1))])])]),e("div",{class:"mt-8 flex justify-end"},[e("button",{onClick:_,class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"}," Sauvegarder les préférences ")])])):$("",!0)])])])]))}},om=Object.freeze(Object.defineProperty({__proto__:null,default:n0},Symbol.toStringTag,{value:"Module"})),i0={class:"max-w-4xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},d0={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},u0={class:"lg:col-span-1"},c0={class:"bg-white rounded-xl shadow-sm border border-gray-200 p-6"},m0={class:"text-center"},p0={class:"mx-auto h-24 w-24 rounded-full bg-blue-100 flex items-center justify-center mb-4"},g0={class:"text-2xl font-bold text-blue-600"},x0={class:"text-lg font-semibold text-gray-900"},b0={class:"text-sm text-gray-600"},f0={class:"mt-4 flex items-center justify-center space-x-2"},v0={class:"flex items-center text-sm text-gray-600"},y0={class:"mt-4 text-xs text-gray-500"},_0={class:"mt-6 bg-white rounded-xl shadow-sm border border-gray-200 p-6"},h0={class:"space-y-4"},w0={class:"flex justify-between items-center"},$0={class:"font-semibold text-gray-900"},k0={class:"flex justify-between items-center"},C0={class:"font-semibold text-purple-600"},P0={class:"flex justify-between items-center"},j0={class:"font-semibold text-blue-600"},F0={class:"flex justify-between items-center"},D0={class:"font-semibold text-blue-600"},M0={class:"lg:col-span-2"},E0={class:"bg-white rounded-xl shadow-sm border border-gray-200"},S0={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},T0={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6"},A0={class:"mt-6"},V0={class:"mt-6"},L0={class:"border-t border-gray-200 pt-6"},z0={class:"space-y-4"},U0={class:"text-sm text-gray-600 bg-gray-100 rounded-lg p-3"},I0={class:"text-sm text-gray-600 bg-gray-100 rounded-lg p-3"},O0={class:"flex justify-end space-x-4 pt-6 border-t border-gray-200"},R0=["disabled"],N0={__name:"Profile",setup(te){const U=Be(),{get:I,put:g}=me(),A=L(!1),h=ae({products:0,lotteries:0,orders:0,revenue:0}),v=Q(()=>U.user),z=Q(()=>{if(!v.value)return"U";const j=v.value.first_name?.[0]||"",p=v.value.last_name?.[0]||"";return(j+p).toUpperCase()}),w=Q(()=>v.value?v.value.roles&&Array.isArray(v.value.roles)&&v.value.roles.length>0?v.value.roles.map(p=>p.name).join(", "):v.value.account_type?{business:"Marchand",personal:"Particulier"}[v.value.account_type]||v.value.account_type:v.value.userType?.name?{MANAGER:"Manager",CUSTOMER:"Client"}[v.value.userType.name]||v.value.userType.name:"Non défini":"Non défini"),D=ae({first_name:"",last_name:"",email:"",phone:"",city:"",address:"",bio:""}),a=()=>{v.value&&(D.first_name=v.value.first_name||"",D.last_name=v.value.last_name||"",D.email=v.value.email||"",D.phone=v.value.phone||"",D.city=v.value.city||"",D.address=v.value.address||"",D.bio=v.value.bio||"")},_=async()=>{try{const j=await I("/merchant/dashboard/stats");j.data&&(h.products=j.data.total_products||0,h.lotteries=j.data.active_lotteries||0,h.orders=j.data.total_orders||0,h.revenue=j.data.revenue_this_month||0)}catch(j){console.error("Erreur lors du chargement des statistiques:",j)}},F=async()=>{A.value=!0;try{await g("/user/profile",D),await U.refreshUser(),window.$toast&&window.$toast.success("Profil mis à jour avec succès","✅ Profil")}catch(j){console.error("Erreur lors de la mise à jour du profil:",j),window.$toast&&window.$toast.error("Erreur lors de la mise à jour du profil","❌ Erreur")}finally{A.value=!1}},i=()=>{a()},k=j=>j?new Date(j).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"Non disponible",c=j=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(j||0)+" FCFA";return ue(()=>{a(),_()}),(j,p)=>(o(),l("div",i0,[p[24]||(p[24]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Mon Profil"),e("p",{class:"mt-2 text-gray-600"},"Gérez vos informations personnelles et professionnelles")],-1)),e("div",d0,[e("div",u0,[e("div",c0,[e("div",m0,[e("div",p0,[e("span",g0,s(z.value),1)]),e("h3",x0,s(v.value?.first_name)+" "+s(v.value?.last_name),1),e("p",b0,s(v.value?.email),1),e("div",f0,[e("div",v0,[e("div",{class:N(["w-2 h-2 rounded-full mr-2",v.value?.is_active?"bg-blue-400":"bg-red-400"])},null,2),T(" "+s(v.value?.is_active?"Compte actif":"Compte inactif"),1)])]),e("div",y0,[p[7]||(p[7]=e("p",null,"Membre depuis",-1)),e("p",null,s(k(v.value?.created_at)),1)])])]),e("div",_0,[p[12]||(p[12]=e("h4",{class:"font-semibold text-gray-900 mb-4"},"Mes statistiques",-1)),e("div",h0,[e("div",w0,[p[8]||(p[8]=e("span",{class:"text-sm text-gray-600"},"Produits",-1)),e("span",$0,s(h.products||0),1)]),e("div",k0,[p[9]||(p[9]=e("span",{class:"text-sm text-gray-600"},"Tombolas actives",-1)),e("span",C0,s(h.lotteries||0),1)]),e("div",P0,[p[10]||(p[10]=e("span",{class:"text-sm text-gray-600"},"Commandes",-1)),e("span",j0,s(h.orders||0),1)]),e("div",F0,[p[11]||(p[11]=e("span",{class:"text-sm text-gray-600"},"Revenus ce mois",-1)),e("span",D0,s(c(h.revenue||0)),1)])])])]),e("div",M0,[e("div",E0,[e("form",{onSubmit:de(F,["prevent"]),class:"space-y-6 p-6"},[e("div",null,[p[19]||(p[19]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Informations personnelles",-1)),e("div",S0,[e("div",null,[p[13]||(p[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Prénom "),e("span",{class:"text-red-500"},"*")],-1)),V(e("input",{"onUpdate:modelValue":p[0]||(p[0]=P=>D.first_name=P),type:"text",required:"",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"}},null,512),[[R,D.first_name]])]),e("div",null,[p[14]||(p[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Nom "),e("span",{class:"text-red-500"},"*")],-1)),V(e("input",{"onUpdate:modelValue":p[1]||(p[1]=P=>D.last_name=P),type:"text",required:"",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"}},null,512),[[R,D.last_name]])])]),e("div",T0,[e("div",null,[p[15]||(p[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Email "),e("span",{class:"text-red-500"},"*")],-1)),V(e("input",{"onUpdate:modelValue":p[2]||(p[2]=P=>D.email=P),type:"email",required:"",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"}},null,512),[[R,D.email]])]),e("div",null,[p[16]||(p[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[T(" Téléphone "),e("span",{class:"text-red-500"},"*")],-1)),f(Ge,{modelValue:D.phone,"onUpdate:modelValue":p[3]||(p[3]=P=>D.phone=P),placeholder:"Numéro de téléphone","initial-country":"ga"},null,8,["modelValue"])])]),e("div",A0,[p[17]||(p[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Ville",-1)),V(e("input",{"onUpdate:modelValue":p[4]||(p[4]=P=>D.city=P),type:"text",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"}},null,512),[[R,D.city]])]),e("div",V0,[p[18]||(p[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Adresse",-1)),V(e("textarea",{"onUpdate:modelValue":p[5]||(p[5]=P=>D.address=P),rows:"3",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"},placeholder:"Votre adresse complète..."},null,512),[[R,D.address]])])]),e("div",L0,[p[23]||(p[23]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Informations business",-1)),e("div",z0,[e("div",null,[p[20]||(p[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type de compte",-1)),e("div",U0,s(v.value?.account_type==="business"?"Compte Business":"Compte Personnel"),1)]),e("div",null,[p[21]||(p[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rôle",-1)),e("div",I0,s(w.value),1)]),e("div",null,[p[22]||(p[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Bio professionnelle",-1)),V(e("textarea",{"onUpdate:modelValue":p[6]||(p[6]=P=>D.bio=P),rows:"4",class:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent",style:{color:"#5f5f5f"},placeholder:"Décrivez votre activité, vos produits, votre expertise..."},null,512),[[R,D.bio]])])])]),e("div",O0,[e("button",{type:"button",onClick:i,class:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors"}," Annuler "),e("button",{type:"submit",disabled:A.value,class:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50"},s(A.value?"Sauvegarde...":"Sauvegarder"),9,R0)])],32)])])])]))}},rm=Object.freeze(Object.defineProperty({__proto__:null,default:N0},Symbol.toStringTag,{value:"Module"}));export{sm as A,Z0 as C,X0 as D,K0 as E,em as L,Y0 as O,Q0 as P,om as S,tm as a,rm as b};
