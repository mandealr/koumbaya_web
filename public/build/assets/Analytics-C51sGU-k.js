import{c as b,au as E,aJ as L,aB as H,b as r,o as a,e,l as F,t as l,z as V,v as y,N as R,a6 as T,F as B,y as j,r as f,j as O,U as N,$ as G,f as J,V as q,u as i,g as _,I as K,b3 as Q,G as I,aH as U,b4 as W,b5 as Y,b6 as Z}from"./vendor-Cfu6aD78.js";import{a as ee}from"./app-DPLsyu-q.js";const te={class:"koumbaya-card group hover:scale-105 transition-all duration-300 cursor-pointer"},se={class:"koumbaya-card-body"},ae={key:0,class:"flex items-center justify-center h-24"},re={key:1,class:"flex items-center justify-between"},oe={class:"flex-1"},ne={class:"space-y-1"},le={class:"text-sm font-medium text-gray-600 group-hover:text-gray-700 transition-colors"},ie={class:"text-3xl font-bold text-gray-900 group-hover:text-koumbaya-primary transition-colors"},de={key:0,class:"flex items-center mt-2 space-x-1"},ce={class:"text-sm text-gray-500"},ue={key:2,class:"mt-4"},ge={class:"flex justify-between text-xs text-gray-500 mb-1"},me={class:"w-full bg-gray-200 rounded-full h-2"},pe={key:3,class:"flex gap-2 mt-4"},he=["onClick"],P={__name:"StatsCard",props:{title:{type:String,required:!0},value:{type:[Number,String],required:!0},icon:{type:[Object,Function],required:!0},change:{type:Number,default:void 0},period:{type:String,default:"mois dernier"},color:{type:String,default:"blue",validator:d=>["blue","green","orange","red","purple","indigo"].includes(d)},format:{type:String,default:"number",validator:d=>["number","currency","percentage"].includes(d)},showProgress:{type:Boolean,default:!1},progressValue:{type:Number,default:void 0},progressTarget:{type:Number,default:100},actions:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},emits:["action"],setup(d,{emit:g}){const n=d,c=g,m=b(()=>{const v=n.value;switch(n.format){case"currency":return new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(v).replace("XAF","FCFA");case"percentage":return`${v}%`;default:return new Intl.NumberFormat("fr-FR").format(v)}}),x=b(()=>n.change===void 0?E:n.change>0?L:n.change<0?H:E),p=b(()=>n.change===void 0?"text-gray-400":n.change>0?"text-blue-600":n.change<0?"text-red-600":"text-gray-400"),u={blue:{iconBg:"bg-blue-100 group-hover:bg-blue-200",iconColor:"text-blue-600",progress:"bg-gradient-to-r from-blue-500 to-blue-600"},green:{iconBg:"bg-blue-100 group-hover:bg-blue-200",iconColor:"text-blue-600",progress:"bg-gradient-to-r from-blue-500 to-blue-600"},orange:{iconBg:"bg-orange-100 group-hover:bg-orange-200",iconColor:"text-orange-600",progress:"bg-gradient-to-r from-orange-500 to-orange-600"},red:{iconBg:"bg-red-100 group-hover:bg-red-200",iconColor:"text-red-600",progress:"bg-gradient-to-r from-red-500 to-red-600"},purple:{iconBg:"bg-purple-100 group-hover:bg-purple-200",iconColor:"text-purple-600",progress:"bg-gradient-to-r from-purple-500 to-purple-600"},indigo:{iconBg:"bg-indigo-100 group-hover:bg-indigo-200",iconColor:"text-indigo-600",progress:"bg-gradient-to-r from-indigo-500 to-indigo-600"}},k=b(()=>u[n.color]?.iconBg||u.blue.iconBg),w=b(()=>u[n.color]?.iconColor||u.blue.iconColor),C=b(()=>u[n.color]?.progress||u.blue.progress),h=b(()=>!n.showProgress||n.progressValue===void 0?0:Math.min(n.progressValue/n.progressTarget*100,100)),S=v=>{c("action",v)};return(v,A)=>(a(),r("div",te,[e("div",se,[d.loading?(a(),r("div",ae,A[0]||(A[0]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):(a(),r("div",re,[e("div",oe,[e("div",ne,[e("p",le,l(d.title),1),e("p",ie,l(m.value),1)]),d.change!==void 0?(a(),r("div",de,[(a(),V(R(x.value),{class:y([p.value,"w-4 h-4 flex-shrink-0"])},null,8,["class"])),e("span",{class:y([p.value,"text-sm font-medium"])},l(Math.abs(d.change))+"% ",3),e("span",ce," vs "+l(d.period||"mois dernier"),1)])):F("",!0)]),e("div",{class:y([k.value,"p-4 rounded-xl group-hover:scale-110 transition-transform duration-300"])},[(a(),V(R(d.icon),{class:y([w.value,"w-8 h-8"])},null,8,["class"]))],2)])),d.showProgress&&d.progressValue!==void 0?(a(),r("div",ue,[e("div",ge,[e("span",null,"Objectif: "+l(d.progressTarget),1),e("span",null,l(Math.round(h.value))+"%",1)]),e("div",me,[e("div",{class:y([C.value,"h-2 rounded-full transition-all duration-500"]),style:T({width:h.value+"%"})},null,6)])])):F("",!0),d.actions?.length?(a(),r("div",pe,[(a(!0),r(B,null,j(d.actions,$=>(a(),r("button",{key:$.label,onClick:D=>S($),class:y(["flex-1 text-xs px-3 py-1.5 rounded-lg font-medium transition-all duration-200",$.primary?"bg-koumbaya-primary text-white hover:bg-koumbaya-primary-dark":"bg-gray-100 text-gray-600 hover:bg-gray-200"])},l($.label),11,he))),128))])):F("",!0)])]))}},ve={class:"px-6"},be={class:"mb-6"},ye={class:"bg-white rounded-lg shadow p-4"},xe={class:"flex flex-col sm:flex-row gap-4"},fe={class:"flex-1"},_e={key:0,class:"flex gap-4"},ke={class:"flex items-end"},we=["disabled"],Ce={key:0},$e={key:1},Fe={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},Ae={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8"},Pe={class:"koumbaya-card"},Be={class:"koumbaya-card-body"},je={key:0,class:"h-64 bg-gradient-to-br from-blue-50 to-blue-50 rounded-lg flex items-center justify-center"},Ve={key:1,class:"h-64"},Se={class:"h-full flex items-end justify-between space-x-2 p-4"},De={class:"text-xs text-gray-600 mt-2"},Me={class:"text-xs font-medium text-gray-900"},Ne={key:2,class:"h-64 bg-gradient-to-br from-blue-50 to-blue-50 rounded-lg flex items-center justify-center"},Te={class:"text-center"},Ee={class:"koumbaya-card"},Re={class:"koumbaya-card-body"},qe={key:0,class:"h-64 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg flex items-center justify-center"},Ie={key:1,class:"h-64 overflow-y-auto"},Ue={class:"space-y-3"},Xe={class:"font-medium text-gray-900"},ze={class:"text-sm text-gray-600"},Le={class:"text-right"},He={class:"font-medium text-gray-900"},Oe={key:2,class:"h-64 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg flex items-center justify-center"},Ge={class:"text-center"},Je={class:"koumbaya-card"},Ke={class:"koumbaya-card-body"},Qe={key:0,class:"flex justify-center items-center h-32"},We={key:1,class:"overflow-x-auto"},Ye={class:"min-w-full divide-y divide-gray-200"},Ze={class:"bg-white divide-y divide-gray-200"},et={class:"px-6 py-4 whitespace-nowrap"},tt={class:"flex items-center"},st={class:"flex-shrink-0 h-10 w-10"},at=["src","alt"],rt={class:"ml-4"},ot={class:"text-sm font-medium text-gray-900"},nt={class:"text-sm text-gray-500"},lt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},it={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},dt={class:"px-6 py-4 whitespace-nowrap"},ct={class:"flex items-center"},ut={key:3,class:"text-sm text-gray-500"},gt={key:2,class:"text-center py-8"},ht={__name:"Analytics",setup(d){const{loading:g,get:n}=ee(),c=f({}),m=f([]),x=f([]),p=f([]),u=f("this_month"),k=f(""),w=f(""),C=b(()=>{const o={period:u.value};return u.value==="custom"&&(k.value&&(o.start_date=k.value),w.value&&(o.end_date=w.value)),o}),h=async()=>{try{await Promise.all([S(),v(),A(),$()])}catch(o){console.error("Erreur lors du chargement des analytics:",o)}},S=async()=>{try{const o=await n("/merchant/dashboard/stats",{params:C.value});c.value=o}catch(o){console.error("Erreur lors du chargement des stats:",o),c.value={}}},v=async()=>{try{const o=await n("/merchant/dashboard/sales-chart",{params:C.value});m.value=o.data||[]}catch(o){console.error("Erreur lors du chargement du graphique des ventes:",o),m.value=[]}},A=async()=>{try{const o=await n("/merchant/dashboard/top-products",{params:C.value});x.value=o.data||[]}catch(o){console.error("Erreur lors du chargement des top produits:",o),x.value=[]}},$=async()=>{try{const o=await n("/merchant/dashboard/lottery-performance",{params:C.value});p.value=o.data||[]}catch(o){console.error("Erreur lors du chargement de la performance des tombolas:",o),p.value=[]}},D=o=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(o||0).replace("XAF","FCFA"),X=o=>o?new Date(o).toLocaleDateString("fr-FR",{month:"short",day:"numeric"}):"";return O(()=>{h()}),(o,s)=>(a(),r("div",ve,[s[17]||(s[17]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Analytiques"),e("p",{class:"mt-2 text-gray-600"},"Analyse de vos performances de vente")],-1)),e("div",be,[e("div",ye,[e("div",xe,[e("div",fe,[s[4]||(s[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Période",-1)),N(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>u.value=t),onChange:h,class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},s[3]||(s[3]=[J('<option value="today">Aujourd&#39;hui</option><option value="yesterday">Hier</option><option value="this_week">Cette semaine</option><option value="last_week">Semaine dernière</option><option value="this_month">Ce mois</option><option value="last_month">Mois dernier</option><option value="this_year">Cette année</option><option value="custom">Période personnalisée</option>',8)]),544),[[G,u.value]])]),u.value==="custom"?(a(),r("div",_e,[e("div",null,[s[5]||(s[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date début",-1)),N(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>k.value=t),onChange:h,type:"date",class:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,544),[[q,k.value]])]),e("div",null,[s[6]||(s[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date fin",-1)),N(e("input",{"onUpdate:modelValue":s[2]||(s[2]=t=>w.value=t),onChange:h,type:"date",class:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,544),[[q,w.value]])])])):F("",!0),e("div",ke,[e("button",{onClick:h,disabled:i(g),class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50"},[i(g)?(a(),r("span",Ce,"Chargement...")):(a(),r("span",$e,"Actualiser"))],8,we)])])])]),e("div",Fe,[_(P,{title:"Revenus Totaux",value:c.value.total_revenue||0,format:"currency",change:c.value.revenue_change||0,color:"green",icon:i(K),loading:i(g),actions:[{label:"Détails",primary:!0}]},null,8,["value","change","icon","loading"]),_(P,{title:"Ventes ce mois",value:c.value.monthly_sales||0,change:c.value.sales_change||0,color:"blue",icon:i(Q),loading:i(g),"show-progress":!0,"progress-value":c.value.monthly_sales||0,"progress-target":c.value.sales_target||200},null,8,["value","change","icon","loading","progress-value","progress-target"]),_(P,{title:"Produits Actifs",value:c.value.active_products||0,change:c.value.products_change||0,color:"purple",icon:i(I),loading:i(g)},null,8,["value","change","icon","loading"]),_(P,{title:"Taux Conversion",value:c.value.conversion_rate||0,format:"percentage",change:c.value.conversion_change||0,color:"orange",icon:i(U),loading:i(g)},null,8,["value","change","icon","loading"])]),e("div",Ae,[e("div",Pe,[s[9]||(s[9]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Évolution des Ventes")],-1)),e("div",Be,[i(g)?(a(),r("div",je,s[7]||(s[7]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e("p",{class:"text-gray-500"},"Chargement...")],-1)]))):m.value&&m.value.length>0?(a(),r("div",Ve,[e("div",Se,[(a(!0),r(B,null,j(m.value.slice(-7),(t,z)=>(a(),r("div",{key:z,class:"flex-1 flex flex-col items-center"},[e("div",{class:"w-full bg-blue-200 rounded-t",style:T({height:`${Math.max(10,t.sales/Math.max(...m.value.map(M=>M.sales))*180)}px`})},[e("div",{class:"w-full bg-blue-600 rounded-t",style:T({height:`${Math.max(5,t.sales/Math.max(...m.value.map(M=>M.sales))*180)}px`})},null,4)],4),e("span",De,l(X(t.date)),1),e("span",Me,l(t.sales),1)]))),128))])])):(a(),r("div",Ne,[e("div",Te,[_(i(U),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s[8]||(s[8]=e("p",{class:"text-gray-500"},"Aucune donnée disponible",-1))])]))])]),e("div",Ee,[s[12]||(s[12]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Performance des Tombolas")],-1)),e("div",Re,[i(g)?(a(),r("div",qe,s[10]||(s[10]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),e("p",{class:"text-gray-500"},"Chargement...")],-1)]))):p.value&&p.value.length>0?(a(),r("div",Ie,[e("div",Ue,[(a(!0),r(B,null,j(p.value.slice(0,5),t=>(a(),r("div",{key:t.id,class:"flex items-center justify-between p-3 bg-gray-100 rounded-lg"},[e("div",null,[e("h4",Xe,l(t.name),1),e("p",ze,l(t.tickets_sold)+" tickets vendus",1)]),e("div",Le,[e("p",He,l(D(t.revenue)),1),e("p",{class:y(["text-sm",t.performance_change>=0?"text-green-600":"text-red-600"])},l(t.performance_change>=0?"+":"")+l(t.performance_change)+"% ",3)])]))),128))])])):(a(),r("div",Oe,[e("div",Ge,[_(i(W),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s[11]||(s[11]=e("p",{class:"text-gray-500"},"Aucune tombola disponible",-1))])]))])])]),e("div",Je,[s[16]||(s[16]=e("div",{class:"koumbaya-card-header"},[e("h3",{class:"koumbaya-heading-4"},"Top Produits")],-1)),e("div",Ke,[i(g)?(a(),r("div",Qe,s[13]||(s[13]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("span",{class:"ml-2 text-gray-600"},"Chargement des produits...",-1)]))):x.value&&x.value.length>0?(a(),r("div",We,[e("table",Ye,[s[14]||(s[14]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Produit "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ventes "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Revenus "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tendance ")])],-1)),e("tbody",Ze,[(a(!0),r(B,null,j(x.value,t=>(a(),r("tr",{key:t.id},[e("td",et,[e("div",tt,[e("div",st,[e("img",{src:t.image_url||t.main_image||t.image||"/images/products/placeholder.jpg",alt:t.name,class:"h-10 w-10 rounded-lg object-cover bg-gray-100"},null,8,at)]),e("div",rt,[e("div",ot,l(t.name),1),e("div",nt,l(t.category?.name||t.category||"Sans catégorie"),1)])])]),e("td",lt,l(t.sales_count||t.sales||0),1),e("td",it,l(D(t.total_revenue||t.revenue||0)),1),e("td",dt,[e("div",ct,[(t.trend||t.performance_change||0)>0?(a(),V(i(Y),{key:0,class:"w-4 h-4 text-green-500 mr-1"})):(t.trend||t.performance_change||0)<0?(a(),V(i(Z),{key:1,class:"w-4 h-4 text-red-500 mr-1"})):F("",!0),(t.trend||t.performance_change||0)!==0?(a(),r("span",{key:2,class:y([(t.trend||t.performance_change||0)>0?"text-green-600":"text-red-600","text-sm font-medium"])},l(Math.abs(t.trend||t.performance_change||0))+"% ",3)):(a(),r("span",ut,"-"))])])]))),128))])])])):(a(),r("div",gt,[_(i(I),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s[15]||(s[15]=e("p",{class:"text-gray-500"},"Aucun produit trouvé pour cette période",-1))]))])])]))}};export{ht as default};
