import{b as c,j as v,o as d,e as t,Q as O,S as J,W as P,X as T,r as $,M as U,c as x,g as K,A as F,i,w as E,k as Q,t as o,B as W,m as b,u as r,a8 as X,I as H,aJ as Y,G as Z,K as tt,C as et,ak as st,a7 as L,as as ot,s as at,an as lt,aE as nt,b0 as it,F as rt,y as dt,av as ut}from"./vendor-iHAJtI43.js";import{a as ct}from"./app-BJBLWr2u.js";const mt={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},pt={__name:"LotteryDrawModal",props:{show:{type:Boolean,default:!1},lottery:{type:Object,default:()=>({})}},emits:["close","confirm"],setup(f,{emit:_}){const h=f,s=_,u=()=>{s("close")},m=()=>{s("confirm",h.lottery)};return(g,y)=>f.show?(d(),c("div",mt,[t("div",{class:"flex items-center justify-center min-h-screen px-4 text-center sm:block sm:p-0"},[t("div",{class:"fixed inset-0 bg-black/20 transition-opacity",onClick:u}),t("div",{class:"koumbaya-card inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle bg-white shadow-xl transform transition-all"},[y[0]||(y[0]=t("div",{class:"koumbaya-card-header"},[t("h3",{class:"koumbaya-heading-4"},"Lancer le tirage")],-1)),y[1]||(y[1]=t("div",{class:"koumbaya-card-body"},[t("p",{class:"koumbaya-text-body"}," Êtes-vous sûr de vouloir lancer le tirage pour cette tombola ? Cette action est irréversible. ")],-1)),t("div",{class:"koumbaya-card-footer"},[t("div",{class:"flex gap-4"},[t("button",{onClick:u,class:"koumbaya-btn koumbaya-btn-outline flex-1"}," Annuler "),t("button",{onClick:m,class:"koumbaya-btn koumbaya-btn-primary flex-1"}," Confirmer ")])])])])])):v("",!0)}},vt={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},xt={class:"flex items-center justify-center min-h-screen px-4 text-center"},bt={class:"koumbaya-card inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle bg-white shadow-xl transform transition-all"},gt={class:"koumbaya-form-group"},yt={class:"koumbaya-form-group"},ft={__name:"LotteryExtendModal",props:{show:{type:Boolean,default:!1},lottery:{type:Object,default:()=>({})}},emits:["close","submit"],setup(f,{emit:_}){const h=f,s=_,u=O({newDrawDate:"",reason:""}),m=()=>{s("close")},g=()=>{s("submit",{lotteryId:h.lottery.id,...u})};return(y,n)=>f.show?(d(),c("div",vt,[t("div",xt,[t("div",{class:"fixed inset-0 bg-black/20 transition-opacity",onClick:m}),t("div",bt,[n[5]||(n[5]=t("div",{class:"koumbaya-card-header"},[t("h3",{class:"koumbaya-heading-4"},"Prolonger la tombola")],-1)),t("form",{onSubmit:J(g,["prevent"]),class:"koumbaya-card-body space-y-4"},[t("div",gt,[n[2]||(n[2]=t("label",{class:"koumbaya-label"},"Nouvelle date de tirage",-1)),P(t("input",{"onUpdate:modelValue":n[0]||(n[0]=k=>u.newDrawDate=k),type:"datetime-local",required:"",class:"koumbaya-input"},null,512),[[T,u.newDrawDate]])]),t("div",yt,[n[3]||(n[3]=t("label",{class:"koumbaya-label"},"Raison de la prolongation",-1)),P(t("textarea",{"onUpdate:modelValue":n[1]||(n[1]=k=>u.reason=k),rows:"3",class:"koumbaya-input",placeholder:"Expliquez pourquoi vous prolongez cette tombola...",required:""},null,512),[[T,u.reason]])]),t("div",{class:"koumbaya-card-footer"},[t("div",{class:"flex gap-4"},[t("button",{type:"button",onClick:m,class:"koumbaya-btn koumbaya-btn-outline flex-1"}," Annuler "),n[4]||(n[4]=t("button",{type:"submit",class:"koumbaya-btn koumbaya-btn-primary flex-1"}," Prolonger ",-1))])])],32)])])])):v("",!0)}},_t={class:"space-y-6"},wt={class:"flex justify-between items-start"},ht={class:"flex items-center space-x-3 mb-2"},kt={class:"text-3xl font-bold text-gray-900"},$t={class:"flex space-x-3"},Dt={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},Mt={class:"bg-white p-6 rounded-xl shadow-sm border"},jt={class:"flex items-center"},Ct={class:"p-3 bg-blue-100 rounded-lg"},Pt={class:"ml-4"},Tt={class:"text-2xl font-bold text-gray-900"},Ft={class:"bg-white p-6 rounded-xl shadow-sm border"},Et={class:"flex items-center"},Lt={class:"p-3 bg-blue-100 rounded-lg"},At={class:"ml-4"},Bt={class:"text-2xl font-bold text-gray-900"},Rt={class:"bg-white p-6 rounded-xl shadow-sm border"},Vt={class:"flex items-center"},zt={class:"p-3 bg-purple-100 rounded-lg"},Nt={class:"ml-4"},St={class:"text-2xl font-bold text-gray-900"},qt={class:"bg-white p-6 rounded-xl shadow-sm border"},Gt={class:"flex items-center"},It={class:"p-3 bg-yellow-100 rounded-lg"},Ot={class:"ml-4"},Jt={class:"text-2xl font-bold text-gray-900"},Ut={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Kt={class:"lg:col-span-2 space-y-6"},Qt={class:"bg-white rounded-xl shadow-sm border overflow-hidden"},Wt={class:"p-6"},Xt={class:"flex space-x-6"},Ht={class:"flex-shrink-0"},Yt=["src","alt"],Zt={class:"flex-1"},te={class:"text-xl font-semibold text-gray-900 mb-2"},ee={class:"text-gray-600 mb-4"},se={class:"grid grid-cols-2 gap-4"},oe={class:"text-lg font-semibold text-gray-900"},ae={class:"text-lg font-semibold text-gray-900"},le={class:"text-lg font-semibold text-gray-900"},ne={class:"text-lg font-semibold text-gray-900"},ie={class:"bg-white rounded-xl shadow-sm border"},re={class:"p-6"},de={class:"space-y-4"},ue={class:"flex justify-between items-center mb-2"},ce={class:"text-sm text-gray-500"},me={class:"w-full bg-gray-200 rounded-full h-2"},pe={key:0},ve={class:"flex justify-between items-center mb-2"},xe={class:"text-sm text-gray-500"},be={class:"w-full bg-gray-200 rounded-full h-2"},ge={class:"mt-6 grid grid-cols-3 gap-4 text-center"},ye={class:"p-4 bg-blue-50 rounded-lg"},fe={class:"text-2xl font-bold text-blue-600"},_e={class:"p-4 bg-blue-50 rounded-lg"},we={class:"text-2xl font-bold text-blue-600"},he={class:"p-4 bg-yellow-50 rounded-lg"},ke={class:"text-2xl font-bold text-yellow-600"},$e={key:0,class:"bg-white rounded-xl shadow-sm border"},De={class:"px-6 py-4 border-b border-gray-200"},Me={class:"text-lg font-semibold text-gray-900 flex items-center"},je={class:"p-6"},Ce={class:"flex items-center space-x-4"},Pe={class:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center"},Te={class:"font-semibold text-gray-900"},Fe={class:"text-sm text-gray-600"},Ee={class:"space-y-6"},Le={class:"bg-white rounded-xl shadow-sm border"},Ae={class:"p-6 space-y-3"},Be={class:"bg-white rounded-xl shadow-sm border"},Re={class:"px-6 py-4 border-b border-gray-200"},Ve={class:"flex justify-between items-center"},ze={class:"p-6"},Ne={class:"space-y-3"},Se={class:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center"},qe={class:"text-sm font-medium text-gray-600"},Ge={class:"flex-1 min-w-0"},Ie={class:"text-sm font-medium text-gray-900 truncate"},Oe={class:"text-xs text-gray-500"},Je={class:"text-sm text-gray-500"},Ue={class:"bg-white rounded-xl shadow-sm border"},Ke={class:"p-6"},Qe={class:"space-y-4"},We={class:"flex justify-between"},Xe={class:"text-sm font-medium text-gray-900"},He={class:"flex justify-between"},Ye={class:"text-sm font-medium text-gray-900"},Ze={class:"flex justify-between"},ts={class:"text-sm font-medium text-gray-900"},es={class:"flex justify-between"},ss={class:"text-sm font-medium text-blue-600"},ls={__name:"LotteryView",setup(f){const _=U(),{get:h}=ct(),s=$({id:_.params.id,title:"iPhone 15 Pro Max 256GB",description:"Tentez de gagner le dernier iPhone 15 Pro Max dans sa version 256GB, couleur Titane Naturel. Un smartphone révolutionnaire avec une caméra professionnelle.",status:"active",product_value:1599e3,ticket_price:5e3,category:"Électronique",participants_count:156,tickets_sold:203,total_revenue:1015e3,max_participants:300,revenue_target:15e5,end_date:"2024-12-25T23:59:59",created_at:"2024-11-01T10:00:00",views_count:1250,product_image:"/images/products/iphone-15-pro.jpg",winner:null,draw_date:null}),u=$([{id:1,name:"Jean Dupont",participated_at:"2024-11-15T14:30:00",tickets_count:2},{id:2,name:"Marie Martin",participated_at:"2024-11-15T13:45:00",tickets_count:1},{id:3,name:"Paul Durant",participated_at:"2024-11-15T12:20:00",tickets_count:3},{id:4,name:"Sophie Leroy",participated_at:"2024-11-15T11:15:00",tickets_count:1},{id:5,name:"Pierre Moreau",participated_at:"2024-11-15T10:30:00",tickets_count:2}]),m=$(!1),g=$(!1),y=$(!1),n=x(()=>s.value.max_participants?Math.min(s.value.participants_count/s.value.max_participants*100,100):0),k=x(()=>s.value.revenue_target?Math.min(s.value.total_revenue/s.value.revenue_target*100,100):0),j=x(()=>!s.value.views_count||s.value.views_count===0?0:(s.value.participants_count/s.value.views_count*100).toFixed(1)),A=x(()=>s.value.participants_count===0?0:s.value.total_revenue/s.value.participants_count),B=x(()=>{const a=s.value.product_value;return((s.value.total_revenue-a)/a*100).toFixed(1)}),R=x(()=>{const a=new Date,p=new Date(s.value.end_date)-a;if(p<=0)return"Terminée";const l=Math.floor(p/(1e3*60*60*24)),C=Math.floor(p%(1e3*60*60*24)/(1e3*60*60));return l>0?`${l}j ${C}h`:`${C}h`}),V=x(()=>{const a=new Date,p=new Date(s.value.end_date)-a;return p<=0?0:Math.ceil(p/(1e3*60*60*24))}),z=x(()=>s.value.participants_count>=10),N=a=>({active:"Active",completed:"Terminée",pending:"En attente",paused:"En pause",cancelled:"Annulée"})[a]||a,w=a=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(a||0)+" FCFA",D=a=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(a)),S=()=>{window.$toast&&window.$toast.info("Fonctionnalité de téléchargement en cours de développement","🚀 En développement")},q=()=>{window.$toast&&window.$toast.info("Mise en pause de la tombola...","⏸️ Pause")},G=()=>{m.value=!1,M()},I=()=>{g.value=!1,M()},M=async()=>{try{const a=await h(`/merchant/lotteries/${_.params.id}`);a?.data&&(s.value={...s.value,...a.data})}catch(a){console.error("Erreur lors du chargement de la tombola:",a)}};return K(()=>{M()}),(a,e)=>{const p=Q("router-link");return d(),c("div",_t,[t("div",wt,[t("div",null,[t("div",ht,[i(p,{to:"/merchant/lotteries",class:"text-gray-500 hover:text-gray-700"},{default:E(()=>[i(r(ut),{class:"w-5 h-5"})]),_:1}),t("h1",kt,o(s.value.title),1),t("span",{class:W(["px-3 py-1 rounded-full text-sm font-medium",s.value.status==="active"||s.value.status==="completed"?"bg-blue-100 text-blue-800":s.value.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},o(N(s.value.status)),3)]),e[6]||(e[6]=t("p",{class:"text-gray-600"},"Gérez votre tombola et suivez les participations",-1))]),t("div",$t,[s.value.status==="active"?(d(),c("button",{key:0,onClick:e[0]||(e[0]=l=>g.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center"},[i(r(X),{class:"w-4 h-4 mr-2"}),e[7]||(e[7]=b(" Prolonger ",-1))])):v("",!0),s.value.status==="active"&&z.value?(d(),c("button",{key:1,onClick:e[1]||(e[1]=l=>m.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center"},[i(r(H),{class:"w-4 h-4 mr-2"}),e[8]||(e[8]=b(" Effectuer le tirage ",-1))])):v("",!0),t("button",{onClick:e[2]||(e[2]=l=>y.value=!0),class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 flex items-center"},[i(r(Y),{class:"w-4 h-4 mr-2"}),e[9]||(e[9]=b(" Modifier ",-1))])])]),t("div",Dt,[t("div",Mt,[t("div",jt,[t("div",Ct,[i(r(Z),{class:"w-6 h-6 text-blue-600"})]),t("div",Pt,[e[10]||(e[10]=t("p",{class:"text-sm font-medium text-gray-600"},"Participants",-1)),t("p",Tt,o(s.value.participants_count),1)])])]),t("div",Ft,[t("div",Et,[t("div",Lt,[i(r(tt),{class:"w-6 h-6 text-blue-600"})]),t("div",At,[e[11]||(e[11]=t("p",{class:"text-sm font-medium text-gray-600"},"Revenus générés",-1)),t("p",Bt,o(w(s.value.total_revenue)),1)])])]),t("div",Rt,[t("div",Vt,[t("div",zt,[i(r(et),{class:"w-6 h-6 text-purple-600"})]),t("div",Nt,[e[12]||(e[12]=t("p",{class:"text-sm font-medium text-gray-600"},"Tickets vendus",-1)),t("p",St,o(s.value.tickets_sold),1)])])]),t("div",qt,[t("div",Gt,[t("div",It,[i(r(st),{class:"w-6 h-6 text-yellow-600"})]),t("div",Ot,[e[13]||(e[13]=t("p",{class:"text-sm font-medium text-gray-600"},"Temps restant",-1)),t("p",Jt,o(R.value),1)])])])]),t("div",Ut,[t("div",Kt,[t("div",Qt,[e[18]||(e[18]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Informations du produit")],-1)),t("div",Wt,[t("div",Xt,[t("div",Ht,[t("img",{src:s.value.product_image||"/images/products/placeholder.jpg",alt:s.value.title,class:"w-32 h-32 object-cover rounded-lg"},null,8,Yt)]),t("div",Zt,[t("h4",te,o(s.value.title),1),t("p",ee,o(s.value.description),1),t("div",se,[t("div",null,[e[14]||(e[14]=t("p",{class:"text-sm font-medium text-gray-500"},"Valeur du produit",-1)),t("p",oe,o(w(s.value.product_value)),1)]),t("div",null,[e[15]||(e[15]=t("p",{class:"text-sm font-medium text-gray-500"},"Prix du ticket",-1)),t("p",ae,o(w(s.value.ticket_price)),1)]),t("div",null,[e[16]||(e[16]=t("p",{class:"text-sm font-medium text-gray-500"},"Catégorie",-1)),t("p",le,o(s.value.category?.name||s.value.category||"Sans catégorie"),1)]),t("div",null,[e[17]||(e[17]=t("p",{class:"text-sm font-medium text-gray-500"},"Date de fin",-1)),t("p",ne,o(D(s.value.end_date)),1)])])])])])]),t("div",ie,[e[24]||(e[24]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Progression")],-1)),t("div",re,[t("div",de,[t("div",null,[t("div",ue,[e[19]||(e[19]=t("span",{class:"text-sm font-medium text-gray-700"},"Objectif de participation",-1)),t("span",ce,o(s.value.participants_count)+" / "+o(s.value.max_participants||"∞"),1)]),t("div",me,[t("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:L({width:n.value+"%"})},null,4)])]),s.value.revenue_target?(d(),c("div",pe,[t("div",ve,[e[20]||(e[20]=t("span",{class:"text-sm font-medium text-gray-700"},"Objectif de revenus",-1)),t("span",xe,o(w(s.value.total_revenue))+" / "+o(w(s.value.revenue_target)),1)]),t("div",be,[t("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:L({width:k.value+"%"})},null,4)])])):v("",!0)]),t("div",ge,[t("div",ye,[t("p",fe,o(n.value)+"%",1),e[21]||(e[21]=t("p",{class:"text-sm text-blue-600"},"Participation",-1))]),t("div",_e,[t("p",we,o(j.value)+"%",1),e[22]||(e[22]=t("p",{class:"text-sm text-blue-600"},"Conversion",-1))]),t("div",he,[t("p",ke,o(V.value),1),e[23]||(e[23]=t("p",{class:"text-sm text-yellow-600"},"Jours restants",-1))])])])]),s.value.winner?(d(),c("div",$e,[t("div",De,[t("h3",Me,[i(r(ot),{class:"w-5 h-5 text-yellow-500 mr-2"}),e[25]||(e[25]=b(" Gagnant ",-1))])]),t("div",je,[t("div",Ce,[t("div",Pe,[i(r(at),{class:"w-6 h-6 text-yellow-600"})]),t("div",null,[t("p",Te,o(s.value.winner.name),1),t("p",Fe,"Tirage effectué le "+o(D(s.value.draw_date)),1)])]),e[26]||(e[26]=t("div",{class:"mt-4 p-4 bg-yellow-50 rounded-lg"},[t("p",{class:"text-sm text-yellow-800"}," Félicitations ! Le gagnant a été contacté automatiquement par email. ")],-1))])])):v("",!0)]),t("div",Ee,[t("div",Le,[e[30]||(e[30]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Actions rapides")],-1)),t("div",Ae,[t("button",{onClick:e[3]||(e[3]=(...l)=>a.shareLottery&&a.shareLottery(...l)),class:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},[i(r(lt),{class:"w-4 h-4 mr-2"}),e[27]||(e[27]=b(" Partager la tombola ",-1))]),t("button",{onClick:S,class:"w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},[i(r(nt),{class:"w-4 h-4 mr-2"}),e[28]||(e[28]=b(" Télécharger le rapport ",-1))]),s.value.status==="active"?(d(),c("button",{key:0,onClick:q,class:"w-full flex items-center justify-center px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"},[i(r(it),{class:"w-4 h-4 mr-2"}),e[29]||(e[29]=b(" Mettre en pause ",-1))])):v("",!0)])]),t("div",Be,[t("div",Re,[t("div",Ve,[e[32]||(e[32]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Participants récents",-1)),i(p,{to:`/merchant/lotteries/${s.value.id}/participants`,class:"text-sm text-blue-600 hover:text-blue-700"},{default:E(()=>e[31]||(e[31]=[b(" Voir tout ",-1)])),_:1,__:[31]},8,["to"])])]),t("div",ze,[t("div",Ne,[(d(!0),c(rt,null,dt(u.value,l=>(d(),c("div",{key:l.id,class:"flex items-center space-x-3"},[t("div",Se,[t("span",qe,o(l.name.charAt(0)),1)]),t("div",Ge,[t("p",Ie,o(l.name),1),t("p",Oe,o(D(l.participated_at)),1)]),t("div",Je,o(l.tickets_count)+" ticket"+o(l.tickets_count>1?"s":""),1)]))),128))])])]),t("div",Ue,[e[37]||(e[37]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Statistiques")],-1)),t("div",Ke,[t("div",Qe,[t("div",We,[e[33]||(e[33]=t("span",{class:"text-sm text-gray-600"},"Vues de la tombola",-1)),t("span",Xe,o(s.value.views_count||"N/A"),1)]),t("div",He,[e[34]||(e[34]=t("span",{class:"text-sm text-gray-600"},"Taux de conversion",-1)),t("span",Ye,o(j.value)+"%",1)]),t("div",Ze,[e[35]||(e[35]=t("span",{class:"text-sm text-gray-600"},"Panier moyen",-1)),t("span",ts,o(w(A.value)),1)]),t("div",es,[e[36]||(e[36]=t("span",{class:"text-sm text-gray-600"},"Retour sur investissement",-1)),t("span",ss,"+"+o(B.value)+"%",1)])])])])])]),m.value?(d(),F(pt,{key:0,lottery:s.value,onClose:e[4]||(e[4]=l=>m.value=!1),onDrawn:G},null,8,["lottery"])):v("",!0),g.value?(d(),F(ft,{key:1,lottery:s.value,onClose:e[5]||(e[5]=l=>g.value=!1),onExtended:I},null,8,["lottery"])):v("",!0)])}}};export{ls as default};
