import{r as u,j as h,b as i,e as t,t as o,U as g,a0 as b,a6 as f,f as w,F as k,z as C,o as l,x as A}from"./vendor-Bi4LjMey.js";import{c as v}from"./app-DkfTsk_6.js";const S={class:"p-6"},V={class:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},D={class:"bg-white rounded-lg shadow p-4"},E={class:"text-2xl font-bold text-gray-900"},M={class:"bg-white rounded-lg shadow p-4"},N={class:"text-2xl font-bold text-green-600"},I={class:"bg-white rounded-lg shadow p-4"},U={class:"text-2xl font-bold text-red-600"},z={class:"bg-white rounded-lg shadow p-4"},B={class:"text-2xl font-bold text-blue-600"},L={class:"bg-white rounded-lg shadow p-4"},R={class:"text-2xl font-bold text-yellow-600"},T={class:"bg-white rounded-lg shadow p-4 mb-6"},j={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},F={class:"bg-white rounded-lg shadow overflow-hidden"},P={key:0,class:"text-center py-12"},$={key:1,class:"text-center py-12"},G={class:"text-red-600"},H={key:2,class:"text-center py-12"},q={key:3,class:"min-w-full divide-y divide-gray-200"},J={class:"bg-white divide-y divide-gray-200"},K={class:"px-6 py-4 whitespace-nowrap"},O={class:"flex items-center"},Q={key:0,class:"flex-shrink-0 h-10 w-10"},W=["src","alt"],X={key:1,class:"flex-shrink-0 h-10 w-10 bg-gray-200 rounded-full flex items-center justify-center"},Y={class:"text-gray-600 font-medium"},Z={class:"ml-4"},tt={class:"text-sm font-medium text-gray-900"},et={class:"text-sm text-gray-500"},st={class:"px-6 py-4 whitespace-nowrap"},at={class:"text-sm text-gray-900"},ot={class:"text-sm text-gray-500"},it={class:"px-6 py-4 whitespace-nowrap"},lt={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"},nt={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800"},rt={class:"px-6 py-4 whitespace-nowrap"},dt={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800"},ct={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800"},ut={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},pt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},xt=["onClick"],yt={__name:"CustomerManagement",setup(gt){const p=u([]),r=u({}),x=u(!1),d=u(""),n=u({search:"",status:"",sort_by:"created_at",sort_order:"desc"}),c=async()=>{x.value=!0,d.value="";try{const a=new URLSearchParams;n.value.search&&a.append("search",n.value.search),n.value.status&&a.append("status",n.value.status),a.append("sort_by",n.value.sort_by),a.append("sort_order",n.value.sort_order);const e=await v.get(`/admin/customers?${a.toString()}`);p.value=e.data.customers||[]}catch(a){d.value=a.response?.data?.message||"Erreur lors du chargement des clients",console.error("Error fetching customers:",a)}finally{x.value=!1}},m=async()=>{try{const a=await v.get("/admin/customers/statistics");r.value=a.data.stats||{}}catch(a){console.error("Error fetching statistics:",a)}},y=async a=>{try{const e=await v.post(`/admin/customers/${a.id}/toggle-status`);e.data.success&&(a.is_active=e.data.is_active,await m())}catch(e){d.value=e.response?.data?.message||"Erreur lors du changement de statut",console.error("Error toggling status:",e)}},_=a=>a?new Date(a).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"-";return h(()=>{c(),m()}),(a,e)=>(l(),i("div",S,[e[16]||(e[16]=t("div",{class:"mb-6"},[t("h1",{class:"text-2xl font-bold text-gray-900"},"Liste des clients (Particuliers)"),t("p",{class:"text-gray-600 mt-1"},'Gérer tous les utilisateurs avec le rôle "particulier"')],-1)),t("div",V,[t("div",D,[e[3]||(e[3]=t("div",{class:"text-sm text-gray-500"},"Total",-1)),t("div",E,o(r.value.total||0),1)]),t("div",M,[e[4]||(e[4]=t("div",{class:"text-sm text-gray-500"},"Actifs",-1)),t("div",N,o(r.value.active||0),1)]),t("div",I,[e[5]||(e[5]=t("div",{class:"text-sm text-gray-500"},"Inactifs",-1)),t("div",U,o(r.value.inactive||0),1)]),t("div",z,[e[6]||(e[6]=t("div",{class:"text-sm text-gray-500"},"Vérifiés",-1)),t("div",B,o(r.value.verified||0),1)]),t("div",L,[e[7]||(e[7]=t("div",{class:"text-sm text-gray-500"},"Non vérifiés",-1)),t("div",R,o(r.value.unverified||0),1)])]),t("div",T,[t("div",j,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Recherche",-1)),g(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>n.value.search=s),type:"text",placeholder:"Nom, email, téléphone...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onInput:c},null,544),[[b,n.value.search]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Statut",-1)),g(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>n.value.status=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:c},e[9]||(e[9]=[w('<option value="">Tous</option><option value="active">Actifs</option><option value="inactive">Inactifs</option><option value="verified">Vérifiés</option><option value="unverified">Non vérifiés</option>',5)]),544),[[f,n.value.status]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Trier par",-1)),g(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>n.value.sort_by=s),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:c},e[11]||(e[11]=[t("option",{value:"created_at"},"Date de création",-1),t("option",{value:"first_name"},"Prénom",-1),t("option",{value:"last_name"},"Nom",-1),t("option",{value:"email"},"Email",-1)]),544),[[f,n.value.sort_by]])])])]),t("div",F,[x.value?(l(),i("div",P,e[13]||(e[13]=[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},null,-1),t("p",{class:"mt-2 text-gray-600"},"Chargement...",-1)]))):d.value?(l(),i("div",$,[t("p",G,o(d.value),1),t("button",{onClick:c,class:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," Réessayer ")])):p.value.length===0?(l(),i("div",H,e[14]||(e[14]=[t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1),t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Aucun client trouvé",-1),t("p",{class:"mt-1 text-sm text-gray-500"},"Aucun client ne correspond aux filtres sélectionnés.",-1)]))):(l(),i("table",q,[e[15]||(e[15]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Client"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contact"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Statut"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Vérification"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Inscrit le"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),t("tbody",J,[(l(!0),i(k,null,C(p.value,s=>(l(),i("tr",{key:s.id},[t("td",K,[t("div",O,[s.avatar_url?(l(),i("div",Q,[t("img",{class:"h-10 w-10 rounded-full",src:s.avatar_url,alt:s.first_name},null,8,W)])):(l(),i("div",X,[t("span",Y,o(s.first_name?.charAt(0))+o(s.last_name?.charAt(0)),1)])),t("div",Z,[t("div",tt,o(s.first_name)+" "+o(s.last_name),1),t("div",et,"ID: "+o(s.id),1)])])]),t("td",st,[t("div",at,o(s.email),1),t("div",ot,o(s.phone),1)]),t("td",it,[s.is_active?(l(),i("span",lt," Actif ")):(l(),i("span",nt," Inactif "))]),t("td",rt,[s.email_verified_at?(l(),i("span",dt," Vérifié ")):(l(),i("span",ct," Non vérifié "))]),t("td",ut,o(_(s.created_at)),1),t("td",pt,[t("button",{onClick:vt=>y(s),class:A([s.is_active?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900","mr-3"])},o(s.is_active?"Désactiver":"Activer"),11,xt)])]))),128))])]))])]))}};export{yt as default};
