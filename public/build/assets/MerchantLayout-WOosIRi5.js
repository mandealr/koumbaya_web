import{r as x,c as l,E as Q,M as X,O as G,N as H,P as J,aM as Y,aR as A,v as Z,B as ee,j as te,k as se,b as i,e,V as M,g as c,l as ae,w as p,h as V,F as _,z as y,t as n,u as B,m as re,T as ne,X as R,s as oe,o as r,A as m,i as g,W as w,x as k,p as le}from"./vendor-DnFm82Vn.js";import{u as ie,a as ce,N as ue,V as de,K as me,d as he}from"./app-CQQLczQI.js";const ve={class:"min-h-screen bg-gray-50"},fe={class:"bg-white shadow-sm border-b border-gray-200"},xe={class:"mx-auto px-4 sm:px-6 lg:px-8"},pe={class:"flex justify-between h-16"},ge={class:"flex"},be={class:"flex-shrink-0 flex items-center min-w-0"},_e={key:1,class:"flex items-center space-x-1"},ye={class:"ml-1 sm:ml-2 text-xs sm:text-sm text-[#0099cc] font-medium whitespace-nowrap"},we={class:"hidden sm:ml-6 sm:flex sm:space-x-8"},ke={class:"flex items-center space-x-2 sm:space-x-4"},Ce={class:"relative ml-1 sm:ml-3"},$e={class:"h-7 w-7 sm:h-8 sm:w-8 rounded-full overflow-hidden flex-shrink-0 border border-gray-200"},Ee=["src","alt"],Fe={key:1,class:"w-full h-full bg-blue-100 flex items-center justify-center"},Ie={class:"text-xs sm:text-sm font-medium text-blue-600"},Ne={class:"ml-2 sm:ml-3 text-gray-700 text-xs sm:text-sm font-medium hidden lg:block min-w-0 truncate"},Se={class:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50"},Ae={class:"py-1"},Me={class:"sm:hidden"},Ve={class:"pt-2 pb-3 space-y-1"},Be={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},Re={key:0,class:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 lg:hidden z-40"},je={class:"flex justify-around text-center"},De={class:"text-lg font-semibold text-gray-900"},Pe={class:"text-lg font-semibold text-blue-600"},Ke={class:"text-lg font-semibold text-purple-600"},ze={__name:"MerchantLayout",setup(Le){const j=oe(),d=ie(),{get:C}=ce(),h=x(!1),$=x(!1),E=x(!1),v=x({products:"0",lotteries:"0",revenue:"0 FCFA"}),F=l(()=>{const t=[{name:f.value?"Mon Espace Vendeur":"Dashboard",href:f.value?"/merchant/simple-dashboard":"/merchant/dashboard",icon:Q},{name:"Articles",href:"/merchant/products",icon:X},{name:"Commandes",href:"/merchant/orders",icon:G}];return t.push({name:"Tombolas",href:"/merchant/lotteries",icon:H},{name:"Remboursements",href:"/merchant/refunds",icon:J}),f.value||t.push({name:"Statistiques",href:"/merchant/analytics",icon:Y}),t.push({name:"Paramètres",href:"/merchant/settings",icon:A}),t}),D=l(()=>{const t=[{name:"Profil",href:"/merchant/profile",icon:Z}];return d.isMerchant&&d.isCustomer&&t.push({name:"Passer à l'espace client",href:{name:"customer.dashboard"},icon:ee,class:"text-[#0099cc] hover:bg-blue-50 font-medium"}),t.push({name:"Paramètres",href:"/merchant/settings",icon:A}),t}),o=l(()=>d.user),P=l(()=>{if(!o.value)return"U";const t=o.value.first_name?.[0]||"",s=o.value.last_name?.[0]||"";return(t+s).toUpperCase()}),f=l(()=>d.hasRole("Business Individual"));l(()=>d.hasRole("Business Enterprise"));const K=l(()=>f.value?"Vendeur":"Marchand"),L=l(()=>f.value?"/merchant/simple-dashboard":"/merchant/dashboard"),O=l(()=>window.innerWidth<1024),I=x(0),T=async()=>{await d.logout(),j.push({name:"login"})},z=()=>{E.value=!0},W=t=>{console.log("Avatar image failed to load, hiding image element"),t.target.style.display="none"},N=async()=>{try{const s=(await C("/merchant/dashboard/stats")).data;v.value={products:s.total_products?.toString()||"0",lotteries:s.active_lotteries?.toString()||"0",revenue:q(s.revenue_this_month||0)}}catch(t){console.error("Erreur lors du chargement des stats rapides:",t),v.value={products:"0",lotteries:"0",revenue:"0 FCFA"}}},S=async()=>{try{const t=await C("/notifications/unread-count");t&&t.data&&t.data.unread_count!==void 0&&(I.value=t.data.unread_count)}catch(t){console.error("Erreur lors du chargement des notifications:",t),I.value=0}},q=t=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(t||0)+" FCFA";return te(()=>{N(),S();const t=setInterval(S,120*1e3),s=setInterval(N,300*1e3),u=b=>{b.target.closest(".relative")||(h.value=!1)};document.addEventListener("click",u),se(()=>{document.removeEventListener("click",u),clearInterval(t),clearInterval(s)})}),(t,s)=>{const u=V("router-link"),b=V("router-view");return r(),i("div",ve,[e("nav",fe,[e("div",xe,[e("div",pe,[e("div",ge,[e("div",be,[c(u,{to:L.value,class:"flex items-center"},{default:p(()=>[E.value?(r(),i("div",_e,s[3]||(s[3]=[e("div",{class:"w-5 h-5 sm:w-6 sm:h-6 bg-[#0099cc] rounded flex items-center justify-center flex-shrink-0"},[e("span",{class:"text-white font-bold text-xs sm:text-sm"},"K")],-1),e("span",{class:"text-sm sm:text-lg font-bold text-[#0099cc] whitespace-nowrap"},"Koumbaya",-1)]))):(r(),i("img",{key:0,class:"h-6 sm:h-8 w-auto object-contain max-w-none",src:he,alt:"Koumbaya",onError:z},null,32)),e("span",ye,n(K.value),1)]),_:1},8,["to"])]),e("div",we,[(r(!0),i(_,null,y(F.value,a=>(r(),m(u,{key:a.name,to:a.href,class:k(["inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium",t.$route.path.startsWith(a.href)?"border-[#0099cc] text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},{default:p(()=>[(r(),m(w(a.icon),{class:"w-4 h-4 mr-2"})),g(" "+n(a.name),1)]),_:2},1032,["to","class"]))),128))])]),e("div",ke,[c(ue),e("div",Ce,[e("div",null,[e("button",{onClick:s[0]||(s[0]=a=>h.value=!h.value),class:"flex items-center max-w-xs bg-white rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#0099cc]"},[s[4]||(s[4]=e("span",{class:"sr-only"},"Open user menu",-1)),e("div",$e,[o.value?.avatar_url?(r(),i("img",{key:0,src:o.value.avatar_url,alt:`Photo de profil de ${o.value.first_name} ${o.value.last_name}`,class:"w-full h-full object-cover",onError:W},null,40,Ee)):(r(),i("div",Fe,[e("span",Ie,n(P.value),1)]))]),e("span",Ne,n(o.value?.first_name)+" "+n(o.value?.last_name),1),c(B(re),{class:"ml-1 sm:ml-2 h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"})])]),c(ne,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:p(()=>[M(e("div",Se,[e("div",Ae,[(r(!0),i(_,null,y(D.value,a=>(r(),m(u,{key:a.name,to:a.href,onClick:s[1]||(s[1]=U=>h.value=!1),class:k([a.class||"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100","flex items-center px-4 py-2 text-sm"])},{default:p(()=>[(r(),m(w(a.icon),{class:"w-4 h-4 mr-3"})),g(" "+n(a.name),1)]),_:2},1032,["to","class"]))),128)),e("button",{onClick:T,class:"flex items-center w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},[c(B(le),{class:"w-4 h-4 mr-3"}),s[5]||(s[5]=g(" Déconnexion ",-1))])])],512),[[R,h.value]])]),_:1})])])])])]),M(e("div",Me,[e("div",Ve,[(r(!0),i(_,null,y(F.value,a=>(r(),m(u,{key:a.name,to:a.href,onClick:s[2]||(s[2]=U=>$.value=!1),class:k(["block pl-3 pr-4 py-2 border-l-4 text-base font-medium",t.$route.path.startsWith(a.href)?"bg-blue-50 border-blue-500 text-blue-700":"border-transparent text-gray-500 hover:bg-gray-100 hover:border-gray-300 hover:text-gray-700"])},{default:p(()=>[(r(),m(w(a.icon),{class:"w-5 h-5 mr-3 inline"})),g(" "+n(a.name),1)]),_:2},1032,["to","class"]))),128))])],512),[[R,$.value]]),e("main",Be,[c(de),c(b)]),c(me),O.value?(r(),i("div",Re,[e("div",je,[e("div",null,[e("div",De,n(v.value.products),1),s[6]||(s[6]=e("div",{class:"text-xs text-gray-600"},"Articles",-1))]),e("div",null,[e("div",Pe,n(v.value.lotteries),1),s[7]||(s[7]=e("div",{class:"text-xs text-gray-600"},"Tirages spéciaux",-1))]),e("div",null,[e("div",Ke,n(v.value.revenue),1),s[8]||(s[8]=e("div",{class:"text-xs text-gray-600"},"Revenus",-1))])])])):ae("",!0)])}}};export{ze as default};
