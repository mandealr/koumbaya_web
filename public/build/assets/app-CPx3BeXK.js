const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SocialCallback-AoBdwr5X.js","assets/vendor-D6suw91W.js","assets/AboutPage-BfPk8n7C.js","assets/StaticPageLayout-CeqcgeSM.js","assets/StaticPageLayout-D0U3Nzub.css","assets/AffiliatesPage-Dqy84FEV.js","assets/EarnGombosPage-Dq_egy_T.js","assets/CareersPage-BOT6cUeO.js","assets/MediaPressPage-B3xmt4j3.js","assets/StaticPage-sZ50idl1.js","assets/StaticPage-D2uRmhJZ.css","assets/ReportSuspiciousPage-CAi-c21J.js","assets/SupportCenterPage-s284KxSu.js","assets/SecurityCenterPage-BDRtdues.js","assets/SitemapPage-DOx0cRFm.js","assets/SellOnKoumbayaPage-BYqJopoZ.js","assets/ProductDetail-qXPDV2YY.js","assets/ProductDetail-Cgc_MD_C.css","assets/VendorManagement-5QaNbqpw.js","assets/MerchantLayout-C2y0N1NL.js","assets/Dashboard-BcwoiFUd.js","assets/SimpleMerchantDashboard-VFCQcKMc.js","assets/SimpleMerchantDashboard-B1Y2dVU2.css","assets/Products-Bf7b80ZG.js","assets/CreateProduct-sOWsXud8.js","assets/ImageUpload-B-dFa7OH.js","assets/ImageUpload-KHDybehO.css","assets/EditProduct-Bh6xDyRa.js","assets/Orders-1TRg_Rjw.js","assets/LotteriesSimple-Bxxcn9jO.js","assets/LotteryView-CRCulJSv.js","assets/LotteryView-DgK8PvgY.css","assets/Refunds-DfIkMl3i.js","assets/Analytics-ekh6dkST.js","assets/Settings-DVcOkgJV.js","assets/Profile-BDUaS-RC.js"])))=>i.map(i=>d[i]);
import{a as ns,r as R,d as Ds,c as de,b as o,e,f as pe,g,w as re,u as l,h as he,i as z,o as s,j as ve,k as st,l as T,n as Me,t,m as $t,p as nt,q as zt,s as $e,v as ze,x as te,y as _e,F as ie,z as le,T as Ts,A as ce,B as je,C as Xe,D as Yt,E as vt,G as qe,H as ot,I as Ms,J as Ls,K as Ke,L as Qt,M as Be,N as is,O as it,P as Ie,Q as xe,R as De,S as lt,U as et,V as Se,W as Q,X as ne,Y as qt,Z as pt,_ as Ue,$ as gt,a0 as Ae,a1 as me,a2 as We,a3 as Re,a4 as ht,a5 as ut,a6 as ls,a7 as Ut,a8 as Te,a9 as Vs,aa as ft,ab as ds,ac as Ze,ad as Bt,ae as us,af as Rs,ag as xt,ah as kt,ai as Oe,aj as Fs,ak as Le,al as Ot,am as be,an as Ns,ao as zs,ap as Gt,aq as qs,ar as Us,as as Zt,at as Rt,au as Je,av as Bs,aw as _t,ax as at,ay as Os,az as Gs,aA as mt,aB as cs,aC as Hs,aD as Ge,aE as Fe,aF as Et,aG as dt,aH as Ct,aI as ms,aJ as ps,aK as gs,aL as jt,aM as Qe,aN as Ks,aO as Ws,aP as Js,aQ as Xs,aR as es,aS as Ys,aT as Qs,aU as Zs,aV as eo,aW as to,aX as so,aY as oo}from"./vendor-D6suw91W.js";window.axios=ns;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";const ro="modulepreload",ao=function(_){return"/build/"+_},ts={},ye=function(y,w,p){let f=Promise.resolve();if(w&&w.length>0){let r=function(P){return Promise.all(P.map($=>Promise.resolve($).then(M=>({status:"fulfilled",value:M}),M=>({status:"rejected",reason:M}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),n=c?.nonce||c?.getAttribute("nonce");f=r(w.map(P=>{if(P=ao(P),P in ts)return;ts[P]=!0;const $=P.endsWith(".css"),M=$?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${P}"]${M}`))return;const D=document.createElement("link");if(D.rel=$?"stylesheet":ro,$||(D.as="script"),D.crossOrigin="",D.href=P,n&&D.setAttribute("nonce",n),document.head.appendChild(D),$)return new Promise((m,k)=>{D.addEventListener("load",m),D.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${P}`)))})}))}function a(c){const n=new Event("vite:preloadError",{cancelable:!0});if(n.payload=c,window.dispatchEvent(n),!n.defaultPrevented)throw c}return f.then(c=>{for(const n of c||[])n.status==="rejected"&&a(n.reason);return y().catch(a)})},Ce=ns.create({baseURL:"https://koumbaya.com/api",headers:{Accept:"application/json"}});Ce.interceptors.request.use(_=>{const y=localStorage.getItem("auth_token");return y&&(_.headers.Authorization=`Bearer ${y}`),_},_=>Promise.reject(_));Ce.interceptors.response.use(_=>_,_=>{if(_.response?.status===401&&!_.config?.url?.includes("/auth/login")){localStorage.getItem("auth_token")&&localStorage.removeItem("auth_token");const w=window.location.pathname,p=w!=="/"&&w!=="/login"?`?redirect=${encodeURIComponent(w)}`:"";window.router?window.router.push(`/login${p}`):window.location.href=`/login${p}`}return Promise.reject(_)});function ge(){const _=R(!1),y=R(null),w=async n=>{_.value=!0,y.value=null;try{return(await n()).data}catch(r){throw y.value=r.response?.data?.message||r.message||"Une erreur est survenue",r}finally{_.value=!1}};return{loading:_,error:y,get:(n,r={})=>w(()=>Ce.get(n,r)),post:(n,r={},P={})=>{if(r instanceof FormData){const M={...P};return M.headers&&delete M.headers["Content-Type"],w(()=>Ce.post(n,r,{...M,headers:{...M.headers}}))}const $={...P,headers:{"Content-Type":"application/json",...P.headers}};return w(()=>Ce.post(n,r,$))},put:(n,r={},P={})=>w(()=>Ce.put(n,r,P)),delete:(n,r={})=>w(()=>Ce.delete(n,r)),api:Ce}}const tB=async(_,y,w=null)=>(await Ce.patch(`/orders/${_}/status`,{status:y,notes:w})).data,Pe=Ds("auth",()=>{const _=R(null),y=R(localStorage.getItem("auth_token")),w=R(!1),p=R(""),f=R(!0),a=de(()=>!f.value&&!!y.value&&!!_.value),c=N=>!_.value?.roles||!Array.isArray(_.value.roles)?!1:_.value.roles.some(u=>typeof u=="string"?u===N:u&&typeof u=="object"&&u.name?u.name===N:!1),n=de(()=>c("Super Admin")||c("Admin")||c("Agent")),r=de(()=>c("Super Admin")||c("Admin")),P=de(()=>c("Agent")),$=de(()=>c("Business Enterprise")||c("Business Individual")||c("Business")),M=de(()=>c("Particulier")),D=de(()=>c("Business Enterprise")||c("Business Individual")||c("Business"));async function m(N){w.value=!0,p.value="";try{const u=await Ce.post("/auth/login",N);console.log("🔍 Structure complète de la réponse API login:",u.data);let A,H;if(u.data.data?(A=u.data.data.access_token||u.data.data.token,H=u.data.data.user,console.log("📦 Structure avec wrapper data détectée")):(A=u.data.access_token||u.data.token,H=u.data.user,console.log("📦 Structure directe détectée")),console.log("🎫 Token extrait:",A?"présent":"absent"),console.log("👤 User data extrait:",H),!A)throw new Error("Token d'authentification manquant dans la réponse");if(!H)throw new Error("Données utilisateur manquantes dans la réponse");return y.value=A,_.value=H,localStorage.setItem("auth_token",A),console.log("✅ Login store: Token et user définis avec succès"),{success:!0}}catch(u){let A="Erreur de connexion";if(u.response?.status===401)A="Identifiants incorrects";else if(u.response?.status===429)A="Trop de tentatives. Veuillez patienter.";else if(u.response?.status===422){const H=u.response?.data?.errors;H?A=Object.values(H).flat().join(", "):A=u.response?.data?.message||"Données invalides"}else u.response?A=u.response?.data?.error||u.response?.data?.message||"Erreur de connexion":A="Problème de connexion réseau";return p.value=A,{success:!1,error:A}}finally{w.value=!1}}async function k(N){w.value=!0,p.value="";try{const u=await Ce.post("/auth/register",N);console.log("🔍 Structure complète de la réponse API register:",u.data);let A,H;return u.data.data?(A=u.data.data.access_token||u.data.data.token,H=u.data.data.user,console.log("📦 Register: Structure avec wrapper data détectée")):(A=u.data.access_token||u.data.token,H=u.data.user,console.log("📦 Register: Structure directe détectée")),y.value=A,_.value=H,localStorage.setItem("auth_token",A),{success:!0}}catch(u){return p.value=u.response?.data?.error||u.response?.data?.message||"Erreur lors de l'inscription",{success:!1,error:p.value}}finally{w.value=!1}}async function U(){try{await Ce.post("/auth/logout")}catch(N){console.error("Erreur lors de la déconnexion:",N)}finally{_.value=null,y.value=null,localStorage.removeItem("auth_token")}}async function V(){if(f.value=!0,!y.value){f.value=!1;return}try{const N=await Ce.get("/auth/me");console.log("🔍 Structure réponse /auth/me:",N.data),N.data.data?.user?(_.value=N.data.data.user,console.log("📦 /auth/me: Structure avec wrapper data détectée")):N.data.user?(_.value=N.data.user,console.log("📦 /auth/me: Structure directe détectée")):(console.warn("⚠️ Structure réponse /auth/me inattendue:",N.data),_.value=null),console.log("👤 User chargé via /auth/me:",_.value)}catch{_.value=null,y.value=null,localStorage.removeItem("auth_token")}finally{f.value=!1}}async function v(){if(a.value)try{const N=await Ce.get("/auth/me");console.log("🔍 Structure réponse /auth/me:",N.data),N.data.data?.user?(_.value=N.data.data.user,console.log("📦 /auth/me: Structure avec wrapper data détectée")):N.data.user?(_.value=N.data.user,console.log("📦 /auth/me: Structure directe détectée")):(console.warn("⚠️ Structure réponse /auth/me inattendue:",N.data),_.value=null),console.log("👤 User chargé via /auth/me:",_.value)}catch(N){console.error("Erreur lors du rafraîchissement:",N)}}function d(){p.value=""}function i(N){p.value=N}function C(N){_.value=N}function x(N){y.value=N,N?localStorage.setItem("auth_token",N):localStorage.removeItem("auth_token")}function I(){return _.value?(console.log("🔄 Logique de redirection:",{email:_.value?.email,userRoles:_.value?.roles,isManager:n.value,isAdmin:r.value,isAgent:P.value,isMerchant:$.value,isCustomer:M.value,isIndividualSeller:c("Business Individual"),isBusinessSeller:c("Business Enterprise"),roles:_.value?.roles?.map(N=>N.name)}),n.value?(console.log("✅ Utilisateur manager détecté, redirection vers admin.dashboard"),console.log("  - isAdmin:",r.value),console.log("  - hasRole Super Admin:",c("Super Admin")),console.log("  - hasRole Admin:",c("Admin")),console.log("  - hasRole Agent:",c("Agent")),"admin.dashboard"):c("Business Individual")?(console.log("✅ Redirection vers merchant.simple-dashboard (Vendeur Individuel)"),"merchant.simple-dashboard"):c("Business Enterprise")?(console.log("✅ Redirection vers merchant.dashboard (Vendeur Entreprise - dashboard complet)"),"merchant.dashboard"):c("Business")?(console.log("✅ Redirection vers merchant.simple-dashboard (Business legacy - simple dashboard)"),"merchant.simple-dashboard"):(console.log("✅ Redirection vers customer.dashboard (Customer par défaut)"),"customer.dashboard")):(console.log("❌ Pas d'utilisateur connecté, redirection vers home"),"home")}return{user:_,token:y,loading:w,error:p,initializing:f,isAuthenticated:a,isManager:n,isAdmin:r,isAgent:P,isMerchant:$,isCustomer:M,canSell:D,hasRole:c,isIndividualSeller:de(()=>c("Business Individual")),isBusinessSeller:de(()=>c("Business Enterprise")),login:m,register:k,logout:U,checkAuth:V,refreshUser:v,clearError:d,setError:i,setUser:C,setToken:x,getDefaultRedirect:I}}),fs="/build/logo.png",Ye="/build/assets/logo-ZbB75Npb.png",Ee=(_,y)=>{const w=_.__vccOpts||_;for(const[p,f]of y)w[p]=f;return w},no={class:"bg-white border-t border-gray-200 mt-12"},io={class:"max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8"},lo={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8"},uo={class:"col-span-1 md:col-span-2 lg:col-span-1"},co={class:"flex items-center"},mo=["src"],po={class:"space-y-3"},go={class:"space-y-3"},fo={class:"space-y-3"},vo={class:"mt-12 pt-8 border-t border-gray-200"},xo={class:"flex flex-col md:flex-row justify-between items-center"},bo={class:"flex flex-wrap items-center space-x-6 mb-4 md:mb-0"},yo={__name:"KoumbayaFooter",setup(_){return(y,w)=>{const p=he("router-link");return s(),o("footer",no,[e("div",io,[e("div",lo,[e("div",uo,[e("div",co,[g(p,{to:"/",class:"inline-block"},{default:re(()=>[e("img",{src:l(Ye),alt:"Koumbaya",class:"h-15 w-auto hover:opacity-80 transition-opacity"},null,8,mo)]),_:1})]),w[0]||(w[0]=pe('<p class="mt-4 text-gray-600 text-sm leading-relaxed" data-v-202ffd9f> La marketplace innovante qui vous permet d&#39;acquérir des produits premium à prix imbattables grâce aux tombolas équitables. </p><div class="mt-6 flex space-x-4" data-v-202ffd9f><a href="#" class="text-gray-400 hover:text-[#0099cc] transition-colors" data-v-202ffd9f><span class="sr-only" data-v-202ffd9f>Facebook</span><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" data-v-202ffd9f><path fill-rule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" clip-rule="evenodd" data-v-202ffd9f></path></svg></a><a href="#" class="text-gray-400 hover:text-[#0099cc] transition-colors" data-v-202ffd9f><span class="sr-only" data-v-202ffd9f>Instagram</span><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" data-v-202ffd9f><path fill-rule="evenodd" d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.618 5.367 11.986 11.988 11.986s11.987-5.368 11.987-11.986C24.004 5.367 18.635.001 12.017.001zM8.449 16.988c-1.297 0-2.448-.49-3.323-1.297C4.198 14.895 3.68 13.729 3.68 12.417s.518-2.478 1.446-3.274c.875-.807 2.026-1.297 3.323-1.297s2.448.49 3.323 1.297c.928.796 1.446 1.962 1.446 3.274s-.518 2.478-1.446 3.274c-.875.807-2.026 1.297-3.323 1.297zm7.718 0c-1.297 0-2.448-.49-3.323-1.297-.928-.796-1.446-1.962-1.446-3.274s.518-2.478 1.446-3.274c.875-.807 2.026-1.297 3.323-1.297s2.448.49 3.323 1.297c.928.796 1.446 1.962 1.446 3.274s-.518 2.478-1.446 3.274c-.875.807-2.026 1.297-3.323 1.297z" clip-rule="evenodd" data-v-202ffd9f></path></svg></a><a href="#" class="text-gray-400 hover:text-[#0099cc] transition-colors" data-v-202ffd9f><span class="sr-only" data-v-202ffd9f>Twitter</span><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" data-v-202ffd9f><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84" data-v-202ffd9f></path></svg></a><a href="#" class="text-gray-400 hover:text-[#0099cc] transition-colors" data-v-202ffd9f><span class="sr-only" data-v-202ffd9f>LinkedIn</span><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24" data-v-202ffd9f><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" data-v-202ffd9f></path></svg></a></div>',2))]),e("div",null,[w[7]||(w[7]=e("h3",{class:"text-sm font-semibold text-gray-900 tracking-wider uppercase mb-4"}," Informations sur l'entreprise ",-1)),e("ul",po,[e("li",null,[g(p,{to:"/about",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[1]||(w[1]=[z("À propos de Koumbaya",-1)])),_:1,__:[1]})]),e("li",null,[g(p,{to:"/affiliates",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[2]||(w[2]=[z("Affiliés & Influenceurs",-1)])),_:1,__:[2]})]),e("li",null,[g(p,{to:"/earn-gombos",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[3]||(w[3]=[z("Gagnez des Gombos",-1)])),_:1,__:[3]})]),e("li",null,[g(p,{to:"/contact",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[4]||(w[4]=[z("Nous contacter",-1)])),_:1,__:[4]})]),e("li",null,[g(p,{to:"/careers",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[5]||(w[5]=[z("Carrières",-1)])),_:1,__:[5]})]),e("li",null,[g(p,{to:"/media-press",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[6]||(w[6]=[z("Media & Presse",-1)])),_:1,__:[6]})])])]),e("div",null,[w[14]||(w[14]=e("h3",{class:"text-sm font-semibold text-gray-900 tracking-wider uppercase mb-4"}," Service client ",-1)),e("ul",go,[e("li",null,[g(p,{to:"/lottery-participation",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[8]||(w[8]=[z("Participation aux tirages spéciaux",-1)])),_:1,__:[8]})]),e("li",null,[g(p,{to:"/intellectual-property",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[9]||(w[9]=[z("Politique de propriété intellectuelle",-1)])),_:1,__:[9]})]),e("li",null,[g(p,{to:"/order-delivery",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[10]||(w[10]=[z("Informations sur la réception des commandes",-1)])),_:1,__:[10]})]),e("li",null,[g(p,{to:"/report-suspicious",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[11]||(w[11]=[z("Signaler une activité suspecte",-1)])),_:1,__:[11]})]),e("li",null,[g(p,{to:"/support-center",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[12]||(w[12]=[z("Centre d'assistance",-1)])),_:1,__:[12]})]),e("li",null,[g(p,{to:"/security-center",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[13]||(w[13]=[z("Centre de sécurité",-1)])),_:1,__:[13]})])])]),e("div",null,[w[19]||(w[19]=e("h3",{class:"text-sm font-semibold text-gray-900 tracking-wider uppercase mb-4"}," Centre d'Assistance ",-1)),e("ul",fo,[e("li",null,[g(p,{to:"/security-center",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[15]||(w[15]=[z("Centre de Sécurité",-1)])),_:1,__:[15]})]),e("li",null,[g(p,{to:"/peace-on-koumbaya",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[16]||(w[16]=[z("Avoir la paix sur Koumbaya",-1)])),_:1,__:[16]})]),e("li",null,[g(p,{to:"/sitemap",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[17]||(w[17]=[z("Plan du site",-1)])),_:1,__:[17]})]),e("li",null,[g(p,{to:"/sell-on-koumbaya",class:"text-sm text-gray-600 hover:text-[#0099cc] transition-colors font-medium"},{default:re(()=>w[18]||(w[18]=[z("Vendre sur Koumbaya",-1)])),_:1,__:[18]})])])])]),e("div",vo,[e("div",xo,[e("div",bo,[g(p,{to:"/terms",class:"text-sm text-gray-500 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[20]||(w[20]=[z("Conditions d'utilisation",-1)])),_:1,__:[20]}),g(p,{to:"/privacy",class:"text-sm text-gray-500 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[21]||(w[21]=[z("Politique de confidentialité",-1)])),_:1,__:[21]}),g(p,{to:"/legal",class:"text-sm text-gray-500 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[22]||(w[22]=[z("Mentions légales",-1)])),_:1,__:[22]}),g(p,{to:"/cookies",class:"text-sm text-gray-500 hover:text-[#0099cc] transition-colors"},{default:re(()=>w[23]||(w[23]=[z("Cookies",-1)])),_:1,__:[23]})]),w[24]||(w[24]=e("div",{class:"text-sm text-gray-500"}," © 2025 Koumbaya. Tous droits réservés. ",-1))])])])])}}},vs=Ee(yo,[["__scopeId","data-v-202ffd9f"]]),ho={class:"min-h-screen bg-gray-50"},_o={class:"bg-white shadow-sm"},wo={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},$o={class:"flex justify-between items-center h-16"},ko={key:1,class:"flex items-center space-x-1 sm:space-x-2"},Co={class:"hidden md:flex space-x-8"},Ao={class:"flex items-center space-x-2 sm:space-x-4"},Po={key:0,class:"flex items-center space-x-2 sm:space-x-4"},Eo={class:"relative"},jo={class:"w-8 h-8 rounded-full overflow-hidden"},So=["src","alt"],Io={class:"text-sm font-medium text-white"},Do={class:"px-4 py-2 text-sm text-gray-700 border-b border-gray-100"},To={class:"font-medium"},Mo={class:"text-xs text-gray-500"},Lo={key:1,class:"flex items-center space-x-2 sm:space-x-4"},Vo={key:0,class:"md:hidden border-t border-gray-200 bg-white"},Ro={class:"px-4 py-3 space-y-1"},Fo={class:"border-t border-gray-200 pt-4 mt-4"},No={key:0,class:"space-y-2"},zo={class:"px-3 py-2 text-sm text-gray-600"},qo={key:1,class:"space-y-2"},Uo={__name:"GuestLayout",setup(_){const y=$e(),w=Pe(),p=R(!1),f=R(!1),a=R(!1),c=de(()=>{const D=w.user;return D?(D.first_name?.[0]||"")+(D.last_name?.[0]||""):"U"}),n=de(()=>{const D=w.getDefaultRedirect();return{"admin.dashboard":"/admin","merchant.dashboard":"/merchant/dashboard","merchant.simple-dashboard":"/merchant/simple-dashboard","customer.dashboard":"/customer"}[D]||"/customer"}),r=async()=>{f.value=!1,await w.logout(),y.push({name:"login"})},P=()=>{a.value=!0},$=()=>{console.log("Logo clicked - navigating to home")},M=D=>{D.target.closest(".relative")||(f.value=!1)};return ve(async()=>{document.addEventListener("click",M),w.token&&!w.user&&(console.log("🔄 Recharging user data in GuestLayout"),await w.checkAuth())}),st(()=>{document.removeEventListener("click",M)}),(D,m)=>{const k=he("router-link"),U=he("router-view");return s(),o("div",ho,[e("header",_o,[e("div",wo,[e("div",$o,[g(k,{to:"/",class:"flex items-center min-w-0 flex-shrink-0",onClick:$},{default:re(()=>[a.value?(s(),o("div",ko,m[12]||(m[12]=[e("div",{class:"w-6 h-6 sm:w-8 sm:h-8 bg-[#0099cc] rounded flex items-center justify-center flex-shrink-0"},[e("span",{class:"text-white font-bold text-sm sm:text-lg"},"K")],-1),e("span",{class:"text-lg sm:text-xl font-bold text-[#0099cc] whitespace-nowrap"},"Koumbaya",-1)]))):(s(),o("img",{key:0,src:fs,alt:"Koumbaya",class:"h-8 sm:h-10 w-auto object-contain max-w-none",onError:P},null,32))]),_:1}),e("nav",Co,[g(k,{to:"/",class:"text-gray-600 hover:text-[#0099cc] px-3 py-2 rounded-md text-sm font-medium transition-colors"},{default:re(()=>m[13]||(m[13]=[z(" Accueil ",-1)])),_:1,__:[13]}),g(k,{to:"/products",class:"text-gray-600 hover:text-[#0099cc] px-3 py-2 rounded-md text-sm font-medium transition-colors"},{default:re(()=>m[14]||(m[14]=[z(" Produits ",-1)])),_:1,__:[14]}),g(k,{to:"/how-it-works",class:"text-gray-600 hover:text-[#0099cc] px-3 py-2 rounded-md text-sm font-medium transition-colors"},{default:re(()=>m[15]||(m[15]=[z(" Comment ça marche ",-1)])),_:1,__:[15]}),g(k,{to:"/contact",class:"text-gray-600 hover:text-[#0099cc] px-3 py-2 rounded-md text-sm font-medium transition-colors"},{default:re(()=>m[16]||(m[16]=[z(" Contact ",-1)])),_:1,__:[16]})]),e("div",Ao,[l(w).isAuthenticated?(s(),o("div",Po,[g(k,{to:n.value,class:"bg-[#0099cc] hover:bg-[#0088bb] text-white px-2 sm:px-4 py-1.5 sm:py-2 rounded-md text-xs sm:text-sm font-medium transition-colors flex items-center whitespace-nowrap"},{default:re(()=>[g(l(ze),{class:"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2 flex-shrink-0"}),m[17]||(m[17]=e("span",{class:"hidden sm:inline"},"Mon Espace",-1)),m[18]||(m[18]=e("span",{class:"sm:hidden"},"Espace",-1))]),_:1,__:[17,18]},8,["to"]),e("div",Eo,[e("button",{onClick:m[1]||(m[1]=V=>f.value=!f.value),class:"flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100"},[e("div",jo,[l(w).user?.avatar_url?(s(),o("img",{key:0,src:l(w).user.avatar_url,alt:l(w).user?.first_name||"Avatar",class:"w-full h-full object-cover",onError:m[0]||(m[0]=V=>{V.target.style.display="none",V.target.nextElementSibling.style.display="flex"})},null,40,So)):T("",!0),e("div",{class:"w-8 h-8 bg-[#0099cc] rounded-full flex items-center justify-center",style:Me(l(w).user?.avatar_url?"display: none":"display: flex")},[e("span",Io,t(c.value),1)],4)]),g(l($t),{class:"w-4 h-4 text-gray-500"})]),f.value?(s(),o("div",{key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-200",onClick:m[3]||(m[3]=V=>f.value=!1)},[e("div",Do,[e("p",To,t(l(w).user?.first_name)+" "+t(l(w).user?.last_name),1),e("p",Mo,t(l(w).user?.email),1)]),g(k,{to:n.value,class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:m[2]||(m[2]=V=>f.value=!1)},{default:re(()=>[g(l(ze),{class:"w-4 h-4 inline mr-2"}),m[19]||(m[19]=z(" Mon Espace ",-1))]),_:1,__:[19]},8,["to"]),e("button",{onClick:r,class:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},[g(l(nt),{class:"w-4 h-4 inline mr-2"}),m[20]||(m[20]=z(" Se déconnecter ",-1))])])):T("",!0)])])):(s(),o("div",Lo,[g(k,{to:"/login",class:"text-gray-600 hover:text-[#0099cc] px-2 sm:px-3 py-1.5 sm:py-2 rounded-md text-xs sm:text-sm font-medium transition-colors whitespace-nowrap"},{default:re(()=>m[21]||(m[21]=[e("span",{class:"hidden sm:inline"},"Se connecter",-1),e("span",{class:"sm:hidden"},"Connexion",-1)])),_:1,__:[21]}),g(k,{to:"/register",class:"bg-[#0099cc] hover:bg-[#0088bb] text-white px-2 sm:px-4 py-1.5 sm:py-2 rounded-md text-xs sm:text-sm font-medium transition-colors whitespace-nowrap"},{default:re(()=>m[22]||(m[22]=[z(" S'inscrire ",-1)])),_:1,__:[22]})])),e("button",{onClick:m[4]||(m[4]=V=>p.value=!p.value),class:"md:hidden p-1 sm:p-2 rounded-md text-gray-400 hover:text-gray-600 flex-shrink-0"},[g(l(zt),{class:"w-5 h-5 sm:w-6 sm:h-6"})])])])]),p.value?(s(),o("div",Vo,[e("div",Ro,[g(k,{to:"/",class:"block px-3 py-2 rounded-md text-base font-medium text-gray-600 hover:text-[#0099cc] hover:bg-[#0099cc]/5",onClick:m[5]||(m[5]=V=>p.value=!1)},{default:re(()=>m[23]||(m[23]=[z(" Accueil ",-1)])),_:1,__:[23]}),g(k,{to:"/products",class:"block px-3 py-2 rounded-md text-base font-medium text-gray-600 hover:text-[#0099cc] hover:bg-[#0099cc]/5",onClick:m[6]||(m[6]=V=>p.value=!1)},{default:re(()=>m[24]||(m[24]=[z(" Produits ",-1)])),_:1,__:[24]}),g(k,{to:"/how-it-works",class:"block px-3 py-2 rounded-md text-base font-medium text-gray-600 hover:text-[#0099cc] hover:bg-[#0099cc]/5",onClick:m[7]||(m[7]=V=>p.value=!1)},{default:re(()=>m[25]||(m[25]=[z(" Comment ça marche ",-1)])),_:1,__:[25]}),g(k,{to:"/contact",class:"block px-3 py-2 rounded-md text-base font-medium text-gray-600 hover:text-[#0099cc] hover:bg-[#0099cc]/5",onClick:m[8]||(m[8]=V=>p.value=!1)},{default:re(()=>m[26]||(m[26]=[z(" Contact ",-1)])),_:1,__:[26]}),e("div",Fo,[l(w).isAuthenticated?(s(),o("div",No,[g(k,{to:n.value,class:"block px-3 py-2 rounded-md text-base font-medium bg-[#0099cc] text-white hover:bg-[#0088bb] flex items-center",onClick:m[9]||(m[9]=V=>p.value=!1)},{default:re(()=>[g(l(ze),{class:"w-5 h-5 mr-2"}),m[27]||(m[27]=z(" Mon Espace ",-1))]),_:1,__:[27]},8,["to"]),e("div",zo,t(l(w).user?.first_name)+" "+t(l(w).user?.last_name),1),e("button",{onClick:r,class:"block w-full text-left px-3 py-2 rounded-md text-base font-medium text-gray-600 hover:text-[#0099cc] hover:bg-[#0099cc]/5"},[g(l(nt),{class:"w-5 h-5 inline mr-2"}),m[28]||(m[28]=z(" Se déconnecter ",-1))])])):(s(),o("div",qo,[g(k,{to:"/login",class:"block px-3 py-2 rounded-md text-base font-medium text-gray-600 hover:text-[#0099cc] hover:bg-[#0099cc]/5",onClick:m[10]||(m[10]=V=>p.value=!1)},{default:re(()=>m[29]||(m[29]=[z(" Se connecter ",-1)])),_:1,__:[29]}),g(k,{to:"/register",class:"block px-3 py-2 rounded-md text-base font-medium bg-[#0099cc] text-white hover:bg-[#0088bb]",onClick:m[11]||(m[11]=V=>p.value=!1)},{default:re(()=>m[30]||(m[30]=[z(" S'inscrire ",-1)])),_:1,__:[30]})]))])])])):T("",!0)]),e("main",null,[g(U)]),g(vs)])}}},Bo={key:0,class:"mx-4 mb-4 p-4 rounded-lg border border-orange-300 animate-slideDown",style:{background:"linear-gradient(135deg, rgb(254, 215, 170) 0%, rgb(254, 235, 200) 100%)","box-shadow":"0 2px 8px rgba(251, 191, 36, 0.15)"}},Oo={class:"flex items-start space-x-3 mb-3"},Go={class:"flex-1"},Ho={class:"text-sm text-orange-700 leading-relaxed"},Ko={class:"flex justify-end"},Wo=["disabled"],Jo={key:0,class:"animate-spin w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24"},Xo={__name:"VerificationRequiredBanner",props:{actionText:{type:String,default:"Vérifier maintenant"}},setup(_){const y=Pe();$e();const{post:w}=ge(),p=R(!1),f=de(()=>y.isAuthenticated&&y.user&&!y.user.is_email_verified&&!y.user.verified_at),a=()=>y.isAdmin||y.isManager?"Vous devez vérifier votre compte pour accéder à toutes les fonctionnalités d'administration.":y.isMerchant?"Vous devez vérifier votre compte pour créer des produits et gérer vos tombolas.":"Vous devez vérifier votre compte pour acheter des articles et participer aux tirages spéciaux.",c=async()=>{if(!p.value){p.value=!0;try{const n=await w("/auth/resend-verification",{email:y.user.email});if(n.success)window.$toast&&window.$toast.success("Email de vérification envoyé ! Consultez votre boîte email.","📧 Vérification"),window.$toast&&setTimeout(()=>{window.$toast.info("Cliquez sur le lien dans l'email pour vérifier votre compte. Vérifiez aussi vos spams.","💡 Instructions",{duration:8e3})},1500);else throw new Error(n.message||"Erreur lors de l'envoi")}catch(n){if(console.error("Erreur verification:",n),window.$toast){const r=n.response?.data?.message||n.message||"Erreur lors de l'envoi de l'email";window.$toast.error(r,"❌ Erreur")}}finally{p.value=!1}}};return(n,r)=>f.value?(s(),o("div",Bo,[e("div",Oo,[r[1]||(r[1]=e("div",{class:"flex-shrink-0 text-orange-600"},[e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),e("div",Go,[r[0]||(r[0]=e("h4",{class:"text-lg font-semibold text-orange-800 mb-1"},"Compte non vérifié",-1)),e("p",Ho,t(a()),1)])]),e("div",Ko,[e("button",{onClick:c,disabled:p.value,class:"inline-flex items-center px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed hover:transform hover:scale-105 hover:shadow-lg"},[p.value?(s(),o("svg",Jo,r[2]||(r[2]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):T("",!0),z(" "+t(p.value?"Envoi en cours...":"Envoyer l'email de vérification"),1)],8,Wo)])])):T("",!0)}},xs=Ee(Xo,[["__scopeId","data-v-1e72aa13"]]),Yo={name:"NotificationIcon",setup(){const _=$e(),y=Pe(),w=R(!1),p=R([]),f=R(0),a=R(!1),c=de(()=>f.value>0),n=()=>{w.value=!w.value,w.value&&P()},r=()=>{w.value=!1},P=async()=>{if(y.isAuthenticated){a.value=!0;try{const i=await Ce.get("/notifications",{params:{limit:10}});i.data.success&&(p.value=i.data.data.notifications,f.value=i.data.data.stats.unread)}catch(i){console.error("Erreur lors du chargement des notifications:",i)}finally{a.value=!1}}},$=async()=>{if(y.isAuthenticated)try{const i=await Ce.get("/notifications/unread-count");i.data.success&&(f.value=i.data.data.unread_count)}catch(i){console.error("Erreur lors du chargement du nombre de notifications:",i)}},M=async i=>{try{await Ce.post(`/notifications/${i}/read`);const C=p.value.find(x=>x.id===i);C&&!C.is_read&&(C.is_read=!0,f.value=Math.max(0,f.value-1))}catch(C){console.error("Erreur lors du marquage de la notification:",C)}},D=async()=>{try{await Ce.post("/notifications/mark-all-read"),p.value.forEach(i=>{i.is_read=!0}),f.value=0}catch(i){console.error("Erreur lors du marquage de toutes les notifications:",i)}},m=async i=>{i.is_read||await M(i.id);const C=k(i);C&&_.push(C),r()},k=i=>{switch(i.type){case"order_status_changed":return`/customer/orders/${i.data?.order_number||""}`;case"lottery_winner":case"ticket_purchase":return"/customer/tickets";case"lottery_draw_result":return`/lotteries/${i.data?.lottery_id||""}`;case"merchant_payment":return"/merchant/orders";case"admin_alert":return"/admin/dashboard";default:return"/notifications"}},U=i=>({order_status_changed:"📦",lottery_winner:"🎉",ticket_purchase:"🎫",lottery_draw_result:"📊",merchant_payment:"💰",admin_alert:"⚠️",welcome:"👋",reminder:"⏰",system:"🔔"})[i]||"🔔",V=i=>({order_status_changed:"bg-blue-500",lottery_winner:"bg-green-500",ticket_purchase:"bg-purple-500",lottery_draw_result:"bg-orange-500",merchant_payment:"bg-yellow-500",admin_alert:"bg-red-500",welcome:"bg-blue-500",reminder:"bg-orange-500",system:"bg-gray-500"})[i]||"bg-gray-500",v=i=>{const C=new Date,x=new Date(i),I=Math.floor((C-x)/1e3);return I<60?"À l'instant":I<3600?`${Math.floor(I/60)}min`:I<86400?`${Math.floor(I/3600)}h`:I<604800?`${Math.floor(I/86400)}j`:x.toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:x.getFullYear()!==C.getFullYear()?"numeric":void 0})},d=i=>{w.value&&!i.target.closest(".relative")&&r()};return ve(()=>{$(),document.addEventListener("click",d);const i=setInterval($,3e4);st(()=>{clearInterval(i),document.removeEventListener("click",d)})}),{showDropdown:w,notifications:p,unreadCount:f,loading:a,hasUnread:c,toggleDropdown:n,closeDropdown:r,markAllAsRead:D,handleNotificationClick:m,getNotificationIcon:U,getNotificationIconClass:V,formatTimeAgo:v}}},Qo={class:"relative"},Zo={key:0,class:"absolute -top-1 -right-1 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full"},er={key:1,class:"absolute top-1 right-1 block w-2 h-2 bg-red-600 rounded-full"},tr={class:"px-4 py-3 border-b border-gray-100 flex items-center justify-between"},sr={class:"text-sm font-medium text-gray-900"},or={key:0,class:"text-blue-600"},rr=["disabled"],ar={class:"max-h-96 overflow-y-auto"},nr={key:0,class:"flex items-center justify-center py-8"},ir={key:1,class:"divide-y divide-gray-100"},lr=["onClick"],dr={class:"flex items-start space-x-3"},ur={class:"flex-shrink-0 mt-1"},cr={class:"flex-1 min-w-0"},mr=["innerHTML"],pr=["innerHTML"],gr={class:"text-xs text-gray-400 mt-2"},fr={key:0,class:"flex-shrink-0"},vr={key:2,class:"px-4 py-8 text-center text-gray-500"},xr={key:0,class:"px-4 py-3 border-t border-gray-100"};function br(_,y,w,p,f,a){const c=he("router-link");return s(),o("div",Qo,[e("button",{onClick:y[0]||(y[0]=(...n)=>p.toggleDropdown&&p.toggleDropdown(...n)),class:te(["relative p-2 text-gray-600 hover:text-gray-900 focus:outline-none focus:text-gray-900 transition-colors duration-200",{"text-blue-600":p.hasUnread}])},[y[3]||(y[3]=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)),p.unreadCount>0?(s(),o("span",Zo,t(p.unreadCount>99?"99+":p.unreadCount),1)):p.hasUnread?(s(),o("span",er)):T("",!0)],2),g(Ts,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:re(()=>[p.showDropdown?(s(),o("div",{key:0,class:"absolute right-0 z-50 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 py-2",onClick:y[2]||(y[2]=_e(()=>{},["stop"]))},[e("div",tr,[e("h3",sr,[y[4]||(y[4]=z(" Notifications ",-1)),p.unreadCount>0?(s(),o("span",or,"("+t(p.unreadCount)+")",1)):T("",!0)]),p.unreadCount>0?(s(),o("button",{key:0,onClick:y[1]||(y[1]=(...n)=>p.markAllAsRead&&p.markAllAsRead(...n)),class:"text-xs text-blue-600 hover:text-blue-800 font-medium",disabled:p.loading}," Tout marquer lu ",8,rr)):T("",!0)]),e("div",ar,[p.loading?(s(),o("div",nr,y[5]||(y[5]=[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"},null,-1)]))):p.notifications.length>0?(s(),o("div",ir,[(s(!0),o(ie,null,le(p.notifications,n=>(s(),o("div",{key:n.id,onClick:r=>p.handleNotificationClick(n),class:te(["px-4 py-3 hover:bg-gray-50 cursor-pointer transition-colors duration-150",{"bg-blue-50 border-l-4 border-l-blue-500":!n.is_read,"opacity-75":n.is_read}])},[e("div",dr,[e("div",ur,[e("div",{class:te(["w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-medium",p.getNotificationIconClass(n.type)])},t(p.getNotificationIcon(n.type)),3)]),e("div",cr,[e("p",{class:"text-sm font-medium text-gray-900",innerHTML:n.title},null,8,mr),e("p",{class:"text-xs text-gray-600 mt-1 line-clamp-2",innerHTML:n.message},null,8,pr),e("p",gr,t(p.formatTimeAgo(n.created_at)),1)]),n.is_read?T("",!0):(s(),o("div",fr,y[6]||(y[6]=[e("div",{class:"w-2 h-2 bg-blue-600 rounded-full"},null,-1)])))])],10,lr))),128))])):(s(),o("div",vr,y[7]||(y[7]=[e("svg",{class:"w-12 h-12 mx-auto text-gray-300 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1),e("p",{class:"text-sm"},"Aucune notification",-1)])))]),p.notifications.length>0?(s(),o("div",xr,[g(c,{to:"/notifications",onClick:p.closeDropdown,class:"text-sm text-blue-600 hover:text-blue-800 font-medium block text-center"},{default:re(()=>y[8]||(y[8]=[z(" Voir toutes les notifications ",-1)])),_:1,__:[8]},8,["onClick"])])):T("",!0)])):T("",!0)]),_:1})])}const bs=Ee(Yo,[["render",br],["__scopeId","data-v-af25b147"]]),yr={class:"min-h-screen bg-gray-50"},hr={class:"bg-white shadow-sm border-b border-gray-200"},_r={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},wr={class:"flex justify-between items-center h-16"},$r={class:"flex items-center min-w-0 flex-shrink-0"},kr={key:1,class:"flex items-center space-x-1 sm:space-x-2"},Cr={class:"hidden md:flex space-x-8"},Ar={class:"flex items-center space-x-2 sm:space-x-4"},Pr={class:"relative"},Er={class:"w-7 h-7 sm:w-8 sm:h-8 rounded-full overflow-hidden flex-shrink-0 border border-gray-200"},jr=["src","alt"],Sr={key:1,class:"w-full h-full bg-[#0099cc] flex items-center justify-center"},Ir={class:"text-xs sm:text-sm font-medium text-white"},Dr={class:"hidden md:block text-left min-w-0"},Tr={class:"text-sm font-medium text-gray-700 truncate"},Mr={class:"text-xs text-gray-500 truncate"},Lr={key:0,class:"md:hidden border-t border-gray-200 bg-white"},Vr={class:"px-4 py-3 space-y-1"},Rr={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},Fr={__name:"CustomerLayout",setup(_){const y=Pe(),w=$e();ge();const p=R(!1),f=R(!1),a=R(!1),c=[{name:"customer.dashboard",to:{name:"customer.dashboard"},label:"Accueil"},{name:"customer.products",to:{name:"customer.products"},label:"Produits"},{name:"customer.tickets",to:{name:"customer.tickets"},label:"Mes Tickets"},{name:"customer.orders",to:{name:"customer.orders"},label:"Mes Commandes"}],n=de(()=>{const m=y.user;return m?(m.first_name?.[0]||"")+(m.last_name?.[0]||""):"U"}),r=de(()=>y.isAuthenticated&&y.user&&!y.user.verified_at),P=async()=>{await y.logout(),w.push({name:"login"})},$=m=>{console.log("Avatar image failed to load, hiding image element"),m.target.style.display="none"},M=()=>{a.value=!0},D=m=>{m.target.closest(".relative")||(p.value=!1)};return ve(()=>{document.addEventListener("click",D),st(()=>{document.removeEventListener("click",D)})}),(m,k)=>{const U=he("router-link"),V=he("router-view");return s(),o("div",yr,[e("header",hr,[e("div",_r,[e("div",wr,[e("div",$r,[g(U,{to:"/",class:"flex items-center"},{default:re(()=>[a.value?(s(),o("div",kr,k[7]||(k[7]=[e("div",{class:"w-6 h-6 sm:w-8 sm:h-8 bg-[#0099cc] rounded flex items-center justify-center flex-shrink-0"},[e("span",{class:"text-white font-bold text-sm sm:text-lg"},"K")],-1),e("span",{class:"text-lg sm:text-xl font-bold text-[#0099cc] whitespace-nowrap"},"Koumbaya",-1)]))):(s(),o("img",{key:0,class:"h-8 sm:h-10 w-auto object-contain max-w-none",src:fs,alt:"Koumbaya Marketplace",onError:M},null,32))]),_:1})]),e("nav",Cr,[(s(),o(ie,null,le(c,v=>g(U,{key:v.name,to:v.to,class:te(["px-3 py-2 rounded-md text-sm font-medium transition-colors",m.$route.name===v.name?"text-white bg-[#0099cc]":"text-gray-600 hover:text-[#0099cc] hover:bg-[#0099cc]/5"])},{default:re(()=>[z(t(v.label),1)]),_:2},1032,["to","class"])),64))]),e("div",Ar,[g(bs),e("div",Pr,[e("button",{onClick:k[0]||(k[0]=v=>p.value=!p.value),class:"flex items-center space-x-1 sm:space-x-3 p-1 sm:p-2 rounded-lg hover:bg-gray-100"},[e("div",Er,[l(y).user?.avatar_url?(s(),o("img",{key:0,src:l(y).user.avatar_url,alt:`Photo de profil de ${l(y).user.first_name} ${l(y).user.last_name}`,class:"w-full h-full object-cover",onError:$},null,40,jr)):(s(),o("div",Sr,[e("span",Ir,t(n.value),1)]))]),e("div",Dr,[e("p",Tr,t(l(y).user?.first_name),1),e("p",Mr,t(l(y).user?.email),1)]),g(l($t),{class:"w-3 h-3 sm:w-4 sm:h-4 text-gray-500 flex-shrink-0"})]),p.value?(s(),o("div",{key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-200",onClick:k[4]||(k[4]=v=>p.value=!1)},[g(U,{to:"/customer/profile",class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:k[1]||(k[1]=v=>p.value=!1)},{default:re(()=>[g(l(ze),{class:"w-4 h-4 inline mr-2"}),k[8]||(k[8]=z(" Mon Profil ",-1))]),_:1,__:[8]}),g(U,{to:"/customer/tickets",class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:k[2]||(k[2]=v=>p.value=!1)},{default:re(()=>[g(l(je),{class:"w-4 h-4 inline mr-2"}),k[9]||(k[9]=z(" Mes Tickets ",-1))]),_:1,__:[9]}),g(U,{to:"/customer/payments",class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:k[3]||(k[3]=v=>p.value=!1)},{default:re(()=>[g(l(Xe),{class:"w-4 h-4 inline mr-2"}),k[10]||(k[10]=z(" Mes Paiements ",-1))]),_:1,__:[10]}),k[12]||(k[12]=e("div",{class:"border-t border-gray-100 my-1"},null,-1)),e("button",{onClick:P,class:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},[g(l(nt),{class:"w-4 h-4 inline mr-2"}),k[11]||(k[11]=z(" Se déconnecter ",-1))])])):T("",!0)]),e("button",{onClick:k[5]||(k[5]=v=>f.value=!f.value),class:"md:hidden p-1 sm:p-2 rounded-md text-gray-400 hover:text-gray-600 flex-shrink-0"},[g(l(zt),{class:"w-5 h-5 sm:w-6 sm:h-6"})])])])]),f.value?(s(),o("div",Lr,[e("div",Vr,[(s(),o(ie,null,le(c,v=>g(U,{key:v.name,to:v.to,class:te(["block px-3 py-2 rounded-md text-base font-medium",m.$route.name===v.name?"text-[#0099cc] bg-blue-50":"text-gray-600 hover:text-[#0099cc] hover:bg-blue-50"]),onClick:k[6]||(k[6]=d=>f.value=!1)},{default:re(()=>[z(t(v.label),1)]),_:2},1032,["to","class"])),64))])])):T("",!0)]),e("main",Rr,[r.value?(s(),ce(xs,{key:0})):T("",!0),g(V)]),g(vs)])}}},Nr="/build/icon.png",zr={class:"min-h-screen admin-layout"},qr={class:"flex items-center justify-between h-16 px-6 border-b border-gray-700"},Ur={class:"w-8 h-8 bg-white rounded-lg flex items-center justify-center p-1"},Br=["src"],Or={class:"mt-6 flex-1"},Gr={class:"px-3 space-y-1"},Hr={class:"font-medium"},Kr={key:0,class:"ml-auto bg-orange-500 text-white text-xs px-2 py-1 rounded-full"},Wr={class:"absolute bottom-4 left-0 right-0 px-3"},Jr={class:"bg-gray-700 rounded-lg p-4"},Xr={class:"flex items-center space-x-3"},Yr={class:"w-10 h-10 rounded-full overflow-hidden flex-shrink-0 border border-gray-600"},Qr=["src","alt"],Zr={key:1,class:"w-full h-full bg-gray-600 flex items-center justify-center"},ea={class:"text-sm font-medium text-gray-300"},ta={class:"flex-1 min-w-0"},sa={class:"text-sm font-medium text-white truncate"},oa={class:"lg:pl-72"},ra={class:"admin-header sticky top-0 z-30"},aa={class:"flex items-center justify-between px-6 py-4"},na={class:"flex items-center space-x-4"},ia={class:"hidden lg:flex items-center space-x-2 text-sm"},la={class:"text-gray-600"},da={class:"flex items-center space-x-4"},ua={class:"hidden md:flex items-center"},ca={class:"relative"},ma={class:"relative"},pa={class:"w-8 h-8 rounded-lg overflow-hidden flex-shrink-0 border border-gray-200"},ga=["src","alt"],fa={key:1,class:"w-full h-full bg-[#0099cc] flex items-center justify-center"},va={class:"text-sm font-semibold text-white"},xa={class:"hidden md:block text-left"},ba={class:"text-sm font-semibold text-gray-800"},ya={class:"px-4 py-3 border-b border-gray-100"},ha={class:"text-sm font-medium text-gray-800"},_a={class:"text-xs text-gray-500"},wa={class:"border-t border-gray-100 mt-2 pt-2"},$a={class:"p-6"},ka={__name:"AdminLayout",setup(_){const y=Pe(),w=$e(),p=Be(),{get:f}=ge(),a=R(!0),c=R(!1),n=R({users:0,lotteries:0,refunds:0}),r=de(()=>[{name:"admin.dashboard",to:{name:"admin.dashboard"},label:"Tableau de bord",icon:Yt},{name:"admin.users",to:{name:"admin.users"},label:"Utilisateurs",icon:vt,badge:n.value.users>0?n.value.users.toString():null},{name:"admin.products",to:{name:"admin.products"},label:"Produits",icon:qe},{name:"admin.lotteries",to:{name:"admin.lotteries"},label:"Tombolas",icon:ot,badge:n.value.lotteries>0?n.value.lotteries.toString():null},{name:"admin.orders",to:{name:"admin.orders"},label:"Commandes",icon:Ms},{name:"admin.vendors",to:{name:"admin.vendors"},label:"Vendeurs Pro",icon:Ls},{name:"admin.refunds",to:{name:"admin.refunds"},label:"Remboursements",icon:Ke,badge:n.value.refunds>0?n.value.refunds.toString():null},{name:"admin.payments",to:{name:"admin.payments"},label:"Paiements",icon:Ke},{name:"admin.settings",to:{name:"admin.settings"},label:"Paramètres",icon:Qt}]),P=de(()=>r.value.find(V=>V.name===p.name)?.label||"Page"),$=async()=>{try{const U=await f("/admin/dashboard/stats");U?.data?.users&&(n.value.users=U.data.users.growth>0?Math.ceil(U.data.users.total*(U.data.users.growth/100)):0);const V=await f("/admin/lotteries?status=active");if(V?.data?.lotteries){const d=V.data.lotteries.filter(i=>{const I=(new Date(i.end_date)-new Date)/(1e3*60*60);return I<=24&&I>0});n.value.lotteries=d.length}const v=await f("/admin/refunds?status=pending");v?.data?.refunds&&(n.value.refunds=v.data.refunds.length)}catch(U){console.error("Erreur lors du chargement des compteurs de badges:",U)}},M=de(()=>{const U=y.user;return U?(U.first_name?.[0]||"")+(U.last_name?.[0]||""):"AD"}),D=async()=>{await y.logout(),w.push({name:"login"})},m=U=>{console.log("Avatar image failed to load, hiding image element"),U.target.style.display="none"},k=U=>{U.target.closest(".relative")||(c.value=!1)};return ve(()=>{document.addEventListener("click",k),$();const U=setInterval($,300*1e3);st(()=>{document.removeEventListener("click",k),clearInterval(U)})}),(U,V)=>{const v=he("router-link"),d=he("router-view");return s(),o("div",zr,[e("aside",{class:te(["fixed inset-y-0 left-0 z-50 w-72 admin-sidebar transform transition-transform duration-300 ease-in-out lg:translate-x-0",{"-translate-x-full lg:translate-x-0":!a.value,"translate-x-0":a.value}])},[e("div",qr,[g(v,{to:"/admin/dashboard",class:"flex items-center space-x-3 hover:opacity-80 transition-opacity"},{default:re(()=>[e("div",Ur,[e("img",{src:l(Nr),alt:"Koumbaya",class:"w-full h-full object-contain"},null,8,Br)]),V[6]||(V[6]=e("div",{class:"text-white"},[e("h1",{class:"text-lg font-bold"},"Koumbaya"),e("p",{class:"text-xs text-gray-300"},"Administration")],-1))]),_:1,__:[6]})]),e("nav",Or,[e("div",Gr,[(s(!0),o(ie,null,le(r.value,i=>(s(),ce(v,{key:i.name,to:i.to,class:te(["admin-sidebar-item",U.$route.name===i.name?"active":""])},{default:re(()=>[(s(),ce(Ie(i.icon),{class:"w-5 h-5 mr-3"})),e("span",Hr,t(i.label),1),i.badge?(s(),o("span",Kr,t(i.badge),1)):T("",!0)]),_:2},1032,["to","class"]))),128))]),e("div",Wr,[e("div",Jr,[e("div",Xr,[e("div",Yr,[l(y).user?.avatar_url?(s(),o("img",{key:0,src:l(y).user.avatar_url,alt:`Photo de profil de ${l(y).user.first_name} ${l(y).user.last_name}`,class:"w-full h-full object-cover",onError:m},null,40,Qr)):(s(),o("div",Zr,[e("span",ea,t(M.value),1)]))]),e("div",ta,[e("p",sa,t(l(y).user?.first_name)+" "+t(l(y).user?.last_name),1),V[7]||(V[7]=e("p",{class:"text-xs text-gray-300 truncate"},"Super Administrateur",-1))]),e("button",{onClick:D,class:"text-gray-300 hover:text-white transition-colors",title:"Se déconnecter"},[g(l(nt),{class:"w-5 h-5"})])])])])])],2),a.value?(s(),o("div",{key:0,class:"fixed inset-0 z-40 bg-black/40 lg:hidden",onClick:V[0]||(V[0]=i=>a.value=!1)})):T("",!0),e("div",oa,[e("header",ra,[e("div",aa,[e("div",na,[e("button",{onClick:V[1]||(V[1]=i=>a.value=!a.value),class:"lg:hidden p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors"},[g(l(zt),{class:"w-6 h-6"})]),e("nav",ia,[g(l(Yt),{class:"w-4 h-4 text-gray-400"}),g(l(is),{class:"w-4 h-4 text-gray-400"}),e("span",la,t(P.value),1)])]),e("div",da,[g(bs),e("div",ua,[e("div",ca,[g(l(it),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),V[8]||(V[8]=e("input",{type:"text",placeholder:"Rechercher...",class:"pl-10 pr-4 py-2 w-64 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#0099cc] focus:border-transparent"},null,-1))])]),e("div",ma,[e("button",{onClick:V[2]||(V[2]=i=>c.value=!c.value),class:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 transition-colors"},[e("div",pa,[l(y).user?.avatar_url?(s(),o("img",{key:0,src:l(y).user.avatar_url,alt:`Photo de profil de ${l(y).user.first_name} ${l(y).user.last_name}`,class:"w-full h-full object-cover",onError:m},null,40,ga)):(s(),o("div",fa,[e("span",va,t(M.value),1)]))]),e("div",xa,[e("p",ba,t(l(y).user?.first_name)+" "+t(l(y).user?.last_name),1),V[9]||(V[9]=e("p",{class:"text-xs text-gray-500"},"Super Admin",-1))]),g(l($t),{class:"w-4 h-4 text-gray-400"})]),c.value?(s(),o("div",{key:0,class:"absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-lg border border-gray-200 py-2 z-50",onClick:V[5]||(V[5]=i=>c.value=!1)},[e("div",ya,[e("p",ha,t(l(y).user?.first_name)+" "+t(l(y).user?.last_name),1),e("p",_a,t(l(y).user?.email),1)]),g(v,{to:{name:"admin.profile"},onClick:V[3]||(V[3]=i=>c.value=!1),class:"flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors"},{default:re(()=>[g(l(ze),{class:"w-4 h-4 mr-3 text-gray-400"}),V[10]||(V[10]=z(" Mon Profil ",-1))]),_:1,__:[10]}),g(v,{to:{name:"admin.settings"},onClick:V[4]||(V[4]=i=>c.value=!1),class:"flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-gray-100 transition-colors"},{default:re(()=>[g(l(Qt),{class:"w-4 h-4 mr-3 text-gray-400"}),V[11]||(V[11]=z(" Paramètres ",-1))]),_:1,__:[11]}),e("div",wa,[e("button",{onClick:D,class:"flex items-center w-full px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors"},[g(l(nt),{class:"w-4 h-4 mr-3"}),V[12]||(V[12]=z(" Se déconnecter ",-1))])])])):T("",!0)])])])]),e("main",$a,[g(xs),g(d)])])])}}};var sB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ca(_){return _&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_}var St={exports:{}},ss;function Aa(){return ss||(ss=1,function(_){(function(y){_.exports?_.exports=y():window.intlTelInput=y()})(()=>{var y=(()=>{var w=Object.defineProperty,p=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,c=(S,E)=>{for(var F in E)w(S,F,{get:E[F],enumerable:!0})},n=(S,E,F,q)=>{if(E&&typeof E=="object"||typeof E=="function")for(let O of f(E))!a.call(S,O)&&O!==F&&w(S,O,{get:()=>E[O],enumerable:!(q=p(E,O))||q.enumerable});return S},r=S=>n(w({},"__esModule",{value:!0}),S),P={};c(P,{Iti:()=>h,default:()=>B});var $=[["af","93"],["ax","358",1],["al","355"],["dz","213"],["as","1",5,["684"]],["ad","376"],["ao","244"],["ai","1",6,["264"]],["ag","1",7,["268"]],["ar","54"],["am","374"],["aw","297"],["ac","247"],["au","61",0,null,"0"],["at","43"],["az","994"],["bs","1",8,["242"]],["bh","973"],["bd","880"],["bb","1",9,["246"]],["by","375"],["be","32"],["bz","501"],["bj","229"],["bm","1",10,["441"]],["bt","975"],["bo","591"],["ba","387"],["bw","267"],["br","55"],["io","246"],["vg","1",11,["284"]],["bn","673"],["bg","359"],["bf","226"],["bi","257"],["kh","855"],["cm","237"],["ca","1",1,["204","226","236","249","250","263","289","306","343","354","365","367","368","382","387","403","416","418","428","431","437","438","450","584","468","474","506","514","519","548","579","581","584","587","604","613","639","647","672","683","705","709","742","753","778","780","782","807","819","825","867","873","879","902","905"]],["cv","238"],["bq","599",1,["3","4","7"]],["ky","1",12,["345"]],["cf","236"],["td","235"],["cl","56"],["cn","86"],["cx","61",2,["89164"],"0"],["cc","61",1,["89162"],"0"],["co","57"],["km","269"],["cg","242"],["cd","243"],["ck","682"],["cr","506"],["ci","225"],["hr","385"],["cu","53"],["cw","599",0],["cy","357"],["cz","420"],["dk","45"],["dj","253"],["dm","1",13,["767"]],["do","1",2,["809","829","849"]],["ec","593"],["eg","20"],["sv","503"],["gq","240"],["er","291"],["ee","372"],["sz","268"],["et","251"],["fk","500"],["fo","298"],["fj","679"],["fi","358",0],["fr","33"],["gf","594"],["pf","689"],["ga","241"],["gm","220"],["ge","995"],["de","49"],["gh","233"],["gi","350"],["gr","30"],["gl","299"],["gd","1",14,["473"]],["gp","590",0],["gu","1",15,["671"]],["gt","502"],["gg","44",1,["1481","7781","7839","7911"],"0"],["gn","224"],["gw","245"],["gy","592"],["ht","509"],["hn","504"],["hk","852"],["hu","36"],["is","354"],["in","91"],["id","62"],["ir","98"],["iq","964"],["ie","353"],["im","44",2,["1624","74576","7524","7924","7624"],"0"],["il","972"],["it","39",0],["jm","1",4,["876","658"]],["jp","81"],["je","44",3,["1534","7509","7700","7797","7829","7937"],"0"],["jo","962"],["kz","7",1,["33","7"],"8"],["ke","254"],["ki","686"],["xk","383"],["kw","965"],["kg","996"],["la","856"],["lv","371"],["lb","961"],["ls","266"],["lr","231"],["ly","218"],["li","423"],["lt","370"],["lu","352"],["mo","853"],["mg","261"],["mw","265"],["my","60"],["mv","960"],["ml","223"],["mt","356"],["mh","692"],["mq","596"],["mr","222"],["mu","230"],["yt","262",1,["269","639"],"0"],["mx","52"],["fm","691"],["md","373"],["mc","377"],["mn","976"],["me","382"],["ms","1",16,["664"]],["ma","212",0,null,"0"],["mz","258"],["mm","95"],["na","264"],["nr","674"],["np","977"],["nl","31"],["nc","687"],["nz","64"],["ni","505"],["ne","227"],["ng","234"],["nu","683"],["nf","672"],["kp","850"],["mk","389"],["mp","1",17,["670"]],["no","47",0],["om","968"],["pk","92"],["pw","680"],["ps","970"],["pa","507"],["pg","675"],["py","595"],["pe","51"],["ph","63"],["pl","48"],["pt","351"],["pr","1",3,["787","939"]],["qa","974"],["re","262",0,null,"0"],["ro","40"],["ru","7",0,null,"8"],["rw","250"],["ws","685"],["sm","378"],["st","239"],["sa","966"],["sn","221"],["rs","381"],["sc","248"],["sl","232"],["sg","65"],["sx","1",21,["721"]],["sk","421"],["si","386"],["sb","677"],["so","252"],["za","27"],["kr","82"],["ss","211"],["es","34"],["lk","94"],["bl","590",1],["sh","290"],["kn","1",18,["869"]],["lc","1",19,["758"]],["mf","590",2],["pm","508"],["vc","1",20,["784"]],["sd","249"],["sr","597"],["sj","47",1,["79"]],["se","46"],["ch","41"],["sy","963"],["tw","886"],["tj","992"],["tz","255"],["th","66"],["tl","670"],["tg","228"],["tk","690"],["to","676"],["tt","1",22,["868"]],["tn","216"],["tr","90"],["tm","993"],["tc","1",23,["649"]],["tv","688"],["ug","256"],["ua","380"],["ae","971"],["gb","44",0,null,"0"],["us","1",0],["uy","598"],["vi","1",24,["340"]],["uz","998"],["vu","678"],["va","39",1,["06698"]],["ve","58"],["vn","84"],["wf","681"],["eh","212",1,["5288","5289"],"0"],["ye","967"],["zm","260"],["zw","263"]],M=[];for(let S=0;S<$.length;S++){const E=$[S];M[S]={name:"",iso2:E[0],dialCode:E[1],priority:E[2]||0,areaCodes:E[3]||null,nodeById:{},nationalPrefix:E[4]||null}}var D=M,m={ad:"Andorra",ae:"United Arab Emirates",af:"Afghanistan",ag:"Antigua & Barbuda",ai:"Anguilla",al:"Albania",am:"Armenia",ao:"Angola",ar:"Argentina",as:"American Samoa",at:"Austria",au:"Australia",aw:"Aruba",ax:"Åland Islands",az:"Azerbaijan",ba:"Bosnia & Herzegovina",bb:"Barbados",bd:"Bangladesh",be:"Belgium",bf:"Burkina Faso",bg:"Bulgaria",bh:"Bahrain",bi:"Burundi",bj:"Benin",bl:"St. Barthélemy",bm:"Bermuda",bn:"Brunei",bo:"Bolivia",bq:"Caribbean Netherlands",br:"Brazil",bs:"Bahamas",bt:"Bhutan",bw:"Botswana",by:"Belarus",bz:"Belize",ca:"Canada",cc:"Cocos (Keeling) Islands",cd:"Congo - Kinshasa",cf:"Central African Republic",cg:"Congo - Brazzaville",ch:"Switzerland",ci:"Côte d’Ivoire",ck:"Cook Islands",cl:"Chile",cm:"Cameroon",cn:"China",co:"Colombia",cr:"Costa Rica",cu:"Cuba",cv:"Cape Verde",cw:"Curaçao",cx:"Christmas Island",cy:"Cyprus",cz:"Czechia",de:"Germany",dj:"Djibouti",dk:"Denmark",dm:"Dominica",do:"Dominican Republic",dz:"Algeria",ec:"Ecuador",ee:"Estonia",eg:"Egypt",eh:"Western Sahara",er:"Eritrea",es:"Spain",et:"Ethiopia",fi:"Finland",fj:"Fiji",fk:"Falkland Islands",fm:"Micronesia",fo:"Faroe Islands",fr:"France",ga:"Gabon",gb:"United Kingdom",gd:"Grenada",ge:"Georgia",gf:"French Guiana",gg:"Guernsey",gh:"Ghana",gi:"Gibraltar",gl:"Greenland",gm:"Gambia",gn:"Guinea",gp:"Guadeloupe",gq:"Equatorial Guinea",gr:"Greece",gt:"Guatemala",gu:"Guam",gw:"Guinea-Bissau",gy:"Guyana",hk:"Hong Kong SAR China",hn:"Honduras",hr:"Croatia",ht:"Haiti",hu:"Hungary",id:"Indonesia",ie:"Ireland",il:"Israel",im:"Isle of Man",in:"India",io:"British Indian Ocean Territory",iq:"Iraq",ir:"Iran",is:"Iceland",it:"Italy",je:"Jersey",jm:"Jamaica",jo:"Jordan",jp:"Japan",ke:"Kenya",kg:"Kyrgyzstan",kh:"Cambodia",ki:"Kiribati",km:"Comoros",kn:"St. Kitts & Nevis",kp:"North Korea",kr:"South Korea",kw:"Kuwait",ky:"Cayman Islands",kz:"Kazakhstan",la:"Laos",lb:"Lebanon",lc:"St. Lucia",li:"Liechtenstein",lk:"Sri Lanka",lr:"Liberia",ls:"Lesotho",lt:"Lithuania",lu:"Luxembourg",lv:"Latvia",ly:"Libya",ma:"Morocco",mc:"Monaco",md:"Moldova",me:"Montenegro",mf:"St. Martin",mg:"Madagascar",mh:"Marshall Islands",mk:"North Macedonia",ml:"Mali",mm:"Myanmar (Burma)",mn:"Mongolia",mo:"Macao SAR China",mp:"Northern Mariana Islands",mq:"Martinique",mr:"Mauritania",ms:"Montserrat",mt:"Malta",mu:"Mauritius",mv:"Maldives",mw:"Malawi",mx:"Mexico",my:"Malaysia",mz:"Mozambique",na:"Namibia",nc:"New Caledonia",ne:"Niger",nf:"Norfolk Island",ng:"Nigeria",ni:"Nicaragua",nl:"Netherlands",no:"Norway",np:"Nepal",nr:"Nauru",nu:"Niue",nz:"New Zealand",om:"Oman",pa:"Panama",pe:"Peru",pf:"French Polynesia",pg:"Papua New Guinea",ph:"Philippines",pk:"Pakistan",pl:"Poland",pm:"St. Pierre & Miquelon",pr:"Puerto Rico",ps:"Palestinian Territories",pt:"Portugal",pw:"Palau",py:"Paraguay",qa:"Qatar",re:"Réunion",ro:"Romania",rs:"Serbia",ru:"Russia",rw:"Rwanda",sa:"Saudi Arabia",sb:"Solomon Islands",sc:"Seychelles",sd:"Sudan",se:"Sweden",sg:"Singapore",sh:"St. Helena",si:"Slovenia",sj:"Svalbard & Jan Mayen",sk:"Slovakia",sl:"Sierra Leone",sm:"San Marino",sn:"Senegal",so:"Somalia",sr:"Suriname",ss:"South Sudan",st:"São Tomé & Príncipe",sv:"El Salvador",sx:"Sint Maarten",sy:"Syria",sz:"Eswatini",tc:"Turks & Caicos Islands",td:"Chad",tg:"Togo",th:"Thailand",tj:"Tajikistan",tk:"Tokelau",tl:"Timor-Leste",tm:"Turkmenistan",tn:"Tunisia",to:"Tonga",tr:"Turkey",tt:"Trinidad & Tobago",tv:"Tuvalu",tw:"Taiwan",tz:"Tanzania",ua:"Ukraine",ug:"Uganda",us:"United States",uy:"Uruguay",uz:"Uzbekistan",va:"Vatican City",vc:"St. Vincent & Grenadines",ve:"Venezuela",vg:"British Virgin Islands",vi:"U.S. Virgin Islands",vn:"Vietnam",vu:"Vanuatu",wf:"Wallis & Futuna",ws:"Samoa",ye:"Yemen",yt:"Mayotte",za:"South Africa",zm:"Zambia",zw:"Zimbabwe"},k=m,U={selectedCountryAriaLabel:"Selected country",noCountrySelected:"No country selected",countryListAriaLabel:"List of countries",searchPlaceholder:"Search",zeroSearchResults:"No results found",oneSearchResult:"1 result found",multipleSearchResults:"${count} results found",ac:"Ascension Island",xk:"Kosovo"},V=U,v={...k,...V},d=v;for(let S=0;S<D.length;S++)D[S].name=d[D[S].iso2];var i=0,C={allowDropdown:!0,autoPlaceholder:"polite",containerClass:"",countryOrder:null,countrySearch:!0,customPlaceholder:null,dropdownContainer:null,excludeCountries:[],fixDropdownWidth:!0,formatAsYouType:!0,formatOnDisplay:!0,geoIpLookup:null,hiddenInput:null,i18n:{},initialCountry:"",loadUtils:null,nationalMode:!0,onlyCountries:[],placeholderNumberType:"MOBILE",showFlags:!0,separateDialCode:!1,strictMode:!1,useFullscreenPopup:typeof navigator<"u"&&typeof window<"u"?/Android.+Mobile|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=500:!1,validationNumberTypes:["MOBILE"]},x=["800","822","833","844","855","866","877","880","881","882","883","884","885","886","887","888","889"],I=S=>S.replace(/\D/g,""),N=(S="")=>S.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),u=S=>{const E=I(S);if(E.charAt(0)==="1"){const F=E.substr(1,3);return x.includes(F)}return!1},A=(S,E,F,q)=>{if(F===0&&!q)return 0;let O=0;for(let K=0;K<E.length;K++){if(/[+0-9]/.test(E[K])&&O++,O===S&&!q)return K+1;if(q&&O===S+1)return K}return E.length},H=(S,E,F)=>{const q=document.createElement(S);return E&&Object.entries(E).forEach(([O,K])=>q.setAttribute(O,K)),F&&F.appendChild(q),q},j=(S,...E)=>{const{instances:F}=ee;Object.values(F).forEach(q=>q[S](...E))},h=class{constructor(S,E={}){this.id=i++,this.telInput=S,this.highlightedItem=null,this.options=Object.assign({},C,E),this.hadInitialPlaceholder=!!S.getAttribute("placeholder")}_init(){this.options.useFullscreenPopup&&(this.options.fixDropdownWidth=!1),this.options.onlyCountries.length===1&&(this.options.initialCountry=this.options.onlyCountries[0]),this.options.separateDialCode&&(this.options.nationalMode=!1),this.options.allowDropdown&&!this.options.showFlags&&!this.options.separateDialCode&&(this.options.nationalMode=!1),this.options.useFullscreenPopup&&!this.options.dropdownContainer&&(this.options.dropdownContainer=document.body),this.isAndroid=typeof navigator<"u"?/Android/i.test(navigator.userAgent):!1,this.isRTL=!!this.telInput.closest("[dir=rtl]");const S=this.options.allowDropdown||this.options.separateDialCode;this.showSelectedCountryOnLeft=this.isRTL?!S:S,this.options.separateDialCode&&(this.isRTL?this.originalPaddingRight=this.telInput.style.paddingRight:this.originalPaddingLeft=this.telInput.style.paddingLeft),this.options.i18n={...d,...this.options.i18n};const E=new Promise((q,O)=>{this.resolveAutoCountryPromise=q,this.rejectAutoCountryPromise=O}),F=new Promise((q,O)=>{this.resolveUtilsScriptPromise=q,this.rejectUtilsScriptPromise=O});this.promise=Promise.all([E,F]),this.selectedCountryData={},this._processCountryData(),this._generateMarkup(),this._setInitialState(),this._initListeners(),this._initRequests()}_processCountryData(){this._processAllCountries(),this._processDialCodes(),this._translateCountryNames(),this._sortCountries()}_sortCountries(){this.options.countryOrder&&(this.options.countryOrder=this.options.countryOrder.map(S=>S.toLowerCase())),this.countries.sort((S,E)=>{const{countryOrder:F}=this.options;if(F){const q=F.indexOf(S.iso2),O=F.indexOf(E.iso2),K=q>-1,W=O>-1;if(K||W)return K&&W?q-O:K?-1:1}return S.name.localeCompare(E.name)})}_addToDialCodeMap(S,E,F){E.length>this.dialCodeMaxLen&&(this.dialCodeMaxLen=E.length),this.dialCodeToIso2Map.hasOwnProperty(E)||(this.dialCodeToIso2Map[E]=[]);for(let O=0;O<this.dialCodeToIso2Map[E].length;O++)if(this.dialCodeToIso2Map[E][O]===S)return;const q=F!==void 0?F:this.dialCodeToIso2Map[E].length;this.dialCodeToIso2Map[E][q]=S}_processAllCountries(){const{onlyCountries:S,excludeCountries:E}=this.options;if(S.length){const F=S.map(q=>q.toLowerCase());this.countries=D.filter(q=>F.includes(q.iso2))}else if(E.length){const F=E.map(q=>q.toLowerCase());this.countries=D.filter(q=>!F.includes(q.iso2))}else this.countries=D}_translateCountryNames(){for(let S=0;S<this.countries.length;S++){const E=this.countries[S].iso2.toLowerCase();this.options.i18n.hasOwnProperty(E)&&(this.countries[S].name=this.options.i18n[E])}}_processDialCodes(){this.dialCodes={},this.dialCodeMaxLen=0,this.dialCodeToIso2Map={};for(let S=0;S<this.countries.length;S++){const E=this.countries[S];this.dialCodes[E.dialCode]||(this.dialCodes[E.dialCode]=!0),this._addToDialCodeMap(E.iso2,E.dialCode,E.priority)}for(let S=0;S<this.countries.length;S++){const E=this.countries[S];if(E.areaCodes){const F=this.dialCodeToIso2Map[E.dialCode][0];for(let q=0;q<E.areaCodes.length;q++){const O=E.areaCodes[q];for(let K=1;K<O.length;K++){const W=O.substr(0,K),J=E.dialCode+W;this._addToDialCodeMap(F,J),this._addToDialCodeMap(E.iso2,J)}this._addToDialCodeMap(E.iso2,E.dialCode+O)}}}}_generateMarkup(){this.telInput.classList.add("iti__tel-input"),!this.telInput.hasAttribute("autocomplete")&&!(this.telInput.form&&this.telInput.form.hasAttribute("autocomplete"))&&this.telInput.setAttribute("autocomplete","off");const{allowDropdown:S,separateDialCode:E,showFlags:F,containerClass:q,hiddenInput:O,dropdownContainer:K,fixDropdownWidth:W,useFullscreenPopup:J,countrySearch:G,i18n:ue}=this.options;let se="iti";S&&(se+=" iti--allow-dropdown"),F&&(se+=" iti--show-flags"),q&&(se+=` ${q}`),J||(se+=" iti--inline-dropdown");const fe=H("div",{class:se});if(this.telInput.parentNode?.insertBefore(fe,this.telInput),S||F||E){this.countryContainer=H("div",{class:"iti__country-container"},fe),this.showSelectedCountryOnLeft?this.countryContainer.style.left="0px":this.countryContainer.style.right="0px",S?(this.selectedCountry=H("button",{type:"button",class:"iti__selected-country","aria-expanded":"false","aria-label":this.options.i18n.selectedCountryAriaLabel,"aria-haspopup":"true","aria-controls":`iti-${this.id}__dropdown-content`,role:"combobox"},this.countryContainer),this.telInput.disabled&&this.selectedCountry.setAttribute("disabled","true")):this.selectedCountry=H("div",{class:"iti__selected-country"},this.countryContainer);const ke=H("div",{class:"iti__selected-country-primary"},this.selectedCountry);if(this.selectedCountryInner=H("div",{class:"iti__flag"},ke),this.selectedCountryA11yText=H("span",{class:"iti__a11y-text"},this.selectedCountryInner),S&&(this.dropdownArrow=H("div",{class:"iti__arrow","aria-hidden":"true"},ke)),E&&(this.selectedDialCode=H("div",{class:"iti__selected-dial-code"},this.selectedCountry)),S){const we=W?"":"iti--flexible-dropdown-width";if(this.dropdownContent=H("div",{id:`iti-${this.id}__dropdown-content`,class:`iti__dropdown-content iti__hide ${we}`}),G&&(this.searchInput=H("input",{type:"text",class:"iti__search-input",placeholder:ue.searchPlaceholder,role:"combobox","aria-expanded":"true","aria-label":ue.searchPlaceholder,"aria-controls":`iti-${this.id}__country-listbox`,"aria-autocomplete":"list",autocomplete:"off"},this.dropdownContent),this.searchResultsA11yText=H("span",{class:"iti__a11y-text"},this.dropdownContent)),this.countryList=H("ul",{class:"iti__country-list",id:`iti-${this.id}__country-listbox`,role:"listbox","aria-label":ue.countryListAriaLabel},this.dropdownContent),this._appendListItems(),G&&this._updateSearchResultsText(),K){let ae="iti iti--container";J?ae+=" iti--fullscreen-popup":ae+=" iti--inline-dropdown",this.dropdown=H("div",{class:ae}),this.dropdown.appendChild(this.dropdownContent)}else this.countryContainer.appendChild(this.dropdownContent)}}if(fe.appendChild(this.telInput),this._updateInputPadding(),O){const ke=this.telInput.getAttribute("name")||"",we=O(ke);if(we.phone){const ae=this.telInput.form?.querySelector(`input[name="${we.phone}"]`);ae?this.hiddenInput=ae:(this.hiddenInput=H("input",{type:"hidden",name:we.phone}),fe.appendChild(this.hiddenInput))}if(we.country){const ae=this.telInput.form?.querySelector(`input[name="${we.country}"]`);ae?this.hiddenInputCountry=ae:(this.hiddenInputCountry=H("input",{type:"hidden",name:we.country}),fe.appendChild(this.hiddenInputCountry))}}}_appendListItems(){for(let S=0;S<this.countries.length;S++){const E=this.countries[S],F=S===0?"iti__highlight":"",q=H("li",{id:`iti-${this.id}__item-${E.iso2}`,class:`iti__country ${F}`,tabindex:"-1",role:"option","data-dial-code":E.dialCode,"data-country-code":E.iso2,"aria-selected":"false"},this.countryList);E.nodeById[this.id]=q;let O="";this.options.showFlags&&(O+=`<div class='iti__flag iti__${E.iso2}'></div>`),O+=`<span class='iti__country-name'>${E.name}</span>`,O+=`<span class='iti__dial-code'>+${E.dialCode}</span>`,q.insertAdjacentHTML("beforeend",O)}}_setInitialState(S=!1){const E=this.telInput.getAttribute("value"),F=this.telInput.value,O=E&&E.charAt(0)==="+"&&(!F||F.charAt(0)!=="+")?E:F,K=this._getDialCode(O),W=u(O),{initialCountry:J,geoIpLookup:G}=this.options,ue=J==="auto"&&G;if(K&&!W)this._updateCountryFromNumber(O);else if(!ue||S){const se=J?J.toLowerCase():"";se&&this._getCountryData(se,!0)?this._setCountry(se):K&&W?this._setCountry("us"):this._setCountry()}O&&this._updateValFromNumber(O)}_initListeners(){this._initTelInputListeners(),this.options.allowDropdown&&this._initDropdownListeners(),(this.hiddenInput||this.hiddenInputCountry)&&this.telInput.form&&this._initHiddenInputListener()}_initHiddenInputListener(){this._handleHiddenInputSubmit=()=>{this.hiddenInput&&(this.hiddenInput.value=this.getNumber()),this.hiddenInputCountry&&(this.hiddenInputCountry.value=this.getSelectedCountryData().iso2||"")},this.telInput.form?.addEventListener("submit",this._handleHiddenInputSubmit)}_initDropdownListeners(){this._handleLabelClick=E=>{this.dropdownContent.classList.contains("iti__hide")?this.telInput.focus():E.preventDefault()};const S=this.telInput.closest("label");S&&S.addEventListener("click",this._handleLabelClick),this._handleClickSelectedCountry=()=>{this.dropdownContent.classList.contains("iti__hide")&&!this.telInput.disabled&&!this.telInput.readOnly&&this._openDropdown()},this.selectedCountry.addEventListener("click",this._handleClickSelectedCountry),this._handleCountryContainerKeydown=E=>{this.dropdownContent.classList.contains("iti__hide")&&["ArrowUp","ArrowDown"," ","Enter"].includes(E.key)&&(E.preventDefault(),E.stopPropagation(),this._openDropdown()),E.key==="Tab"&&this._closeDropdown()},this.countryContainer.addEventListener("keydown",this._handleCountryContainerKeydown)}_initRequests(){let{loadUtils:S,initialCountry:E,geoIpLookup:F}=this.options;S&&!ee.utils?(this._handlePageLoad=()=>{window.removeEventListener("load",this._handlePageLoad),ee.attachUtils(S)?.catch(()=>{})},ee.documentReady()?this._handlePageLoad():window.addEventListener("load",this._handlePageLoad)):this.resolveUtilsScriptPromise(),E==="auto"&&F&&!this.selectedCountryData.iso2?this._loadAutoCountry():this.resolveAutoCountryPromise()}_loadAutoCountry(){ee.autoCountry?this.handleAutoCountry():ee.startedLoadingAutoCountry||(ee.startedLoadingAutoCountry=!0,typeof this.options.geoIpLookup=="function"&&this.options.geoIpLookup((S="")=>{const E=S.toLowerCase();E&&this._getCountryData(E,!0)?(ee.autoCountry=E,setTimeout(()=>j("handleAutoCountry"))):(this._setInitialState(!0),j("rejectAutoCountryPromise"))},()=>{this._setInitialState(!0),j("rejectAutoCountryPromise")}))}_openDropdownWithPlus(){this._openDropdown(),this.searchInput.value="+",this._filterCountries("",!0)}_initTelInputListeners(){const{strictMode:S,formatAsYouType:E,separateDialCode:F,formatOnDisplay:q,allowDropdown:O,countrySearch:K}=this.options;let W=!1;new RegExp("\\p{L}","u").test(this.telInput.value)&&(W=!0),this._handleInputEvent=J=>{if(this.isAndroid&&J?.data==="+"&&F&&O&&K){const fe=this.telInput.selectionStart||0,ke=this.telInput.value.substring(0,fe-1),we=this.telInput.value.substring(fe);this.telInput.value=ke+we,this._openDropdownWithPlus();return}this._updateCountryFromNumber(this.telInput.value)&&this._triggerCountryChange();const G=J?.data&&/[^+0-9]/.test(J.data),ue=J?.inputType==="insertFromPaste"&&this.telInput.value;G||ue&&!S?W=!0:/[^+0-9]/.test(this.telInput.value)||(W=!1);const se=J?.detail&&J.detail.isSetNumber&&!q;if(E&&!W&&!se){const fe=this.telInput.selectionStart||0,we=this.telInput.value.substring(0,fe).replace(/[^+0-9]/g,"").length,ae=J?.inputType==="deleteContentForward",X=this._formatNumberAsYouType(),oe=A(we,X,fe,ae);this.telInput.value=X,this.telInput.setSelectionRange(oe,oe)}},this.telInput.addEventListener("input",this._handleInputEvent),(S||F)&&(this._handleKeydownEvent=J=>{if(J.key&&J.key.length===1&&!J.altKey&&!J.ctrlKey&&!J.metaKey){if(F&&O&&K&&J.key==="+"){J.preventDefault(),this._openDropdownWithPlus();return}if(S){const G=this.telInput.value,ue=G.charAt(0)==="+",se=!ue&&this.telInput.selectionStart===0&&J.key==="+",fe=/^[0-9]$/.test(J.key),ke=F?fe:se||fe,we=G.slice(0,this.telInput.selectionStart)+J.key+G.slice(this.telInput.selectionEnd),ae=this._getFullNumber(we),X=ee.utils.getCoreNumber(ae,this.selectedCountryData.iso2),oe=this.maxCoreNumberLength&&X.length>this.maxCoreNumberLength;let rt=!1;if(ue){const At=this.selectedCountryData.iso2;rt=this._getCountryFromNumber(ae)!==At}(!ke||oe&&!rt&&!se)&&J.preventDefault()}}},this.telInput.addEventListener("keydown",this._handleKeydownEvent))}_cap(S){const E=parseInt(this.telInput.getAttribute("maxlength")||"",10);return E&&S.length>E?S.substr(0,E):S}_trigger(S,E={}){const F=new CustomEvent(S,{bubbles:!0,cancelable:!0,detail:E});this.telInput.dispatchEvent(F)}_openDropdown(){const{fixDropdownWidth:S,countrySearch:E}=this.options;if(S&&(this.dropdownContent.style.width=`${this.telInput.offsetWidth}px`),this.dropdownContent.classList.remove("iti__hide"),this.selectedCountry.setAttribute("aria-expanded","true"),this._setDropdownPosition(),E){const F=this.countryList.firstElementChild;F&&(this._highlightListItem(F,!1),this.countryList.scrollTop=0),this.searchInput.focus()}this._bindDropdownListeners(),this.dropdownArrow.classList.add("iti__arrow--up"),this._trigger("open:countrydropdown")}_setDropdownPosition(){if(this.options.dropdownContainer&&this.options.dropdownContainer.appendChild(this.dropdown),!this.options.useFullscreenPopup){const S=this.telInput.getBoundingClientRect(),E=this.telInput.offsetHeight;this.options.dropdownContainer&&(this.dropdown.style.top=`${S.top+E}px`,this.dropdown.style.left=`${S.left}px`,this._handleWindowScroll=()=>this._closeDropdown(),window.addEventListener("scroll",this._handleWindowScroll))}}_bindDropdownListeners(){this._handleMouseoverCountryList=q=>{const O=q.target?.closest(".iti__country");O&&this._highlightListItem(O,!1)},this.countryList.addEventListener("mouseover",this._handleMouseoverCountryList),this._handleClickCountryList=q=>{const O=q.target?.closest(".iti__country");O&&this._selectListItem(O)},this.countryList.addEventListener("click",this._handleClickCountryList);let S=!0;this._handleClickOffToClose=()=>{S||this._closeDropdown(),S=!1},document.documentElement.addEventListener("click",this._handleClickOffToClose);let E="",F=null;if(this._handleKeydownOnDropdown=q=>{["ArrowUp","ArrowDown","Enter","Escape"].includes(q.key)&&(q.preventDefault(),q.stopPropagation(),q.key==="ArrowUp"||q.key==="ArrowDown"?this._handleUpDownKey(q.key):q.key==="Enter"?this._handleEnterKey():q.key==="Escape"&&this._closeDropdown()),!this.options.countrySearch&&/^[a-zA-ZÀ-ÿа-яА-Я ]$/.test(q.key)&&(q.stopPropagation(),F&&clearTimeout(F),E+=q.key.toLowerCase(),this._searchForCountry(E),F=setTimeout(()=>{E=""},1e3))},document.addEventListener("keydown",this._handleKeydownOnDropdown),this.options.countrySearch){const q=()=>{const K=this.searchInput.value.trim();K?this._filterCountries(K):this._filterCountries("",!0)};let O=null;this._handleSearchChange=()=>{O&&clearTimeout(O),O=setTimeout(()=>{q(),O=null},100)},this.searchInput.addEventListener("input",this._handleSearchChange),this.searchInput.addEventListener("click",K=>K.stopPropagation())}}_searchForCountry(S){for(let E=0;E<this.countries.length;E++){const F=this.countries[E];if(F.name.substr(0,S.length).toLowerCase()===S){const O=F.nodeById[this.id];this._highlightListItem(O,!1),this._scrollTo(O);break}}}_filterCountries(S,E=!1){let F=!0;this.countryList.innerHTML="";const q=N(S);for(let O=0;O<this.countries.length;O++){const K=this.countries[O],W=N(K.name),J=K.name.split(/[^a-zA-ZÀ-ÿа-яА-Я]/).map(ue=>ue[0]).join("").toLowerCase(),G=`+${K.dialCode}`;if(E||W.includes(q)||G.includes(q)||K.iso2.includes(q)||J.includes(q)){const ue=K.nodeById[this.id];ue&&this.countryList.appendChild(ue),F&&(this._highlightListItem(ue,!1),F=!1)}}F&&this._highlightListItem(null,!1),this.countryList.scrollTop=0,this._updateSearchResultsText()}_updateSearchResultsText(){const{i18n:S}=this.options,E=this.countryList.childElementCount;let F;"searchResultsText"in S?F=S.searchResultsText(E):E===0?F=S.zeroSearchResults:E===1?F=S.oneSearchResult:F=S.multipleSearchResults.replace("${count}",E.toString()),this.searchResultsA11yText.textContent=F}_handleUpDownKey(S){let E=S==="ArrowUp"?this.highlightedItem?.previousElementSibling:this.highlightedItem?.nextElementSibling;!E&&this.countryList.childElementCount>1&&(E=S==="ArrowUp"?this.countryList.lastElementChild:this.countryList.firstElementChild),E&&(this._scrollTo(E),this._highlightListItem(E,!1))}_handleEnterKey(){this.highlightedItem&&this._selectListItem(this.highlightedItem)}_updateValFromNumber(S){let E=S;if(this.options.formatOnDisplay&&ee.utils&&this.selectedCountryData){const F=this.options.nationalMode||E.charAt(0)!=="+"&&!this.options.separateDialCode,{NATIONAL:q,INTERNATIONAL:O}=ee.utils.numberFormat,K=F?q:O;E=ee.utils.formatNumber(E,this.selectedCountryData.iso2,K)}E=this._beforeSetNumber(E),this.telInput.value=E}_updateCountryFromNumber(S){const E=this._getCountryFromNumber(S);return E!==null?this._setCountry(E):!1}_ensureHasDialCode(S){const{dialCode:E,nationalPrefix:F}=this.selectedCountryData;if(S.charAt(0)==="+"||!E)return S;const K=F&&S.charAt(0)===F&&!this.options.separateDialCode?S.substring(1):S;return`+${E}${K}`}_getCountryFromNumber(S){const E=S.indexOf("+");let F=E?S.substring(E):S;const q=this.selectedCountryData.iso2,O=this.selectedCountryData.dialCode;F=this._ensureHasDialCode(F);const K=this._getDialCode(F,!0),W=I(F);if(K){const J=I(K),G=this.dialCodeToIso2Map[J];if(!q&&this.defaultCountry&&G.includes(this.defaultCountry))return this.defaultCountry;const ue=q&&G.includes(q)&&(W.length===J.length||!this.selectedCountryData.areaCodes);if(!(O==="1"&&u(W))&&!ue){for(let fe=0;fe<G.length;fe++)if(G[fe])return G[fe]}}else{if(F.charAt(0)==="+"&&W.length)return"";if((!F||F==="+")&&!this.selectedCountryData.iso2)return this.defaultCountry}return null}_highlightListItem(S,E){const F=this.highlightedItem;if(F&&(F.classList.remove("iti__highlight"),F.setAttribute("aria-selected","false")),this.highlightedItem=S,this.highlightedItem){this.highlightedItem.classList.add("iti__highlight"),this.highlightedItem.setAttribute("aria-selected","true");const q=this.highlightedItem.getAttribute("id")||"";this.selectedCountry.setAttribute("aria-activedescendant",q),this.options.countrySearch&&this.searchInput.setAttribute("aria-activedescendant",q)}E&&this.highlightedItem.focus()}_getCountryData(S,E){for(let F=0;F<this.countries.length;F++)if(this.countries[F].iso2===S)return this.countries[F];if(E)return null;throw new Error(`No country data for '${S}'`)}_setCountry(S){const{separateDialCode:E,showFlags:F,i18n:q}=this.options,O=this.selectedCountryData.iso2?this.selectedCountryData:{};if(this.selectedCountryData=S?this._getCountryData(S,!1)||{}:{},this.selectedCountryData.iso2&&(this.defaultCountry=this.selectedCountryData.iso2),this.selectedCountryInner){let K="",W="";S&&F?(K=`iti__flag iti__${S}`,W=`${this.selectedCountryData.name} +${this.selectedCountryData.dialCode}`):(K="iti__flag iti__globe",W=q.noCountrySelected),this.selectedCountryInner.className=K,this.selectedCountryA11yText.textContent=W}if(this._setSelectedCountryTitleAttribute(S,E),E){const K=this.selectedCountryData.dialCode?`+${this.selectedCountryData.dialCode}`:"";this.selectedDialCode.innerHTML=K,this._updateInputPadding()}return this._updatePlaceholder(),this._updateMaxLength(),O.iso2!==S}_updateInputPadding(){if(this.selectedCountry){const E=(this.selectedCountry.offsetWidth||this._getHiddenSelectedCountryWidth())+6;this.showSelectedCountryOnLeft?this.telInput.style.paddingLeft=`${E}px`:this.telInput.style.paddingRight=`${E}px`}}_updateMaxLength(){const{strictMode:S,placeholderNumberType:E,validationNumberTypes:F}=this.options,{iso2:q}=this.selectedCountryData;if(S&&ee.utils)if(q){const O=ee.utils.numberType[E];let K=ee.utils.getExampleNumber(q,!1,O,!0),W=K;for(;ee.utils.isPossibleNumber(K,q,F);)W=K,K+="0";const J=ee.utils.getCoreNumber(W,q);this.maxCoreNumberLength=J.length,q==="by"&&(this.maxCoreNumberLength=J.length+1)}else this.maxCoreNumberLength=null}_setSelectedCountryTitleAttribute(S=null,E){if(!this.selectedCountry)return;let F;S&&!E?F=`${this.selectedCountryData.name}: +${this.selectedCountryData.dialCode}`:S?F=this.selectedCountryData.name:F="Unknown",this.selectedCountry.setAttribute("title",F)}_getHiddenSelectedCountryWidth(){if(this.telInput.parentNode){const S=this.telInput.parentNode.cloneNode(!1);S.style.visibility="hidden",document.body.appendChild(S);const E=this.countryContainer.cloneNode();S.appendChild(E);const F=this.selectedCountry.cloneNode(!0);E.appendChild(F);const q=F.offsetWidth;return document.body.removeChild(S),q}return 0}_updatePlaceholder(){const{autoPlaceholder:S,placeholderNumberType:E,nationalMode:F,customPlaceholder:q}=this.options,O=S==="aggressive"||!this.hadInitialPlaceholder&&S==="polite";if(ee.utils&&O){const K=ee.utils.numberType[E];let W=this.selectedCountryData.iso2?ee.utils.getExampleNumber(this.selectedCountryData.iso2,F,K):"";W=this._beforeSetNumber(W),typeof q=="function"&&(W=q(W,this.selectedCountryData)),this.telInput.setAttribute("placeholder",W)}}_selectListItem(S){const E=this._setCountry(S.getAttribute("data-country-code"));this._closeDropdown(),this._updateDialCode(S.getAttribute("data-dial-code")),this.telInput.focus(),E&&this._triggerCountryChange()}_closeDropdown(){this.dropdownContent.classList.add("iti__hide"),this.selectedCountry.setAttribute("aria-expanded","false"),this.selectedCountry.removeAttribute("aria-activedescendant"),this.highlightedItem&&this.highlightedItem.setAttribute("aria-selected","false"),this.options.countrySearch&&this.searchInput.removeAttribute("aria-activedescendant"),this.dropdownArrow.classList.remove("iti__arrow--up"),document.removeEventListener("keydown",this._handleKeydownOnDropdown),this.options.countrySearch&&this.searchInput.removeEventListener("input",this._handleSearchChange),document.documentElement.removeEventListener("click",this._handleClickOffToClose),this.countryList.removeEventListener("mouseover",this._handleMouseoverCountryList),this.countryList.removeEventListener("click",this._handleClickCountryList),this.options.dropdownContainer&&(this.options.useFullscreenPopup||window.removeEventListener("scroll",this._handleWindowScroll),this.dropdown.parentNode&&this.dropdown.parentNode.removeChild(this.dropdown)),this._handlePageLoad&&window.removeEventListener("load",this._handlePageLoad),this._trigger("close:countrydropdown")}_scrollTo(S){const E=this.countryList,F=document.documentElement.scrollTop,q=E.offsetHeight,O=E.getBoundingClientRect().top+F,K=O+q,W=S.offsetHeight,J=S.getBoundingClientRect().top+F,G=J+W,ue=J-O+E.scrollTop;if(J<O)E.scrollTop=ue;else if(G>K){const se=q-W;E.scrollTop=ue-se}}_updateDialCode(S){const E=this.telInput.value,F=`+${S}`;let q;if(E.charAt(0)==="+"){const O=this._getDialCode(E);O?q=E.replace(O,F):q=F,this.telInput.value=q}}_getDialCode(S,E){let F="";if(S.charAt(0)==="+"){let q="";for(let O=0;O<S.length;O++){const K=S.charAt(O);if(!isNaN(parseInt(K,10))){if(q+=K,E)this.dialCodeToIso2Map[q]&&(F=S.substr(0,O+1));else if(this.dialCodes[q]){F=S.substr(0,O+1);break}if(q.length===this.dialCodeMaxLen)break}}}return F}_getFullNumber(S){const E=S||this.telInput.value.trim(),{dialCode:F}=this.selectedCountryData;let q;const O=I(E);return this.options.separateDialCode&&E.charAt(0)!=="+"&&F&&O?q=`+${F}`:q="",q+E}_beforeSetNumber(S){let E=S;if(this.options.separateDialCode){let F=this._getDialCode(E);if(F){F=`+${this.selectedCountryData.dialCode}`;const q=E[F.length]===" "||E[F.length]==="-"?F.length+1:F.length;E=E.substr(q)}}return this._cap(E)}_triggerCountryChange(){this._trigger("countrychange")}_formatNumberAsYouType(){const S=this._getFullNumber(),E=ee.utils?ee.utils.formatNumberAsYouType(S,this.selectedCountryData.iso2):S,{dialCode:F}=this.selectedCountryData;return this.options.separateDialCode&&this.telInput.value.charAt(0)!=="+"&&E.includes(`+${F}`)?(E.split(`+${F}`)[1]||"").trim():E}handleAutoCountry(){this.options.initialCountry==="auto"&&ee.autoCountry&&(this.defaultCountry=ee.autoCountry,this.selectedCountryData.iso2||this.selectedCountryInner.classList.contains("iti__globe")||this.setCountry(this.defaultCountry),this.resolveAutoCountryPromise())}handleUtils(){ee.utils&&(this.telInput.value&&this._updateValFromNumber(this.telInput.value),this.selectedCountryData.iso2&&(this._updatePlaceholder(),this._updateMaxLength())),this.resolveUtilsScriptPromise()}destroy(){this.telInput.iti=void 0;const{allowDropdown:S,separateDialCode:E}=this.options;if(S){this._closeDropdown(),this.selectedCountry.removeEventListener("click",this._handleClickSelectedCountry),this.countryContainer.removeEventListener("keydown",this._handleCountryContainerKeydown);const O=this.telInput.closest("label");O&&O.removeEventListener("click",this._handleLabelClick)}const{form:F}=this.telInput;this._handleHiddenInputSubmit&&F&&F.removeEventListener("submit",this._handleHiddenInputSubmit),this.telInput.removeEventListener("input",this._handleInputEvent),this._handleKeydownEvent&&this.telInput.removeEventListener("keydown",this._handleKeydownEvent),this.telInput.removeAttribute("data-intl-tel-input-id"),E&&(this.isRTL?this.telInput.style.paddingRight=this.originalPaddingRight:this.telInput.style.paddingLeft=this.originalPaddingLeft);const q=this.telInput.parentNode;q?.parentNode?.insertBefore(this.telInput,q),q?.parentNode?.removeChild(q),delete ee.instances[this.id]}getExtension(){return ee.utils?ee.utils.getExtension(this._getFullNumber(),this.selectedCountryData.iso2):""}getNumber(S){if(ee.utils){const{iso2:E}=this.selectedCountryData;return ee.utils.formatNumber(this._getFullNumber(),E,S)}return""}getNumberType(){return ee.utils?ee.utils.getNumberType(this._getFullNumber(),this.selectedCountryData.iso2):-99}getSelectedCountryData(){return this.selectedCountryData}getValidationError(){if(ee.utils){const{iso2:S}=this.selectedCountryData;return ee.utils.getValidationError(this._getFullNumber(),S)}return-99}isValidNumber(){if(!this.selectedCountryData.iso2)return!1;const S=this._getFullNumber(),E=S.search(new RegExp("\\p{L}","u"));if(E>-1){const F=S.substring(0,E),q=this._utilsIsPossibleNumber(F),O=this._utilsIsPossibleNumber(S);return q&&O}return this._utilsIsPossibleNumber(S)}_utilsIsPossibleNumber(S){return ee.utils?ee.utils.isPossibleNumber(S,this.selectedCountryData.iso2,this.options.validationNumberTypes):null}isValidNumberPrecise(){if(!this.selectedCountryData.iso2)return!1;const S=this._getFullNumber(),E=S.search(new RegExp("\\p{L}","u"));if(E>-1){const F=S.substring(0,E),q=this._utilsIsValidNumber(F),O=this._utilsIsValidNumber(S);return q&&O}return this._utilsIsValidNumber(S)}_utilsIsValidNumber(S){return ee.utils?ee.utils.isValidNumber(S,this.selectedCountryData.iso2,this.options.validationNumberTypes):null}setCountry(S){const E=S?.toLowerCase(),F=this.selectedCountryData.iso2;(S&&E!==F||!S&&F)&&(this._setCountry(E),this._updateDialCode(this.selectedCountryData.dialCode),this._triggerCountryChange())}setNumber(S){const E=this._updateCountryFromNumber(S);this._updateValFromNumber(S),E&&this._triggerCountryChange(),this._trigger("input",{isSetNumber:!0})}setPlaceholderNumberType(S){this.options.placeholderNumberType=S,this._updatePlaceholder()}setDisabled(S){this.telInput.disabled=S,S?this.selectedCountry.setAttribute("disabled","true"):this.selectedCountry.removeAttribute("disabled")}},b=S=>{if(!ee.utils&&!ee.startedLoadingUtilsScript){let E;if(typeof S=="function")try{E=Promise.resolve(S())}catch(F){return Promise.reject(F)}else return Promise.reject(new TypeError(`The argument passed to attachUtils must be a function that returns a promise for the utilities module, not ${typeof S}`));return ee.startedLoadingUtilsScript=!0,E.then(F=>{const q=F?.default;if(!q||typeof q!="object")throw new TypeError("The loader function passed to attachUtils did not resolve to a module object with utils as its default export.");return ee.utils=q,j("handleUtils"),!0}).catch(F=>{throw j("rejectUtilsScriptPromise",F),F})}return null},ee=Object.assign((S,E)=>{const F=new h(S,E);return F._init(),S.setAttribute("data-intl-tel-input-id",F.id.toString()),ee.instances[F.id]=F,S.iti=F,F},{defaults:C,documentReady:()=>document.readyState==="complete",getCountryData:()=>D,getInstance:S=>{const E=S.getAttribute("data-intl-tel-input-id");return E?ee.instances[E]:null},instances:{},attachUtils:b,startedLoadingUtilsScript:!1,startedLoadingAutoCountry:!1,version:"25.4.2"}),B=ee;return r(P)})();return y.default})}(St)),St.exports}var Pa=Aa();const ys=Ca(Pa),Ea={name:"PhoneInput",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"Numéro de téléphone"},preferredCountries:{type:Array,default:()=>["ga","cm","ci","cg","cf","td","gq","bf","bj","tg","fr","ca"]},initialCountry:{type:String,default:"ga"}},data(){return{phoneNumber:this.modelValue,iti:null}},watch:{phoneNumber(_){this.$emit("update:modelValue",_)},modelValue(_){_!==this.phoneNumber&&(this.phoneNumber=_,this.iti&&this.$refs.phoneInput&&_&&this.iti.setNumber(_))}},mounted(){this.initializeIntlTelInput()},beforeUnmount(){this.iti&&this.iti.destroy()},methods:{initializeIntlTelInput(){const _=this.$refs.phoneInput;this.iti=ys(_,{preferredCountries:this.preferredCountries,initialCountry:this.initialCountry,separateDialCode:!0,customPlaceholder:(y,w)=>y}),_.addEventListener("input",y=>{this.phoneNumber=y.target.value,this.emitAllData()}),_.addEventListener("countrychange",()=>{this.emitAllData()}),setTimeout(()=>{this.modelValue&&this.iti.setNumber(this.modelValue),this.emitAllData()},100)},emitAllData(){if(this.iti&&this.iti.getSelectedCountryData)try{const _=this.iti.getSelectedCountryData(),y=this.phoneNumber||"";let w="";y.trim()&&(y.startsWith("+")?w=y:w=`+${_.dialCode}${y}`);const p=this.validatePhoneNumber(y,_);this.$emit("update:modelValue",w),console.log("PhoneInput emitting:",{number:y,fullNumber:w,countryCode:_.dialCode,countryIso2:_.iso2,isValid:p}),this.$emit("phone-change",{number:y,fullNumber:w,countryCode:_.dialCode,countryIso2:_.iso2,isValid:p})}catch(_){console.warn("PhoneInput: Error emitting data",_)}},emitPhoneData(){this.emitAllData()},validatePhoneNumber(_,y){if(!_||!_.trim())return!1;const p={ga:{min:7,max:8},cm:{min:8,max:9},ci:{min:8,max:10},fr:{min:9,max:10},ca:{min:10,max:10},cg:{min:8,max:9},cf:{min:8,max:8},td:{min:8,max:8},gq:{min:9,max:9},bf:{min:8,max:8},bj:{min:8,max:8},tg:{min:8,max:8}}[y.iso2]||{min:7,max:15},f=_.replace(/[^\d]/g,"");return f.length>=p.min&&f.length<=p.max},getNumber(){if(this.iti&&this.iti.getSelectedCountryData){const _=this.iti.getSelectedCountryData(),y=this.phoneNumber||"";if(y.trim())return y.startsWith("+")?y:`+${_.dialCode}${y}`}return""},isValidNumber(){if(this.iti&&this.iti.getSelectedCountryData){const _=this.iti.getSelectedCountryData();return this.validatePhoneNumber(this.phoneNumber,_)}return!1},setNumber(_){this.iti&&(this.iti.setNumber(_),this.phoneNumber=_,this.emitAllData())}}},ja={class:"phone-input-wrapper"},Sa=["placeholder"];function Ia(_,y,w,p,f,a){return s(),o("div",ja,[e("input",{ref:"phoneInput",type:"tel",class:"form-control",placeholder:w.placeholder},null,8,Sa)])}const tt=Ee(Ea,[["render",Ia],["__scopeId","data-v-118cdfc2"]]),Da={class:"min-h-screen bg-gradient-to-br from-koumbaya-primary/5 via-white to-koumbaya-primary/10 flex flex-col justify-center py-12 sm:px-6 lg:px-8"},Ta={class:"sm:mx-auto sm:w-full sm:max-w-md"},Ma={class:"flex justify-center mb-8"},La=["src"],Va={class:"text-center text-sm text-gray-500"},Ra={class:"mt-12 sm:mx-auto sm:w-full sm:max-w-md"},Fa={class:"koumbaya-card bg-white/80 backdrop-blur-sm border-0 shadow-2xl"},Na={class:"koumbaya-card-body p-8"},za={key:0,class:"mb-6 rounded-xl bg-gradient-to-r from-green-50 to-blue-50 border-2 border-green-200 p-4 shadow-lg"},qa={class:"flex items-start"},Ua={class:"ml-3 flex-1"},Ba={class:"text-sm font-semibold text-green-800 mb-2"},Oa={class:"text-sm text-green-700 leading-relaxed"},Ga={key:0,class:"mt-2 text-xs text-green-600 bg-green-100 rounded-lg p-2"},Ha={class:"space-y-1 list-disc list-inside ml-2"},Ka={class:"flex justify-center space-x-2 p-1 bg-gray-100 rounded-lg mb-6"},Wa={key:0,class:"rounded-xl bg-gradient-to-r from-red-50 to-orange-50 border-2 border-red-200 p-4 shadow-lg"},Ja={class:"flex items-start"},Xa={class:"flex-shrink-0"},Ya={class:"ml-3 flex-1"},Qa={class:"text-sm text-red-800 font-semibold leading-relaxed"},Za={key:0,class:"mt-2 text-xs text-red-600 bg-red-100 rounded-lg p-2"},en={key:1,class:"mt-2 text-xs text-red-600 bg-red-100 rounded-lg p-2"},tn={key:2,class:"mt-2 text-xs text-red-600 bg-red-100 rounded-lg p-2"},sn={key:1,class:"koumbaya-form-group"},on={for:"email",class:"block text-sm font-medium text-gray-700 mb-2"},rn={class:"flex items-center"},an={key:0,class:"mt-2 text-sm text-red-600 flex items-center"},nn={key:1,class:"mt-2 text-sm text-blue-600 flex items-center"},ln={key:2,class:"koumbaya-form-group"},dn={for:"phone",class:"block text-sm font-medium text-gray-700 mb-2"},un={class:"flex items-center"},cn={key:0,class:"mt-2 text-sm text-red-600 flex items-center"},mn={key:1,class:"mt-2 text-sm text-blue-600 flex items-center"},pn={class:"koumbaya-form-group"},gn={for:"password",class:"block text-sm font-medium text-gray-700 mb-2"},fn={class:"flex items-center"},vn={class:"relative"},xn=["type"],bn={key:0,class:"mt-2 text-sm text-red-600 flex items-center"},yn={key:1,class:"mt-2 text-sm text-blue-600 flex items-center"},hn={class:"flex items-center justify-between"},_n={class:"flex items-center cursor-pointer group"},wn={class:"pt-2"},$n=["disabled"],kn={key:0,class:"absolute left-0 inset-y-0 flex items-center pl-4"},Cn={class:"flex items-center justify-center"},An={class:"grid grid-cols-2 gap-4"},Pn=["disabled"],En=["disabled"],jn={__name:"Login",setup(_){const y=$e(),w=Be(),p=Pe(),f=xe({email:"",phone:"",password:"",rememberMe:!1}),a=R("email"),c=R(null),n=R(!1),r=xe({email:"",phone:"",password:"",general:""}),P=d=>{console.log("Login phone change:",d),n.value=d.isValid,f.phone=d.fullNumber,d.isValid&&d.fullNumber&&(r.phone="")},$=R(!1),M=R(!1),D=R(null),m=()=>{let d=!0;return Object.keys(r).forEach(i=>{r[i]=""}),a.value==="email"?f.email?f.email.includes("@")?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f.email)?f.email.length>100&&(r.email="L'adresse email est trop longue (max 100 caractères)",d=!1):(r.email="Format d'email invalide (exemple: nom@domaine.com)",d=!1):(r.email="L'adresse email doit contenir le symbole @",d=!1):(r.email="L'adresse email est obligatoire",d=!1):!f.phone||f.phone.trim()===""?(r.phone="📱 Le numéro de téléphone est obligatoire",d=!1):!n.value&&f.phone.length>3&&(r.phone="Format de téléphone invalide",d=!1),f.password?f.password.length<6?(r.password="Le mot de passe doit contenir au moins 6 caractères",d=!1):f.password.length>50?(r.password="Le mot de passe est trop long (max 50 caractères)",d=!1):f.password.includes(" ")&&(r.password="Le mot de passe ne doit pas contenir d'espaces",d=!1):(r.password="Le mot de passe est obligatoire",d=!1),d},k=async d=>{if(d&&(d.preventDefault(),d.stopPropagation()),!!m()){$.value=!0,r.general="";try{const i={password:f.password};a.value==="email"?i.email=f.email:i.phone=f.phone;const C=await p.login(i);if(C.success){if(window.$toast){const N=p.user?.name||p.user?.first_name||"utilisateur";window.$toast.success(`🎉 Bienvenue ${N} ! Redirection en cours...`,"✅ Connexion réussie")}console.log("User data après connexion:",p.user);const x=w.query.redirect,I=w.query.action;setTimeout(()=>{if(x&&(I==="participate"||I==="wishlist")){const u=x.match(/\/products\/(\d+)/)?.[1];if(u){y.push({name:"customer.product.detail",params:{id:u}});return}}if(x){y.push(x);return}const N=p.getDefaultRedirect();console.log("Redirection logic:",{user:p.user,redirectTo:N,isAdmin:p.isAdmin,isMerchant:p.isMerchant,isCustomer:p.isCustomer}),y.push({name:N}).catch(u=>{console.error("Erreur de redirection vers",N,":",u),y.push({name:"customer.dashboard"}).catch(()=>{y.push("/")})})},100)}else{const x=C.error||"Erreur de connexion inconnue";x.toLowerCase().includes("identifiants incorrects")||x.toLowerCase().includes("invalid credentials")||x.includes("401")?(r.general="Identifiants incorrects. Vérifiez votre adresse email et votre mot de passe.",r.email="Adresse email ou mot de passe incorrect",r.password="Adresse email ou mot de passe incorrect"):x.toLowerCase().includes("trop de tentatives")||x.toLowerCase().includes("too many")||x.includes("429")?r.general="Trop de tentatives de connexion. Veuillez patienter 15 minutes avant de réessayer.":x.toLowerCase().includes("network")||x.toLowerCase().includes("réseau")||x.toLowerCase().includes("connexion")?r.general="Problème de connexion internet. Vérifiez votre connexion et réessayez.":x.toLowerCase().includes("email")&&x.toLowerCase().includes("verify")?r.general="Votre compte n'est pas encore vérifié. Vérifiez votre boîte email et cliquez sur le lien de vérification.":x.toLowerCase().includes("blocked")||x.toLowerCase().includes("suspendu")?r.general="Votre compte est temporairement suspendu. Contactez le support client.":r.general=`${x}`,window.$toast&&window.$toast.error(r.general,"🚫 Erreur de connexion"),setTimeout(()=>{r.email,document.getElementById("email")?.focus()},100)}}catch(i){console.error("Erreur lors de la connexion:",i);let C="Une erreur technique est survenue. Veuillez réessayer.";if(i.response?.status===401)C="🚫 Identifiants incorrects. Vérifiez votre adresse email et votre mot de passe.",r.email="Adresse email ou mot de passe incorrect",r.password="Adresse email ou mot de passe incorrect";else if(i.response?.status===422)if(i.response.data?.errors){const x=i.response.data.errors;x.email&&(r.email=x.email[0]),x.password&&(r.password=x.password[0]),C="⚠️ Veuillez corriger les erreurs ci-dessous."}else C="⚠️ Données invalides. Vérifiez vos informations.";else i.response?.status===429?C="⏳ Trop de tentatives de connexion. Veuillez patienter 15 minutes avant de réessayer.":i.response?.status===500?C="🔧 Erreur du serveur. Nos équipes sont notifiées. Veuillez réessayer dans quelques minutes.":i.response?.status===503?C="⚙️ Service temporairement indisponible. Maintenance en cours.":i.code==="NETWORK_ERROR"||!i.response?C="🌐 Impossible de joindre le serveur. Vérifiez votre connexion internet.":i.response?.data?.message?C=`${i.response.data.message}`:i.message&&(C=`${i.message}`);if(r.general=C,window.$toast){let x="🚫 Erreur de connexion";i.response?.status===500?x="🔧 Erreur serveur":i.code==="NETWORK_ERROR"&&(x="🌐 Problème réseau"),window.$toast.error(C,x)}setTimeout(()=>{r.email?document.getElementById("email")?.focus():r.password?document.getElementById("password")?.focus():document.getElementById("email")?.focus()},100)}finally{$.value=!1}}};De(()=>f.email,d=>{r.email&&d&&d.includes("@")&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d)&&(r.email="")},{debounce:300}),De(()=>f.password,d=>{r.password&&d&&d.length>=6&&d.length<=50&&!d.includes(" ")&&(r.password="")},{debounce:300}),De([()=>f.email,()=>f.password],()=>{r.general&&(r.general="")});const U=()=>{D.value=null,sessionStorage.removeItem("registration_success")},V=async()=>{$.value=!0;try{const i=await(await fetch("/api/auth/google/redirect")).json();if(i.redirect_url)window.location.href=i.redirect_url;else throw new Error("Impossible de rediriger vers Google")}catch(d){console.error("Erreur connexion Google:",d),r.general="Erreur lors de la connexion avec Google",window.$toast&&window.$toast.error("Erreur lors de la connexion avec Google","🚫 Erreur"),$.value=!1}},v=async()=>{$.value=!0;try{const i=await(await fetch("/api/auth/facebook/redirect")).json();if(i.redirect_url)window.location.href=i.redirect_url;else throw new Error("Impossible de rediriger vers Facebook")}catch(d){console.error("Erreur connexion Facebook:",d),r.general="Erreur lors de la connexion avec Facebook",window.$toast&&window.$toast.error("Erreur lors de la connexion avec Facebook","🚫 Erreur"),$.value=!1}};return ve(()=>{if(w.query.registered==="true"){const d=sessionStorage.getItem("registration_success");if(d)try{D.value=JSON.parse(d),D.value.email&&(f.email=D.value.email)}catch(i){console.error("Erreur lors du parsing des données d'inscription:",i)}else w.query.email&&(f.email=w.query.email,D.value={email:w.query.email,first_name:"utilisateur",verification_message:"Un email de vérification a été envoyé à votre adresse. Veuillez consulter votre boîte email pour vérifier votre compte.",requires_verification:!0})}}),(d,i)=>{const C=he("router-link");return s(),o("div",Da,[e("div",Ta,[e("div",Ma,[g(C,{to:"/"},{default:re(()=>[e("img",{class:"h-20 w-auto hover:opacity-80 transition-opacity",src:l(Ye),alt:"Koumbaya"},null,8,La)]),_:1})]),i[10]||(i[10]=e("h2",{class:"text-center text-4xl font-bold text-gray-900 mb-3"}," Content de vous revoir ! ",-1)),i[11]||(i[11]=e("p",{class:"text-center text-lg text-gray-600 mb-8"}," Connectez-vous pour accéder à vos tombolas ",-1)),e("p",Va,[i[9]||(i[9]=z(" Pas encore de compte ? ",-1)),g(C,{to:"/register",class:"font-semibold text-koumbaya-primary hover:text-koumbaya-primary-dark transition-colors ml-1"},{default:re(()=>i[8]||(i[8]=[z(" Inscrivez-vous gratuitement → ",-1)])),_:1,__:[8]})])]),e("div",Ra,[e("div",Fa,[e("div",Na,[D.value?(s(),o("div",za,[e("div",qa,[i[17]||(i[17]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-green-500",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",Ua,[e("div",Ba," Inscription réussie ! Bienvenue "+t(D.value.first_name),1),e("div",Oa,t(D.value.verification_message),1),D.value.email?(s(),o("div",Ga,[i[15]||(i[15]=e("div",{class:"font-medium mb-1"},"Que faire maintenant :",-1)),e("ul",Ha,[e("li",null,[i[12]||(i[12]=z("Consultez votre boîte email : ",-1)),e("strong",null,t(D.value.email),1)]),i[13]||(i[13]=e("li",null,"Cliquez sur le lien de vérification dans l'email",-1)),i[14]||(i[14]=e("li",null,"Revenez ici pour vous connecter avec vos identifiants",-1))])])):T("",!0)]),e("button",{onClick:U,class:"flex-shrink-0 ml-2 text-green-400 hover:text-green-600 transition-colors",title:"Fermer ce message"},i[16]||(i[16]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])):T("",!0),e("form",{onSubmit:_e(k,["prevent"]),class:"space-y-6"},[e("div",Ka,[e("button",{type:"button",onClick:i[0]||(i[0]=x=>a.value="email"),class:te(["flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all duration-200",a.value==="email"?"bg-white text-koumbaya-primary shadow-sm":"text-gray-600 hover:text-gray-900"])},[g(l(lt),{class:"w-4 h-4 inline-block mr-2"}),i[18]||(i[18]=z(" Email ",-1))],2),e("button",{type:"button",onClick:i[1]||(i[1]=x=>a.value="phone"),class:te(["flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all duration-200",a.value==="phone"?"bg-white text-koumbaya-primary shadow-sm":"text-gray-600 hover:text-gray-900"])},[g(l(et),{class:"w-4 h-4 inline-block mr-2"}),i[19]||(i[19]=z(" Téléphone ",-1))],2)]),r.general?(s(),o("div",Wa,[e("div",Ja,[e("div",Xa,[g(l(Se),{class:"w-6 h-6 text-red-500 animate-pulse"})]),e("div",Ya,[e("div",Qa,t(r.general),1),r.general.includes("Identifiants incorrects")?(s(),o("div",Za,i[20]||(i[20]=[e("div",{class:"font-medium mb-1"},"💡 Conseils :",-1),e("ul",{class:"space-y-1 list-disc list-inside ml-2"},[e("li",null,"Vérifiez que votre adresse email est correcte"),e("li",null,"Assurez-vous que les majuscules/minuscules sont respectées"),e("li",null,"Essayez de réinitialiser votre mot de passe si nécessaire")],-1)]))):r.general.includes("connexion internet")?(s(),o("div",en,i[21]||(i[21]=[e("div",{class:"font-medium mb-1"},"💡 Conseils :",-1),e("ul",{class:"space-y-1 list-disc list-inside ml-2"},[e("li",null,"Vérifiez votre connexion WiFi ou données mobiles"),e("li",null,"Essayez de rafraîchir la page"),e("li",null,"Contactez votre fournisseur internet si le problème persiste")],-1)]))):r.general.includes("Trop de tentatives")?(s(),o("div",tn,i[22]||(i[22]=[e("div",{class:"font-medium mb-1"},"💡 Que faire :",-1),e("ul",{class:"space-y-1 list-disc list-inside ml-2"},[e("li",null,"Attendez 15 minutes avant de réessayer"),e("li",null,"Utilisez ce temps pour vérifier vos identifiants"),e("li",null,"Réinitialisez votre mot de passe si nécessaire")],-1)]))):T("",!0)]),e("button",{onClick:i[2]||(i[2]=x=>r.general=""),class:"flex-shrink-0 ml-2 text-red-400 hover:text-red-600 transition-colors",title:"Fermer ce message"},i[23]||(i[23]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))])])):T("",!0),a.value==="email"?(s(),o("div",sn,[e("label",on,[e("div",rn,[g(l(lt),{class:"w-4 h-4 mr-2 text-gray-500 flex-shrink-0"}),i[24]||(i[24]=e("span",null,"Adresse e-mail",-1))])]),Q(e("input",{id:"email",name:"email",type:"email","onUpdate:modelValue":i[3]||(i[3]=x=>f.email=x),required:"",class:te(["koumbaya-input bg-white/50 border-gray-200 focus:border-koumbaya-primary focus:ring-4 focus:ring-koumbaya-primary/10 rounded-xl transition-all duration-200",{"border-red-300 focus:border-red-500 focus:ring-red-500/10":r.email,"border-blue-300 focus:border-blue-500":!r.email&&f.email&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f.email)}]),style:{color:"#5f5f5f"},placeholder:"exemple@koumbaya.com"},null,2),[[ne,f.email]]),r.email?(s(),o("p",an,[g(l(Se),{class:"w-4 h-4 mr-1"}),z(" "+t(r.email),1)])):!r.email&&f.email&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f.email)?(s(),o("p",nn,i[25]||(i[25]=[e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1),z(" ✓ Adresse email valide ",-1)]))):T("",!0)])):T("",!0),a.value==="phone"?(s(),o("div",ln,[e("label",dn,[e("div",un,[g(l(et),{class:"w-4 h-4 mr-2 text-gray-500 flex-shrink-0"}),i[26]||(i[26]=e("span",null,"Numéro de téléphone",-1))])]),g(tt,{ref_key:"phoneInputRef",ref:c,modelValue:f.phone,"onUpdate:modelValue":i[4]||(i[4]=x=>f.phone=x),"preferred-countries":["ga","cm","ci","cg","cf","td","gq","bf","bj","tg","fr","ca"],"initial-country":"ga",onPhoneChange:P},null,8,["modelValue"]),r.phone?(s(),o("p",cn,[g(l(Se),{class:"w-4 h-4 mr-1"}),z(" "+t(r.phone),1)])):n.value?(s(),o("p",mn,i[27]||(i[27]=[e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1),z(" ✓ Numéro de téléphone valide ",-1)]))):T("",!0)])):T("",!0),e("div",pn,[e("label",gn,[e("div",fn,[g(l(qt),{class:"w-4 h-4 mr-2 text-gray-500 flex-shrink-0"}),i[28]||(i[28]=e("span",null,"Mot de passe",-1))])]),e("div",vn,[Q(e("input",{id:"password",name:"password",type:M.value?"text":"password","onUpdate:modelValue":i[5]||(i[5]=x=>f.password=x),required:"",class:te(["koumbaya-input bg-white/50 border-gray-200 focus:border-koumbaya-primary focus:ring-4 focus:ring-koumbaya-primary/10 rounded-xl transition-all duration-200 pr-12",{"border-red-300 focus:border-red-500 focus:ring-red-500/10":r.password,"border-blue-300 focus:border-blue-500":!r.password&&f.password&&f.password.length>=6}]),style:{color:"#5f5f5f"},placeholder:"••••••••"},null,10,xn),[[pt,f.password]]),e("button",{type:"button",onClick:i[6]||(i[6]=x=>M.value=!M.value),class:"absolute inset-y-0 right-0 pr-4 flex items-center hover:bg-gray-100 rounded-r-xl transition-colors"},[M.value?(s(),ce(l(gt),{key:1,class:"h-5 w-5 text-gray-400 hover:text-gray-600"})):(s(),ce(l(Ue),{key:0,class:"h-5 w-5 text-gray-400 hover:text-gray-600"}))])]),r.password?(s(),o("p",bn,[g(l(Se),{class:"w-4 h-4 mr-1"}),z(" "+t(r.password),1)])):!r.password&&f.password&&f.password.length>=6?(s(),o("p",yn,i[29]||(i[29]=[e("svg",{class:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})],-1),z(" ✓ Mot de passe valide ",-1)]))):T("",!0)]),e("div",hn,[e("label",_n,[Q(e("input",{id:"remember-me",name:"remember-me",type:"checkbox","onUpdate:modelValue":i[7]||(i[7]=x=>f.rememberMe=x),class:"w-4 h-4 text-koumbaya-primary bg-white border-2 border-gray-300 rounded focus:ring-koumbaya-primary focus:ring-2 transition-colors"},null,512),[[Ae,f.rememberMe]]),i[30]||(i[30]=e("span",{class:"ml-3 text-sm text-gray-700 group-hover:text-gray-900 transition-colors"}," Se souvenir de moi ",-1))]),g(C,{to:"/forgot-password",class:"text-sm font-semibold text-koumbaya-primary hover:text-koumbaya-primary-dark transition-colors"},{default:re(()=>i[31]||(i[31]=[z(" Mot de passe oublié ? ",-1)])),_:1,__:[31]})]),e("div",wn,[e("button",{type:"submit",disabled:$.value,class:"koumbaya-btn koumbaya-btn-primary koumbaya-btn-full koumbaya-btn-lg relative overflow-hidden group disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transition-all duration-300"},[$.value?(s(),o("span",kn,i[32]||(i[32]=[e("div",{class:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"},null,-1)]))):T("",!0),e("span",Cn,[$.value?T("",!0):(s(),ce(l(nt),{key:0,class:"w-5 h-5 mr-2 group-hover:translate-x-1 transition-transform"})),z(" "+t($.value?"Connexion en cours...":"Se connecter"),1)])],8,$n)])],32),i[35]||(i[35]=pe('<div class="my-8" data-v-0b844892><div class="relative" data-v-0b844892><div class="absolute inset-0 flex items-center" data-v-0b844892><div class="w-full border-t border-gray-200" data-v-0b844892></div></div><div class="relative flex justify-center text-sm" data-v-0b844892><span class="px-4 bg-white text-gray-500 font-medium" data-v-0b844892>Ou continuez avec</span></div></div></div>',1)),e("div",An,[e("button",{onClick:V,type:"button",disabled:$.value,class:"flex items-center justify-center px-4 py-3 border border-gray-200 rounded-xl shadow-sm bg-white hover:bg-gray-50 hover:border-gray-300 transition-all duration-200 group whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed"},i[33]||(i[33]=[pe('<svg class="w-5 h-5 text-gray-600 group-hover:text-gray-700 flex-shrink-0" viewBox="0 0 24 24" data-v-0b844892><path fill="currentColor" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" data-v-0b844892></path><path fill="currentColor" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" data-v-0b844892></path><path fill="currentColor" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" data-v-0b844892></path><path fill="currentColor" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" data-v-0b844892></path></svg><span class="ml-2 text-sm font-medium text-gray-700" data-v-0b844892>Google</span>',2)]),8,Pn),e("button",{onClick:v,type:"button",disabled:$.value,class:"flex items-center justify-center px-4 py-3 border border-gray-200 rounded-xl shadow-sm bg-white hover:bg-gray-50 hover:border-gray-300 transition-all duration-200 group whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed"},i[34]||(i[34]=[e("svg",{class:"w-5 h-5 text-blue-600 group-hover:text-blue-700 flex-shrink-0",fill:"currentColor",viewBox:"0 0 24 24"},[e("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})],-1),e("span",{class:"ml-2 text-sm font-medium text-gray-700"},"Facebook",-1)]),8,En)])])])])])}}},Sn=Ee(jn,[["__scopeId","data-v-0b844892"]]),Ft={async loginWithFacebook(){try{const y=await ge().get("/auth/facebook/redirect");y.redirect_url&&(window.location.href=y.redirect_url)}catch(_){throw console.error("Facebook login error:",_),new Error("Erreur lors de la connexion avec Facebook")}},async loginWithGoogle(){try{const y=await ge().get("/auth/google/redirect");y.redirect_url&&(window.location.href=y.redirect_url)}catch(_){throw console.error("Google login error:",_),new Error("Erreur lors de la connexion avec Google")}},async loginWithApple(){try{const y=await ge().get("/auth/apple/redirect");y.redirect_url&&(window.location.href=y.redirect_url)}catch(_){throw console.error("Apple login error:",_),new Error("Erreur lors de la connexion avec Apple")}},async handleSocialCallback(_,y){try{const p=await ge().get(`/auth/${_}/callback`,{params:y});if(p.access_token){const f=Pe();return f.setUser(p.user),f.setToken(p.access_token),{success:!0,user:p.user,message:p.message}}else throw new Error("Réponse invalide du serveur")}catch(w){return console.error("Social callback error:",w),{success:!1,message:w.response?.data?.message||"Erreur lors de l'authentification"}}},async openSocialLoginPopup(_){return new Promise((y,w)=>{try{const p=window.open(`/api/auth/${_}`,"socialLogin","width=600,height=700,scrollbars=yes,resizable=yes"),f=setInterval(()=>{p.closed&&(clearInterval(f),Ft.checkAuthenticationStatus().then(y).catch(w))},1e3);setTimeout(()=>{clearInterval(f),p.closed||p.close(),w(new Error("Timeout lors de l'authentification"))},3e5)}catch(p){w(p)}})},async checkAuthenticationStatus(){try{const y=await ge().get("/auth/me");return y.user?(Pe().setUser(y.user),{success:!0,user:y.user}):{success:!1}}catch{return{success:!1}}}},In={class:"min-h-screen bg-white flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"},Dn={class:"max-w-4xl w-full"},Tn={class:"bg-white rounded-3xl shadow-2xl border border-gray-100 overflow-hidden"},Mn={class:"grid grid-cols-1 lg:grid-cols-2"},Ln={class:"bg-gradient-to-br from-[#0099cc] to-[#0088bb] p-8 lg:p-12 flex flex-col justify-center relative overflow-hidden"},Vn={class:"relative z-10"},Rn={class:"flex items-center mb-8"},Fn={class:"p-8 lg:p-12"},Nn={class:"max-w-md mx-auto"},zn={class:"text-gray-600 mb-8"},qn={class:"mb-6"},Un={class:"grid grid-cols-2 gap-3"},Bn={class:"flex items-center"},On={key:0,class:"w-full h-full rounded-full bg-white scale-50"},Gn={class:"flex items-center"},Hn={key:0,class:"w-full h-full rounded-full bg-white scale-50"},Kn={class:"grid grid-cols-2 gap-4"},Wn={key:0,class:"mt-1 text-sm text-red-600"},Jn={key:0,class:"mt-1 text-sm text-red-600"},Xn={key:0,class:"mt-1 text-sm text-red-600"},Yn={key:0,class:"mt-1 text-sm text-red-600"},Qn={class:"relative"},Zn=["disabled"],ei=["value"],ti={key:0,class:"mt-1 text-sm text-red-600"},si={key:1,class:"mt-1 text-sm text-gray-500"},oi={class:"grid grid-cols-2 gap-4"},ri={class:"relative"},ai=["type"],ni={key:0,class:"mt-1 text-sm text-red-600"},ii={class:"relative"},li=["type"],di={key:0,class:"mt-1 text-sm text-red-600"},ui={class:"flex items-start space-x-3"},ci={class:"flex items-center h-6"},mi={key:0,class:"text-sm text-red-600"},pi={key:1,class:"rounded-xl bg-red-50 p-4 border border-red-200"},gi={class:"flex"},fi={class:"ml-3"},vi={class:"mt-1 text-sm text-red-700"},xi=["disabled"],bi={key:0,class:"flex items-center space-x-2"},yi={key:1},hi="/logo_white.png",_i={__name:"Register",setup(_){const y=$e(),w=Pe(),{get:p}=ge(),f=R(!1),a=R(!1),c=R([]),n=R(!1),r=R(!1);R("GA");const P=xe({role:"Particulier",first_name:"",last_name:"",email:"",phone:"",country_id:"",password:"",password_confirmation:"",terms:!1}),$=xe({first_name:"",last_name:"",email:"",phone:"",country_id:"",password:"",password_confirmation:"",terms:""}),M=()=>{Object.keys($).forEach(d=>{$[d]=""});let v=!0;return P.first_name.trim()||($.first_name="Le prénom est requis",v=!1),P.last_name.trim()||($.last_name="Le nom est requis",v=!1),P.email?/\S+@\S+\.\S+/.test(P.email)||($.email="Format d'email invalide",v=!1):($.email="L'email est requis",v=!1),!P.phone||P.phone.trim()===""?($.phone="Le numéro de téléphone est requis",v=!1):!r.value&&P.phone.length>3&&($.phone="Format de téléphone invalide",v=!1),P.country_id||($.country_id="Le pays est requis",v=!1),P.password?P.password.length<8&&($.password="Le mot de passe doit contenir au moins 8 caractères",v=!1):($.password="Le mot de passe est requis",v=!1),P.password!==P.password_confirmation&&($.password_confirmation="Les mots de passe ne correspondent pas",v=!1),P.terms||($.terms="Vous devez accepter les conditions d'utilisation",v=!1),v},D=v=>{console.log("Phone change:",v),r.value=v.isValid,P.phone=v.fullNumber,v.isValid&&v.fullNumber&&($.phone="")},m=async()=>{if(!M())return;w.clearError();const v={role:P.role,first_name:P.first_name.trim(),last_name:P.last_name.trim(),email:P.email.trim(),phone:P.phone.trim(),country_id:parseInt(P.country_id),password:P.password,password_confirmation:P.password_confirmation},d=await w.register(v);if(d.success){console.log("Inscription réussie, données utilisateur:",w.user),w.logout();const i=P.role==="Business"?"marchand":"client",C=d.verification_type==="email_link"?`Un email de vérification a été envoyé à ${d.verification_sent_to}. Veuillez cliquer sur le lien dans votre email, puis vous connecter ci-dessous.`:`Un code de vérification a été envoyé à ${d.verification_sent_to}. Veuillez vérifier votre compte, puis vous connecter ci-dessous.`;sessionStorage.setItem("registration_success",JSON.stringify({email:P.email.trim(),first_name:d.user?.first_name||P.first_name,role_type:i,verification_message:C,requires_verification:d.requires_verification||!1})),console.log("Redirection vers la page de connexion après inscription"),y.push({name:"login",query:{registered:"true",email:P.email.trim()}})}else if(console.error("Erreur lors de l'inscription:",d),window.$toast){const i=d.message||"Une erreur est survenue lors de l'inscription";window.$toast.error(i,"Erreur d'inscription")}},k=async()=>{try{w.clearError(),await Ft.loginWithFacebook()}catch(v){w.setError(v.message||"Erreur lors de la connexion avec Facebook")}},U=async()=>{try{w.clearError(),await Ft.loginWithGoogle()}catch(v){w.setError(v.message||"Erreur lors de la connexion avec Google")}},V=async()=>{try{n.value=!0;const v=await p("/countries");c.value=v.countries||[];const d=c.value.find(i=>i.name==="Gabon");d&&!P.country_id&&(P.country_id=d.id)}catch(v){console.error("Erreur lors du chargement des pays:",v)}finally{n.value=!1}};return ve(()=>{V()}),(v,d)=>{const i=he("router-link");return s(),o("div",In,[e("div",Dn,[e("div",Tn,[e("div",Mn,[e("div",Ln,[d[13]||(d[13]=e("div",{class:"absolute inset-0 opacity-10"},[e("div",{class:"absolute -top-10 -right-10 w-40 h-40 bg-white rounded-full"}),e("div",{class:"absolute -bottom-16 -left-16 w-60 h-60 bg-white rounded-full"})],-1)),e("div",Vn,[e("div",Rn,[g(i,{to:"/"},{default:re(()=>[e("img",{src:hi,alt:"Logo Koumbaya",class:"h-16 w-auto mr-4 hover:opacity-80 transition-opacity"})]),_:1})]),d[12]||(d[12]=pe('<h2 class="text-4xl lg:text-5xl font-bold text-white mb-6"> Rejoignez notre marketplace ! </h2><p class="text-blue-100 text-lg leading-relaxed mb-8"> Créez votre compte hybride et profitez d&#39;une expérience unique : <strong class="text-white">achetez malin</strong> et <strong class="text-white">vendez facilement</strong> sur la même plateforme. </p><div class="space-y-4"><div class="flex items-center text-blue-100"><div class="w-6 h-6 bg-white/20 rounded-full flex items-center justify-center mr-3"><span class="text-white text-sm">✓</span></div><span>Compte hybride acheteur-vendeur</span></div><div class="flex items-center text-blue-100"><div class="w-6 h-6 bg-white/20 rounded-full flex items-center justify-center mr-3"><span class="text-white text-sm">✓</span></div><span>Produits authentiques à prix réduits</span></div><div class="flex items-center text-blue-100"><div class="w-6 h-6 bg-white/20 rounded-full flex items-center justify-center mr-3"><span class="text-white text-sm">✓</span></div><span>Système de notation communautaire</span></div></div>',3))])]),e("div",Fn,[e("div",Nn,[d[34]||(d[34]=e("h3",{class:"text-3xl font-bold text-gray-900 mb-2"},"Créer un compte",-1)),e("p",zn,[d[15]||(d[15]=z(" Déjà membre ? ",-1)),g(i,{to:"/login",class:"text-[#0099cc] hover:text-[#0088bb] font-semibold"},{default:re(()=>d[14]||(d[14]=[z(" Se connecter ",-1)])),_:1,__:[14]})]),e("div",{class:"space-y-3 mb-8"},[e("button",{onClick:k,class:"w-full flex items-center justify-center px-4 py-3 border border-gray-200 rounded-xl text-gray-700 bg-white hover:bg-gray-50 transition-colors duration-200 group"},d[16]||(d[16]=[e("svg",{class:"w-5 h-5 mr-3",viewBox:"0 0 24 24",fill:"#1877F2"},[e("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})],-1),z(" Continuer avec Facebook ",-1)])),e("button",{onClick:U,class:"w-full flex items-center justify-center px-4 py-3 border border-gray-200 rounded-xl text-gray-700 bg-white hover:bg-gray-50 transition-colors duration-200 group"},d[17]||(d[17]=[pe('<svg class="w-5 h-5 mr-3" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"></path></svg> Continuer avec Google ',2)]))]),d[35]||(d[35]=pe('<div class="relative my-8"><div class="absolute inset-0 flex items-center"><div class="w-full border-t border-gray-200"></div></div><div class="relative flex justify-center text-sm"><span class="px-4 bg-white text-gray-500">ou créer avec email</span></div></div>',1)),e("div",qn,[d[20]||(d[20]=e("label",{class:"block text-sm font-semibold text-gray-900 mb-3"},"Type de compte",-1)),e("div",Un,[e("div",{onClick:d[0]||(d[0]=C=>P.role="Particulier"),class:te(["relative cursor-pointer p-4 border-2 rounded-xl transition-all duration-200 hover:border-[#0099cc]/50",P.role==="Particulier"?"border-[#0099cc] bg-[#0099cc]/5":"border-gray-200"])},[e("div",Bn,[e("div",{class:te(["w-4 h-4 rounded-full border-2 mr-3 transition-colors",P.role==="Particulier"?"border-[#0099cc] bg-[#0099cc]":"border-gray-300"])},[P.role==="Particulier"?(s(),o("div",On)):T("",!0)],2),d[18]||(d[18]=e("div",null,[e("h4",{class:"font-semibold text-gray-900"},"Koumbuyer"),e("p",{class:"text-xs text-gray-600"},"Acheteur Particulier")],-1))])],2),e("div",{onClick:d[1]||(d[1]=C=>P.role="Business"),class:te(["relative cursor-pointer p-4 border-2 rounded-xl transition-all duration-200 hover:border-[#0099cc]/50",P.role==="Business"?"border-[#0099cc] bg-[#0099cc]/5":"border-gray-200"])},[e("div",Gn,[e("div",{class:te(["w-4 h-4 rounded-full border-2 mr-3 transition-colors",P.role==="Business"?"border-[#0099cc] bg-[#0099cc]":"border-gray-300"])},[P.role==="Business"?(s(),o("div",Hn)):T("",!0)],2),d[19]||(d[19]=e("div",null,[e("h4",{class:"font-semibold text-gray-900"},"Koumbiste"),e("p",{class:"text-xs text-gray-600"},"Vendeur Indépendant")],-1))])],2)])]),e("form",{onSubmit:_e(m,["prevent"]),class:"space-y-5"},[e("div",Kn,[e("div",null,[d[21]||(d[21]=e("label",{for:"first_name",class:"block text-sm font-semibold text-gray-900 mb-2"}," Prénom * ",-1)),Q(e("input",{id:"first_name","onUpdate:modelValue":d[2]||(d[2]=C=>P.first_name=C),type:"text",required:"",class:te(["w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",{"border-red-300 bg-red-50":$.first_name}]),style:{color:"#5f5f5f"},placeholder:"Jean"},null,2),[[ne,P.first_name]]),$.first_name?(s(),o("p",Wn,t($.first_name),1)):T("",!0)]),e("div",null,[d[22]||(d[22]=e("label",{for:"last_name",class:"block text-sm font-semibold text-gray-900 mb-2"}," Nom * ",-1)),Q(e("input",{id:"last_name","onUpdate:modelValue":d[3]||(d[3]=C=>P.last_name=C),type:"text",required:"",class:te(["w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",{"border-red-300 bg-red-50":$.last_name}]),style:{color:"#5f5f5f"},placeholder:"Dupont"},null,2),[[ne,P.last_name]]),$.last_name?(s(),o("p",Jn,t($.last_name),1)):T("",!0)])]),d[33]||(d[33]=pe('<div class="bg-amber-50 border border-amber-200 rounded-lg p-3"><p class="text-xs text-amber-800 flex items-center"><svg class="w-4 h-4 mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><span class="font-medium">Veuillez renseigner vos Nom et Prénom tels qu&#39;ils figurent à l&#39;État Civil</span></p></div>',1)),e("div",null,[d[23]||(d[23]=e("label",{for:"email",class:"block text-sm font-semibold text-gray-900 mb-2"}," Adresse email * ",-1)),Q(e("input",{id:"email","onUpdate:modelValue":d[4]||(d[4]=C=>P.email=C),type:"email",required:"",class:te(["w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",{"border-red-300 bg-red-50":$.email}]),style:{color:"#5f5f5f"},placeholder:"jean@exemple.com"},null,2),[[ne,P.email]]),$.email?(s(),o("p",Xn,t($.email),1)):T("",!0)]),e("div",null,[d[24]||(d[24]=e("label",{for:"phone",class:"block text-sm font-semibold text-gray-900 mb-2"}," Numéro de téléphone * ",-1)),g(tt,{ref:"phoneInputRef",modelValue:P.phone,"onUpdate:modelValue":d[5]||(d[5]=C=>P.phone=C),"preferred-countries":["ga","cm","ci","cg","cf","td","gq","bf","bj","tg","fr","ca"],"initial-country":"ga",onPhoneChange:D},null,8,["modelValue"]),$.phone?(s(),o("p",Yn,t($.phone),1)):T("",!0)]),e("div",null,[d[27]||(d[27]=e("label",{for:"country",class:"block text-sm font-semibold text-gray-900 mb-2"}," Pays * ",-1)),e("div",Qn,[Q(e("select",{id:"country","onUpdate:modelValue":d[6]||(d[6]=C=>P.country_id=C),required:"",class:te(["w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all appearance-none bg-white",{"border-red-300 bg-red-50":$.country_id}]),style:{color:"#5f5f5f"},disabled:n.value},[d[25]||(d[25]=e("option",{value:"",disabled:""},"Sélectionnez votre pays",-1)),(s(!0),o(ie,null,le(c.value,C=>(s(),o("option",{key:C.id,value:C.id},t(C.name),9,ei))),128))],10,Zn),[[me,P.country_id]]),d[26]||(d[26]=e("div",{class:"absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})])],-1))]),$.country_id?(s(),o("p",ti,t($.country_id),1)):T("",!0),n.value?(s(),o("p",si,"Chargement des pays...")):T("",!0)]),e("div",oi,[e("div",null,[d[28]||(d[28]=e("label",{for:"password",class:"block text-sm font-semibold text-gray-900 mb-2"}," Mot de passe * ",-1)),e("div",ri,[Q(e("input",{id:"password","onUpdate:modelValue":d[7]||(d[7]=C=>P.password=C),type:f.value?"text":"password",required:"",class:te(["w-full px-4 py-3 pr-12 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",{"border-red-300 bg-red-50":$.password}]),style:{color:"#5f5f5f"},placeholder:"••••••••"},null,10,ai),[[pt,P.password]]),e("button",{type:"button",onClick:d[8]||(d[8]=C=>f.value=!f.value),class:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600"},[f.value?(s(),ce(l(gt),{key:1,class:"h-5 w-5"})):(s(),ce(l(Ue),{key:0,class:"h-5 w-5"}))])]),$.password?(s(),o("p",ni,t($.password),1)):T("",!0)]),e("div",null,[d[29]||(d[29]=e("label",{for:"password_confirmation",class:"block text-sm font-semibold text-gray-900 mb-2"}," Confirmer * ",-1)),e("div",ii,[Q(e("input",{id:"password_confirmation","onUpdate:modelValue":d[9]||(d[9]=C=>P.password_confirmation=C),type:a.value?"text":"password",required:"",class:te(["w-full px-4 py-3 pr-12 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",{"border-red-300 bg-red-50":$.password_confirmation}]),style:{color:"#5f5f5f"},placeholder:"••••••••"},null,10,li),[[pt,P.password_confirmation]]),e("button",{type:"button",onClick:d[10]||(d[10]=C=>a.value=!a.value),class:"absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600"},[a.value?(s(),ce(l(gt),{key:1,class:"h-5 w-5"})):(s(),ce(l(Ue),{key:0,class:"h-5 w-5"}))])]),$.password_confirmation?(s(),o("p",di,t($.password_confirmation),1)):T("",!0)])]),e("div",ui,[e("div",ci,[Q(e("input",{id:"terms","onUpdate:modelValue":d[11]||(d[11]=C=>P.terms=C),type:"checkbox",class:te(["h-4 w-4 text-[#0099cc] focus:ring-[#0099cc] border-gray-300 rounded",{"border-red-500":$.terms}])},null,2),[[Ae,P.terms]])]),d[30]||(d[30]=e("label",{for:"terms",class:"text-sm text-gray-600 leading-6"},[z(" J'accepte les "),e("a",{href:"#",class:"text-[#0099cc] hover:text-[#0088bb] font-semibold"},"conditions d'utilisation"),z(" et la "),e("a",{href:"#",class:"text-[#0099cc] hover:text-[#0088bb] font-semibold"},"politique de confidentialité")],-1))]),$.terms?(s(),o("p",mi,t($.terms),1)):T("",!0),l(w).error?(s(),o("div",pi,[e("div",gi,[g(l(We),{class:"h-5 w-5 text-red-400 mt-0.5"}),e("div",fi,[d[31]||(d[31]=e("h3",{class:"text-sm font-semibold text-red-800"}," Erreur d'inscription ",-1)),e("div",vi,t(l(w).error),1)])])])):T("",!0),e("button",{type:"submit",disabled:l(w).loading,class:"w-full bg-[#0099cc] hover:bg-[#0088bb] disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold py-4 px-6 rounded-xl transition-all duration-200 hover:scale-[1.02] shadow-lg hover:shadow-xl flex items-center justify-center space-x-2"},[l(w).loading?(s(),o("span",bi,d[32]||(d[32]=[e("div",{class:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"},null,-1),e("span",null,"Création en cours...",-1)]))):(s(),o("span",yi,"Créer mon compte Koumbaya"))],8,xi)],32)])])])])])])}}},wi={class:"min-h-screen bg-white flex items-center justify-center py-12 px-4"},$i={class:"max-w-md w-full bg-white rounded-3xl shadow-2xl border border-gray-100 p-8"},ki={class:"text-center mb-8"},Ci=["src"],Ai={key:0,class:"text-center"},Pi={key:1,class:"text-center"},Ei={class:"text-2xl font-bold text-[#0099cc] mb-2"},ji={class:"text-gray-600 mb-6"},Si={class:"space-y-3"},Ii={key:2,class:"text-center"},Di={class:"text-gray-600 mb-6"},Ti={class:"space-y-3"},Mi={__name:"VerifyEmail",setup(_){const y=Be(),w=$e(),p=Pe(),{get:f}=ge(),a=R(!0),c=R(null),n=R(""),r=async()=>{try{const $=y.query.token;if(!$)throw new Error("Token de vérification manquant");const M=await f(`/auth/verify-email/${encodeURIComponent($)}`);if(M.success)c.value=M,p.isAuthenticated&&await p.refreshUser();else throw new Error(M.message||"Erreur de vérification")}catch($){console.error("Erreur lors de la vérification:",$),c.value={success:!1},n.value=$.response?.data?.message||$.message||"Une erreur est survenue lors de la vérification"}finally{a.value=!1}},P=()=>{if(p.isAuthenticated){const $=p.getDefaultRedirect();w.push({name:$}).catch(()=>{w.push("/dashboard")})}else w.push("/login")};return ve(()=>{r()}),($,M)=>{const D=he("router-link");return s(),o("div",wi,[e("div",$i,[e("div",ki,[g(D,{to:"/"},{default:re(()=>[e("img",{src:l(Ye),alt:"Logo Koumbaya",class:"h-16 w-auto mx-auto mb-4 hover:opacity-80 transition-opacity"},null,8,Ci)]),_:1})]),a.value?(s(),o("div",Ai,M[3]||(M[3]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-[#0099cc] border-t-transparent mx-auto mb-4"},null,-1),e("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Vérification en cours...",-1),e("p",{class:"text-gray-600"},"Nous vérifions votre lien de vérification.",-1)]))):c.value?.success?(s(),o("div",Pi,[M[4]||(M[4]=e("div",{class:"w-16 h-16 bg-[#0099cc]/10 rounded-full flex items-center justify-center mx-auto mb-4"},[e("svg",{class:"w-8 h-8 text-[#0099cc]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1)),e("h2",Ei,t(c.value.already_verified?"Déjà vérifié !":"Compte vérifié !"),1),e("p",ji,t(c.value.message),1),e("div",Si,[e("button",{onClick:P,class:"w-full bg-[#0099cc] hover:bg-[#0088bb] text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 hover:scale-[1.02] shadow-lg hover:shadow-xl"}," Accéder à mon compte "),e("button",{onClick:M[0]||(M[0]=m=>$.$router.push("/")),class:"w-full border-2 border-gray-200 hover:border-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-xl transition-all duration-200"}," Retour à l'accueil ")])])):(s(),o("div",Ii,[M[5]||(M[5]=e("div",{class:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},[e("svg",{class:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),M[6]||(M[6]=e("h2",{class:"text-2xl font-bold text-red-600 mb-2"},"Vérification échouée",-1)),e("p",Di,t(n.value),1),e("div",Ti,[e("button",{onClick:M[1]||(M[1]=m=>$.$router.push("/register")),class:"w-full bg-[#0099cc] hover:bg-[#0088bb] text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200"}," Créer un nouveau compte "),e("button",{onClick:M[2]||(M[2]=m=>$.$router.push("/login")),class:"w-full border-2 border-gray-200 hover:border-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-xl transition-all duration-200"}," Se connecter ")])])),M[7]||(M[7]=pe('<div class="mt-8 p-4 bg-blue-50 rounded-xl border border-blue-200"><div class="flex items-start"><svg class="w-5 h-5 text-blue-600 mt-0.5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div><h4 class="text-sm font-semibold text-blue-900">Pourquoi vérifier mon compte ?</h4><p class="text-sm text-blue-700 mt-1"> La vérification de votre compte est nécessaire pour pouvoir acheter des produits et participer aux tombolas sur Koumbaya. </p></div></div></div>',1))])])}}},Li={class:"min-h-screen bg-white flex flex-col justify-center py-12 sm:px-6 lg:px-8"},Vi={class:"sm:mx-auto sm:w-full sm:max-w-md"},Ri={class:"flex justify-center mb-8"},Fi=["src"],Ni={class:"mt-12 sm:mx-auto sm:w-full sm:max-w-md"},zi={class:"koumbaya-card bg-white/80 backdrop-blur-sm border-0 shadow-2xl"},qi={class:"koumbaya-card-body p-8"},Ui={class:"flex justify-center space-x-2 p-1 bg-gray-100 rounded-lg mb-6"},Bi={key:0,class:"koumbaya-form-group"},Oi={for:"email",class:"block text-sm font-medium text-gray-700 mb-2"},Gi={class:"flex items-center"},Hi={key:0,class:"mt-2 text-sm text-red-600 flex items-center"},Ki={key:1,class:"koumbaya-form-group"},Wi={for:"phone",class:"block text-sm font-medium text-gray-700 mb-2"},Ji={class:"flex items-center"},Xi={key:0,class:"mt-2 text-sm text-red-600 flex items-center"},Yi={key:2,class:"rounded-xl bg-red-50 p-4 border border-red-200"},Qi={class:"flex"},Zi={class:"ml-3"},el={class:"mt-1 text-sm text-red-700"},tl={key:3,class:"rounded-xl bg-green-50 p-4 border border-green-200"},sl={class:"flex"},ol={class:"ml-3"},rl={class:"mt-1 text-sm text-green-700"},al=["disabled"],nl={key:0,class:"flex items-center space-x-2"},il={key:1},ll={class:"text-center"},dl={__name:"ForgotPassword",setup(_){const y=$e(),{post:w}=ge(),p=R("email"),f=R(!1),a=R(!1),c=R(!1),n=xe({email:"",phone:""}),r=xe({email:"",phone:"",general:""}),P=D=>{f.value=D.isValid,n.phone=D.fullNumber,D.isValid&&(r.phone="")},$=()=>{Object.keys(r).forEach(m=>{r[m]=""});let D=!0;return p.value==="email"?n.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)||(r.email="Format d'email invalide",D=!1):(r.email="L'adresse email est obligatoire",D=!1):n.phone?f.value||(r.phone="Format de téléphone invalide",D=!1):(r.phone="Le numéro de téléphone est obligatoire",D=!1),D},M=async()=>{if($()){a.value=!0,r.general="",c.value=!1;try{const D=p.value==="email"?n.email:n.phone,m=await w("/otp/send",{identifier:D,type:p.value==="email"?"email":"sms",purpose:"password_reset"});m.success?(c.value=!0,setTimeout(()=>{y.push({name:"reset-password-verify",query:{identifier:D,method:p.value}})},2e3)):r.general=m.message||"Une erreur est survenue"}catch(D){console.error("Erreur lors de l'envoi du code:",D),r.general="Une erreur est survenue lors de l'envoi du code"}finally{a.value=!1}}};return(D,m)=>{const k=he("router-link");return s(),o("div",Li,[e("div",Vi,[e("div",Ri,[g(k,{to:"/"},{default:re(()=>[e("img",{class:"h-20 w-auto hover:opacity-80 transition-opacity",src:l(Ye),alt:"Koumbaya"},null,8,Fi)]),_:1})]),m[4]||(m[4]=e("h2",{class:"text-center text-4xl font-bold text-gray-900 mb-3"}," Mot de passe oublié ? ",-1)),m[5]||(m[5]=e("p",{class:"text-center text-lg text-gray-600 mb-8"}," Entrez votre adresse email ou votre numéro de téléphone ",-1))]),e("div",Ni,[e("div",zi,[e("div",qi,[e("form",{onSubmit:_e(M,["prevent"]),class:"space-y-6"},[e("div",Ui,[e("button",{type:"button",onClick:m[0]||(m[0]=U=>p.value="email"),class:te(["flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all duration-200",p.value==="email"?"bg-white text-koumbaya-primary shadow-sm":"text-gray-600 hover:text-gray-900"])},[g(l(lt),{class:"w-4 h-4 inline-block mr-2"}),m[6]||(m[6]=z(" Email ",-1))],2),e("button",{type:"button",onClick:m[1]||(m[1]=U=>p.value="phone"),class:te(["flex-1 py-2 px-4 rounded-md text-sm font-medium transition-all duration-200",p.value==="phone"?"bg-white text-koumbaya-primary shadow-sm":"text-gray-600 hover:text-gray-900"])},[g(l(et),{class:"w-4 h-4 inline-block mr-2"}),m[7]||(m[7]=z(" Téléphone ",-1))],2)]),p.value==="email"?(s(),o("div",Bi,[e("label",Oi,[e("div",Gi,[g(l(lt),{class:"w-4 h-4 mr-2 text-gray-500 flex-shrink-0"}),m[8]||(m[8]=e("span",null,"Adresse e-mail",-1))])]),Q(e("input",{id:"email",name:"email",type:"email","onUpdate:modelValue":m[2]||(m[2]=U=>n.email=U),required:"",class:te(["koumbaya-input bg-white/50 border-gray-200 focus:border-koumbaya-primary focus:ring-4 focus:ring-koumbaya-primary/10 rounded-xl transition-all duration-200",{"border-red-300 focus:border-red-500 focus:ring-red-500/10":r.email}]),style:{color:"#5f5f5f"},placeholder:"exemple@koumbaya.com"},null,2),[[ne,n.email]]),r.email?(s(),o("p",Hi,[g(l(Se),{class:"w-4 h-4 mr-1"}),z(" "+t(r.email),1)])):T("",!0)])):T("",!0),p.value==="phone"?(s(),o("div",Ki,[e("label",Wi,[e("div",Ji,[g(l(et),{class:"w-4 h-4 mr-2 text-gray-500 flex-shrink-0"}),m[9]||(m[9]=e("span",null,"Numéro de téléphone",-1))])]),g(tt,{ref:"phoneInputRef",modelValue:n.phone,"onUpdate:modelValue":m[3]||(m[3]=U=>n.phone=U),"preferred-countries":["ga","cm","ci","cg","cf","td","gq","bf","bj","tg","fr","ca"],"initial-country":"ga",onPhoneChange:P},null,8,["modelValue"]),r.phone?(s(),o("p",Xi,[g(l(Se),{class:"w-4 h-4 mr-1"}),z(" "+t(r.phone),1)])):T("",!0)])):T("",!0),r.general?(s(),o("div",Yi,[e("div",Qi,[g(l(Se),{class:"h-5 w-5 text-red-400 mt-0.5"}),e("div",Zi,[m[10]||(m[10]=e("h3",{class:"text-sm font-semibold text-red-800"},"Erreur",-1)),e("div",el,t(r.general),1)])])])):T("",!0),c.value?(s(),o("div",tl,[e("div",sl,[g(l(Re),{class:"h-5 w-5 text-green-400 mt-0.5"}),e("div",ol,[m[11]||(m[11]=e("h3",{class:"text-sm font-semibold text-green-800"},"Code envoyé !",-1)),e("div",rl," Un code de réinitialisation a été envoyé à "+t(p.value==="email"?n.email:n.phone),1)])])])):T("",!0),e("button",{type:"submit",disabled:a.value,class:"w-full bg-[#0099cc] hover:bg-[#0088bb] disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold py-4 px-6 rounded-xl transition-all duration-200 hover:scale-[1.02] shadow-lg hover:shadow-xl flex items-center justify-center space-x-2"},[a.value?(s(),o("span",nl,m[12]||(m[12]=[e("div",{class:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"},null,-1),e("span",null,"Envoi en cours...",-1)]))):(s(),o("span",il,"Envoyer le code"))],8,al),e("div",ll,[g(k,{to:"/login",class:"text-sm font-semibold text-koumbaya-primary hover:text-koumbaya-primary-dark transition-colors"},{default:re(()=>m[13]||(m[13]=[z(" ← Retour à la connexion ",-1)])),_:1,__:[13]})])],32)])])])])}}},ul=Ee(dl,[["__scopeId","data-v-c87532bd"]]),cl={class:"min-h-screen bg-white flex flex-col justify-center py-12 sm:px-6 lg:px-8"},ml={class:"sm:mx-auto sm:w-full sm:max-w-md"},pl={class:"flex justify-center mb-8"},gl=["src"],fl={class:"text-center text-lg text-gray-600 mb-8"},vl={class:"mt-12 sm:mx-auto sm:w-full sm:max-w-md"},xl={class:"koumbaya-card bg-white/80 backdrop-blur-sm border-0 shadow-2xl"},bl={class:"koumbaya-card-body p-8"},yl={class:"koumbaya-form-group"},hl={key:0,class:"mt-2 text-sm text-red-600 flex items-center"},_l={class:"koumbaya-form-group"},wl={class:"relative"},$l=["type"],kl={key:0,class:"mt-2 text-sm text-red-600 flex items-center"},Cl={class:"koumbaya-form-group"},Al={class:"relative"},Pl=["type"],El={key:0,class:"mt-2 text-sm text-red-600 flex items-center"},jl={key:0,class:"rounded-xl bg-red-50 p-4 border border-red-200"},Sl={class:"flex"},Il={class:"ml-3"},Dl={class:"mt-1 text-sm text-red-700"},Tl={key:1,class:"rounded-xl bg-green-50 p-4 border border-green-200"},Ml={class:"flex"},Ll=["disabled"],Vl={key:0,class:"flex items-center space-x-2"},Rl={key:1},Fl={class:"text-center"},Nl=["disabled"],zl={key:0},ql={key:1},Ul={key:2},Bl={__name:"ResetPasswordVerify",setup(_){const y=$e(),w=Be(),{post:p}=ge(),f=R(w.query.identifier||""),a=R(w.query.method||"email"),c=R(!1),n=R(!1),r=R(!1),P=R(!1),$=R(!1),M=R(0),D=R(null),m=xe({otp:"",password:"",password_confirmation:""}),k=xe({otp:"",password:"",password_confirmation:"",general:""}),U=()=>{Object.keys(k).forEach(C=>{k[C]=""});let i=!0;return m.otp?m.otp.length!==6&&(k.otp="Le code doit contenir 6 chiffres",i=!1):(k.otp="Le code est obligatoire",i=!1),m.password?m.password.length<8&&(k.password="Le mot de passe doit contenir au moins 8 caractères",i=!1):(k.password="Le mot de passe est obligatoire",i=!1),m.password!==m.password_confirmation&&(k.password_confirmation="Les mots de passe ne correspondent pas",i=!1),i},V=async()=>{if(U()){c.value=!0,k.general="",n.value=!1;try{const i=await p("/auth/reset-password",{identifier:f.value,otp:m.otp,password:m.password,password_confirmation:m.password_confirmation});i.success?(n.value=!0,setTimeout(()=>{y.push({name:"login"})},2e3)):k.general=i.message||"Une erreur est survenue"}catch(i){console.error("Erreur lors de la réinitialisation:",i),i.response?.data?.message?k.general=i.response.data.message:k.general="Une erreur est survenue lors de la réinitialisation"}finally{c.value=!1}}},v=async()=>{$.value=!0;try{const i=await p("/otp/resend",{identifier:f.value,type:a.value==="email"?"email":"sms",purpose:"password_reset"});i.success?d():k.general=i.message||"Erreur lors du renvoi du code"}catch(i){console.error("Erreur lors du renvoi:",i),k.general="Erreur lors du renvoi du code"}finally{$.value=!1}},d=()=>{M.value=60,D.value=setInterval(()=>{M.value--,M.value<=0&&clearInterval(D.value)},1e3)};return ve(()=>{f.value||y.push({name:"forgot-password"})}),st(()=>{D.value&&clearInterval(D.value)}),(i,C)=>{const x=he("router-link");return s(),o("div",cl,[e("div",ml,[e("div",pl,[g(x,{to:"/"},{default:re(()=>[e("img",{class:"h-20 w-auto hover:opacity-80 transition-opacity",src:l(Ye),alt:"Koumbaya"},null,8,gl)]),_:1})]),C[5]||(C[5]=e("h2",{class:"text-center text-4xl font-bold text-gray-900 mb-3"}," Vérification du code ",-1)),e("p",fl," Entrez le code reçu "+t(a.value==="email"?"par email":"par SMS"),1)]),e("div",vl,[e("div",xl,[e("div",bl,[e("form",{onSubmit:_e(V,["prevent"]),class:"space-y-6"},[e("div",yl,[C[6]||(C[6]=e("label",{for:"otp",class:"block text-sm font-medium text-gray-700 mb-2"}," Code de vérification ",-1)),Q(e("input",{id:"otp",name:"otp",type:"text","onUpdate:modelValue":C[0]||(C[0]=I=>m.otp=I),required:"",maxlength:"6",class:te(["koumbaya-input bg-white/50 border-gray-200 focus:border-koumbaya-primary focus:ring-4 focus:ring-koumbaya-primary/10 rounded-xl transition-all duration-200 text-center text-2xl letter-spacing-wide",{"border-red-300 focus:border-red-500 focus:ring-red-500/10":k.otp}]),style:{color:"#5f5f5f"},placeholder:"123456"},null,2),[[ne,m.otp]]),k.otp?(s(),o("p",hl,[g(l(Se),{class:"w-4 h-4 mr-1"}),z(" "+t(k.otp),1)])):T("",!0)]),e("div",_l,[C[7]||(C[7]=e("label",{for:"password",class:"block text-sm font-medium text-gray-700 mb-2"}," Nouveau mot de passe ",-1)),e("div",wl,[Q(e("input",{id:"password",name:"password",type:r.value?"text":"password","onUpdate:modelValue":C[1]||(C[1]=I=>m.password=I),required:"",class:te(["koumbaya-input bg-white/50 border-gray-200 focus:border-koumbaya-primary focus:ring-4 focus:ring-koumbaya-primary/10 rounded-xl transition-all duration-200 pr-12",{"border-red-300 focus:border-red-500 focus:ring-red-500/10":k.password}]),style:{color:"#5f5f5f"},placeholder:"••••••••"},null,10,$l),[[pt,m.password]]),e("button",{type:"button",onClick:C[2]||(C[2]=I=>r.value=!r.value),class:"absolute inset-y-0 right-0 pr-4 flex items-center hover:bg-gray-100 rounded-r-xl transition-colors"},[r.value?(s(),ce(l(gt),{key:1,class:"h-5 w-5 text-gray-400 hover:text-gray-600"})):(s(),ce(l(Ue),{key:0,class:"h-5 w-5 text-gray-400 hover:text-gray-600"}))])]),k.password?(s(),o("p",kl,[g(l(Se),{class:"w-4 h-4 mr-1"}),z(" "+t(k.password),1)])):T("",!0)]),e("div",Cl,[C[8]||(C[8]=e("label",{for:"password_confirmation",class:"block text-sm font-medium text-gray-700 mb-2"}," Confirmer le mot de passe ",-1)),e("div",Al,[Q(e("input",{id:"password_confirmation",name:"password_confirmation",type:P.value?"text":"password","onUpdate:modelValue":C[3]||(C[3]=I=>m.password_confirmation=I),required:"",class:te(["koumbaya-input bg-white/50 border-gray-200 focus:border-koumbaya-primary focus:ring-4 focus:ring-koumbaya-primary/10 rounded-xl transition-all duration-200 pr-12",{"border-red-300 focus:border-red-500 focus:ring-red-500/10":k.password_confirmation}]),style:{color:"#5f5f5f"},placeholder:"••••••••"},null,10,Pl),[[pt,m.password_confirmation]]),e("button",{type:"button",onClick:C[4]||(C[4]=I=>P.value=!P.value),class:"absolute inset-y-0 right-0 pr-4 flex items-center hover:bg-gray-100 rounded-r-xl transition-colors"},[P.value?(s(),ce(l(gt),{key:1,class:"h-5 w-5 text-gray-400 hover:text-gray-600"})):(s(),ce(l(Ue),{key:0,class:"h-5 w-5 text-gray-400 hover:text-gray-600"}))])]),k.password_confirmation?(s(),o("p",El,[g(l(Se),{class:"w-4 h-4 mr-1"}),z(" "+t(k.password_confirmation),1)])):T("",!0)]),k.general?(s(),o("div",jl,[e("div",Sl,[g(l(Se),{class:"h-5 w-5 text-red-400 mt-0.5"}),e("div",Il,[C[9]||(C[9]=e("h3",{class:"text-sm font-semibold text-red-800"},"Erreur",-1)),e("div",Dl,t(k.general),1)])])])):T("",!0),n.value?(s(),o("div",Tl,[e("div",Ml,[g(l(Re),{class:"h-5 w-5 text-green-400 mt-0.5"}),C[10]||(C[10]=e("div",{class:"ml-3"},[e("h3",{class:"text-sm font-semibold text-green-800"},"Mot de passe réinitialisé !"),e("div",{class:"mt-1 text-sm text-green-700"}," Redirection vers la page de connexion... ")],-1))])])):T("",!0),e("button",{type:"submit",disabled:c.value,class:"w-full bg-[#0099cc] hover:bg-[#0088bb] disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold py-4 px-6 rounded-xl transition-all duration-200 hover:scale-[1.02] shadow-lg hover:shadow-xl flex items-center justify-center space-x-2"},[c.value?(s(),o("span",Vl,C[11]||(C[11]=[e("div",{class:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"},null,-1),e("span",null,"Réinitialisation...",-1)]))):(s(),o("span",Rl,"Réinitialiser le mot de passe"))],8,Ll),e("div",Fl,[e("button",{type:"button",onClick:v,disabled:$.value||M.value>0,class:"text-sm font-semibold text-koumbaya-primary hover:text-koumbaya-primary-dark transition-colors disabled:opacity-50"},[M.value>0?(s(),o("span",zl," Renvoyer le code ("+t(M.value)+"s) ",1)):$.value?(s(),o("span",ql,"Envoi...")):(s(),o("span",Ul,"Renvoyer le code"))],8,Nl)])],32)])])])])}}},Ol=Ee(Bl,[["__scopeId","data-v-bcc15f23"]]);function Gl(){const _=f=>f?f.image_url?f.image_url:f.main_image?f.main_image:f.images&&Array.isArray(f.images)&&f.images.length>0?f.images[0]:f.image?f.image:null:null;return{getProductImageUrl:_,getProductImageUrlWithFallback:(f,a="/images/products/placeholder.jpg")=>_(f)||a,hasProductImage:f=>_(f)!==null,getAllProductImages:f=>{if(!f)return[];const a=[];return f.image_url&&a.push(f.image_url),f.images&&Array.isArray(f.images)&&f.images.forEach(c=>{c&&!a.includes(c)&&a.push(c)}),f.image&&!a.includes(f.image)&&a.push(f.image),a}}}const Ne="/build/assets/placeholder-BS1MYrTN.jpg",It="/build/assets/placeholder-BS1MYrTN.jpg",Hl={class:"bg-white"},Kl={class:"relative bg-gradient-to-br from-[#0099cc]/5 via-white to-[#0099cc]/10 overflow-hidden"},Wl={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Jl={class:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center min-h-[90vh] py-20"},Xl={class:"space-y-8"},Yl={class:"space-y-4"},Ql={class:"inline-flex items-center gap-2 bg-[#0099cc]/10 text-[#0099cc] px-4 py-2 rounded-full text-sm font-medium"},Zl={class:"flex flex-col sm:flex-row gap-4"},ed={class:"flex items-center gap-8 pt-8"},td={class:"flex items-center gap-2 text-gray-600"},sd={class:"flex items-center gap-2 text-gray-600"},od={class:"flex items-center gap-2 text-gray-600"},rd={class:"relative lg:h-[600px] flex items-center justify-center"},ad={class:"relative"},nd={class:"bg-white rounded-3xl shadow-2xl p-8 max-w-sm relative z-10 border border-gray-100"},id={class:"relative mb-6"},ld=["src","alt"],dd={class:"absolute -top-2 -right-2 bg-[#0099cc] text-white px-3 py-1 rounded-full text-sm font-bold"},ud={class:"space-y-4"},cd={class:"text-xl font-bold text-black"},md={class:"text-gray-600"},pd={class:"space-y-2"},gd={class:"flex justify-between text-sm text-gray-600"},fd={class:"font-semibold"},vd={class:"w-full bg-gray-200 rounded-full h-3"},xd={class:"text-center text-sm text-gray-500"},bd={class:"w-full bg-purple-600 text-white font-semibold py-3 rounded-xl hover:bg-purple-700 transition-colors flex items-center justify-center gap-2 whitespace-nowrap"},yd={class:"absolute inline-flex items-center -top-8 -left-8 bg-[#0099cc]/10 text-[#0099cc] px-4 py-2 rounded-full text-sm font-medium z-20 animate-float"},hd={key:0,class:"absolute -bottom-4 -right-8 bg-red-100 text-red-600 px-4 py-2 rounded-full text-sm font-medium z-20 animate-float-delayed flex items-center gap-1"},_d={key:1,class:"absolute -bottom-4 -right-8 bg-yellow-100 text-yellow-600 px-4 py-2 rounded-full text-sm font-medium z-20 animate-float-delayed flex items-center gap-1"},wd={class:"py-20 bg-gray-50"},$d={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},kd={class:"grid grid-cols-1 md:grid-cols-4 gap-8"},Cd={class:"text-center"},Ad={class:"w-20 h-20 bg-[#0099cc]/10 rounded-full flex items-center justify-center mx-auto mb-4"},Pd={class:"text-center"},Ed={class:"w-20 h-20 bg-[#0099cc]/10 rounded-full flex items-center justify-center mx-auto mb-4"},jd={class:"text-center"},Sd={class:"w-20 h-20 bg-[#0099cc]/10 rounded-full flex items-center justify-center mx-auto mb-4"},Id={class:"text-center"},Dd={class:"w-20 h-20 bg-[#0099cc]/10 rounded-full flex items-center justify-center mx-auto mb-4"},Td={class:"py-20"},Md={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Ld={class:"text-center mt-12"},Vd={class:"py-20 bg-gray-50"},Rd={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Fd={class:"flex items-center justify-between mb-12"},Nd={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"},zd=["onClick"],qd={class:"absolute top-4 left-4 z-10"},Ud={key:0,class:"bg-gradient-to-r from-purple-500 to-purple-600 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg flex items-center gap-1"},Bd={key:1,class:"bg-gradient-to-r from-[#0099cc] to-cyan-500 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg flex items-center gap-1"},Od={class:"absolute top-4 right-4 z-10"},Gd={key:0,class:"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg animate-pulse flex items-center gap-1"},Hd={key:1,class:"bg-blue-500 text-white px-3 py-1 rounded-full text-sm font-medium shadow-lg flex items-center gap-1"},Kd={class:"relative mb-6 mt-4"},Wd=["src","alt"],Jd={class:"absolute -bottom-3 -right-3"},Xd={key:0,class:"bg-purple-600 text-white px-4 py-2 rounded-full font-semibold shadow-lg"},Yd={key:1,class:"bg-[#0099cc] text-white px-4 py-2 rounded-full font-semibold shadow-lg"},Qd={class:"space-y-4"},Zd={key:0,class:"text-gray-600"},eu={key:1,class:"text-gray-600"},tu={key:0,class:"space-y-2"},su={class:"flex justify-between text-sm text-gray-600"},ou={class:"font-semibold"},ru={class:"w-full bg-gray-200 rounded-full h-3"},au={class:"text-center text-sm text-gray-500"},nu={key:1,class:"flex items-center justify-between py-2"},iu={class:"text-center mt-12 md:hidden"},lu={class:"py-20"},du={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},uu={class:"grid grid-cols-1 md:grid-cols-3 gap-8"},cu={class:"flex items-center mb-6"},mu=["src","alt"],pu={class:"ml-4"},gu={class:"font-semibold text-gray-900"},fu={class:"text-sm text-gray-600"},vu={class:"flex items-center mb-4"},xu={class:"flex text-yellow-400"},bu={class:"text-gray-700 italic leading-relaxed"},yu={class:"mt-4 text-sm text-[#0099cc] font-medium"},hu={class:"py-20 bg-gradient-to-r from-[#0099cc] to-cyan-600"},_u={class:"max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8"},wu={class:"flex flex-col sm:flex-row gap-4 justify-center"},$u={__name:"Home",setup(_){const y=$e(),{get:w}=ge(),{getProductImageUrlWithFallback:p}=Gl(),f=R([]),a=R(null);R({participants:"12 000+",productsWon:"250+",amountDistributed:"500M+",rating:"4.9/5"});const c=async()=>{try{console.log("Chargement des derniers produits mixtes...");const[m,k]=await Promise.all([w("/products/latest-lottery-only?limit=3"),w("/products/latest-direct?limit=3")]);console.log("Réponses API:",{lottery:m,direct:k});let U=[];if(m&&m.success&&m.data){const V=(m.data.products||m.data).slice(0,2).map(v=>{const d=v.active_lottery,i=parseInt(d?.sold_tickets||0),C=parseInt(d?.max_tickets||d?.total_tickets||1e3),x=d?.progress_percentage||d?.participation_rate||0;return{id:v.id,name:v.name||v.title,value:v.price||0,price:v.price||0,ticketPrice:v.ticket_price||d?.ticket_price||1e3,ticket_price:v.ticket_price||d?.ticket_price||1e3,image_url:p(v,null),image:p(v,Ne),soldTickets:i,totalTickets:C,isNew:P(v.created_at),sale_mode:"lottery",has_active_lottery:v.has_active_lottery||!1,lottery_ends_soon:v.lottery_ends_soon||!1,category:v.category}});U.push(...V)}if(k&&k.success&&k.data){const V=(k.data.products||k.data).slice(0,2).map(v=>({id:v.id,name:v.name||v.title,value:v.price||0,price:v.price||0,image_url:p(v,null),image:p(v,Ne),isNew:P(v.created_at),sale_mode:"direct",category:v.category}));U.push(...V)}f.value=U.sort(()=>Math.random()-.5).slice(0,6),f.value.length===0&&r()}catch(m){console.error("Erreur lors du chargement des produits mixtes:",m),r()}},n=async()=>{try{console.log("Chargement du dernier produit tombola...");const m=await w("/products/latest-lottery");if(console.log("Réponse API dernier produit tombola:",m),m&&m.success&&m.data){const k=m.data.product,U=m.data.lottery,V=m.data.debug;console.log("Données produit:",k),console.log("Données lottery:",U),console.log("🐛 Debug backend:",V);let v=parseInt(U?.sold_tickets||0),d=parseInt(U?.max_tickets||U?.total_tickets||1e3);const i=U?.progress_percentage||U?.participation_rate||0;console.log("📊 Données lottery brutes:",{sold_tickets:U?.sold_tickets,max_tickets:U?.max_tickets,total_tickets:U?.total_tickets,progress_percentage:U?.progress_percentage,participation_rate:U?.participation_rate});let C=i>0?Math.round(i):d>0?Math.round(v/d*100):0;console.log("🔢 Valeurs calculées:",{soldTickets:v,maxTickets:d,progressFromAPI:i,finalProgress:C}),console.log("📈 Progression finale utilisée:",C),v>d&&(console.warn("⚠️ PROBLÈME DÉTECTÉ: soldTickets > maxTickets, correction forcée"),v=Math.min(v,d),C=Math.round(v/d*100)),a.value={id:k.id,name:k.name||k.title,value:k.price||0,ticketPrice:U?.ticket_price||k.ticket_price||1500,image:p(k,Ne),soldTickets:v,totalTickets:d,progress:C,timeRemaining:U?.time_remaining,isEndingSoon:U?.is_ending_soon||!1},console.log("✅ Produit tombola final assigné:",{soldTickets:a.value.soldTickets,totalTickets:a.value.totalTickets,progress:a.value.progress,name:a.value.name})}else a.value={id:"fallback",name:"iPhone 15 Pro Max",value:1299e3,ticketPrice:1500,image:Ne,soldTickets:0,totalTickets:500,progress:0}}catch(m){console.error("Erreur lors du chargement du dernier produit tombola:",m),a.value={id:"fallback",name:"iPhone 15 Pro Max",value:1299e3,ticketPrice:1500,image:Ne,soldTickets:0,totalTickets:500,progress:0}}},r=()=>{f.value=[{id:"fallback-1",name:"iPhone 15 Pro Max",value:1299e3,price:1299e3,ticketPrice:1500,ticket_price:1500,image:Ne,soldTickets:0,totalTickets:500,isNew:!0,sale_mode:"lottery",lottery_ends_soon:!1,category:{name:"Smartphones"}},{id:"fallback-2",name:"MacBook Pro M3",value:25e5,price:25e5,image:Ne,isNew:!0,sale_mode:"direct",category:{name:"Ordinateurs"}},{id:"fallback-3",name:"Samsung Galaxy S24",value:95e4,price:95e4,ticketPrice:1200,ticket_price:1200,image:Ne,soldTickets:50,totalTickets:800,isNew:!1,sale_mode:"lottery",lottery_ends_soon:!0,category:{name:"Smartphones"}},{id:"fallback-4",name:"AirPods Pro",value:38e4,price:38e4,image:Ne,isNew:!1,sale_mode:"direct",category:{name:"Audio"}}]},P=m=>{if(!m)return!1;const k=new Date,U=new Date(m);return(k-U)/(1e3*60*60*24)<=7},$=R([{id:1,name:"Marie Dubois",location:"Libreville",avatar:It,review:"J'ai acheté un iPhone 14 Pro avec seulement 5 tickets ! Le processus était transparent et la livraison rapide.",won:"iPhone 14 Pro"},{id:2,name:"Jean Kamga",location:"Port-Gentil",avatar:It,review:"Koumbaya a changé ma vie ! J'ai obtenu une moto à prix réduit et maintenant je participe à toutes les tombolas.",won:"Yamaha MT-03"},{id:3,name:"Fatou Ndongo",location:"Franceville",avatar:It,review:"Platform très sérieuse, paiement sécurisé et service client réactif. Je recommande vivement !",won:"MacBook Air M2"}]),M=m=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(m).replace("XAF","FCFA"),D=m=>{y.push({name:"public.product.detail",params:{id:m.id}})};return De(a,m=>{m&&console.log("🔄 latestLotteryProduct mis à jour:",m)},{deep:!0}),ve(async()=>{console.log("🚀 Montage du composant Home - chargement des données..."),console.log("📊 Données initiales latestLotteryProduct:",a.value),await Promise.all([c(),n()]),console.log("📊 Données finales latestLotteryProduct:",a.value),console.log("✅ Chargement terminé")}),(m,k)=>{const U=he("router-link");return s(),o("div",Hl,[e("section",Kl,[e("div",Wl,[e("div",Jl,[e("div",Xl,[e("div",Yl,[e("div",Ql,[g(l(ht),{class:"h-4 w-4"}),k[0]||(k[0]=e("span",null,"Nouveau au Gabon",-1))]),k[1]||(k[1]=pe('<h1 class="text-5xl lg:text-6xl xl:text-7xl font-bold text-black leading-none" data-v-b9f64766> Rendre l&#39;impossible <span class="text-[#0099cc]" data-v-b9f64766>accessible</span></h1><p class="text-xl lg:text-2xl text-gray-600 leading-relaxed" data-v-b9f64766> Des smartphones aux voitures, profitez de nos tombolas pour <strong class="text-[#0099cc]" data-v-b9f64766>acheter malin</strong> et obtenir des produits <strong class="text-[#0099cc]" data-v-b9f64766>à prix réduit</strong>. </p>',2))]),e("div",Zl,[g(U,{to:"/products",class:"inline-flex items-center justify-center gap-2 bg-[#0099cc] hover:bg-[#0088bb] text-white font-semibold px-8 py-4 rounded-2xl transition-all duration-200 hover:scale-105 shadow-lg hover:shadow-xl"},{default:re(()=>[g(l(qe),{class:"h-5 w-5"}),k[2]||(k[2]=e("span",null,"Découvrir les produits",-1))]),_:1,__:[2]}),g(U,{to:"/how-it-works",class:"inline-flex items-center justify-center gap-2 border-2 border-[#0099cc] text-[#0099cc] hover:bg-[#0099cc]/5 font-semibold px-8 py-4 rounded-2xl transition-all duration-200"},{default:re(()=>[g(l(ds),{class:"h-5 w-5"}),k[3]||(k[3]=e("span",null,"Comment ça marche",-1))]),_:1,__:[3]})]),e("div",ed,[e("div",td,[g(l(ut),{class:"h-6 w-6 text-[#0099cc]"}),k[4]||(k[4]=e("span",{class:"font-medium"},"100% sécurisé",-1))]),e("div",sd,[g(l(ls),{class:"h-6 w-6 text-[#0099cc]"}),k[5]||(k[5]=e("span",{class:"font-medium"},"Produits authentiques",-1))]),e("div",od,[g(l(Ut),{class:"h-6 w-6 text-[#0099cc]"}),k[6]||(k[6]=e("span",{class:"font-medium"},"Livraison gratuite",-1))])])]),e("div",rd,[e("div",ad,[e("div",nd,[e("div",id,[e("img",{src:a.value?.image||l(Ne),alt:a.value?.name||"Produit tombola",class:"w-full h-48 object-cover rounded-2xl bg-gray-100"},null,8,ld),e("div",dd,t(M(a.value?.ticketPrice||1500)),1)]),e("div",ud,[e("div",null,[e("h3",cd,t(a.value?.name||"iPhone 15 Pro Max"),1),e("p",md,"Valeur: "+t(M(a.value?.value||1299e3)),1)]),e("div",pd,[e("div",gd,[k[7]||(k[7]=e("span",null,"Progression",-1)),e("span",fd,t(a.value?.progress||0)+"%",1)]),e("div",vd,[e("div",{class:"bg-gradient-to-r from-purple-500 to-purple-600 h-3 rounded-full animate-pulse transition-all duration-500",style:Me({width:(a.value?.progress||0)+"%"})},null,4)]),e("div",xd,t(a.value?.soldTickets||0)+"/"+t(a.value?.totalTickets||500)+" tickets ",1)]),e("button",bd,[g(l(je),{class:"h-5 w-5 flex-shrink-0"}),k[8]||(k[8]=z(" Participer maintenant ",-1))])])]),e("div",yd,[g(l(ht),{class:"h-4 w-4"}),k[9]||(k[9]=z(" Nouvelle tombola ",-1))]),a.value?.isEndingSoon?(s(),o("div",hd,[g(l(Te),{class:"h-4 w-4"}),k[10]||(k[10]=z(" Se termine bientôt ! ",-1))])):(s(),o("div",_d,[g(l(Vs),{class:"h-4 w-4"}),k[11]||(k[11]=z(" Populaire ",-1))]))])])])])]),e("section",wd,[e("div",$d,[k[20]||(k[20]=e("div",{class:"text-center mb-16"},[e("h2",{class:"text-3xl md:text-4xl font-bold text-black mb-4"}," Koumbaya en chiffres "),e("p",{class:"text-xl text-gray-600 max-w-3xl mx-auto"}," Rejoignez des milliers de participants qui ont déjà fait confiance à notre plateforme ")],-1)),e("div",kd,[e("div",Cd,[e("div",Ad,[g(l(vt),{class:"h-10 w-10 text-[#0099cc]"})]),k[12]||(k[12]=e("div",{class:"text-4xl font-bold text-black mb-2"},"12 000+",-1)),k[13]||(k[13]=e("div",{class:"text-gray-600"},"Participants actifs",-1))]),e("div",Pd,[e("div",Ed,[g(l(ot),{class:"h-10 w-10 text-[#0099cc]"})]),k[14]||(k[14]=e("div",{class:"text-4xl font-bold text-black mb-2"},"250+",-1)),k[15]||(k[15]=e("div",{class:"text-gray-600"},"Produits gagnés",-1))]),e("div",jd,[e("div",Sd,[g(l(Ke),{class:"h-10 w-10 text-[#0099cc]"})]),k[16]||(k[16]=e("div",{class:"text-4xl font-bold text-black mb-2"},"500M+",-1)),k[17]||(k[17]=e("div",{class:"text-gray-600"},"FCFA distribués",-1))]),e("div",Id,[e("div",Dd,[g(l(ft),{class:"h-10 w-10 text-[#0099cc]"})]),k[18]||(k[18]=e("div",{class:"text-4xl font-bold text-black mb-2"},"4.9/5",-1)),k[19]||(k[19]=e("div",{class:"text-gray-600"},"Note utilisateurs",-1))])])])]),e("section",Td,[e("div",Md,[k[22]||(k[22]=pe('<div class="text-center mb-16" data-v-b9f64766><h2 class="text-3xl md:text-4xl font-bold text-black mb-4" data-v-b9f64766> Simple comme bonjour </h2><p class="text-xl text-gray-600 max-w-3xl mx-auto" data-v-b9f64766> 3 étapes suffisent pour obtenir vos produits à prix cassés </p></div><div class="grid grid-cols-1 md:grid-cols-3 gap-8 lg:gap-12" data-v-b9f64766><div class="text-center group" data-v-b9f64766><div class="relative mx-auto w-24 h-24 mb-6" data-v-b9f64766><div class="absolute inset-0 bg-[#0099cc]/10 rounded-full group-hover:bg-[#0099cc]/20 transition-colors" data-v-b9f64766></div><div class="absolute inset-3 bg-[#0099cc] rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300" data-v-b9f64766><span class="text-2xl font-bold text-white" data-v-b9f64766>1</span></div></div><h3 class="text-xl font-bold text-black mb-4" data-v-b9f64766>Choisissez votre produit</h3><p class="text-gray-600 leading-relaxed" data-v-b9f64766> Parcourez notre catalogue de produits authentiques et sélectionnez celui que vous souhaitez acquérir. </p></div><div class="text-center group" data-v-b9f64766><div class="relative mx-auto w-24 h-24 mb-6" data-v-b9f64766><div class="absolute inset-0 bg-[#0099cc]/10 rounded-full group-hover:bg-[#0099cc]/20 transition-colors" data-v-b9f64766></div><div class="absolute inset-3 bg-[#0099cc] rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300" data-v-b9f64766><span class="text-2xl font-bold text-white" data-v-b9f64766>2</span></div></div><h3 class="text-xl font-bold text-black mb-4" data-v-b9f64766>Achetez vos tickets</h3><p class="text-gray-600 leading-relaxed" data-v-b9f64766> Participez à la tombola avec un petit budget. Plus vous prenez de tickets, meilleures sont vos chances d&#39;obtenir le produit. </p></div><div class="text-center group" data-v-b9f64766><div class="relative mx-auto w-24 h-24 mb-6" data-v-b9f64766><div class="absolute inset-0 bg-[#0099cc]/10 rounded-full group-hover:bg-[#0099cc]/20 transition-colors" data-v-b9f64766></div><div class="absolute inset-3 bg-[#0099cc] rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300" data-v-b9f64766><span class="text-2xl font-bold text-white" data-v-b9f64766>3</span></div></div><h3 class="text-xl font-bold text-black mb-4" data-v-b9f64766>Obtenez votre produit</h3><p class="text-gray-600 leading-relaxed" data-v-b9f64766> Le tirage automatique désigne l&#39;acheteur. Nous livrons gratuitement partout au Gabon ! </p></div></div>',2)),e("div",Ld,[g(U,{to:"/how-it-works",class:"inline-flex items-center gap-2 bg-black hover:bg-gray-800 text-white font-semibold px-8 py-4 rounded-2xl transition-all duration-200"},{default:re(()=>[k[21]||(k[21]=e("span",null,"En savoir plus",-1)),g(l(Ze),{class:"h-5 w-5"})]),_:1,__:[21]})])])]),e("section",Vd,[e("div",Rd,[e("div",Fd,[k[24]||(k[24]=e("div",null,[e("h2",{class:"text-3xl md:text-4xl font-bold text-black mb-4"}," Produits en vedette "),e("p",{class:"text-xl text-gray-600"}," Découvrez les derniers produits - tombolas et achat direct ")],-1)),g(U,{to:"/products",class:"hidden md:inline-flex items-center gap-2 text-[#0099cc] hover:text-[#0088bb] font-semibold group"},{default:re(()=>[k[23]||(k[23]=e("span",null,"Voir tout",-1)),g(l(Ze),{class:"h-5 w-5 group-hover:translate-x-1 transition-transform"})]),_:1,__:[23]})]),e("div",Nd,[(s(!0),o(ie,null,le(f.value,V=>(s(),o("div",{key:V.id,onClick:v=>D(V),class:"bg-white rounded-3xl p-6 shadow-lg hover:shadow-2xl transition-all duration-300 cursor-pointer group border border-gray-100 relative overflow-hidden"},[e("div",qd,[V.sale_mode==="lottery"?(s(),o("span",Ud,[g(l(je),{class:"h-4 w-4"}),k[25]||(k[25]=z(" Tombola ",-1))])):(s(),o("span",Bd,[g(l(Bt),{class:"h-4 w-4"}),k[26]||(k[26]=z(" Achat direct ",-1))]))]),e("div",Od,[V.lottery_ends_soon&&V.sale_mode==="lottery"?(s(),o("span",Gd,[g(l(Te),{class:"h-4 w-4"}),k[27]||(k[27]=z(" Fin proche ! ",-1))])):V.isNew?(s(),o("span",Hd,[g(l(ht),{class:"h-4 w-4"}),k[28]||(k[28]=z(" Nouveau ",-1))])):T("",!0)]),e("div",Kd,[e("img",{src:l(p)(V),alt:V.name,class:"w-full h-48 object-cover rounded-2xl bg-gray-100 group-hover:scale-105 transition-transform duration-300"},null,8,Wd),e("div",Jd,[V.sale_mode==="lottery"?(s(),o("div",Xd,t(M(V.ticketPrice||V.ticket_price))+"/ticket ",1)):(s(),o("div",Yd,t(M(V.price||V.value)),1))])]),e("div",Qd,[e("div",null,[e("h3",{class:te(["text-xl font-bold text-black group-hover:transition-colors",V.sale_mode==="lottery"?"group-hover:text-purple-600":"group-hover:text-[#0099cc]"])},t(V.name),3),V.sale_mode==="lottery"?(s(),o("p",Zd," Valeur totale: "+t(M(V.value||V.price)),1)):(s(),o("p",eu,t(V.category?.name||"Catégorie"),1))]),V.sale_mode==="lottery"?(s(),o("div",tu,[e("div",su,[k[29]||(k[29]=e("span",null,"Progression",-1)),e("span",ou,t(Math.round((V.soldTickets||0)/(V.totalTickets||1e3)*100))+"%",1)]),e("div",ru,[e("div",{class:"bg-gradient-to-r from-purple-500 to-purple-600 h-3 rounded-full transition-all duration-500",style:Me({width:Math.round((V.soldTickets||0)/(V.totalTickets||1e3)*100)+"%"})},null,4)]),e("div",au,t(V.soldTickets||0)+"/"+t(V.totalTickets||1e3)+" tickets vendus ",1)])):(s(),o("div",nu,k[30]||(k[30]=[e("span",{class:"text-sm text-gray-500"},"Statut",-1),e("span",{class:"text-sm font-medium text-green-600 flex items-center gap-1"},[e("div",{class:"w-2 h-2 bg-green-500 rounded-full"}),z(" Disponible ")],-1)]))),e("button",{class:te(["w-full font-semibold py-3 rounded-xl transition-all duration-200 group-hover:scale-105 group-hover:shadow-lg flex items-center justify-center gap-2 whitespace-nowrap",V.sale_mode==="lottery"?"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white":"bg-gradient-to-r from-[#0099cc] to-cyan-500 hover:from-[#0088bb] hover:to-cyan-600 text-white"])},[V.sale_mode==="lottery"?(s(),ce(l(je),{key:0,class:"h-5 w-5 flex-shrink-0"})):(s(),ce(l(Xe),{key:1,class:"h-5 w-5 flex-shrink-0"})),z(" "+t(V.sale_mode==="lottery"?"Participer maintenant":"Acheter maintenant"),1)],2)])],8,zd))),128))]),e("div",iu,[g(U,{to:"/products",class:"inline-flex items-center gap-2 bg-[#0099cc] hover:bg-[#0088bb] text-white font-semibold px-8 py-4 rounded-2xl transition-all"},{default:re(()=>[k[31]||(k[31]=e("span",null,"Voir tous les produits",-1)),g(l(Ze),{class:"h-5 w-5"})]),_:1,__:[31]})])])]),e("section",lu,[e("div",du,[k[32]||(k[32]=e("div",{class:"text-center mb-16"},[e("h2",{class:"text-3xl md:text-4xl font-bold text-black mb-4"}," Ils ont acheté malin avec Koumbaya "),e("p",{class:"text-xl text-gray-600 max-w-3xl mx-auto"}," Découvrez les témoignages de nos clients satisfaits ")],-1)),e("div",uu,[(s(!0),o(ie,null,le($.value,V=>(s(),o("div",{key:V.id,class:"bg-white rounded-2xl p-8 shadow-lg border border-gray-100"},[e("div",cu,[e("img",{src:V.avatar,alt:V.name,class:"w-12 h-12 rounded-full bg-gray-200"},null,8,mu),e("div",pu,[e("div",gu,t(V.name),1),e("div",fu,t(V.location),1)])]),e("div",vu,[e("div",xu,[(s(),o(ie,null,le(5,v=>g(l(ft),{key:v,class:"h-5 w-5 fill-current"})),64))])]),e("blockquote",bu,' "'+t(V.review)+'" ',1),e("div",yu," A obtenu: "+t(V.won),1)]))),128))])])]),e("section",hu,[e("div",_u,[k[35]||(k[35]=e("h2",{class:"text-4xl md:text-5xl font-bold text-white mb-6"}," Votre prochain lot vous attend ",-1)),k[36]||(k[36]=e("p",{class:"text-xl text-blue-100 mb-8 leading-relaxed"}," Rejoignez la communauté Koumbaya et tentez votre chance dès aujourd'hui. L'inscription est gratuite et ne prend que quelques minutes. ",-1)),e("div",wu,[g(U,{to:"/register",class:"inline-flex items-center justify-center gap-2 bg-white text-[#0099cc] hover:text-[#0088bb] font-bold px-10 py-5 rounded-2xl transition-all duration-200 hover:scale-105 shadow-xl"},{default:re(()=>[g(l(us),{class:"h-6 w-6"}),k[33]||(k[33]=e("span",null,"S'inscrire gratuitement",-1))]),_:1,__:[33]}),g(U,{to:"/products",class:"inline-flex items-center justify-center gap-2 border-2 border-white text-white hover:bg-white hover:text-[#0099cc] font-bold px-10 py-5 rounded-2xl transition-all duration-200"},{default:re(()=>[g(l(Ue),{class:"h-6 w-6"}),k[34]||(k[34]=e("span",null,"Voir les produits",-1))]),_:1,__:[34]})])])])])}}},ku=Ee($u,[["__scopeId","data-v-b9f64766"]]),Cu=["src","alt"],Au={class:"text-xs font-medium"},Pu={key:2,class:"absolute inset-0 flex items-center justify-center bg-gray-100"},Eu={name:"ProductImage"},He=Object.assign(Eu,{props:{src:{type:String,default:""},alt:{type:String,default:""},fallbackText:{type:String,default:"Image non disponible"},containerClass:{type:String,default:"w-full h-48"},imageClass:{type:String,default:"w-full h-full object-cover"},fallbackClass:{type:String,default:"w-full h-full"}},setup(_){const y=_,w=R(!1),p=R(!1),f=de(()=>{if(!y.src)return console.debug("ProductImage: No src provided"),"";if(y.src.startsWith("data:image/"))return y.src;if(y.src.includes("/storage/products/")){const m=y.src.match(/\/storage\/products\/(\d{4})\/(\d{2})\/(.+)$/);if(m){const[,k,U,V]=m,v=`/api/products/images/${k}/${U}/${V}`;return console.debug("ProductImage: Converted storage URL to API URL:",v),v}}if(y.src.startsWith("http"))return y.src;if(y.src.startsWith("/storage/products/")){const m=y.src.match(/\/storage\/products\/(\d{4})\/(\d{2})\/(.+)$/);if(m){const[,k,U,V]=m,v=`/api/products/images/${k}/${U}/${V}`;return console.debug("ProductImage: Converted storage path to API URL:",v),v}}if(y.src.startsWith("/"))return y.src;const r=y.src.split("/");if(r.length>=3){const[m,k,U,V]=r;if(m==="products"&&k&&U&&V){const v=`/api/products/images/${k}/${U}/${V}`;return console.debug("ProductImage: Generated API URL:",v),v}}const P=new Date,$=P.getFullYear(),M=String(P.getMonth()+1).padStart(2,"0"),D=`/api/products/images/${$}/${M}/${y.src}`;return console.debug("ProductImage: Generated fallback API URL:",D),D}),a=()=>{w.value=!0,p.value=!1},c=()=>{w.value=!1,p.value=!1},{src:n}=Rs(y);return De(n,()=>{w.value=!1,p.value=!0}),(r,P)=>(s(),o("div",{class:te(["relative overflow-hidden bg-gray-100 flex items-center justify-center",_.containerClass])},[!w.value&&f.value?(s(),o("img",{key:0,src:f.value,alt:_.alt||"Image du produit",class:te(_.imageClass),onError:a,onLoad:c},null,42,Cu)):T("",!0),w.value||!f.value?(s(),o("div",{key:1,class:te([_.fallbackClass,"flex flex-col items-center justify-center text-gray-600 bg-gray-100"])},[P[0]||(P[0]=e("svg",{class:"w-8 h-8 mb-2",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z","clip-rule":"evenodd"})],-1)),e("span",Au,t(_.fallbackText),1)],2)):T("",!0),p.value&&!w.value?(s(),o("div",Pu,P[1]||(P[1]=[e("svg",{class:"animate-spin h-6 w-6 text-gray-400",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):T("",!0)],2))}}),ju={class:"min-h-screen bg-gray-50"},Su={class:"bg-gradient-to-r from-blue-600 to-blue-600 text-white"},Iu={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},Du={class:"text-center"},Tu={class:"grid grid-cols-2 md:grid-cols-4 gap-4 max-w-4xl mx-auto"},Mu={class:"bg-white/20 rounded-lg p-4"},Lu={class:"text-2xl font-bold"},Vu={class:"bg-white/20 rounded-lg p-4"},Ru={class:"text-2xl font-bold"},Fu={class:"bg-white/20 rounded-lg p-4"},Nu={class:"text-2xl font-bold"},zu={class:"bg-white/20 rounded-lg p-4"},qu={class:"text-2xl font-bold"},Uu={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},Bu={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},Ou={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},Gu={class:"flex space-x-2"},Hu=["onClick"],Ku={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},Wu={class:"flex gap-4"},Ju=["disabled"],Xu={key:0,class:"flex items-center text-blue-800"},Yu={class:"text-sm mt-1"},Qu={key:1,class:"flex items-center text-red-800"},Zu={class:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8"},ec={key:0,class:"p-8 text-center"},tc={key:1,class:"p-6"},sc={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},oc={class:"flex items-center space-x-4"},rc=["src","alt"],ac={class:"flex-1"},nc={class:"font-medium text-gray-900"},ic={class:"text-sm text-gray-600 mb-1"},lc={class:"text-sm font-medium text-blue-600"},dc={class:"text-xs text-gray-500"},uc={class:"bg-white rounded-lg shadow-sm border border-gray-200"},cc={key:0,class:"p-8 text-center"},mc={key:1,class:"p-8 text-center text-gray-500"},pc={key:2,class:"overflow-x-auto"},gc={class:"min-w-full divide-y divide-gray-200"},fc={class:"bg-white divide-y divide-gray-200"},vc={class:"px-6 py-4 whitespace-nowrap"},xc={class:"flex items-center"},bc={class:"text-sm font-medium text-gray-900"},yc={class:"text-sm text-gray-500"},hc={class:"text-xs text-gray-600"},_c={class:"px-6 py-4 whitespace-nowrap"},wc={class:"flex items-center"},$c={class:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mr-3"},kc={class:"text-sm font-medium text-gray-900"},Cc={class:"text-sm text-gray-500"},Ac={class:"px-6 py-4 whitespace-nowrap"},Pc={class:"text-sm font-mono font-medium text-gray-900"},Ec={class:"px-6 py-4 whitespace-nowrap"},jc={class:"text-sm text-gray-900"},Sc={class:"w-16 bg-gray-200 rounded-full h-1.5 mt-1"},Ic={class:"text-xs text-gray-500"},Dc={class:"px-6 py-4 whitespace-nowrap"},Tc={class:"text-sm text-gray-900"},Mc={class:"text-xs text-gray-500"},Lc={class:"px-6 py-4 whitespace-nowrap"},Vc={class:"text-xs font-mono text-gray-600 bg-gray-100 rounded px-2 py-1"},Rc=["onClick"],Fc={__name:"Results",setup(_){const{get:y}=ge(),w=R([]),p=R([]),f=R({}),a=R(!1),c=R(!1),n=R("month"),r=R(""),P=R(!1),$=R(null),M=[{value:"week",label:"Cette semaine"},{value:"month",label:"Ce mois"},{value:"year",label:"Cette année"}],D=async()=>{a.value=!0;try{const i=await y(`/public/results?period=${n.value}&limit=50`);w.value=i.data.results||[],f.value=i.data.stats||{}}catch(i){console.error("Erreur lors du chargement des résultats:",i)}finally{a.value=!1}},m=async()=>{c.value=!0;try{const i=await y("/public/results/recent-winners?limit=6");p.value=i.data.winners||[]}catch(i){console.error("Erreur lors du chargement des gagnants récents:",i)}finally{c.value=!1}},k=async()=>{if(r.value.trim()){P.value=!0,$.value=null;try{const i=await y(`/public/results/verify/${r.value.trim()}`);$.value=i.data,$.value.valid=!0}catch{$.value={valid:!1}}finally{P.value=!1}}},U=async i=>{try{await navigator.clipboard.writeText(i),window.$toast&&window.$toast.success("Code copié dans le presse-papiers!","✅ Copié")}catch(C){console.error("Erreur lors de la copie:",C)}},V=i=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(i||0)+" FCFA",v=i=>i?i>=1e6?(i/1e6).toFixed(1)+"M":i>=1e3?(i/1e3).toFixed(0)+"K":i.toString():"0",d=i=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(i));return ve(async()=>{await Promise.all([D(),m()])}),(i,C)=>(s(),o("div",ju,[e("div",Su,[e("div",Iu,[e("div",Du,[C[5]||(C[5]=e("h1",{class:"text-4xl font-bold mb-4"},"🏆 Résultats des Tombolas",-1)),C[6]||(C[6]=e("p",{class:"text-xl opacity-90 mb-8"}," Découvrez les gagnants et vérifiez les résultats officiels ",-1)),e("div",Tu,[e("div",Mu,[e("div",Lu,t(f.value.total_lotteries||0),1),C[1]||(C[1]=e("div",{class:"text-sm opacity-90"},"Tombolas terminées",-1))]),e("div",Vu,[e("div",Ru,t(f.value.total_winners||0),1),C[2]||(C[2]=e("div",{class:"text-sm opacity-90"},"Gagnants heureux",-1))]),e("div",Fu,[e("div",Nu,t(v(f.value.total_prizes_value)),1),C[3]||(C[3]=e("div",{class:"text-sm opacity-90"},"Valeur des prix",-1))]),e("div",zu,[e("div",qu,t(f.value.total_tickets_sold||0),1),C[4]||(C[4]=e("div",{class:"text-sm opacity-90"},"Tickets vendus",-1))])])])])]),e("div",Uu,[e("div",Bu,[e("div",Ou,[C[7]||(C[7]=e("div",null,[e("h2",{class:"text-lg font-semibold text-gray-900"},"Filtrer par période"),e("p",{class:"text-gray-600"},"Choisissez la période à afficher")],-1)),e("div",Gu,[(s(),o(ie,null,le(M,x=>e("button",{key:x.value,onClick:I=>{n.value=x.value,D()},class:te(["px-4 py-2 rounded-md text-sm font-medium",n.value===x.value?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"])},t(x.label),11,Hu)),64))])])]),e("div",Ku,[C[11]||(C[11]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"🔍 Vérifier un Résultat",-1)),e("div",Wu,[Q(e("input",{"onUpdate:modelValue":C[0]||(C[0]=x=>r.value=x),type:"text",placeholder:"Entrez le code de vérification...",class:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",onKeyup:xt(k,["enter"])},null,544),[[ne,r.value]]),e("button",{onClick:k,disabled:!r.value||P.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},t(P.value?"Vérification...":"Vérifier"),9,Ju)]),$.value?(s(),o("div",{key:0,class:te(["mt-4 p-4 rounded-lg",[$.value.valid?"bg-blue-50 border border-blue-200":"bg-red-50 border border-red-200"]])},[$.value.valid?(s(),o("div",Xu,[g(l(Re),{class:"w-5 h-5 mr-2"}),e("div",null,[C[9]||(C[9]=e("div",{class:"font-medium"},"✅ Résultat vérifié",-1)),e("div",Yu,[z(" Tombola "+t($.value.lottery_number)+" - "+t($.value.product_title)+" ",1),C[8]||(C[8]=e("br",null,null,-1)),z("Gagnant: "+t($.value.winner_initial)+"**** le "+t(d($.value.draw_date)),1)])])])):(s(),o("div",Qu,[g(l(kt),{class:"w-5 h-5 mr-2"}),C[10]||(C[10]=e("div",{class:"font-medium"},"Code invalide",-1))]))],2)):T("",!0)]),e("div",Zu,[C[13]||(C[13]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"🎉 Gagnants Récents")],-1)),c.value?(s(),o("div",ec,C[12]||(C[12]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"},null,-1)]))):(s(),o("div",tc,[e("div",sc,[(s(!0),o(ie,null,le(p.value,x=>(s(),o("div",{key:x.lottery_number,class:"bg-gradient-to-r from-blue-50 to-blue-50 rounded-lg p-4 border border-blue-100"},[e("div",oc,[e("img",{src:x.product_image||"/images/products/placeholder.jpg",alt:x.product_title,class:"w-16 h-16 rounded-lg object-cover"},null,8,rc),e("div",ac,[e("div",nc,t(x.product_title),1),e("div",ic,t(V(x.product_value)),1),e("div",lc," Gagnant: "+t(x.winner_initial)+"**** ("+t(x.winner_city)+") ",1),e("div",dc," Il y a "+t(x.days_ago)+" jour"+t(x.days_ago>1?"s":""),1)])])]))),128))])]))]),e("div",uc,[C[18]||(C[18]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"📋 Historique Complet des Résultats")],-1)),a.value?(s(),o("div",cc,C[14]||(C[14]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement des résultats...",-1)]))):w.value.length===0?(s(),o("div",mc,[g(l(ot),{class:"mx-auto h-12 w-12 text-gray-400 mb-4"}),C[15]||(C[15]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Aucun résultat",-1)),C[16]||(C[16]=e("p",null,"Aucune tombola terminée pour cette période.",-1))])):(s(),o("div",pc,[e("table",gc,[C[17]||(C[17]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Produit "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Gagnant "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ticket Gagnant "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Participation "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date de Tirage "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Vérification ")])],-1)),e("tbody",fc,[(s(!0),o(ie,null,le(w.value,x=>(s(),o("tr",{key:x.lottery_id,class:"hover:bg-gray-50"},[e("td",vc,[e("div",xc,[g(He,{src:x.product.image_url||x.product.image,alt:x.product.title,"container-class":"w-12 h-12 rounded-lg mr-4","image-class":"w-12 h-12 rounded-lg object-cover","fallback-class":"w-12 h-12 rounded-lg","fallback-text":"Photo"},null,8,["src","alt"]),e("div",null,[e("div",bc,t(x.product.title),1),e("div",yc,t(x.product.category?.name||x.product.category||"Sans catégorie")+" • "+t(V(x.product.price)),1),e("div",hc,t(x.lottery_number),1)])])]),e("td",_c,[e("div",wc,[e("div",$c,t(x.winner.initial),1),e("div",null,[e("div",kc,t(x.winner.name),1),e("div",Cc,t(x.winner.city),1)])])]),e("td",Ac,[e("div",Pc,t(x.winning_ticket),1)]),e("td",Ec,[e("div",jc,t(x.sold_tickets)+"/"+t(x.total_tickets)+" tickets ",1),e("div",Sc,[e("div",{class:"bg-blue-600 h-1.5 rounded-full",style:Me({width:x.participation_rate+"%"})},null,4)]),e("div",Ic,t(x.participation_rate)+"%",1)]),e("td",Dc,[e("div",Tc,t(d(x.draw_date)),1),e("div",Mc,t(V(x.total_revenue))+" collectés ",1)]),e("td",Lc,[e("div",Vc,t(x.verification_code),1),e("button",{onClick:I=>U(x.verification_code),class:"text-xs text-blue-600 hover:text-blue-700 mt-1"}," Copier ",8,Rc)])]))),128))])])]))])])]))}},Nc={class:"min-h-screen bg-gray-50"},zc={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},qc={class:"bg-white rounded-lg shadow-lg border border-gray-200 p-8 mb-8"},Uc={class:"max-w-md mx-auto"},Bc={class:"mb-6"},Oc=["disabled"],Gc={key:0,class:"flex items-center justify-center"},Hc={key:1},Kc={key:0,class:"mb-8"},Wc={key:0,class:"bg-white rounded-lg shadow-lg border-2 border-blue-200 overflow-hidden"},Jc={class:"bg-gradient-to-r from-blue-500 to-emerald-500 text-white p-6"},Xc={class:"flex items-center justify-center"},Yc={class:"p-8"},Qc={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Zc={class:"space-y-4"},e0={class:"space-y-2"},t0={class:"flex justify-between"},s0={class:"font-medium"},o0={class:"flex justify-between"},r0={class:"font-medium"},a0={class:"flex justify-between"},n0={class:"font-medium"},i0={class:"space-y-4"},l0={class:"space-y-2"},d0={class:"flex justify-between"},u0={class:"font-medium"},c0={class:"flex justify-between"},m0={class:"font-mono font-medium text-blue-600"},p0={class:"flex justify-between"},g0={class:"font-medium"},f0={class:"mt-8 p-4 bg-blue-50 rounded-lg"},v0={class:"flex items-start"},x0={class:"text-sm text-blue-800"},b0={key:1,class:"bg-white rounded-lg shadow-lg border-2 border-red-200"},y0={class:"bg-gradient-to-r from-red-500 to-red-600 text-white p-6"},h0={class:"flex items-center justify-center"},_0={class:"p-8"},w0={class:"text-center"},$0={class:"text-gray-700 mb-4"},k0={class:"font-mono bg-gray-100 px-2 py-1 rounded"},C0={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6"},A0={class:"flex items-start"},P0={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},E0={key:0,class:"text-center text-gray-500 py-8"},j0={key:1,class:"space-y-3"},S0={class:"font-mono text-sm text-gray-600"},I0={class:"text-xs text-gray-500"},D0={__name:"VerifyWinner",setup(_){const{get:y}=ge(),w=R(""),p=R(!1),f=R(null),a=R([]),c=async()=>{if(!(!w.value.trim()||w.value.length!==8)){p.value=!0,f.value=null;try{const M=await y(`/public/results/verify/${w.value.trim()}`);f.value=M.data,f.value.valid=!0,n(w.value,!0)}catch{f.value={valid:!1,code:w.value.trim()},n(w.value,!1)}finally{p.value=!1}}},n=(M,D)=>{const m={id:Date.now(),code:M,valid:D,verified_at:new Date};a.value.unshift(m),a.value.length>5&&(a.value=a.value.slice(0,5)),localStorage.setItem("recent_verifications",JSON.stringify(a.value))},r=()=>{try{const M=localStorage.getItem("recent_verifications");M&&(a.value=JSON.parse(M).map(D=>({...D,verified_at:new Date(D.verified_at)})).slice(0,5))}catch(M){console.error("Failed to load recent verifications",M)}},P=M=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(M)),$=M=>{const m=new Date-M,k=Math.floor(m/6e4);if(k<1)return"À l'instant";if(k<60)return`${k}min`;const U=Math.floor(k/60);return U<24?`${U}h`:`${Math.floor(U/24)}j`};return ve(()=>{r()}),(M,D)=>(s(),o("div",Nc,[D[24]||(D[24]=pe('<div class="bg-gradient-to-r from-blue-600 to-blue-600 text-white"><div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12"><div class="text-center"><h1 class="text-4xl font-bold mb-4">🔍 Vérification de Gain</h1><p class="text-xl opacity-90 mb-8"> Vérifiez l&#39;authenticité d&#39;un résultat de tombola </p></div></div></div>',1)),e("div",zc,[e("div",qc,[D[5]||(D[5]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-6 text-center"},[e("span",{class:"text-blue-600"},"🏆"),z(" Outil de Vérification Officiel ")],-1)),e("div",Uc,[e("div",Bc,[D[2]||(D[2]=e("label",{for:"verification-code",class:"block text-sm font-medium text-gray-700 mb-2"}," Code de Vérification ",-1)),Q(e("input",{id:"verification-code","onUpdate:modelValue":D[0]||(D[0]=m=>w.value=m),type:"text",placeholder:"Ex: A1B2C3D4",class:"w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-lg font-mono uppercase",maxlength:"8",onInput:D[1]||(D[1]=m=>w.value=m.target.value.toUpperCase()),onKeyup:xt(c,["enter"])},null,544),[[ne,w.value]]),D[3]||(D[3]=e("p",{class:"mt-2 text-sm text-gray-600"}," Entrez le code de 8 caractères fourni avec votre notification de gain ",-1))]),e("button",{onClick:c,disabled:!w.value||p.value||w.value.length!==8,class:"w-full py-3 px-6 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors duration-200"},[p.value?(s(),o("span",Gc,D[4]||(D[4]=[e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),z(" Vérification en cours... ",-1)]))):(s(),o("span",Hc," 🔍 Vérifier le Gain "))],8,Oc)])]),f.value?(s(),o("div",Kc,[f.value.valid?(s(),o("div",Wc,[e("div",Jc,[e("div",Xc,[g(l(Re),{class:"w-12 h-12 mr-4"}),D[6]||(D[6]=e("div",null,[e("h3",{class:"text-2xl font-bold"},"✅ GAIN VÉRIFIÉ"),e("p",{class:"text-blue-100"},"Ce résultat est authentique et officiel")],-1))])]),e("div",Yc,[e("div",Qc,[e("div",Zc,[D[10]||(D[10]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"📋 Informations de la Tombola",-1)),e("div",e0,[e("div",t0,[D[7]||(D[7]=e("span",{class:"text-gray-600"},"Numéro :",-1)),e("span",s0,t(f.value.lottery_number),1)]),e("div",o0,[D[8]||(D[8]=e("span",{class:"text-gray-600"},"Produit :",-1)),e("span",r0,t(f.value.product_title),1)]),e("div",a0,[D[9]||(D[9]=e("span",{class:"text-gray-600"},"Date du tirage :",-1)),e("span",n0,t(P(f.value.draw_date)),1)])])]),e("div",i0,[D[14]||(D[14]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"🏆 Gagnant",-1)),e("div",l0,[e("div",d0,[D[11]||(D[11]=e("span",{class:"text-gray-600"},"Identité :",-1)),e("span",u0,t(f.value.winner_initial)+"****",1)]),e("div",c0,[D[12]||(D[12]=e("span",{class:"text-gray-600"},"Code :",-1)),e("span",m0,t(w.value),1)]),e("div",p0,[D[13]||(D[13]=e("span",{class:"text-gray-600"},"Vérifié le :",-1)),e("span",g0,t(P(f.value.verification_date)),1)])])])]),e("div",f0,[e("div",v0,[g(l(Oe),{class:"w-5 h-5 text-blue-500 mt-0.5 mr-3"}),e("div",x0,[D[15]||(D[15]=e("p",{class:"font-medium mb-1"},"Certificat de Vérification",-1)),e("p",null,"Ce résultat a été vérifié dans notre système officiel. La tombola "+t(f.value.lottery_number)+" s'est terminée le "+t(P(f.value.draw_date))+" avec un tirage transparent et équitable.",1)])])])])])):(s(),o("div",b0,[e("div",y0,[e("div",h0,[g(l(kt),{class:"w-12 h-12 mr-4"}),D[16]||(D[16]=e("div",null,[e("h3",{class:"text-2xl font-bold"},"CODE INVALIDE"),e("p",{class:"text-red-100"},"Ce code de vérification n'existe pas")],-1))])]),e("div",_0,[e("div",w0,[e("p",$0,[D[17]||(D[17]=z(" Le code ",-1)),e("span",k0,t(w.value),1),D[18]||(D[18]=z(" ne correspond à aucun résultat officiel dans notre système. ",-1))]),e("div",C0,[e("div",A0,[g(l(We),{class:"w-5 h-5 text-yellow-500 mt-0.5 mr-3"}),D[19]||(D[19]=e("div",{class:"text-sm text-yellow-800"},[e("p",{class:"font-medium mb-1"},"Vérifications possibles :"),e("ul",{class:"list-disc list-inside space-y-1"},[e("li",null,"Assurez-vous que le code est correct (8 caractères)"),e("li",null,"Vérifiez que le code provient d'une source officielle"),e("li",null,"Contactez notre support si vous pensez qu'il y a une erreur")])],-1))])])])])]))])):T("",!0),D[23]||(D[23]=pe('<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"><h3 class="text-lg font-semibold text-gray-900 mb-4">ℹ️ Comment ça marche ?</h3><div class="grid grid-cols-1 md:grid-cols-3 gap-6"><div class="text-center"><div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3"><span class="text-xl">1️⃣</span></div><h4 class="font-medium text-gray-900 mb-2">Recevez votre code</h4><p class="text-sm text-gray-600"> Après un tirage, le gagnant reçoit un code de vérification unique par email et SMS </p></div><div class="text-center"><div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3"><span class="text-xl">2️⃣</span></div><h4 class="font-medium text-gray-900 mb-2">Vérifiez en ligne</h4><p class="text-sm text-gray-600"> Entrez le code sur cette page pour vérifier l&#39;authenticité du résultat </p></div><div class="text-center"><div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3"><span class="text-xl">3️⃣</span></div><h4 class="font-medium text-gray-900 mb-2">Confirmez le gain</h4><p class="text-sm text-gray-600"> Un résultat valide confirme officiellement le gain et ses détails </p></div></div></div>',1)),e("div",P0,[D[22]||(D[22]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"🔍 Vérifications Récentes",-1)),a.value.length===0?(s(),o("div",E0,[g(l(it),{class:"w-12 h-12 mx-auto text-gray-300 mb-3"}),D[20]||(D[20]=e("p",null,"Aucune vérification récente",-1))])):(s(),o("div",j0,[(s(!0),o(ie,null,le(a.value,m=>(s(),o("div",{key:m.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("div",null,[e("span",S0,t(m.code),1),D[21]||(D[21]=e("span",{class:"mx-2"},"→",-1)),e("span",{class:te(["text-sm",m.valid?"text-blue-600":"text-red-600"])},t(m.valid?"✅ Valide":"Invalide"),3)]),e("span",I0,t($(m.verified_at)),1)]))),128))]))])])]))}},T0={class:"min-h-screen bg-gray-50"},M0={class:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white"},L0={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"},V0={class:"text-center"},R0={class:"grid grid-cols-2 md:grid-cols-4 gap-4 max-w-4xl mx-auto"},F0={class:"bg-white/20 rounded-lg p-4"},N0={class:"text-2xl font-bold"},z0={class:"bg-white/20 rounded-lg p-4"},q0={class:"text-2xl font-bold"},U0={class:"bg-white/20 rounded-lg p-4"},B0={class:"text-2xl font-bold"},O0={class:"bg-white/20 rounded-lg p-4"},G0={class:"text-2xl font-bold"},H0={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},K0={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},W0={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},J0={class:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-4"},X0=["value"],Y0={class:"flex items-center space-x-4"},Q0={class:"text-sm text-gray-500"},Z0={key:0,class:"text-center py-12"},em={key:1,class:"text-center py-12"},tm={key:2},sm={class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 mb-8"},om={class:"relative h-48 bg-gray-200"},rm=["src","alt"],am={class:"absolute bottom-3 left-3"},nm={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-white text-gray-900"},im={class:"p-6"},lm={class:"mb-4"},dm={class:"text-lg font-semibold text-gray-900 mb-1"},um={class:"text-2xl font-bold text-purple-600"},cm={class:"text-sm text-gray-500"},mm={class:"bg-blue-50 rounded-lg p-4 mb-4"},pm={class:"flex items-center"},gm={class:"w-10 h-10 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mr-3"},fm={class:"flex-1"},vm={class:"text-sm text-blue-700"},xm={class:"grid grid-cols-2 gap-4 mb-4"},bm={class:"text-center"},ym={class:"text-lg font-bold text-gray-900"},hm={class:"text-center"},_m={class:"text-lg font-bold text-gray-900"},wm={class:"w-full bg-gray-200 rounded-full h-2 mb-4"},$m={class:"flex items-center justify-between"},km={class:"text-sm text-gray-600"},Cm=["onClick"],Am={key:0,class:"flex items-center justify-center space-x-2"},Pm=["disabled"],Em=["onClick"],jm={key:1,class:"px-3 py-2 text-sm text-gray-500"},Sm=["disabled"],Im={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Dm={class:"flex items-center justify-center min-h-screen px-4"},Tm={class:"relative bg-white rounded-lg max-w-2xl w-full max-h-screen overflow-y-auto"},Mm={class:"p-6"},Lm={class:"flex items-center justify-between mb-4"},Vm={class:"space-y-6"},Rm={class:"flex items-start space-x-4"},Fm=["src","alt"],Nm={class:"flex-1"},zm={class:"text-xl font-bold text-gray-900"},qm={class:"text-lg text-purple-600 font-semibold"},Um={class:"text-sm text-gray-600"},Bm={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Om={class:"flex items-center"},Gm={class:"w-12 h-12 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mr-4 text-lg font-bold"},Hm={class:"font-medium text-blue-900"},Km={class:"text-sm text-blue-700"},Wm={class:"text-sm text-blue-600"},Jm={class:"grid grid-cols-2 gap-4"},Xm={class:"bg-gray-50 p-4 rounded-lg"},Ym={class:"text-2xl font-bold text-gray-900"},Qm={class:"text-xs text-gray-500"},Zm={class:"bg-gray-50 p-4 rounded-lg"},ep={class:"text-2xl font-bold text-gray-900"},tp={class:"bg-gray-50 p-4 rounded-lg"},sp={class:"text-2xl font-bold text-gray-900"},op={class:"bg-gray-50 p-4 rounded-lg"},rp={class:"text-2xl font-bold text-gray-900 font-mono"},ap={class:"text-sm text-gray-600 space-y-1"},Dt=12,np={__name:"History",setup(_){const{get:y}=ge(),w=R([]),p=R({}),f=R([]),a=R(!1),c=R(null),n=R({period:"all",category:"",sort:"date_desc"}),r=R(1),P=de(()=>{let i=[...w.value];switch(n.value.sort){case"date_asc":i.sort((C,x)=>new Date(C.draw_date)-new Date(x.draw_date));break;case"date_desc":i.sort((C,x)=>new Date(x.draw_date)-new Date(C.draw_date));break;case"value_asc":i.sort((C,x)=>C.product.price-x.product.price);break;case"value_desc":i.sort((C,x)=>x.product.price-C.product.price);break;case"participation_desc":i.sort((C,x)=>x.participation_rate-C.participation_rate);break}return i}),$=de(()=>Math.ceil(P.value.length/Dt)),M=de(()=>{const i=(r.value-1)*Dt,C=i+Dt;return P.value.slice(i,C)}),D=de(()=>{const i=[],C=r.value,x=$.value;if(x<=7)for(let I=1;I<=x;I++)i.push(I);else if(C<=4){for(let I=1;I<=5;I++)i.push(I);i.push("..."),i.push(x)}else if(C>=x-3){i.push(1),i.push("...");for(let I=x-4;I<=x;I++)i.push(I)}else{i.push(1),i.push("...");for(let I=C-1;I<=C+1;I++)i.push(I);i.push("..."),i.push(x)}return i}),m=async()=>{a.value=!0;try{const i=new URLSearchParams({period:n.value.period,limit:500});n.value.category&&i.append("category",n.value.category);const[C,x,I]=await Promise.all([y(`/public/results?${i}`),y("/public/results/stats"),y("/categories")]);w.value=C.data.results||[],p.value=C.data.stats||{},f.value=I.data||[]}catch(i){console.error("Erreur lors du chargement de l'historique:",i)}finally{a.value=!1}},k=()=>{n.value={period:"all",category:"",sort:"date_desc"},r.value=1},U=i=>{c.value=i},V=i=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(i||0)+" FCFA",v=i=>i?i>=1e6?(i/1e6).toFixed(1)+"M":i>=1e3?(i/1e3).toFixed(0)+"K":i.toString():"0",d=i=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(i));return De(n,()=>{r.value=1},{deep:!0}),ve(()=>{m()}),(i,C)=>(s(),o("div",T0,[e("div",M0,[e("div",L0,[e("div",V0,[C[11]||(C[11]=e("h1",{class:"text-4xl font-bold mb-4"},"📚 Historique des Tombolas",-1)),C[12]||(C[12]=e("p",{class:"text-xl opacity-90 mb-8"}," Explorez l'historique complet de toutes nos tombolas terminées ",-1)),e("div",R0,[e("div",F0,[e("div",N0,t(p.value.total_lotteries||0),1),C[7]||(C[7]=e("div",{class:"text-sm opacity-90"},"Tombolas terminées",-1))]),e("div",z0,[e("div",q0,t(p.value.total_winners||0),1),C[8]||(C[8]=e("div",{class:"text-sm opacity-90"},"Gagnants heureux",-1))]),e("div",U0,[e("div",B0,t(v(p.value.total_prizes_value)),1),C[9]||(C[9]=e("div",{class:"text-sm opacity-90"},"Valeur totale",-1))]),e("div",O0,[e("div",G0,t(Math.round(p.value.average_participation_rate||0))+"%",1),C[10]||(C[10]=e("div",{class:"text-sm opacity-90"},"Participation moy.",-1))])])])])]),e("div",H0,[e("div",K0,[e("div",W0,[e("div",J0,[e("div",null,[C[14]||(C[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Période",-1)),Q(e("select",{"onUpdate:modelValue":C[0]||(C[0]=x=>n.value.period=x),onChange:m,class:"w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500"},C[13]||(C[13]=[e("option",{value:"all"},"Toute la période",-1),e("option",{value:"month"},"Ce mois",-1),e("option",{value:"quarter"},"Ce trimestre",-1),e("option",{value:"year"},"Cette année",-1)]),544),[[me,n.value.period]])]),e("div",null,[C[16]||(C[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Catégorie",-1)),Q(e("select",{"onUpdate:modelValue":C[1]||(C[1]=x=>n.value.category=x),onChange:m,class:"w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500"},[C[15]||(C[15]=e("option",{value:""},"Toutes les catégories",-1)),(s(!0),o(ie,null,le(f.value,x=>(s(),o("option",{key:x.id,value:x.id},t(x.name),9,X0))),128))],544),[[me,n.value.category]])]),e("div",null,[C[18]||(C[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Trier par",-1)),Q(e("select",{"onUpdate:modelValue":C[2]||(C[2]=x=>n.value.sort=x),onChange:m,class:"w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500"},C[17]||(C[17]=[pe('<option value="date_desc">Plus récent</option><option value="date_asc">Plus ancien</option><option value="value_desc">Valeur croissante</option><option value="value_asc">Valeur décroissante</option><option value="participation_desc">Participation élevée</option>',5)]),544),[[me,n.value.sort]])])]),e("div",Y0,[e("button",{onClick:k,class:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors"}," Réinitialiser "),e("div",Q0,t(M.value.length)+" résultat(s) ",1)])])]),a.value?(s(),o("div",Z0,C[19]||(C[19]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement de l'historique...",-1)]))):w.value.length===0?(s(),o("div",em,[g(l(Fs),{class:"mx-auto h-16 w-16 text-gray-400 mb-4"}),C[20]||(C[20]=e("h3",{class:"text-xl font-medium text-gray-900 mb-2"},"Aucun historique",-1)),C[21]||(C[21]=e("p",{class:"text-gray-600"},"Aucune tombola terminée ne correspond à vos critères.",-1))])):(s(),o("div",tm,[e("div",sm,[(s(!0),o(ie,null,le(M.value,x=>(s(),o("div",{key:x.lottery_id,class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow duration-200"},[e("div",om,[x.product.image_url?(s(),o("img",{key:0,src:x.product.image_url,alt:x.product.title,class:"w-full h-full object-cover"},null,8,rm)):T("",!0),C[22]||(C[22]=e("div",{class:"absolute top-3 right-3"},[e("span",{class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"}," Terminé ")],-1)),e("div",am,[e("span",nm,t(x.product.category?.name||x.product.category||"Sans catégorie"),1)])]),e("div",im,[e("div",lm,[e("h3",dm,t(x.product.title),1),e("p",um,t(V(x.product.price)),1),e("p",cm,"Tombola "+t(x.lottery_number),1)]),e("div",mm,[e("div",pm,[e("div",gm,t(x.winner.initial),1),e("div",fm,[C[23]||(C[23]=e("div",{class:"text-sm font-medium text-blue-900"},"🏆 Gagnant",-1)),e("div",vm,t(x.winner.name)+" • "+t(x.winner.city),1)])])]),e("div",xm,[e("div",bm,[e("div",ym,t(x.sold_tickets),1),C[24]||(C[24]=e("div",{class:"text-xs text-gray-500"},"Participants",-1))]),e("div",hm,[e("div",_m,t(x.participation_rate)+"%",1),C[25]||(C[25]=e("div",{class:"text-xs text-gray-500"},"Participation",-1))])]),e("div",wm,[e("div",{class:"bg-blue-500 h-2 rounded-full",style:Me({width:x.participation_rate+"%"})},null,4)]),e("div",$m,[e("div",km,t(d(x.draw_date)),1),e("button",{onClick:I=>U(x),class:"text-purple-600 hover:text-purple-700 text-sm font-medium"}," Voir détails → ",8,Cm)])])]))),128))]),$.value>1?(s(),o("div",Am,[e("button",{onClick:C[3]||(C[3]=x=>r.value=Math.max(1,r.value-1)),disabled:r.value===1,class:"px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Précédent ",8,Pm),(s(!0),o(ie,null,le(D.value,x=>(s(),o(ie,{key:x},[x!=="..."?(s(),o("button",{key:0,onClick:I=>r.value=x,class:te(["px-4 py-2 text-sm font-medium border rounded-md",r.value===x?"bg-purple-600 text-white border-purple-600":"text-gray-700 bg-white border-gray-300 hover:bg-gray-50"])},t(x),11,Em)):(s(),o("span",jm,"..."))],64))),128)),e("button",{onClick:C[4]||(C[4]=x=>r.value=Math.min($.value,r.value+1)),disabled:r.value===$.value,class:"px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Suivant ",8,Sm)])):T("",!0)]))]),c.value?(s(),o("div",Im,[e("div",Dm,[e("div",{class:"fixed inset-0 bg-black/40",onClick:C[5]||(C[5]=x=>c.value=null)}),e("div",Tm,[e("div",Mm,[e("div",Lm,[C[26]||(C[26]=e("h3",{class:"text-lg font-semibold"},"Détails de la tombola",-1)),e("button",{onClick:C[6]||(C[6]=x=>c.value=null),class:"text-gray-400 hover:text-gray-600"},[g(l(Le),{class:"w-6 h-6"})])]),e("div",Vm,[e("div",Rm,[c.value.product.image_url?(s(),o("img",{key:0,src:c.value.product.image_url,alt:c.value.product.title,class:"w-24 h-24 rounded-lg object-cover"},null,8,Fm)):T("",!0),e("div",Nm,[e("h4",zm,t(c.value.product.title),1),e("p",qm,t(V(c.value.product.price)),1),e("p",Um,t(c.value.product.category?.name||c.value.product.category||"Sans catégorie"),1)])]),e("div",Bm,[C[27]||(C[27]=e("h5",{class:"font-medium text-blue-900 mb-2"},"🏆 Gagnant officiel",-1)),e("div",Om,[e("div",Gm,t(c.value.winner.initial),1),e("div",null,[e("p",Hm,t(c.value.winner.name),1),e("p",Km,t(c.value.winner.city),1),e("p",Wm,"Ticket: "+t(c.value.winning_ticket),1)])])]),e("div",Jm,[e("div",Xm,[e("div",Ym,t(c.value.sold_tickets),1),C[28]||(C[28]=e("div",{class:"text-sm text-gray-600"},"Tickets vendus",-1)),e("div",Qm,"sur "+t(c.value.total_tickets),1)]),e("div",Zm,[e("div",ep,t(c.value.participation_rate)+"%",1),C[29]||(C[29]=e("div",{class:"text-sm text-gray-600"},"Participation",-1))]),e("div",tp,[e("div",sp,t(v(c.value.total_revenue)),1),C[30]||(C[30]=e("div",{class:"text-sm text-gray-600"},"Revenus",-1))]),e("div",op,[e("div",rp,t(c.value.verification_code),1),C[31]||(C[31]=e("div",{class:"text-sm text-gray-600"},"Code vérif.",-1))])]),e("div",null,[C[34]||(C[34]=e("h5",{class:"font-medium text-gray-900 mb-3"},"📅 Chronologie",-1)),e("div",ap,[e("p",null,[C[32]||(C[32]=e("strong",null,"Tirage :",-1)),z(" "+t(d(c.value.draw_date)),1)]),e("p",null,[C[33]||(C[33]=e("strong",null,"Revenus :",-1)),z(" "+t(V(c.value.total_revenue)),1)])])])])])])])])):T("",!0)]))}},ip={class:"relative overflow-hidden h-48"},lp={class:"absolute top-3 left-3"},dp={key:0,class:"flex items-center bg-purple-600 text-white px-3 py-1.5 rounded-full shadow-lg"},up={key:1,class:"flex items-center bg-[#0099cc] text-white px-3 py-1.5 rounded-full shadow-lg"},cp={class:"absolute top-3 right-3"},mp={key:0,class:"bg-yellow-500 text-white px-2 py-1 rounded-md text-xs font-medium shadow-sm flex items-center"},pp={class:"absolute bottom-3 left-3"},gp={class:"bg-black/70 backdrop-blur text-white px-2 py-1 rounded-md text-xs font-medium"},fp={class:"p-5 space-y-4"},vp={class:"font-bold text-lg text-gray-900 group-hover:text-blue-600 transition-colors line-clamp-2"},xp={class:"text-gray-600 text-sm line-clamp-2"},bp={key:0,class:"space-y-3"},yp={class:"flex justify-between items-center bg-purple-50 rounded-lg p-3"},hp={class:"text-xl font-bold text-purple-700"},_p={class:"text-right"},wp={class:"text-lg font-semibold text-gray-900"},$p={key:0,class:"space-y-1"},kp={class:"flex justify-between text-sm"},Cp={class:"font-medium text-purple-700"},Ap={class:"w-full bg-gray-200 rounded-full h-2.5"},Pp={class:"flex justify-between text-xs text-gray-500"},Ep={key:1,class:"flex items-center text-sm text-gray-600"},jp={key:1,class:"space-y-3"},Sp={class:"bg-blue-50 rounded-lg p-3"},Ip={class:"text-2xl font-bold text-[#0099cc]"},Dp={key:0,class:"flex items-center text-sm"},Tp={key:3,disabled:"",class:"w-full py-3 px-4 rounded-lg font-medium bg-gray-400 text-white cursor-not-allowed"},Mp={__name:"ProductCardV2",props:{product:{type:Object,required:!0}},emits:["view-product"],setup(_){const y=_,w=c=>new Intl.NumberFormat("fr-FR").format(c||0),p=c=>c?new Date(c).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}):"",f=c=>{if(!c.active_lottery)return 0;const n=c.active_lottery.sold_tickets||0,r=c.active_lottery.total_tickets||1;return Math.round(n/r*100)},a=de(()=>{if(y.product.sale_mode!=="lottery"||!y.product.active_lottery)return!1;const c=y.product.active_lottery.sold_tickets||0,n=y.product.active_lottery.total_tickets||y.product.active_lottery.max_tickets||0;return c>=n});return(c,n)=>(s(),o("div",{class:te(["group cursor-pointer overflow-hidden bg-white rounded-xl shadow-sm hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 border border-gray-100",{"ring-2 ring-purple-500":_.product.sale_mode==="lottery","ring-2 ring-[#0099cc]":_.product.sale_mode==="direct"}]),onClick:n[1]||(n[1]=r=>c.$emit("view-product",_.product))},[e("div",ip,[g(He,{src:_.product.image_url||_.product.main_image||_.product.image,alt:_.product.name||_.product.title,"container-class":"w-full h-full","image-class":"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"},null,8,["src","alt"]),n[5]||(n[5]=e("div",{class:"absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1)),e("div",lp,[_.product.sale_mode==="lottery"?(s(),o("div",dp,[g(l(je),{class:"w-4 h-4 mr-1.5 flex-shrink-0"}),n[2]||(n[2]=e("span",{class:"text-sm font-semibold"},"Tombola",-1))])):(s(),o("div",up,[g(l(qe),{class:"w-4 h-4 mr-1.5 flex-shrink-0"}),n[3]||(n[3]=e("span",{class:"text-sm font-semibold"},"Achat direct",-1))]))]),e("div",cp,[_.product.featured?(s(),o("span",mp,[g(l(ft),{class:"w-3.5 h-3.5 mr-1 flex-shrink-0"}),n[4]||(n[4]=z(" Vedette ",-1))])):T("",!0)]),e("div",pp,[e("span",gp,t(_.product.category?.name||"Non catégorisé"),1)])]),e("div",fp,[e("h3",vp,t(_.product.name||_.product.title),1),e("p",xp,t(_.product.description||"Aucune description disponible"),1),_.product.sale_mode==="lottery"?(s(),o("div",bp,[e("div",yp,[e("div",null,[n[6]||(n[6]=e("p",{class:"text-xs text-gray-600"},"Prix du ticket",-1)),e("p",hp,t(w(_.product.active_lottery?.ticket_price||_.product.ticket_price||1e3))+" FCFA",1)]),e("div",_p,[n[7]||(n[7]=e("p",{class:"text-xs text-gray-600"},"Valeur du lot",-1)),e("p",wp,t(w(_.product.price))+" FCFA",1)])]),_.product.sale_mode==="lottery"&&_.product.active_lottery?(s(),o("div",$p,[e("div",kp,[n[8]||(n[8]=e("span",{class:"text-gray-600"},"Progression",-1)),e("span",Cp,t(f(_.product))+"%",1)]),e("div",Ap,[e("div",{class:"bg-gradient-to-r from-purple-500 to-purple-700 h-2.5 rounded-full transition-all duration-500",style:Me({width:f(_.product)+"%"})},null,4)]),e("div",Pp,[e("span",null,t(_.product.active_lottery.sold_tickets||0)+" tickets vendus",1),e("span",null,t(_.product.active_lottery.total_tickets||1e3)+" au total",1)])])):T("",!0),_.product.sale_mode==="lottery"&&_.product.active_lottery?.draw_date?(s(),o("div",Ep,[g(l(Ot),{class:"w-4 h-4 mr-2 text-purple-600 flex-shrink-0"}),e("span",null,"Tirage le "+t(p(_.product.active_lottery.draw_date)),1)])):T("",!0)])):(s(),o("div",jp,[e("div",Sp,[n[9]||(n[9]=e("p",{class:"text-xs text-gray-600 mb-1"},"Prix",-1)),e("p",Ip,t(w(_.product.price))+" FCFA",1)]),_.product.stock!==void 0?(s(),o("div",Dp,[n[10]||(n[10]=e("span",{class:"text-gray-600"},"Stock disponible:",-1)),e("span",{class:te(["ml-2 font-medium",_.product.stock>0?"text-[#0099cc]":"text-red-600"])},t(_.product.stock>0?_.product.stock+" unités":"Épuisé"),3)])):T("",!0)])),a.value?(s(),o("button",Tp," Tombola complète ")):(s(),o("button",{key:2,onClick:n[0]||(n[0]=_e(r=>c.$emit("view-product",_.product),["stop"])),class:te(["w-full py-3 px-4 rounded-lg font-medium transition-all duration-200 btn-responsive btn-wrap-mobile group-hover:shadow-md",_.product.sale_mode==="lottery"?"bg-purple-600 hover:bg-purple-700 text-white":"bg-[#0099cc] hover:bg-[#0088bb] text-white"])},[g(l(qe),{class:"w-5 h-5 mr-2 flex-shrink-0"}),z(" "+t(_.product.sale_mode==="lottery"?"Participer à la tombola":"Acheter maintenant"),1)],2))])],2))}},hs=Ee(Mp,[["__scopeId","data-v-ccedde79"]]);var Lp=typeof global=="object"&&global&&global.Object===Object&&global,Vp=typeof self=="object"&&self&&self.Object===Object&&self,_s=Lp||Vp||Function("return this")(),wt=_s.Symbol,ws=Object.prototype,Rp=ws.hasOwnProperty,Fp=ws.toString,ct=wt?wt.toStringTag:void 0;function Np(_){var y=Rp.call(_,ct),w=_[ct];try{_[ct]=void 0;var p=!0}catch{}var f=Fp.call(_);return p&&(y?_[ct]=w:delete _[ct]),f}var zp=Object.prototype,qp=zp.toString;function Up(_){return qp.call(_)}var Bp="[object Null]",Op="[object Undefined]",os=wt?wt.toStringTag:void 0;function Gp(_){return _==null?_===void 0?Op:Bp:os&&os in Object(_)?Np(_):Up(_)}function Hp(_){return _!=null&&typeof _=="object"}var Kp="[object Symbol]";function Wp(_){return typeof _=="symbol"||Hp(_)&&Gp(_)==Kp}var Jp=/\s/;function Xp(_){for(var y=_.length;y--&&Jp.test(_.charAt(y)););return y}var Yp=/^\s+/;function Qp(_){return _&&_.slice(0,Xp(_)+1).replace(Yp,"")}function Nt(_){var y=typeof _;return _!=null&&(y=="object"||y=="function")}var rs=NaN,Zp=/^[-+]0x[0-9a-f]+$/i,eg=/^0b[01]+$/i,tg=/^0o[0-7]+$/i,sg=parseInt;function as(_){if(typeof _=="number")return _;if(Wp(_))return rs;if(Nt(_)){var y=typeof _.valueOf=="function"?_.valueOf():_;_=Nt(y)?y+"":y}if(typeof _!="string")return _===0?_:+_;_=Qp(_);var w=eg.test(_);return w||tg.test(_)?sg(_.slice(2),w?2:8):Zp.test(_)?rs:+_}var Tt=function(){return _s.Date.now()},og="Expected a function",rg=Math.max,ag=Math.min;function $s(_,y,w){var p,f,a,c,n,r,P=0,$=!1,M=!1,D=!0;if(typeof _!="function")throw new TypeError(og);y=as(y)||0,Nt(w)&&($=!!w.leading,M="maxWait"in w,a=M?rg(as(w.maxWait)||0,y):a,D="trailing"in w?!!w.trailing:D);function m(I){var N=p,u=f;return p=f=void 0,P=I,c=_.apply(u,N),c}function k(I){return P=I,n=setTimeout(v,y),$?m(I):c}function U(I){var N=I-r,u=I-P,A=y-N;return M?ag(A,a-u):A}function V(I){var N=I-r,u=I-P;return r===void 0||N>=y||N<0||M&&u>=a}function v(){var I=Tt();if(V(I))return d(I);n=setTimeout(v,U(I))}function d(I){return n=void 0,D&&p?m(I):(p=f=void 0,c)}function i(){n!==void 0&&clearTimeout(n),P=0,p=r=f=n=void 0}function C(){return n===void 0?c:d(Tt())}function x(){var I=Tt(),N=V(I);if(p=arguments,f=this,r=I,N){if(n===void 0)return k(r);if(M)return clearTimeout(n),n=setTimeout(v,y),m(r)}return n===void 0&&(n=setTimeout(v,y)),c}return x.cancel=i,x.flush=C,x}const ng={class:"min-h-screen bg-gray-50"},ig={class:"bg-white shadow-sm border-b"},lg={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 product-filter"},dg={class:"flex flex-col lg:flex-row gap-6"},ug={class:"flex-1"},cg={class:"relative"},mg={class:"lg:w-48"},pg={class:"lg:w-64"},gg={key:0,disabled:""},fg=["value"],vg={key:0,class:"mt-2 text-sm text-red-600"},xg={class:"lg:w-48"},bg={class:"lg:w-48"},yg={class:"py-12"},hg={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},_g={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},wg={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},$g={key:2,class:"mt-8 flex justify-center"},kg={class:"flex space-x-2"},Cg=["disabled"],Ag={class:"px-4 py-2 text-gray-700"},Pg=["disabled"],Eg={key:3,class:"text-center py-16"},jg={class:"w-32 h-32 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center"},Sg={class:"bg-gradient-to-r from-[#0099cc] to-cyan-600 py-16"},Ig={class:"max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8"},Dg={class:"flex flex-col sm:flex-row gap-4 justify-center"},Mt=12,Tg={__name:"Products",setup(_){const y=$e(),{get:w,loading:p}=ge(),f=R(""),a=R(""),c=R(""),n=R(""),r=R("newest"),P=R([]),$=R([]),M=R(1),D=async()=>{try{const x=new URLSearchParams;if(f.value&&x.append("search",f.value),a.value&&x.append("category_id",a.value),c.value&&x.append("sale_mode",c.value),n.value){const[u,A]=n.value.split("-");u&&x.append("min_price",u),A&&A!=="+"&&x.append("max_price",A)}const I=x.toString()?`/products?${x.toString()}`:"/products",N=await w(I);N&&N.success&&N.data&&(P.value=N.data.products||N.data||[],M.value=1)}catch(x){console.error("Erreur lors du chargement des produits:",x),P.value=[]}},m=async()=>{try{console.log("Chargement des catégories...");const x=await w("/categories");console.log("Réponse API categories:",x),x&&x.success?($.value=x.data||[],console.log("Catégories chargées:",$.value.length)):(console.log("Structure de réponse inattendue:",x),$.value=x?.data||x||[])}catch(x){console.error("Erreur lors du chargement des catégories:",x),$.value=[]}},k=de(()=>{let x=[...P.value];return r.value==="price-asc"?x.sort((I,N)=>I.price-N.price):r.value==="price-desc"?x.sort((I,N)=>N.price-I.price):r.value==="popular"?x.sort((I,N)=>{const u=I.sale_mode==="lottery"?I.active_lottery?.sold_tickets||0:I.views_count||0;return(N.sale_mode==="lottery"?N.active_lottery?.sold_tickets||0:N.views_count||0)-u}):r.value==="newest"&&x.sort((I,N)=>new Date(N.created_at)-new Date(I.created_at)),x}),U=de(()=>{const x=(M.value-1)*Mt,I=x+Mt;return k.value.slice(x,I)}),V=de(()=>Math.ceil(k.value.length/Mt)),v=x=>{y.push({name:"public.product.detail",params:{id:x.id}})},d=()=>{f.value="",a.value="",c.value="",n.value="",r.value="newest",D()},i=$s(()=>{D()},300),C=()=>{D()};return ve(async()=>{await Promise.all([D(),m()])}),(x,I)=>{const N=he("router-link");return s(),o("div",ng,[I[19]||(I[19]=pe('<section class="bg-gradient-to-br from-[#0099cc] via-[#0088bb] to-[#0077aa] text-white py-16" data-v-c6640e87><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8" data-v-c6640e87><div class="text-center" data-v-c6640e87><h1 class="text-4xl md:text-5xl font-bold mb-4" data-v-c6640e87> Découvrez nos <span class="text-white/80" data-v-c6640e87>produits incroyables</span></h1><p class="text-xl text-white/80 max-w-3xl mx-auto mb-8" data-v-c6640e87> Des smartphones dernière génération aux gadgets high-tech, tous nos produits sont garantis et à gagner facilement </p><div class="flex flex-wrap justify-center gap-4" data-v-c6640e87><div class="bg-white/10 backdrop-blur-sm rounded-full px-6 py-2" data-v-c6640e87><span class="text-sm font-medium" data-v-c6640e87>✓ Produits authentiques</span></div><div class="bg-white/10 backdrop-blur-sm rounded-full px-6 py-2" data-v-c6640e87><span class="text-sm font-medium" data-v-c6640e87>✓ Livraison gratuite</span></div><div class="bg-white/10 backdrop-blur-sm rounded-full px-6 py-2" data-v-c6640e87><span class="text-sm font-medium" data-v-c6640e87>✓ Garantie constructeur</span></div></div></div></div></section>',1)),e("section",ig,[e("div",lg,[e("div",dg,[e("div",ug,[e("div",cg,[g(l(it),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),Q(e("input",{"onUpdate:modelValue":I[0]||(I[0]=u=>f.value=u),onInput:I[1]||(I[1]=(...u)=>l(i)&&l(i)(...u)),type:"text",placeholder:"Rechercher un produit...",class:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all text-gray-900 placeholder-gray-500 bg-white"},null,544),[[ne,f.value]])])]),e("div",mg,[Q(e("select",{"onUpdate:modelValue":I[2]||(I[2]=u=>c.value=u),onChange:C,class:"w-full py-3 px-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all text-gray-900 bg-white"},I[8]||(I[8]=[e("option",{value:""},"Tous les types",-1),e("option",{value:"direct"},"Achat direct",-1),e("option",{value:"lottery"},"Tombola",-1)]),544),[[me,c.value]])]),e("div",pg,[Q(e("select",{"onUpdate:modelValue":I[3]||(I[3]=u=>a.value=u),onChange:C,class:"w-full py-3 px-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all text-gray-900 bg-white"},[I[9]||(I[9]=e("option",{value:""},"Toutes catégories",-1)),$.value.length===0?(s(),o("option",gg,"Aucune catégorie disponible")):T("",!0),(s(!0),o(ie,null,le($.value,u=>(s(),o("option",{key:u.id,value:u.id},t(u.name),9,fg))),128))],544),[[me,a.value]]),$.value.length===0?(s(),o("div",vg," Aucune catégorie trouvée ("+t($.value.length)+") ",1)):T("",!0)]),e("div",xg,[Q(e("select",{"onUpdate:modelValue":I[4]||(I[4]=u=>n.value=u),onChange:C,class:"w-full py-3 px-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all text-gray-900 bg-white"},I[10]||(I[10]=[pe('<option value="" data-v-c6640e87>Tous les prix</option><option value="0-50000" data-v-c6640e87>0 - 50,000 FCFA</option><option value="50000-100000" data-v-c6640e87>50,000 - 100,000 FCFA</option><option value="100000-500000" data-v-c6640e87>100,000 - 500,000 FCFA</option><option value="500000+" data-v-c6640e87>Plus de 500,000 FCFA</option>',5)]),544),[[me,n.value]])]),e("div",bg,[Q(e("select",{"onUpdate:modelValue":I[5]||(I[5]=u=>r.value=u),onChange:C,class:"w-full py-3 px-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all text-gray-900 bg-white"},I[11]||(I[11]=[e("option",{value:"newest"},"Plus récents",-1),e("option",{value:"price-asc"},"Prix croissant",-1),e("option",{value:"price-desc"},"Prix décroissant",-1),e("option",{value:"popular"},"Plus populaires",-1)]),544),[[me,r.value]])])])])]),e("section",yg,[e("div",hg,[l(p)?(s(),o("div",_g,[(s(),o(ie,null,le(12,u=>e("div",{key:u,class:"animate-pulse"},I[12]||(I[12]=[pe('<div class="bg-white rounded-2xl p-6 shadow-sm" data-v-c6640e87><div class="w-full h-48 bg-gray-200 rounded-xl mb-4" data-v-c6640e87></div><div class="h-4 bg-gray-200 rounded mb-2" data-v-c6640e87></div><div class="h-4 bg-gray-200 rounded w-2/3 mb-4" data-v-c6640e87></div><div class="h-6 bg-gray-200 rounded w-1/3" data-v-c6640e87></div></div>',1)]))),64))])):(s(),o("div",wg,[(s(!0),o(ie,null,le(U.value,u=>(s(),ce(hs,{key:u.id,product:u,onViewProduct:v},null,8,["product"]))),128))])),V.value>1?(s(),o("div",$g,[e("nav",kg,[e("button",{onClick:I[6]||(I[6]=u=>M.value=Math.max(1,M.value-1)),disabled:M.value===1,class:"px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"}," Précédent ",8,Cg),e("span",Ag," Page "+t(M.value)+" sur "+t(V.value),1),e("button",{onClick:I[7]||(I[7]=u=>M.value=Math.min(V.value,M.value+1)),disabled:M.value===V.value,class:"px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"}," Suivant ",8,Pg)])])):T("",!0),!l(p)&&k.value.length===0?(s(),o("div",Eg,[e("div",jg,[g(l(it),{class:"w-16 h-16 text-gray-400"})]),I[13]||(I[13]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"Aucun produit trouvé",-1)),I[14]||(I[14]=e("p",{class:"text-gray-600 mb-6"},"Essayez de modifier vos critères de recherche",-1)),e("button",{onClick:d,class:"bg-[#0099cc] hover:bg-[#0088bb] text-white px-6 py-3 rounded-xl transition-colors"}," Réinitialiser les filtres ")])):T("",!0)])]),e("section",Sg,[e("div",Ig,[I[17]||(I[17]=e("h2",{class:"text-3xl md:text-4xl font-bold text-white mb-4"}," Prêt à tenter votre chance ? ",-1)),I[18]||(I[18]=e("p",{class:"text-xl text-blue-100 mb-8"}," Inscrivez-vous gratuitement et participez à vos premiers tirages ",-1)),e("div",Dg,[g(N,{to:"/register",class:"bg-white text-[#0099cc] px-8 py-4 rounded-xl font-semibold hover:bg-gray-50 transition-colors"},{default:re(()=>I[15]||(I[15]=[z(" S'inscrire gratuitement ",-1)])),_:1,__:[15]}),g(N,{to:"/login",class:"border-2 border-white text-white px-8 py-4 rounded-xl font-semibold hover:bg-white hover:text-[#0099cc] transition-all"},{default:re(()=>I[16]||(I[16]=[z(" Se connecter ",-1)])),_:1,__:[16]})])])])])}}},Mg=Ee(Tg,[["__scopeId","data-v-c6640e87"]]),Lg={class:"min-h-screen bg-gray-50"},Vg={key:0,class:"animate-pulse"},Rg={key:1,class:"bg-white"},Fg={class:"bg-gray-50 border-b"},Ng={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4"},zg={class:"flex items-center space-x-2 text-sm"},qg={class:"text-gray-900 font-medium"},Ug={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16"},Bg={class:"grid grid-cols-1 lg:grid-cols-2 gap-12"},Og={class:"space-y-4"},Gg={class:"relative overflow-hidden rounded-2xl bg-gray-100"},Hg={key:0,class:"absolute top-4 right-4"},Kg={class:"bg-[#0099cc] text-white px-4 py-2 rounded-full font-semibold"},Wg={key:1,class:"absolute top-4 right-4"},Jg={key:2,class:"absolute top-4 left-4"},Xg={key:0,class:"grid grid-cols-4 gap-4"},Yg={class:"space-y-8"},Qg={class:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4"},Zg={class:"flex items-center gap-4 mb-6"},ef={class:"bg-[#0099cc]/10 text-[#0099cc] px-4 py-2 rounded-full font-semibold"},tf={class:"flex items-center text-yellow-500"},sf={key:0,class:"flex items-center gap-3 p-4 bg-gray-50 rounded-xl"},of={class:"w-12 h-12 rounded-full bg-[#0099cc]/10 flex items-center justify-center"},rf={key:0,class:"w-6 h-6 text-[#0099cc]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},af={key:1,class:"w-6 h-6 text-[#0099cc]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},nf={class:"font-semibold text-gray-900"},lf={class:"bg-gradient-to-r from-[#0099cc]/5 to-[#0099cc]/10 rounded-2xl p-6"},df={class:"text-center"},uf={class:"text-sm text-gray-600 mb-2"},cf={class:"text-4xl font-bold text-[#0099cc] mb-2"},mf={key:0,class:"text-sm text-gray-600"},pf={class:"font-semibold text-[#0099cc]"},gf={key:1,class:"text-sm text-gray-600"},ff={key:0,class:"space-y-4"},vf={class:"space-y-3"},xf={class:"flex justify-between text-sm"},bf={class:"font-semibold"},yf={class:"w-full bg-gray-200 rounded-full h-4"},hf={class:"flex justify-between text-sm"},_f={class:"text-[#0099cc] font-medium"},wf={class:"text-gray-600"},$f={key:1,class:"bg-gray-50 rounded-2xl p-6 space-y-4"},kf={class:"grid grid-cols-2 gap-4 text-sm"},Cf={class:"font-semibold"},Af={class:"font-semibold"},Pf={key:2,class:"bg-green-50 rounded-2xl p-6 space-y-4"},Ef={class:"space-y-3"},jf={class:"flex items-center gap-3"},Sf={class:"flex items-center gap-3"},If={class:"flex items-center gap-3"},Df={class:"flex items-center gap-3"},Tf={class:"space-y-4"},Mf={class:"flex flex-col items-center"},Lf={class:"text-sm font-medium opacity-90"},Vf={class:"flex flex-col items-center"},Rf={class:"text-sm font-medium opacity-90"},Ff={class:"grid grid-cols-2 gap-4"},Nf=["title"],zf={class:"flex items-center gap-6 pt-6 border-t"},qf={class:"flex items-center gap-2 text-sm text-gray-600"},Uf={class:"flex items-center gap-2 text-sm text-gray-600"},Bf={class:"flex items-center gap-2 text-sm text-gray-600"},Of={class:"mt-16 grid grid-cols-1 lg:grid-cols-3 gap-8"},Gf={class:"lg:col-span-2"},Hf={class:"prose max-w-none text-gray-700"},Kf={class:"text-lg leading-relaxed mb-6"},Wf={class:"space-y-2 mb-6"},Jf={class:"flex items-start gap-3"},Xf={class:"flex items-start gap-3"},Yf={class:"flex items-start gap-3"},Qf={class:"flex items-start gap-3"},Zf={class:"space-y-6"},ev={class:"bg-gray-50 rounded-2xl p-6"},tv={class:"space-y-3 text-sm"},sv={class:"flex justify-between"},ov={class:"font-medium"},rv={class:"flex justify-between"},av={class:"font-medium"},nv={class:"flex justify-between"},iv={class:"font-medium text-[#0099cc]"},lv={class:"bg-[#0099cc]/5 rounded-2xl p-6"},dv={class:"space-y-3 text-sm"},uv={class:"flex items-start gap-3"},cv={class:"flex items-start gap-3"},mv={class:"flex items-start gap-3"},pv={class:"flex items-start gap-3"},gv={class:"bg-gray-50 py-16"},fv={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},vv={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},xv=["onClick"],bv={class:"relative overflow-hidden rounded-xl mb-4"},yv={class:"absolute top-2 right-2"},hv={class:"bg-[#0099cc] text-white px-2 py-1 rounded-full text-xs"},_v={class:"font-semibold text-gray-900 mb-2"},wv={class:"text-lg font-bold text-[#0099cc]"},$v={key:2,class:"min-h-screen flex items-center justify-center"},kv={class:"text-center"},Cv={class:"w-32 h-32 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center"},Av={class:"text-xl font-semibold text-gray-900 mb-2"},Pv={class:"text-gray-600 mb-6"},Ev={class:"space-y-3"},jv={__name:"ProductDetail",setup(_){const y=Be(),w=$e(),{get:p}=ge(),f=Pe(),a=R(!0),c=R(null),n=R(null),r=de(()=>c.value&&c.value.activeLottery&&c.value.activeLottery.id),P=R([]),$=C=>{const x=Number(C)||0;return isNaN(x)?"0 FCFA":new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(x).replace("XAF","FCFA")},M=C=>C?new Date(C).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Non définie",D=()=>{if(!c.value?.activeLottery?.draw_date)return"Non défini";const I=new Date(c.value.activeLottery.draw_date)-new Date;if(I<=0)return"Terminé";const N=Math.floor(I/(1e3*60*60*24)),u=Math.floor(I%(1e3*60*60*24)/(1e3*60*60));if(N>0)return`${N}j ${u}h`;{const A=Math.floor(I%36e5/6e4);return`${u}h ${A}min`}},m=()=>{f.isAuthenticated?f.isCustomer?w.push({name:"customer.product.detail",params:{id:y.params.id}}):f.isMerchant?w.push({name:"merchant.dashboard"}):w.push({name:"customer.product.detail",params:{id:y.params.id}}):w.push({name:"login",query:{redirect:`/products/${y.params.id}`,action:"participate"}})},k=()=>{f.isAuthenticated?f.isCustomer?w.push({name:"customer.product.detail",params:{id:y.params.id}}):f.isMerchant?w.push({name:"merchant.dashboard"}):w.push({name:"customer.product.detail",params:{id:y.params.id}}):w.push({name:"login",query:{redirect:`/products/${y.params.id}`,action:"buy"}})},U=()=>{if(!f.isAuthenticated){w.push({name:"login",query:{redirect:`/products/${y.params.id}`,action:"wishlist"}});return}window.$toast&&window.$toast.success("Produit ajouté aux favoris !","Favoris")},V=()=>{navigator.share?navigator.share({title:c.value.name,text:c.value.description,url:window.location.href}):(navigator.clipboard.writeText(window.location.href),window.$toast&&window.$toast.success("Lien copié dans le presse-papier !","Partage"))},v=C=>{w.push({name:"public.product.detail",params:{id:C.id}})},d=async(C,x)=>{try{const I=await p(`/products?category_id=${C}&limit=4`);P.value=(I.data||I||[]).filter(N=>N.id!==x).slice(0,4).map(N=>({id:N.id,name:N.name||N.title,price:N.price,ticketPrice:N.ticket_price||0,image:N.image_url||N.main_image||N.image||Ne}))}catch(I){console.warn("Erreur lors du chargement des produits similaires:",I),P.value=[]}},i=async()=>{try{a.value=!0,n.value=null;const C=y.params.id,x=await p(`/products/${C}`);console.log("🔍 Full response:",x),console.log("🔍 Response type:",typeof x),console.log("🔍 Response data field:",x.data);let I=x.data||x;if(console.log("📦 Product data:",I),!I)throw console.error("Product data is null/undefined"),console.error("Full response:",JSON.stringify(x,null,2)),new Error("Produit non trouvé dans la réponse API");const N=I.sale_mode==="lottery";c.value={id:I.id,name:I.name||I.title,description:I.description,price:I.price,ticketPrice:I.ticket_price||0,image:I.image_url||I.main_image||I.image||Ne,category:I.category?.name||I.category?.slug||"Non catégorisé",soldTickets:I.active_lottery?.sold_tickets||0,participants:I.active_lottery?.sold_tickets||0,drawDate:I.active_lottery?.draw_date||I.active_lottery?.end_date,isNew:I.created_at?new Date(I.created_at)>new Date(Date.now()-720*60*60*1e3):!1,activeLottery:I.active_lottery||null,lotteries:I.lotteries||[]},console.log("Product loaded successfully:",c.value.name),console.log("Product data:",JSON.stringify(c.value,null,2)),console.log("hasActiveLottery:",r.value),I.category_id&&await d(I.category_id,I.id)}catch(C){console.error("Erreur lors du chargement du produit:",C),n.value=C.response?.data?.message||"Erreur lors du chargement du produit",c.value=null}finally{a.value=!1}};return ve(()=>{i()}),(C,x)=>{const I=he("router-link");return s(),o("div",Lg,[a.value?(s(),o("div",Vg,x[0]||(x[0]=[pe('<div class="bg-white"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16"><div class="grid grid-cols-1 lg:grid-cols-2 gap-12"><div class="h-96 bg-gray-200 rounded-2xl"></div><div class="space-y-4"><div class="h-8 bg-gray-200 rounded"></div><div class="h-4 bg-gray-200 rounded w-3/4"></div><div class="h-20 bg-gray-200 rounded"></div></div></div></div></div>',1)]))):c.value?(s(),o("div",Rg,[e("div",Fg,[e("div",Ng,[e("nav",zg,[g(I,{to:"/",class:"text-gray-500 hover:text-gray-700"},{default:re(()=>x[1]||(x[1]=[z("Accueil",-1)])),_:1,__:[1]}),x[3]||(x[3]=e("span",{class:"text-gray-400"},"/",-1)),g(I,{to:"/products",class:"text-gray-500 hover:text-gray-700"},{default:re(()=>x[2]||(x[2]=[z("Produits",-1)])),_:1,__:[2]}),x[4]||(x[4]=e("span",{class:"text-gray-400"},"/",-1)),e("span",qg,t(c.value.name),1)])])]),e("div",Ug,[e("div",Bg,[e("div",Og,[e("div",Gg,[g(He,{src:c.value.image_url||c.value.main_image||c.value.image,alt:c.value.name,"container-class":"w-full h-96 lg:h-[500px]","image-class":"w-full h-full object-cover"},null,8,["src","alt"]),r.value?(s(),o("div",Hg,[e("span",Kg,t($(c.value.ticketPrice))+" / ticket ",1)])):(s(),o("div",Wg,x[5]||(x[5]=[e("span",{class:"bg-green-600 text-white px-4 py-2 rounded-full font-semibold"}," Achat direct ",-1)]))),c.value.isNew?(s(),o("div",Jg,x[6]||(x[6]=[e("span",{class:"bg-[#0099cc] text-white px-4 py-2 rounded-full font-semibold"}," Nouveau ",-1)]))):T("",!0)]),c.value.images&&c.value.images.length>1?(s(),o("div",Xg,[(s(!0),o(ie,null,le(c.value.images.slice(0,4),(N,u)=>(s(),o("div",{key:u,class:"relative overflow-hidden rounded-xl bg-gray-100 cursor-pointer hover:ring-2 hover:ring-[#0099cc] transition-all"},[g(He,{src:N,alt:`${c.value.name} - Vue ${u+1}`,"container-class":"w-full h-20","image-class":"w-full h-full object-cover"},null,8,["src","alt"])]))),128))])):T("",!0)]),e("div",Yg,[e("div",null,[e("h1",Qg,t(c.value.name),1),e("div",Zg,[e("span",ef,t(c.value.category),1),e("div",tf,[(s(),o(ie,null,le(5,N=>g(l(ft),{key:N,class:"h-5 w-5 fill-current"})),64)),x[7]||(x[7]=e("span",{class:"ml-2 text-gray-600"},"(4.8)",-1))])]),c.value.merchant?(s(),o("div",sf,[e("div",of,[c.value.merchant.company_name?(s(),o("svg",rf,x[8]||(x[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"},null,-1)]))):(s(),o("svg",af,x[9]||(x[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"},null,-1)])))]),e("div",null,[x[10]||(x[10]=e("p",{class:"text-sm text-gray-600"},"Vendu par",-1)),e("p",nf,t(c.value.merchant.company_name||`${c.value.merchant.first_name} ${c.value.merchant.last_name}`),1)])])):T("",!0)]),e("div",lf,[e("div",df,[e("div",uf,t(r.value?"Valeur du produit":"Prix"),1),e("div",cf,t($(c.value.price)),1),r.value?(s(),o("div",mf,[x[11]||(x[11]=z(" Prix d'un ticket : ",-1)),e("span",pf,t($(c.value.ticketPrice)),1)])):(s(),o("div",gf,x[12]||(x[12]=[e("span",{class:"font-semibold text-green-600"},"Disponible à l'achat direct",-1)])))])]),r.value?(s(),o("div",ff,[x[14]||(x[14]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Progression du tirage",-1)),e("div",vf,[e("div",xf,[x[13]||(x[13]=e("span",{class:"text-gray-600"},"Tickets vendus",-1)),e("span",bf,t(c.value.soldTickets)+" / 1000",1)]),e("div",yf,[e("div",{class:"bg-gradient-to-r from-[#0099cc] to-[#0088bb] h-4 rounded-full transition-all duration-500",style:Me({width:Math.round(c.value.soldTickets/1e3*100)+"%"})},null,4)]),e("div",hf,[e("span",_f,t(Math.round(c.value.soldTickets/1e3*100))+"% vendu",1),e("span",wf,t(1e3-c.value.soldTickets)+" tickets restants",1)])])])):T("",!0),r.value?(s(),o("div",$f,[x[19]||(x[19]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Informations du tirage",-1)),e("div",kf,[e("div",null,[x[15]||(x[15]=e("span",{class:"text-gray-600"},"Date limite :",-1)),e("p",Cf,t(M(c.value.drawDate)),1)]),e("div",null,[x[16]||(x[16]=e("span",{class:"text-gray-600"},"Participants :",-1)),e("p",Af,t(c.value.participants||0),1)]),x[17]||(x[17]=e("div",null,[e("span",{class:"text-gray-600"},"Chances de gagner :"),e("p",{class:"font-semibold text-[#0099cc]"},"1 sur 1000")],-1)),x[18]||(x[18]=e("div",null,[e("span",{class:"text-gray-600"},"Statut :"),e("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-[#0099cc]/10 text-[#0099cc]"}," En cours ")],-1))])])):(s(),o("div",Pf,[x[24]||(x[24]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Achat direct",-1)),e("div",Ef,[e("div",jf,[g(l(be),{class:"h-5 w-5 text-green-600"}),x[20]||(x[20]=e("span",{class:"text-sm text-gray-700"},"Disponible immédiatement",-1))]),e("div",Sf,[g(l(be),{class:"h-5 w-5 text-green-600"}),x[21]||(x[21]=e("span",{class:"text-sm text-gray-700"},"Pas de tirage au sort",-1))]),e("div",If,[g(l(be),{class:"h-5 w-5 text-green-600"}),x[22]||(x[22]=e("span",{class:"text-sm text-gray-700"},"Livraison garantie",-1))]),e("div",Df,[g(l(be),{class:"h-5 w-5 text-green-600"}),x[23]||(x[23]=e("span",{class:"text-sm text-gray-700"},"Paiement sécurisé",-1))])])])),e("div",Tf,[r.value?(s(),o("button",{key:0,onClick:m,class:"w-full bg-[#0099cc] hover:bg-[#0088bb] text-white font-bold py-4 px-8 rounded-xl text-lg transition-all duration-200 hover:scale-[1.02] shadow-lg hover:shadow-xl flex items-center justify-center gap-2"},[g(l(je),{class:"w-5 h-5 flex-shrink-0"}),e("div",Mf,[e("span",null,t(l(f).isAuthenticated?"Participer maintenant":"Se connecter pour participer"),1),e("span",Lf,t($(c.value.ticketPrice)),1)])])):(s(),o("button",{key:1,onClick:k,class:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-8 rounded-xl text-lg transition-all duration-200 hover:scale-[1.02] shadow-lg hover:shadow-xl flex items-center justify-center gap-2"},[g(l(Bt),{class:"w-5 h-5 flex-shrink-0"}),e("div",Vf,[e("span",null,t(l(f).isAuthenticated?"Acheter maintenant":"Se connecter pour acheter"),1),e("span",Rf,t($(c.value.price)),1)])])),e("div",Ff,[e("button",{onClick:U,class:"flex items-center justify-center gap-2 border-2 border-gray-200 hover:border-[#0099cc] text-gray-700 hover:text-[#0099cc] py-3 rounded-xl transition-all",title:l(f).isAuthenticated?"Ajouter aux favoris":"Se connecter pour ajouter aux favoris"},[g(l(Ns),{class:"h-5 w-5"}),z(" "+t((l(f).isAuthenticated,"Favoris")),1)],8,Nf),e("button",{onClick:V,class:"flex items-center justify-center gap-2 border-2 border-gray-200 hover:border-[#0099cc] text-gray-700 hover:text-[#0099cc] py-3 rounded-xl transition-all"},[g(l(zs),{class:"h-5 w-5"}),x[25]||(x[25]=z(" Partager ",-1))])])]),e("div",zf,[e("div",qf,[g(l(ut),{class:"h-5 w-5 text-[#0099cc]"}),x[26]||(x[26]=e("span",null,"Produit garanti",-1))]),e("div",Uf,[g(l(Ut),{class:"h-5 w-5 text-[#0099cc]"}),x[27]||(x[27]=e("span",null,"Livraison gratuite",-1))]),e("div",Bf,[g(l(ls),{class:"h-5 w-5 text-[#0099cc]"}),x[28]||(x[28]=e("span",null,"Authentique",-1))])])])]),e("div",Of,[e("div",Gf,[x[35]||(x[35]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-6"},"Description",-1)),e("div",Hf,[e("p",Kf,t(c.value.description),1),x[33]||(x[33]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-4"},"Caractéristiques principales",-1)),e("ul",Wf,[e("li",Jf,[g(l(be),{class:"h-5 w-5 text-[#0099cc] mt-0.5"}),x[29]||(x[29]=e("span",null,"Produit neuf avec garantie constructeur",-1))]),e("li",Xf,[g(l(be),{class:"h-5 w-5 text-[#0099cc] mt-0.5"}),x[30]||(x[30]=e("span",null,"Livraison express partout au Cameroun",-1))]),e("li",Yf,[g(l(be),{class:"h-5 w-5 text-[#0099cc] mt-0.5"}),x[31]||(x[31]=e("span",null,"Service client disponible 24h/7j",-1))]),e("li",Qf,[g(l(be),{class:"h-5 w-5 text-[#0099cc] mt-0.5"}),x[32]||(x[32]=e("span",null,"Certification d'authenticité incluse",-1))])]),x[34]||(x[34]=pe('<h3 class="text-xl font-semibold text-gray-900 mb-4">Comment participer ?</h3><div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"><div class="text-center p-4 bg-[#0099cc]/5 rounded-xl"><div class="w-12 h-12 bg-[#0099cc] text-white rounded-full flex items-center justify-center mx-auto mb-3 font-bold text-lg">1</div><h4 class="font-semibold mb-2">Achetez vos tickets</h4><p class="text-sm text-gray-600">Choisissez le nombre de tickets que vous souhaitez</p></div><div class="text-center p-4 bg-[#0099cc]/5 rounded-xl"><div class="w-12 h-12 bg-[#0099cc] text-white rounded-full flex items-center justify-center mx-auto mb-3 font-bold text-lg">2</div><h4 class="font-semibold mb-2">Attendez le tirage</h4><p class="text-sm text-gray-600">Le tirage se fait automatiquement à la date prévue</p></div><div class="text-center p-4 bg-[#0099cc]/5 rounded-xl"><div class="w-12 h-12 bg-[#0099cc] text-white rounded-full flex items-center justify-center mx-auto mb-3 font-bold text-lg">3</div><h4 class="font-semibold mb-2">Récupérez votre lot</h4><p class="text-sm text-gray-600">Si vous gagnez, nous vous livrons gratuitement</p></div></div>',2))])]),e("div",Zf,[e("div",ev,[x[39]||(x[39]=e("h3",{class:"font-semibold text-gray-900 mb-4"},"Statistiques",-1)),e("div",tv,[e("div",sv,[x[36]||(x[36]=e("span",{class:"text-gray-600"},"Participants uniques",-1)),e("span",ov,t(c.value.participants||0),1)]),e("div",rv,[x[37]||(x[37]=e("span",{class:"text-gray-600"},"Tickets moyens/personne",-1)),e("span",av,t(Math.round(c.value.soldTickets/Math.max(c.value.participants||1,1))),1)]),e("div",nv,[x[38]||(x[38]=e("span",{class:"text-gray-600"},"Temps restant",-1)),e("span",iv,t(D()),1)])])]),e("div",lv,[x[44]||(x[44]=e("h3",{class:"font-semibold text-gray-900 mb-4"},"Pourquoi Koumbaya ?",-1)),e("div",dv,[e("div",uv,[g(l(be),{class:"h-4 w-4 text-[#0099cc] mt-0.5"}),x[40]||(x[40]=e("span",null,"Tirages transparents et vérifiables",-1))]),e("div",cv,[g(l(be),{class:"h-4 w-4 text-[#0099cc] mt-0.5"}),x[41]||(x[41]=e("span",null,"Paiement 100% sécurisé",-1))]),e("div",mv,[g(l(be),{class:"h-4 w-4 text-[#0099cc] mt-0.5"}),x[42]||(x[42]=e("span",null,"Support client réactif",-1))]),e("div",pv,[g(l(be),{class:"h-4 w-4 text-[#0099cc] mt-0.5"}),x[43]||(x[43]=e("span",null,"Plus de 10 000+ gagnants",-1))])])])])])]),e("section",gv,[e("div",fv,[x[45]||(x[45]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-8"},"Produits similaires",-1)),e("div",vv,[(s(!0),o(ie,null,le(P.value,N=>(s(),o("div",{key:N.id,onClick:u=>v(N),class:"bg-white rounded-2xl p-6 shadow-sm hover:shadow-lg transition-all cursor-pointer"},[e("div",bv,[g(He,{src:N.image,alt:N.name,"container-class":"w-full h-40","image-class":"w-full h-full object-cover"},null,8,["src","alt"]),e("div",yv,[e("span",hv,t($(N.ticketPrice)),1)])]),e("h3",_v,t(N.name),1),e("div",wv,t($(N.price)),1)],8,xv))),128))])])])])):(s(),o("div",$v,[e("div",kv,[e("div",Cv,[g(l(Se),{class:"w-16 h-16 text-gray-400"})]),e("h3",Av,t(n.value?"Erreur de chargement":"Produit introuvable"),1),e("p",Pv,t(n.value||"Ce produit n'existe pas ou a été supprimé"),1),e("div",Ev,[n.value?(s(),o("button",{key:0,onClick:i,class:"bg-[#0099cc] hover:bg-[#0088bb] text-white px-6 py-3 rounded-xl transition-colors mr-4"}," Réessayer ")):T("",!0),g(I,{to:"/products",class:"bg-[#0099cc] hover:bg-[#0088bb] text-white px-6 py-3 rounded-xl transition-colors"},{default:re(()=>x[46]||(x[46]=[z(" Retour aux produits ",-1)])),_:1,__:[46]})])])]))])}}},Sv={class:"min-h-screen bg-white"},Iv={class:"py-20"},Dv={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Tv={class:"grid grid-cols-1 lg:grid-cols-3 gap-8 lg:gap-12"},Mv={class:"relative text-center group"},Lv={class:"relative mx-auto w-32 h-32 mb-8"},Vv={class:"hidden lg:block absolute -right-16 top-1/2 transform -translate-y-1/2"},Rv={class:"mt-6 bg-[#0099cc]/5 rounded-xl p-4"},Fv={class:"flex items-center justify-center gap-2 text-[#0099cc] font-medium"},Nv={class:"relative text-center group"},zv={class:"relative mx-auto w-32 h-32 mb-8"},qv={class:"hidden lg:block absolute -right-16 top-1/2 transform -translate-y-1/2"},Uv={class:"mt-6 bg-[#0099cc]/5 rounded-xl p-4"},Bv={class:"flex items-center justify-center gap-2 text-[#0099cc] font-medium"},Ov={class:"relative text-center group"},Gv={class:"mt-6 bg-yellow-50 rounded-xl p-4"},Hv={class:"flex items-center justify-center gap-2 text-yellow-700 font-medium"},Kv={class:"py-20 bg-gray-50"},Wv={class:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},Jv={class:"grid grid-cols-1 md:grid-cols-2 gap-12 items-center"},Xv={class:"space-y-6"},Yv={class:"flex gap-4"},Qv={class:"flex-shrink-0"},Zv={class:"w-12 h-12 bg-[#0099cc] rounded-full flex items-center justify-center"},ex={class:"flex gap-4"},tx={class:"flex-shrink-0"},sx={class:"w-12 h-12 bg-[#0099cc] rounded-full flex items-center justify-center"},ox={class:"flex gap-4"},rx={class:"flex-shrink-0"},ax={class:"w-12 h-12 bg-[#0099cc] rounded-full flex items-center justify-center"},nx={class:"flex gap-4"},ix={class:"flex-shrink-0"},lx={class:"w-12 h-12 bg-[#0099cc] rounded-full flex items-center justify-center"},dx={class:"relative"},ux={class:"bg-white rounded-2xl p-8 shadow-xl border border-gray-100"},cx={class:"text-center mb-6"},mx={class:"w-20 h-20 bg-[#0099cc]/10 rounded-full flex items-center justify-center mx-auto mb-4"},px={class:"space-y-4"},gx={class:"bg-gray-50 rounded-lg p-4"},fx={class:"flex items-center justify-between mb-2"},vx={class:"bg-gray-50 rounded-lg p-4"},xx={class:"flex items-center justify-between mb-2"},bx={class:"bg-[#0099cc]/5 rounded-lg p-4 border border-[#0099cc]/20"},yx={class:"flex items-center justify-between mb-2"},hx={class:"py-20"},_x={class:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},wx={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"},$x={class:"bg-white rounded-2xl p-8 shadow-lg border border-gray-100"},kx={class:"w-16 h-16 bg-[#0099cc]/10 rounded-full flex items-center justify-center mx-auto mb-6"},Cx={class:"space-y-3 text-gray-600"},Ax={class:"flex items-center gap-3"},Px={class:"flex items-center gap-3"},Ex={class:"flex items-center gap-3"},jx={class:"flex items-center gap-3"},Sx={class:"bg-white rounded-2xl p-8 shadow-lg border border-gray-100"},Ix={class:"w-16 h-16 bg-[#0099cc]/10 rounded-full flex items-center justify-center mx-auto mb-6"},Dx={class:"space-y-3 text-gray-600"},Tx={class:"flex items-center gap-3"},Mx={class:"flex items-center gap-3"},Lx={class:"flex items-center gap-3"},Vx={class:"flex items-center gap-3"},Rx={class:"bg-white rounded-2xl p-8 shadow-lg border border-gray-100"},Fx={class:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-6"},Nx={class:"space-y-3 text-gray-600"},zx={class:"flex items-center gap-3"},qx={class:"flex items-center gap-3"},Ux={class:"flex items-center gap-3"},Bx={class:"flex items-center gap-3"},Ox={class:"py-20 bg-gray-50"},Gx={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"},Hx={class:"space-y-6"},Kx=["onClick"],Wx={class:"text-lg font-semibold text-gray-900"},Jx={class:"py-20 bg-gradient-to-r from-[#0099cc] to-[#0088bb]"},Xx={class:"max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8"},Yx={class:"flex flex-col sm:flex-row gap-4 justify-center"},Qx={__name:"HowItWorks",setup(_){const y=R(null),w=R([{question:"Comment puis-je être sûr que le tirage est équitable ?",answer:"Notre système utilise un générateur de nombres aléatoires (RNG) certifié et audité régulièrement par des organismes indépendants. Tous les tirages sont enregistrés et vérifiables publiquement."},{question:"Que se passe-t-il si je gagne ?",answer:"Vous êtes immédiatement notifié par email et SMS. Notre équipe vous contacte dans les 24h pour organiser la livraison gratuite de votre lot. Vous recevez aussi un certificat d'authenticité."},{question:"Puis-je acheter plusieurs tickets pour le même produit ?",answer:"Oui, absolument ! Plus vous achetez de tickets, plus vous augmentez vos chances de gagner. Il n'y a pas de limite au nombre de tickets que vous pouvez acheter."},{question:"Les produits sont-ils vraiment authentiques ?",answer:"Tous nos produits sont 100% authentiques et neufs. Nous travaillons directement avec les distributeurs officiels et fournissons un certificat d'authenticité avec chaque lot."},{question:"Combien de temps ai-je pour réclamer mon lot ?",answer:"Vous avez 30 jours pour réclamer votre lot après le tirage. Passé ce délai, un nouveau tirage est organisé avec les tickets non gagnants."},{question:"Y a-t-il des frais cachés ?",answer:"Aucun frais caché ! Le prix affiché est le prix final. La livraison est gratuite partout au Gabon, et il n'y a aucun frais supplémentaire."}]),p=f=>{y.value=y.value===f?null:f};return(f,a)=>{const c=he("router-link");return s(),o("div",Sv,[a[47]||(a[47]=e("section",{class:"bg-gradient-to-br from-[#0099cc] via-[#0088bb] to-[#0099cc] text-white py-20"},[e("div",{class:"max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8"},[e("h1",{class:"text-4xl md:text-6xl font-bold mb-6"}," Comment ça marche ? "),e("p",{class:"text-xl md:text-2xl text-blue-100 leading-relaxed max-w-3xl mx-auto"}," Découvrez comment obtenir des produits incroyables à prix réduit en quelques clics seulement. C'est simple, transparent et malin ! ")])],-1)),e("section",Iv,[e("div",Dv,[a[12]||(a[12]=e("div",{class:"text-center mb-16"},[e("h2",{class:"text-3xl md:text-4xl font-bold text-gray-900 mb-4"}," 3 étapes pour acheter malin "),e("p",{class:"text-xl text-gray-600 max-w-3xl mx-auto"}," Notre système de tombola est conçu pour être simple et équitable pour tous les participants ")],-1)),e("div",Tv,[e("div",Mv,[e("div",Lv,[a[0]||(a[0]=e("div",{class:"absolute inset-0 bg-[#0099cc]/10 rounded-full"},null,-1)),a[1]||(a[1]=e("div",{class:"absolute inset-2 bg-[#0099cc] rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300"},[e("span",{class:"text-4xl font-bold text-white"},"1")],-1)),e("div",Vv,[g(l(Ze),{class:"h-8 w-8 text-[#0099cc]/30"})])]),a[3]||(a[3]=e("h3",{class:"text-2xl font-bold text-gray-900 mb-4"},"Choisissez votre produit",-1)),a[4]||(a[4]=e("p",{class:"text-gray-600 leading-relaxed"}," Parcourez notre catalogue de produits authentiques : smartphones, ordinateurs, voitures, montres de luxe et bien plus encore. ",-1)),e("div",Rv,[e("div",Fv,[g(l(qe),{class:"h-5 w-5"}),a[2]||(a[2]=e("span",null,"Plus de 100 produits disponibles",-1))])])]),e("div",Nv,[e("div",zv,[a[5]||(a[5]=e("div",{class:"absolute inset-0 bg-[#0099cc]/10 rounded-full"},null,-1)),a[6]||(a[6]=e("div",{class:"absolute inset-2 bg-[#0099cc] rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300"},[e("span",{class:"text-4xl font-bold text-white"},"2")],-1)),e("div",qv,[g(l(Ze),{class:"h-8 w-8 text-[#0099cc]/30"})])]),a[8]||(a[8]=e("h3",{class:"text-2xl font-bold text-gray-900 mb-4"},"Achetez vos tickets",-1)),a[9]||(a[9]=e("p",{class:"text-gray-600 leading-relaxed"}," Chaque produit a un prix de ticket unique. Plus vous achetez de tickets, plus vous augmentez vos chances d'obtenir le produit à prix réduit. ",-1)),e("div",Uv,[e("div",Bv,[g(l(je),{class:"h-5 w-5"}),a[7]||(a[7]=e("span",null,"Tickets à partir de 500 FCFA",-1))])])]),e("div",Ov,[a[11]||(a[11]=pe('<div class="relative mx-auto w-32 h-32 mb-8"><div class="absolute inset-0 bg-yellow-100 rounded-full"></div><div class="absolute inset-2 bg-yellow-500 rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300"><span class="text-4xl font-bold text-white">3</span></div></div><h3 class="text-2xl font-bold text-gray-900 mb-4">Obtenez votre produit</h3><p class="text-gray-600 leading-relaxed"> Le tirage se fait automatiquement quand tous les tickets sont vendus. Si vous obtenez le produit, nous vous livrons gratuitement ! </p>',3)),e("div",Gv,[e("div",Hv,[g(l(ot),{class:"h-5 w-5"}),a[10]||(a[10]=e("span",null,"Livraison gratuite partout",-1))])])])])])]),e("section",Kv,[e("div",Wv,[a[25]||(a[25]=e("div",{class:"text-center mb-16"},[e("h2",{class:"text-3xl md:text-4xl font-bold text-gray-900 mb-4"}," Comment fonctionne notre tombola ? "),e("p",{class:"text-xl text-gray-600"}," Notre système de tombola est 100% équitable et transparent ")],-1)),e("div",Jv,[e("div",Xv,[e("div",Yv,[e("div",Qv,[e("div",Zv,[g(l(be),{class:"h-6 w-6 text-white"})])]),a[13]||(a[13]=e("div",null,[e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"Tirage automatique"),e("p",{class:"text-gray-600"}," Dès que tous les tickets sont vendus, le tirage se lance automatiquement. Aucune intervention humaine possible. ")],-1))]),e("div",ex,[e("div",tx,[e("div",sx,[g(l(Ue),{class:"h-6 w-6 text-white"})])]),a[14]||(a[14]=e("div",null,[e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"Transparence totale"),e("p",{class:"text-gray-600"}," Tous les tirages sont enregistrés et vérifiables. Vous pouvez consulter l'historique à tout moment. ")],-1))]),e("div",ox,[e("div",rx,[e("div",ax,[g(l(ut),{class:"h-6 w-6 text-white"})])]),a[15]||(a[15]=e("div",null,[e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"Sécurité garantie"),e("p",{class:"text-gray-600"}," Notre algorithme de tirage est certifié et audité régulièrement pour assurer une équité parfaite. ")],-1))]),e("div",nx,[e("div",ix,[e("div",lx,[g(l(Gt),{class:"h-6 w-6 text-white"})])]),a[16]||(a[16]=e("div",null,[e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"Notification immédiate"),e("p",{class:"text-gray-600"}," Les participants sélectionnés sont notifiés instantanément par email et SMS. Plus besoin d'attendre ! ")],-1))])]),e("div",dx,[e("div",ux,[e("div",cx,[e("div",mx,[g(l(qs),{class:"h-10 w-10 text-[#0099cc]"})]),a[17]||(a[17]=e("h3",{class:"text-xl font-semibold text-gray-900"},"Algorithme RNG",-1)),a[18]||(a[18]=e("p",{class:"text-gray-600 text-sm mt-2"},"Générateur de nombres aléatoires certifié",-1))]),e("div",px,[e("div",gx,[e("div",fx,[a[19]||(a[19]=e("span",{class:"text-sm text-gray-600"},"Étape 1",-1)),g(l(be),{class:"h-4 w-4 text-[#0099cc]"})]),a[20]||(a[20]=e("div",{class:"text-sm font-medium text-gray-900"},"Collecte des tickets vendus",-1))]),e("div",vx,[e("div",xx,[a[21]||(a[21]=e("span",{class:"text-sm text-gray-600"},"Étape 2",-1)),g(l(be),{class:"h-4 w-4 text-[#0099cc]"})]),a[22]||(a[22]=e("div",{class:"text-sm font-medium text-gray-900"},"Génération nombre aléatoire",-1))]),e("div",bx,[e("div",yx,[a[23]||(a[23]=e("span",{class:"text-sm text-[#0099cc]"},"Étape 3",-1)),g(l(ht),{class:"h-4 w-4 text-[#0099cc]"})]),a[24]||(a[24]=e("div",{class:"text-sm font-medium text-gray-900"},"Désignation du participant sélectionné",-1))])])])])])])]),e("section",hx,[e("div",_x,[a[41]||(a[41]=e("div",{class:"text-center mb-16"},[e("h2",{class:"text-3xl md:text-4xl font-bold text-gray-900 mb-4"}," Paiement sécurisé et livraison "),e("p",{class:"text-xl text-gray-600"}," Vos transactions sont protégées par les meilleurs systèmes de sécurité ")],-1)),e("div",wx,[e("div",$x,[e("div",kx,[g(l(Xe),{class:"h-8 w-8 text-[#0099cc]"})]),a[30]||(a[30]=e("h3",{class:"text-xl font-semibold text-gray-900 text-center mb-4"},"Moyens de paiement",-1)),e("ul",Cx,[e("li",Ax,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[26]||(a[26]=e("span",null,"Mobile Money (MTN, Orange)",-1))]),e("li",Px,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[27]||(a[27]=e("span",null,"Carte bancaire Visa/Mastercard",-1))]),e("li",Ex,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[28]||(a[28]=e("span",null,"Virement bancaire",-1))]),e("li",jx,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[29]||(a[29]=e("span",null,"Portefeuille électronique",-1))])])]),e("div",Sx,[e("div",Ix,[g(l(qt),{class:"h-8 w-8 text-[#0099cc]"})]),a[35]||(a[35]=e("h3",{class:"text-xl font-semibold text-gray-900 text-center mb-4"},"Sécurité des données",-1)),e("ul",Dx,[e("li",Tx,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[31]||(a[31]=e("span",null,"Chiffrement SSL 256 bits",-1))]),e("li",Mx,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[32]||(a[32]=e("span",null,"Conformité PCI DSS",-1))]),e("li",Lx,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[33]||(a[33]=e("span",null,"Authentification 2 facteurs",-1))]),e("li",Vx,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[34]||(a[34]=e("span",null,"Protection anti-fraude",-1))])])]),e("div",Rx,[e("div",Fx,[g(l(Ut),{class:"h-8 w-8 text-yellow-500"})]),a[40]||(a[40]=e("h3",{class:"text-xl font-semibold text-gray-900 text-center mb-4"},"Livraison gratuite",-1)),e("ul",Nx,[e("li",zx,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[36]||(a[36]=e("span",null,"Livraison partout au Gabon",-1))]),e("li",qx,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[37]||(a[37]=e("span",null,"Suivi en temps réel",-1))]),e("li",Ux,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[38]||(a[38]=e("span",null,"Délai 24-48h en ville",-1))]),e("li",Bx,[g(l(be),{class:"h-4 w-4 text-[#0099cc]"}),a[39]||(a[39]=e("span",null,"Assurance colis incluse",-1))])])])])])]),e("section",Ox,[e("div",Gx,[a[42]||(a[42]=e("div",{class:"text-center mb-16"},[e("h2",{class:"text-3xl md:text-4xl font-bold text-gray-900 mb-4"}," Questions fréquentes "),e("p",{class:"text-xl text-gray-600"}," Trouvez rapidement les réponses à vos questions ")],-1)),e("div",Hx,[(s(!0),o(ie,null,le(w.value,(n,r)=>(s(),o("div",{key:r,class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},[e("button",{onClick:P=>p(r),class:"w-full px-8 py-6 text-left flex items-center justify-between hover:bg-gray-50 transition-colors"},[e("span",Wx,t(n.question),1),g(l($t),{class:te(["h-6 w-6 text-gray-400 transition-transform",y.value===r?"rotate-180":""])},null,8,["class"])],8,Kx),Q(e("div",{class:"px-8 pb-6 text-gray-600 leading-relaxed"},t(n.answer),513),[[Us,y.value===r]])]))),128))])])]),e("section",Jx,[e("div",Xx,[a[45]||(a[45]=e("h2",{class:"text-3xl md:text-4xl font-bold text-white mb-6"}," Prêt à acheter malin ? ",-1)),a[46]||(a[46]=e("p",{class:"text-xl text-blue-100 mb-8"}," Rejoignez les milliers de participants qui ont déjà acheté malin ",-1)),e("div",Yx,[g(c,{to:"/products",class:"bg-white text-[#0099cc] px-8 py-4 rounded-xl font-semibold hover:bg-gray-50 transition-colors shadow-lg"},{default:re(()=>a[43]||(a[43]=[z(" Voir les produits ",-1)])),_:1,__:[43]}),g(c,{to:"/register",class:"border-2 border-white text-white px-8 py-4 rounded-xl font-semibold hover:bg-white hover:text-[#0099cc] transition-all"},{default:re(()=>a[44]||(a[44]=[z(" S'inscrire gratuitement ",-1)])),_:1,__:[44]})])])])])}}},Zx={class:"min-h-screen bg-white"},e1={class:"py-20"},t1={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},s1={class:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-16"},o1={class:"text-center group"},r1={class:"w-20 h-20 bg-[#0099cc]/10 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:bg-[#0099cc] transition-colors"},a1={class:"text-center group"},n1={class:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:bg-blue-500 transition-colors"},i1={class:"text-center group"},l1={class:"w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-6 group-hover:bg-yellow-500 transition-colors"},d1={class:"py-20 bg-gray-50"},u1={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},c1={class:"grid grid-cols-1 lg:grid-cols-2 gap-16"},m1={class:"bg-white rounded-2xl p-8 shadow-lg"},p1={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},g1={key:0,class:"text-red-500 text-sm mt-1"},f1={key:0,class:"text-red-500 text-sm mt-1"},v1={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},x1={key:0,class:"text-red-500 text-sm mt-1"},b1={key:0,class:"text-red-500 text-sm mt-1"},y1={class:"flex items-start gap-3"},h1={for:"agree",class:"text-sm text-gray-600"},_1=["disabled"],w1={key:0,class:"flex items-center justify-center gap-2"},$1={key:1},k1={class:"space-y-8"},C1={class:"bg-white rounded-2xl p-8 shadow-lg"},A1={class:"space-y-6"},P1={class:"flex gap-4"},E1={class:"flex-shrink-0"},j1={class:"w-12 h-12 bg-[#0099cc]/10 rounded-full flex items-center justify-center"},S1={class:"flex gap-4"},I1={class:"flex-shrink-0"},D1={class:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center"},T1={class:"bg-gradient-to-br from-[#0099cc] to-cyan-600 rounded-2xl p-8 text-white"},M1={class:"grid grid-cols-2 gap-4"},L1={href:"tel:+24107123456",class:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-4 hover:bg-white/20 transition-colors"},V1={href:"https://wa.me/24107123456",target:"_blank",class:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-4 hover:bg-white/20 transition-colors"},R1={class:"bg-gray-100 rounded-2xl p-8"},F1={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},N1={class:"flex items-center justify-center min-h-screen px-4 text-center"},z1={class:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle bg-white shadow-xl rounded-2xl transform transition-all"},q1={class:"text-center"},U1={class:"w-16 h-16 bg-[#0099cc]/10 rounded-full flex items-center justify-center mx-auto mb-4"},B1={__name:"Contact",setup(_){const y=R(!1),w=R(!1),p=xe({name:"",email:"",phone:"",subject:"",message:"",agree:!1}),f=xe({name:"",email:"",subject:"",message:""}),a=()=>{let n=!0;return Object.keys(f).forEach(r=>{f[r]=""}),p.name.trim()?p.name.trim().length<2&&(f.name="Le nom doit contenir au moins 2 caractères",n=!1):(f.name="Le nom est requis",n=!1),p.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(p.email)||(f.email="Format d'email invalide",n=!1):(f.email="L'email est requis",n=!1),p.subject||(f.subject="Veuillez sélectionner un sujet",n=!1),p.message.trim()?p.message.trim().length<10&&(f.message="Le message doit contenir au moins 10 caractères",n=!1):(f.message="Le message est requis",n=!1),n},c=async()=>{if(a()){y.value=!0;try{await new Promise(n=>setTimeout(n,1500)),Object.keys(p).forEach(n=>{n==="agree"?p[n]=!1:p[n]=""}),w.value=!0,window.$toast&&window.$toast.success("Message envoyé avec succès !","Contact")}catch{window.$toast&&window.$toast.error("Erreur lors de l'envoi du message","Erreur")}finally{y.value=!1}}};return(n,r)=>{const P=he("router-link");return s(),o("div",Zx,[r[37]||(r[37]=e("section",{class:"bg-gradient-to-br from-[#0099cc] via-[#0088bb] to-[#0077aa] text-white py-20"},[e("div",{class:"max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8"},[e("h1",{class:"text-4xl md:text-6xl font-bold mb-6"}," Contactez-nous "),e("p",{class:"text-xl md:text-2xl text-blue-100 leading-relaxed"}," Notre équipe est là pour répondre à toutes vos questions. N'hésitez pas à nous contacter ! ")])],-1)),e("section",e1,[e("div",t1,[e("div",s1,[e("div",o1,[e("div",r1,[g(l(et),{class:"h-10 w-10 text-[#0099cc] group-hover:text-white transition-colors"})]),r[8]||(r[8]=pe('<h3 class="text-xl font-semibold text-gray-900 mb-2">Téléphone</h3><p class="text-gray-600 mb-4">Appelez-nous directement</p><div class="space-y-2"><a href="tel:+24107123456" class="block text-[#0099cc] hover:text-[#0088bb] font-medium"> +241 07 12 34 56 </a><a href="tel:+24106987654" class="block text-[#0099cc] hover:text-[#0088bb] font-medium"> +241 06 98 76 54 </a></div><p class="text-sm text-gray-500 mt-2">Lun - Ven : 8h - 20h</p>',4))]),e("div",a1,[e("div",n1,[g(l(lt),{class:"h-10 w-10 text-blue-500 group-hover:text-white transition-colors"})]),r[9]||(r[9]=pe('<h3 class="text-xl font-semibold text-gray-900 mb-2">Email</h3><p class="text-gray-600 mb-4">Écrivez-nous un message</p><div class="space-y-2"><a href="mailto:contact@koumbaya.ga" class="block text-blue-600 hover:text-blue-700 font-medium"> contact@koumbaya.ga </a><a href="mailto:support@koumbaya.ga" class="block text-blue-600 hover:text-blue-700 font-medium"> support@koumbaya.ga </a></div><p class="text-sm text-gray-500 mt-2">Réponse sous 24h</p>',4))]),e("div",i1,[e("div",l1,[g(l(Zt),{class:"h-10 w-10 text-yellow-500 group-hover:text-white transition-colors"})]),r[10]||(r[10]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"WhatsApp",-1)),r[11]||(r[11]=e("p",{class:"text-gray-600 mb-4"},"Chat en temps réel",-1)),r[12]||(r[12]=e("a",{href:"https://wa.me/24107123456",target:"_blank",class:"inline-block bg-[#0099cc] text-white px-6 py-3 rounded-xl font-medium hover:bg-[#0088bb] transition-colors"}," Chatter maintenant ",-1)),r[13]||(r[13]=e("p",{class:"text-sm text-gray-500 mt-2"},"Disponible 24h/7j",-1))])])])]),e("section",d1,[e("div",u1,[e("div",c1,[e("div",m1,[r[24]||(r[24]=e("div",{class:"mb-8"},[e("h2",{class:"text-2xl md:text-3xl font-bold text-gray-900 mb-4"}," Envoyez-nous un message "),e("p",{class:"text-gray-600"}," Remplissez le formulaire ci-dessous et nous vous répondrons dans les plus brefs délais. ")],-1)),e("form",{onSubmit:_e(c,["prevent"]),class:"space-y-6"},[e("div",p1,[e("div",null,[r[14]||(r[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Nom complet * ",-1)),Q(e("input",{"onUpdate:modelValue":r[0]||(r[0]=$=>p.name=$),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",placeholder:"Votre nom"},null,512),[[ne,p.name]]),f.name?(s(),o("div",g1,t(f.name),1)):T("",!0)]),e("div",null,[r[15]||(r[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Adresse email * ",-1)),Q(e("input",{"onUpdate:modelValue":r[1]||(r[1]=$=>p.email=$),type:"email",required:"",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all",placeholder:"votre@email.com"},null,512),[[ne,p.email]]),f.email?(s(),o("div",f1,t(f.email),1)):T("",!0)])]),e("div",v1,[e("div",null,[r[16]||(r[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Numéro de téléphone ",-1)),g(tt,{modelValue:p.phone,"onUpdate:modelValue":r[2]||(r[2]=$=>p.phone=$),placeholder:"Numéro de téléphone","initial-country":"ga"},null,8,["modelValue"])]),e("div",null,[r[18]||(r[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Sujet * ",-1)),Q(e("select",{"onUpdate:modelValue":r[3]||(r[3]=$=>p.subject=$),required:"",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all"},r[17]||(r[17]=[pe('<option value="">Choisir un sujet</option><option value="support">Support technique</option><option value="billing">Facturation</option><option value="product">Question sur un produit</option><option value="tombola">Question sur une tombola</option><option value="delivery">Livraison</option><option value="partnership">Partenariat</option><option value="other">Autre</option>',8)]),512),[[me,p.subject]]),f.subject?(s(),o("div",x1,t(f.subject),1)):T("",!0)])]),e("div",null,[r[19]||(r[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Message * ",-1)),Q(e("textarea",{"onUpdate:modelValue":r[4]||(r[4]=$=>p.message=$),required:"",rows:"6",class:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#0099cc] focus:border-transparent transition-all resize-none",placeholder:"Décrivez votre demande en détail..."},null,512),[[ne,p.message]]),f.message?(s(),o("div",b1,t(f.message),1)):T("",!0)]),e("div",y1,[Q(e("input",{"onUpdate:modelValue":r[5]||(r[5]=$=>p.agree=$),type:"checkbox",id:"agree",required:"",class:"mt-1 h-4 w-4 text-[#0099cc] border-gray-200 rounded focus:ring-[#0099cc]"},null,512),[[Ae,p.agree]]),e("label",h1,[r[21]||(r[21]=z(" J'accepte que mes données soient utilisées pour traiter ma demande selon notre ",-1)),g(P,{to:"/privacy",class:"text-[#0099cc] hover:text-[#0088bb]"},{default:re(()=>r[20]||(r[20]=[z("politique de confidentialité",-1)])),_:1,__:[20]}),r[22]||(r[22]=z(". ",-1))])]),e("button",{type:"submit",disabled:y.value,class:"w-full bg-[#0099cc] hover:bg-[#0088bb] disabled:opacity-50 text-white font-semibold py-4 rounded-xl transition-all duration-200 hover:scale-[1.02] shadow-lg hover:shadow-xl"},[y.value?(s(),o("span",w1,r[23]||(r[23]=[e("div",{class:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"},null,-1),z(" Envoi en cours... ",-1)]))):(s(),o("span",$1,"Envoyer le message"))],8,_1)],32)]),e("div",k1,[e("div",C1,[r[27]||(r[27]=e("h3",{class:"text-2xl font-bold text-gray-900 mb-6"},"Nos bureaux",-1)),e("div",A1,[e("div",P1,[e("div",E1,[e("div",j1,[g(l(Rt),{class:"h-6 w-6 text-[#0099cc]"})])]),r[25]||(r[25]=e("div",null,[e("h4",{class:"font-semibold text-gray-900 mb-2"},"Libreville (Siège social)"),e("p",{class:"text-gray-600 mb-2"},[z(" Boulevard Triomphal, Centre-ville"),e("br"),z(" Face à l'Hôtel Intercontinental"),e("br"),z(" BP 1234 Libreville, Gabon ")]),e("div",{class:"text-sm text-gray-500"},[e("p",null,"Lun - Ven : 8h00 - 18h00"),e("p",null,"Sam : 9h00 - 15h00")])],-1))]),e("div",S1,[e("div",I1,[e("div",D1,[g(l(Rt),{class:"h-6 w-6 text-blue-500"})])]),r[26]||(r[26]=e("div",null,[e("h4",{class:"font-semibold text-gray-900 mb-2"},"Port-Gentil"),e("p",{class:"text-gray-600 mb-2"},[z(" Avenue Savorgnan de Brazza"),e("br"),z(" Centre Commercial Delta"),e("br"),z(" BP 5678 Port-Gentil, Gabon ")]),e("div",{class:"text-sm text-gray-500"},[e("p",null,"Lun - Ven : 8h30 - 17h30"),e("p",null,"Sam : 9h00 - 14h00")])],-1))])])]),e("div",T1,[r[30]||(r[30]=e("h3",{class:"text-2xl font-bold mb-4"},"Besoin d'une réponse rapide ?",-1)),r[31]||(r[31]=e("p",{class:"text-blue-100 mb-6"}," Notre équipe de support est disponible pour vous aider immédiatement. ",-1)),e("div",M1,[e("a",L1,[g(l(et),{class:"h-6 w-6"}),r[28]||(r[28]=e("div",{class:"text-left"},[e("div",{class:"font-medium"},"Appelez-nous"),e("div",{class:"text-sm text-blue-100"},"24h/7j")],-1))]),e("a",V1,[g(l(Zt),{class:"h-6 w-6"}),r[29]||(r[29]=e("div",{class:"text-left"},[e("div",{class:"font-medium"},"WhatsApp"),e("div",{class:"text-sm text-blue-100"},"Chat live")],-1))])])]),e("div",R1,[r[33]||(r[33]=e("h3",{class:"text-xl font-semibold text-gray-900 mb-4"},"Consultez d'abord notre FAQ",-1)),r[34]||(r[34]=e("p",{class:"text-gray-600 mb-6"}," La plupart des questions trouvent leur réponse dans notre section FAQ. ",-1)),g(P,{to:"/how-it-works",class:"inline-flex items-center gap-2 bg-white text-gray-900 px-6 py-3 rounded-xl font-medium hover:bg-gray-50 transition-colors shadow-sm"},{default:re(()=>[g(l(ds),{class:"h-5 w-5"}),r[32]||(r[32]=z(" Voir les questions fréquentes ",-1))]),_:1,__:[32]})])])])])]),w.value?(s(),o("div",F1,[e("div",N1,[e("div",{class:"fixed inset-0 bg-black/40 transition-opacity",onClick:r[6]||(r[6]=$=>w.value=!1)}),e("div",z1,[e("div",q1,[e("div",U1,[g(l(Re),{class:"h-8 w-8 text-[#0099cc]"})]),r[35]||(r[35]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"Message envoyé !",-1)),r[36]||(r[36]=e("p",{class:"text-gray-600 mb-6"}," Merci pour votre message. Nous vous répondrons dans les plus brefs délais. ",-1)),e("button",{onClick:r[7]||(r[7]=$=>w.value=!1),class:"bg-[#0099cc] hover:bg-[#0088bb] text-white px-6 py-3 rounded-xl font-medium transition-colors"}," Parfait ")])])])])):T("",!0)])}}};function O1(){const{get:_,loading:y,error:w}=ge(),p=R({ticketsBought:0,lotteriesParticipated:0,totalSpent:0,prizesWon:0}),f=R([]),a=R([]),c=de(()=>[{label:"Tickets achetés",value:p.value.ticketsBought.toString(),color:"bg-blue-500",icon:"TicketIcon"},{label:"Tombolas participées",value:p.value.lotteriesParticipated.toString(),color:"bg-[#0099cc]",icon:"GiftIcon"},{label:"Total dépensé",value:$(p.value.totalSpent),color:"bg-yellow-500",icon:"CurrencyDollarIcon"},{label:"Prix gagnés",value:p.value.prizesWon.toString(),color:"bg-purple-500",icon:"TrophyIcon"}]),n=async()=>{try{const m=await _("/stats/customer/dashboard");if(m&&m.success){const k=m.data;p.value={ticketsBought:k.total_tickets||0,lotteriesParticipated:k.lotteries_participated||0,totalSpent:k.total_spent||0,prizesWon:k.prizes_won||0}}}catch(m){console.error("Erreur lors du chargement des statistiques:",m),p.value={ticketsBought:0,lotteriesParticipated:0,totalSpent:0,prizesWon:0}}},r=async()=>{try{const m=await _("/tickets/my-tickets");if(m&&m.success&&Array.isArray(m.data)){const k=m.data.slice(0,5);f.value=k.map(U=>({id:U.id,ticket_number:U.ticket_number,product:{id:U.lottery?.product?.id,title:U.lottery?.product?.name||"Produit inconnu",image:U.lottery?.product?.image_url||U.lottery?.product?.image||"/images/products/placeholder.jpg"},quantity:1,total_price:$(U.price||0),status:U.status||"reserved",purchased_at:new Date(U.purchased_at||U.created_at),lottery:{id:U.lottery?.id,lottery_number:U.lottery?.lottery_number,title:U.lottery?.title,draw_date:U.lottery?.draw_date}}))}else f.value=[]}catch(m){console.error("Erreur lors du chargement des tickets récents:",m),f.value=[]}},P=async()=>{try{const m=await _("/stats/lotteries/popular?limit=6");m&&m.success&&Array.isArray(m.data)?a.value=m.data.map(k=>({id:k.id,product:{id:k.product?.id,title:k.product?.name||"Produit inconnu",price:$(k.ticket_price||0),image:k.product?.image_url||"/images/products/placeholder.jpg"},progress:k.progress||0,draw_date:new Date(k.draw_date),sold_tickets:k.sold_tickets,total_tickets:k.total_tickets})):a.value=[]}catch(m){console.error("Erreur lors du chargement des tombolas populaires:",m),a.value=[]}},$=m=>{const k=parseFloat(m)||0;return k>=1e6?(k/1e6).toFixed(1)+"M FCFA":k>=1e3?(k/1e3).toFixed(0)+"k FCFA":k.toLocaleString()+" FCFA"};return{stats:c,recentTickets:f,activeLotteries:a,loading:y,error:w,loadDashboardData:async()=>{await Promise.all([n(),r(),P()])},loadDashboardStats:n,loadRecentTickets:r,loadActiveLotteries:P,formatCurrency:$,formatDate:m=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(m)}}const G1={class:"mb-8"},H1={class:"text-3xl font-bold text-gray-900"},K1={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},W1={class:"flex items-center"},J1={class:"ml-4"},X1={class:"text-sm font-medium text-gray-600"},Y1={class:"text-2xl font-bold text-gray-900"},Q1={key:0,class:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4"},Z1={class:"flex"},eb={class:"ml-3"},tb={class:"mt-1 text-sm text-red-700"},sb={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-8"},ob={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},rb={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},ab={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},nb={class:"flex justify-between items-center mb-4"},ib={key:0,class:"text-center py-8"},lb={key:1,class:"space-y-4"},db=["src","alt"],ub={class:"flex-1"},cb={class:"font-medium text-gray-900"},mb={class:"text-sm text-gray-600"},pb={class:"text-xs text-gray-500"},gb={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},fb={class:"flex justify-between items-center mb-4"},vb={class:"space-y-4"},xb={class:"flex items-start space-x-4"},bb=["src","alt"],yb={class:"flex-1"},hb={class:"font-medium text-gray-900 mb-1"},_b={class:"text-sm text-gray-600 mb-2"},wb={class:"mb-3"},$b={class:"flex justify-between text-sm text-gray-600 mb-1"},kb={class:"w-full bg-gray-200 rounded-full h-2"},Cb={class:"text-xs text-gray-500 mt-1"},Ab={class:"flex justify-between items-center"},Pb={class:"text-xs text-gray-500"},Eb={key:1,class:"text-sm bg-gray-400 text-white px-3 py-1 rounded-md"},jb={__name:"Dashboard",setup(_){const y=Pe(),{stats:w,recentTickets:p,activeLotteries:f,loading:a,error:c,loadDashboardData:n,formatDate:r}=O1(),P={TicketIcon:je,GiftIcon:ot,CurrencyDollarIcon:Ke,TrophyIcon:Je},$=de(()=>w.value.map(m=>({...m,icon:P[m.icon]||je}))),M=m=>({active:"Actif",won:"Gagné",lost:"Perdu",pending:"En attente"})[m]||m,D=async()=>{await n()};return ve(async()=>{await n()}),(m,k)=>{const U=he("router-link");return s(),o("div",null,[e("div",G1,[e("h1",H1," Bonjour "+t(l(y).user?.first_name)+" ! ",1),k[0]||(k[0]=e("p",{class:"mt-2 text-gray-600"}," Voici un aperçu de vos activités sur la plateforme ",-1))]),e("div",K1,[l(a)?(s(),o(ie,{key:0},le(4,V=>e("div",{key:V,class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 animate-pulse"},k[1]||(k[1]=[pe('<div class="flex items-center"><div class="p-3 rounded-lg bg-gray-200"></div><div class="ml-4 flex-1"><div class="h-4 bg-gray-200 rounded w-20 mb-2"></div><div class="h-6 bg-gray-200 rounded w-16"></div></div></div>',1)]))),64)):(s(!0),o(ie,{key:1},le($.value,V=>(s(),o("div",{key:V.label,class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-200"},[e("div",W1,[e("div",{class:te(["p-3 rounded-lg",V.color])},[(s(),ce(Ie(V.icon),{class:"w-6 h-6 text-white"}))],2),e("div",J1,[e("p",X1,t(V.label),1),e("p",Y1,t(V.value),1)])])]))),128))]),l(c)&&!l(a)?(s(),o("div",Q1,[e("div",Z1,[e("div",eb,[k[2]||(k[2]=e("h3",{class:"text-sm font-medium text-red-800"},"Erreur de chargement",-1)),e("p",tb,t(l(c)),1),e("button",{onClick:D,class:"mt-2 text-sm bg-red-100 hover:bg-red-200 text-red-800 px-3 py-1 rounded"}," Réessayer ")])])])):T("",!0),e("div",sb,[k[6]||(k[6]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Actions rapides",-1)),e("div",ob,[g(U,{to:"/customer/products",class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-[#0099cc] hover:bg-blue-50 transition-colors"},{default:re(()=>[g(l(qe),{class:"w-8 h-8 text-[#0099cc] mr-3"}),k[3]||(k[3]=e("div",null,[e("p",{class:"font-medium text-gray-900"},"Acheter des tickets"),e("p",{class:"text-sm text-gray-600"},"Découvrir les produits disponibles")],-1))]),_:1,__:[3]}),g(U,{to:"/customer/tickets",class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-black hover:bg-gray-50 transition-colors"},{default:re(()=>[g(l(je),{class:"w-8 h-8 text-black mr-3"}),k[4]||(k[4]=e("div",null,[e("p",{class:"font-medium text-gray-900"},"Mes tickets"),e("p",{class:"text-sm text-gray-600"},"Voir mes participations")],-1))]),_:1,__:[4]}),g(U,{to:"/customer/profile",class:"flex items-center p-4 border border-gray-200 rounded-lg hover:border-[#0099cc] hover:bg-blue-50 transition-colors"},{default:re(()=>[g(l(ze),{class:"w-8 h-8 text-[#0099cc] mr-3"}),k[5]||(k[5]=e("div",null,[e("p",{class:"font-medium text-gray-900"},"Mon profil"),e("p",{class:"text-sm text-gray-600"},"Gérer mes informations")],-1))]),_:1,__:[5]})])]),e("div",rb,[e("div",ab,[e("div",nb,[k[8]||(k[8]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Mes derniers tickets",-1)),g(U,{to:"/customer/tickets",class:"text-sm text-[#0099cc] hover:text-blue-700"},{default:re(()=>k[7]||(k[7]=[z(" Voir tout ",-1)])),_:1,__:[7]})]),l(p).length===0?(s(),o("div",ib,[g(l(je),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),k[10]||(k[10]=e("p",{class:"text-gray-600"},"Aucun ticket acheté pour le moment",-1)),g(U,{to:"/customer/products",class:"inline-block mt-2 text-[#0099cc] hover:text-blue-700"},{default:re(()=>k[9]||(k[9]=[z(" Acheter des tickets ",-1)])),_:1,__:[9]})])):(s(),o("div",lb,[(s(!0),o(ie,null,le(l(p),V=>(s(),o("div",{key:V.id,class:"flex items-center space-x-4 p-3 border border-gray-200 rounded-lg"},[e("img",{src:V.product.image_url||V.product.main_image||V.product.image,alt:V.product.title,class:"w-12 h-12 rounded-lg object-cover"},null,8,db),e("div",ub,[e("p",cb,t(V.product.title),1),e("p",mb,t(V.quantity)+" ticket"+t(V.quantity>1?"s":"")+" - "+t(V.total_price)+" FCFA ",1),e("p",pb,t(l(r)(V.purchased_at)),1)]),e("span",{class:te(["px-2 py-1 text-xs font-medium rounded-full",V.status==="active"?"bg-[#0099cc] text-white":V.status==="won"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},t(M(V.status)),3)]))),128))]))]),e("div",gb,[e("div",fb,[k[12]||(k[12]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Tombolas populaires",-1)),g(U,{to:"/customer/products",class:"text-sm text-[#0099cc] hover:text-blue-700"},{default:re(()=>k[11]||(k[11]=[z(" Voir tout ",-1)])),_:1,__:[11]})]),e("div",vb,[(s(!0),o(ie,null,le(l(f),V=>(s(),o("div",{key:V.id,class:"border border-gray-200 rounded-lg p-4 hover:border-[#0099cc] transition-colors"},[e("div",xb,[e("img",{src:V.product.image_url||V.product.main_image||V.product.image,alt:V.product.title,class:"w-16 h-16 rounded-lg object-cover"},null,8,bb),e("div",yb,[e("h4",hb,t(V.product.title),1),e("p",_b,t(V.product.price)+" FCFA",1),e("div",wb,[e("div",$b,[k[13]||(k[13]=e("span",null,"Progression",-1)),e("span",null,t(V.progress)+"%",1)]),e("div",kb,[e("div",{class:"bg-[#0099cc] h-2 rounded-full transition-all duration-300",style:Me({width:V.progress+"%"})},null,4)]),e("p",Cb,t(V.sold_tickets)+" / "+t(V.total_tickets)+" tickets vendus ",1)]),e("div",Ab,[e("span",Pb," Tirage le "+t(l(r)(V.draw_date)),1),V.sold_tickets<V.total_tickets?(s(),ce(U,{key:0,to:`/customer/products/${V.product.id}`,class:"text-sm bg-[#0099cc] text-white px-3 py-1 rounded-md hover:bg-blue-700 transition-colors"},{default:re(()=>k[14]||(k[14]=[z(" Participer ",-1)])),_:2,__:[14]},1032,["to"])):(s(),o("span",Eb," Complet "))])])])]))),128))])])])])}}},Sb={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-6 product-filter"},Ib={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4"},Db={key:0,disabled:""},Tb=["value"],Mb={key:0,class:"text-center py-12"},Lb={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Vb={key:2,class:"text-center py-12"},Rb={key:3,class:"mt-8 flex justify-center"},Fb={class:"flex space-x-2"},Nb=["disabled"],zb={class:"px-4 py-2 text-gray-700"},qb=["disabled"],Lt=9,Ub={__name:"Products",setup(_){const{get:y,loading:w}=ge();R(!0);const p=R([]),f=R([]),a=$e(),c=R(1),n=R({search:"",category:"",saleMode:"",maxPrice:""}),r=de(()=>{const V=(c.value-1)*Lt,v=V+Lt;return p.value.slice(V,v)}),P=de(()=>Math.ceil(p.value.length/Lt)),$=async()=>{try{const V=new URLSearchParams;n.value.search&&V.append("search",n.value.search),n.value.category&&V.append("category_id",n.value.category),n.value.saleMode&&V.append("sale_mode",n.value.saleMode),n.value.maxPrice&&V.append("max_price",n.value.maxPrice);const v=V.toString()?`/products?${V.toString()}`:"/products",d=await y(v);d&&d.success&&d.data&&(p.value=d.data.products||d.data||[],c.value=1)}catch(V){console.error("Erreur lors du chargement des produits:",V),p.value=[]}},M=async()=>{try{console.log("Customer - Chargement des catégories...");const V=await y("/categories");console.log("Customer - Réponse API categories:",V),V&&V.success?(f.value=V.data||[],console.log("Customer - Catégories chargées:",f.value.length)):(console.log("Customer - Structure de réponse inattendue:",V),f.value=V?.data||V||[])}catch(V){console.error("Customer - Erreur lors du chargement des catégories:",V),f.value=[]}},D=()=>{n.value={search:"",category:"",saleMode:"",maxPrice:""},$()},m=$s(()=>{$()},300),k=()=>{$()},U=V=>{a.push({name:"customer.product.detail",params:{id:V.id}})};return ve(async()=>{await Promise.all([$(),M()])}),(V,v)=>(s(),o("div",null,[v[18]||(v[18]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Produits disponibles"),e("p",{class:"mt-2 text-gray-600"},"Découvrez tous les produits que vous pouvez gagner")],-1)),e("div",Sb,[e("div",Ib,[e("div",null,[v[7]||(v[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rechercher",-1)),Q(e("input",{"onUpdate:modelValue":v[0]||(v[0]=d=>n.value.search=d),onInput:v[1]||(v[1]=(...d)=>l(m)&&l(m)(...d)),type:"text",placeholder:"Nom du produit...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 placeholder-gray-500 bg-white"},null,544),[[ne,n.value.search]])]),e("div",null,[v[9]||(v[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type de vente",-1)),Q(e("select",{"onUpdate:modelValue":v[2]||(v[2]=d=>n.value.saleMode=d),onChange:k,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white"},v[8]||(v[8]=[e("option",{value:""},"Tous les types",-1),e("option",{value:"direct"},"Achat direct",-1),e("option",{value:"lottery"},"Tombola",-1)]),544),[[me,n.value.saleMode]])]),e("div",null,[v[11]||(v[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Catégorie",-1)),Q(e("select",{"onUpdate:modelValue":v[3]||(v[3]=d=>n.value.category=d),onChange:k,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white"},[v[10]||(v[10]=e("option",{value:""},"Toutes les catégories",-1)),f.value.length===0?(s(),o("option",Db,"Aucune catégorie disponible")):T("",!0),(s(!0),o(ie,null,le(f.value,d=>(s(),o("option",{key:d.id,value:d.id},t(d.name),9,Tb))),128))],544),[[me,n.value.category]])]),e("div",null,[v[13]||(v[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prix max",-1)),Q(e("select",{"onUpdate:modelValue":v[4]||(v[4]=d=>n.value.maxPrice=d),onChange:k,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 bg-white"},v[12]||(v[12]=[pe('<option value="">Tous les prix</option><option value="100000">100,000 FCFA</option><option value="500000">500,000 FCFA</option><option value="1000000">1,000,000 FCFA</option><option value="2000000">2,000,000+ FCFA</option>',5)]),544),[[me,n.value.maxPrice]])]),e("div",{class:"flex items-end"},[e("button",{onClick:D,class:"w-full px-4 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"}," Réinitialiser ")])])]),l(w)?(s(),o("div",Mb,v[14]||(v[14]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement des produits...",-1)]))):(s(),o("div",Lb,[(s(!0),o(ie,null,le(r.value,d=>(s(),ce(hs,{key:d.id,product:d,onViewProduct:U},null,8,["product"]))),128))])),!l(w)&&p.value.length===0?(s(),o("div",Vb,[g(l(qe),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),v[15]||(v[15]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Aucun produit trouvé",-1)),v[16]||(v[16]=e("p",{class:"text-gray-600"},"Essayez de modifier vos filtres de recherche",-1))])):T("",!0),P.value>1?(s(),o("div",Rb,[e("nav",Fb,[e("button",{onClick:v[5]||(v[5]=d=>c.value=Math.max(1,c.value-1)),disabled:c.value===1,class:"px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"}," Précédent ",8,Nb),e("span",zb," Page "+t(c.value)+" sur "+t(P.value),1),e("button",{onClick:v[6]||(v[6]=d=>c.value=Math.min(P.value,c.value+1)),disabled:c.value===P.value,class:"px-4 py-2 border border-gray-300 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50"}," Suivant ",8,qb)])])):T("",!0),T("",!0)]))}},Bb={key:0,class:"text-center py-12"},Ob={key:1,class:"max-w-7xl mx-auto"},Gb={class:"mb-6"},Hb={class:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"},Kb={class:"relative"},Wb={class:"absolute top-4 left-4"},Jb={key:0,class:"absolute top-4 right-4"},Xb={key:0,class:"grid grid-cols-4 gap-2 mt-4"},Yb={class:"mb-6"},Qb={class:"text-3xl font-bold text-gray-900 mb-4"},Zb={class:"text-lg text-gray-600 mb-4"},ey={class:"flex items-center space-x-4 mb-6"},ty={class:"text-center"},sy={class:"text-3xl font-bold text-blue-600"},oy={class:"text-sm text-gray-500"},ry={key:0,class:"text-center"},ay={class:"text-xl font-semibold text-gray-900"},ny={key:0,class:"mb-6"},iy={class:"flex justify-between text-sm text-gray-600 mb-2"},ly={class:"w-full bg-gray-200 rounded-full h-3"},dy={class:"flex justify-between text-xs text-gray-500 mt-1"},uy={key:1,class:"mb-6 p-4 bg-gray-50 rounded-lg"},cy={class:"flex items-center mb-2"},my={class:"font-medium text-gray-900"},py={class:"flex items-center"},gy={class:"text-gray-600"},fy={class:"bg-white border border-gray-200 rounded-xl p-6 mb-6"},vy={key:0},xy={class:"flex items-center space-x-4 mb-4"},by={class:"flex items-center space-x-2"},yy=["disabled"],hy=["max"],_y=["disabled"],wy={class:"flex justify-between items-center mb-4"},$y={class:"text-2xl font-bold text-blue-600"},ky=["disabled"],Cy={key:0},Ay={key:1},Py={key:2},Ey={key:3},jy={key:1},Sy={class:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200"},Iy={class:"flex items-center gap-2 mb-2"},Dy={class:"flex justify-between items-center mb-6"},Ty={class:"text-3xl font-bold text-blue-600"},My=["disabled"],Ly={key:0},Vy={class:"mb-8"},Ry={class:"border-b border-gray-200 mb-6"},Fy={class:"flex space-x-8"},Ny=["onClick"],zy={key:0,class:"prose max-w-none"},qy={class:"text-gray-600 leading-relaxed"},Uy={key:0,class:"space-y-2"},By={class:"text-gray-600"},Oy={key:1,class:"prose max-w-none"},Gy={key:2},Hy={class:"text-lg font-semibold mb-3"},Ky={key:0,class:"text-center py-8"},Wy={key:1,class:"space-y-3"},Jy={class:"flex items-center"},Xy={class:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white text-sm font-medium"},Yy={class:"ml-3 text-gray-900"},Qy={class:"text-sm text-gray-600"},Zy={key:2,class:"text-center py-12"},eh={__name:"ProductDetail",setup(_){const y=Be(),w=$e(),{get:p,post:f,loading:a}=ge(),c=Pe(),n=R(!1),r=R(null),P=R(1),$=R("description"),M=R(""),D=R([]),m=[{key:"description",label:"Description"},{key:"rules",label:"Règles"},{key:"participants",label:"Participants"}],k=de(()=>r.value&&(r.value.lottery||r.value.active_lottery)&&(r.value.lottery?.total_tickets>0||r.value.active_lottery?.total_tickets>0)),U=de(()=>{if(!r.value)return 0;const h=r.value.lottery||r.value.active_lottery;return h?(h.ticket_price||r.value.ticket_price||0)*P.value:0}),V=()=>{if(!r.value)return 0;const h=r.value.lottery||r.value.active_lottery;if(!h)return 0;const b=h.sold_tickets||0,ee=h.total_tickets||1;return Math.round(b/ee*100)},v=de(()=>{if(!r.value)return!1;const h=r.value.lottery||r.value.active_lottery;if(!h)return!1;const b=h.sold_tickets||0,ee=h.total_tickets||h.max_tickets||0;return b>=ee}),d=h=>h==null||isNaN(h)?"0":new Intl.NumberFormat("fr-FR").format(Number(h)),i=()=>{const h=r.value.lottery||r.value.active_lottery,b=(h?.total_tickets||0)-(h?.sold_tickets||0);P.value<b&&P.value++},C=()=>{P.value>1&&P.value--},x=h=>{if(!h)return"";const b=new Date(h);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(b)},I=h=>{if(!h)return"";const b=new Date,B=new Date(h)-b,S=Math.floor(B/(1e3*60*60*24));if(S>7)return`Plus de ${S} jours restants`;if(S>0)return`${S} jour${S>1?"s":""} restant${S>1?"s":""}`;{const E=Math.floor(B/36e5);return E>0?`${E}h restantes`:"Se termine bientôt"}},N=h=>({active:"Actif",ending_soon:"Bientôt terminé",completed:"Terminé"})[h]||h,u=async()=>{n.value=!0;try{const h=r.value.lottery||r.value.active_lottery,ee=(h?.ticket_price||r.value.ticket_price||0)*P.value,B=c.user?.phone;if(!B){window.$toast&&window.$toast.error("Veuillez ajouter un numéro de téléphone à votre profil avant d'effectuer un achat.","Téléphone requis");return}const S=await f("/tickets/purchase",{lottery_id:h?.id,quantity:P.value,phone_number:B,total_amount:ee});if(S&&S.success)window.$toast&&window.$toast.success(S.message||"Commande créée avec succès !","Commande créée"),w.push({path:"/payment/method",query:{order_number:S.data.order_number,amount:ee,lottery_id:h?.id,quantity:P.value,type:"ticket"}});else throw new Error(S?.message||"Erreur lors de la création de la commande")}catch(h){console.error("Error purchasing tickets:",h);const b=h.response?.data?.message||h.message||"Erreur lors de l'achat des tickets";window.$toast&&window.$toast.error(""+b," Erreur d'achat")}finally{n.value=!1}},A=async()=>{n.value=!0;try{const h=await f("/payments/initiate",{product_id:r.value.id,type:"product_purchase",amount:r.value.price});if(h&&h.success)h.redirect_to_payment?w.push({name:"payment.method",query:{order_number:h.data.order_number,amount:h.data.amount,type:h.data.type||"product"}}):(window.$toast&&window.$toast.success("Produit acheté avec succès ! Vous recevrez une confirmation par SMS.","Achat confirmé"),await H());else throw new Error(h?.message||"Erreur lors de l'achat")}catch(h){console.error("Error purchasing product directly:",h);const b=h.response?.data?.message||h.message||"Erreur lors de l'achat";window.$toast&&window.$toast.error(" "+b," Erreur d'achat")}finally{n.value=!1}},H=async()=>{try{const h=y.params.id;console.log("Loading product ID:",h);const b=await p(`/products/${h}`);console.log("Product API response:",b),b&&b.success&&b.data?(r.value=b.data,M.value=r.value.image||"/images/products/placeholder.jpg",(r.value.lottery||r.value.active_lottery)&&await j()):b&&b.data?(r.value=b.data,M.value=r.value.image||"/images/products/placeholder.jpg"):(console.error("Product not found in response:",b),r.value=null)}catch(h){console.error("Error loading product:",h),r.value=null}},j=async()=>{try{const h=r.value.lottery||r.value.active_lottery;h&&(console.log("Participants endpoint not available yet for lottery:",h.id),D.value=[])}catch(h){console.error("Error loading participants:",h),D.value=[]}};return ve(()=>{H()}),(h,b)=>{const ee=he("router-link");return l(a)?(s(),o("div",Bb,b[1]||(b[1]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement du produit...",-1)]))):r.value?(s(),o("div",Ob,[e("div",Gb,[g(ee,{to:"/customer/products",class:"inline-flex items-center text-gray-600 hover:text-gray-900"},{default:re(()=>[g(l(at),{class:"w-5 h-5 mr-2"}),b[2]||(b[2]=z(" Retour aux produits ",-1))]),_:1,__:[2]})]),e("div",Hb,[e("div",null,[e("div",Kb,[g(He,{src:r.value.image_url||r.value.main_image||r.value.image,alt:r.value.title||r.value.name,"container-class":"w-full h-96 rounded-xl overflow-hidden","image-class":"w-full h-96 object-cover","fallback-text":"Image non disponible"},null,8,["src","alt"]),e("div",Wb,[e("span",{class:te(["px-3 py-1 text-sm font-medium rounded-full",r.value.status==="active"?"bg-blue-100 text-blue-800":r.value.status==="ending_soon"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},t(N(r.value.status)),3)]),r.value.featured?(s(),o("div",Jb,[g(l(ft),{class:"w-8 h-8 text-yellow-500 fill-current"})])):T("",!0)]),r.value.images&&r.value.images.length>1?(s(),o("div",Xb,[(s(!0),o(ie,null,le(r.value.images,(B,S)=>(s(),ce(He,{key:S,src:B,alt:`${r.value.title||r.value.name} ${S+1}`,"container-class":"w-full h-20 rounded-lg overflow-hidden cursor-pointer hover:opacity-75 transition-opacity","image-class":"w-full h-20 object-cover",onClick:E=>M.value=B},null,8,["src","alt","onClick"]))),128))])):T("",!0)]),e("div",null,[e("div",Yb,[e("h1",Qb,t(r.value.title||r.value.name),1),e("p",Zb,t(r.value.description),1),e("div",ey,[e("div",ty,[e("div",sy,t(d(r.value.price))+" FCFA",1),e("div",oy,t(k.value?"Valeur du produit":"Prix"),1)]),k.value?(s(),o("div",ry,[e("div",ay,t(d(r.value.lottery?.ticket_price||r.value.active_lottery?.ticket_price||r.value.ticket_price||0))+" FCFA",1),b[3]||(b[3]=e("div",{class:"text-sm text-gray-500"},"Prix par ticket",-1))])):T("",!0)]),k.value?(s(),o("div",ny,[e("div",iy,[b[4]||(b[4]=e("span",null,"Progression de la tombola",-1)),e("span",null,t(V())+"% ("+t(r.value.lottery?.sold_tickets||r.value.active_lottery?.sold_tickets||0)+"/"+t(r.value.lottery?.total_tickets||r.value.active_lottery?.total_tickets||0)+")",1)]),e("div",ly,[e("div",{class:"bg-blue-600 h-3 rounded-full transition-all duration-300",style:Me({width:V()+"%"})},null,4)]),e("div",dy,[b[5]||(b[5]=e("span",null,"0 tickets",-1)),e("span",null,t(r.value.lottery?.total_tickets||r.value.active_lottery?.total_tickets||0)+" tickets",1)])])):T("",!0),k.value?(s(),o("div",uy,[e("div",cy,[g(l(Ot),{class:"w-5 h-5 text-gray-600 mr-2"}),e("span",my,"Date de tirage: "+t(x(r.value.lottery?.draw_date||r.value.active_lottery?.draw_date)),1)]),e("div",py,[g(l(Te),{class:"w-5 h-5 text-gray-600 mr-2"}),e("span",gy,t(I(r.value.lottery?.draw_date||r.value.active_lottery?.draw_date)),1)])])):T("",!0)]),e("div",fy,[k.value?(s(),o("div",vy,[b[8]||(b[8]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Acheter des tickets",-1)),e("div",xy,[b[6]||(b[6]=e("label",{class:"block text-sm font-medium text-gray-700"},"Nombre de tickets:",-1)),e("div",by,[e("button",{onClick:C,class:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50",disabled:P.value<=1},[g(l(Bs),{class:"w-4 h-4"})],8,yy),Q(e("input",{"onUpdate:modelValue":b[0]||(b[0]=B=>P.value=B),type:"number",min:"1",max:(r.value.lottery?.total_tickets||r.value.active_lottery?.total_tickets||0)-(r.value.lottery?.sold_tickets||r.value.active_lottery?.sold_tickets||0),class:"w-20 text-center border border-gray-300 rounded-md py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,hy),[[ne,P.value]]),e("button",{onClick:i,class:"w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:bg-gray-50",disabled:P.value>=(r.value.lottery?.total_tickets||0)-(r.value.lottery?.sold_tickets||0)},[g(l(_t),{class:"w-4 h-4"})],8,_y)])]),e("div",wy,[b[7]||(b[7]=e("span",{class:"text-gray-600"},"Total à payer:",-1)),e("span",$y,t(d(U.value))+" FCFA",1)]),e("button",{onClick:u,disabled:n.value||r.value.status!=="active"||v.value,class:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed"},[n.value?(s(),o("span",Cy,"Achat en cours...")):r.value.status!=="active"?(s(),o("span",Ay,"Tombola terminée")):v.value?(s(),o("span",Py,"Tous les tickets sont vendus")):(s(),o("span",Ey,"Acheter "+t(P.value)+" ticket"+t(P.value>1?"s":""),1))],8,ky)])):(s(),o("div",jy,[b[13]||(b[13]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Acheter ce produit",-1)),e("div",Sy,[e("div",Iy,[g(l(Re),{class:"w-5 h-5 text-[#0099cc]"}),b[9]||(b[9]=e("span",{class:"font-medium text-blue-900"},"Achat direct disponible",-1))]),b[10]||(b[10]=e("p",{class:"text-sm text-blue-700"}," Ce produit peut être acheté directement sans passer par une tombola. ",-1))]),e("div",Dy,[b[11]||(b[11]=e("span",{class:"text-gray-600 text-lg"},"Prix:",-1)),e("span",Ty,t(r.value.price)+" FCFA",1)]),e("button",{onClick:A,disabled:n.value,class:"w-full bg-[#0099cc] text-white py-3 rounded-lg font-medium hover:bg-[#0088bb] transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center gap-2 whitespace-nowrap"},[n.value?(s(),o("span",Ly,"Achat en cours...")):(s(),o(ie,{key:1},[g(l(Bt),{class:"w-5 h-5 flex-shrink-0"}),b[12]||(b[12]=e("span",null,"Acheter maintenant",-1))],64))],8,My)]))])])]),e("div",Vy,[e("div",Ry,[e("nav",Fy,[(s(),o(ie,null,le(m,B=>e("button",{key:B.key,onClick:S=>$.value=B.key,class:te(["py-2 px-1 border-b-2 font-medium text-sm",$.value===B.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},t(B.label),11,Ny)),64))])]),$.value==="description"?(s(),o("div",zy,[b[14]||(b[14]=e("h3",{class:"text-lg font-semibold mb-3"},"Description détaillée",-1)),e("p",qy,t(r.value.detailed_description||r.value.description),1),b[15]||(b[15]=e("h4",{class:"text-md font-semibold mt-6 mb-3"},"Caractéristiques",-1)),r.value.features?(s(),o("ul",Uy,[(s(!0),o(ie,null,le(r.value.features,B=>(s(),o("li",{key:B,class:"flex items-center gap-2"},[g(l(Re),{class:"w-5 h-5 text-blue-500 flex-shrink-0"}),e("span",By,t(B),1)]))),128))])):T("",!0)])):T("",!0),$.value==="rules"?(s(),o("div",Oy,b[16]||(b[16]=[e("h3",{class:"text-lg font-semibold mb-3"},"Règles de la tombola",-1),e("div",{class:"space-y-4 text-gray-600"},[e("p",null,"• Chaque ticket acheté vous donne une chance de gagner ce produit"),e("p",null,"• Le tirage aura lieu à la date indiquée une fois tous les tickets vendus"),e("p",null,"• Le gagnant sera choisi de manière aléatoire et équitable"),e("p",null,"• Vous serez notifié par email et SMS si vous gagnez"),e("p",null,"• Les prix non réclamés dans les 30 jours seront remis en jeu")],-1)]))):T("",!0),$.value==="participants"?(s(),o("div",Gy,[e("h3",Hy,"Participants ("+t(r.value.sold_tickets)+")",1),D.value.length===0?(s(),o("div",Ky,[g(l(vt),{class:"w-12 h-12 text-gray-400 mx-auto mb-4"}),b[17]||(b[17]=e("p",{class:"text-gray-600"},"Soyez le premier à participer !",-1))])):(s(),o("div",Wy,[(s(!0),o(ie,null,le(D.value,B=>(s(),o("div",{key:B.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("div",Jy,[e("div",Xy,t(B.name.charAt(0).toUpperCase()),1),e("span",Yy,t(B.name),1)]),e("span",Qy,t(B.tickets)+" ticket"+t(B.tickets>1?"s":""),1)]))),128))]))])):T("",!0)])])):(s(),o("div",Zy,[g(l(We),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),b[19]||(b[19]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Produit introuvable",-1)),b[20]||(b[20]=e("p",{class:"text-gray-600 mb-4"},"Le produit que vous cherchez n'existe pas ou a été supprimé",-1)),g(ee,{to:"/customer/products",class:"inline-block bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"},{default:re(()=>b[18]||(b[18]=[z(" Retour aux produits ",-1)])),_:1,__:[18]})]))}}},th=(_="Image",y=400,w=300,p="#e2e8f0",f="#64748b")=>{const a=Math.min(y,w)/15,c=`
    <svg width="${y}" height="${w}" xmlns="http://www.w3.org/2000/svg">
      <rect width="100%" height="100%" fill="${p}"/>
      <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" 
            fill="${f}" font-family="Arial, sans-serif" font-size="${a}" font-weight="bold">
        ${_}
      </text>
    </svg>
  `;return`data:image/svg+xml;base64,${btoa(c)}`},sh=(_,y="Image non disponible")=>{console.log("Image loading error, using placeholder");const w=_.target,p=w.naturalWidth||w.width||400,f=w.naturalHeight||w.height||300;w.src=th(y,p,f)},oh={class:"avatar-upload-container"},rh={class:"relative group"},ah=["src","alt"],nh={key:1,class:"flex flex-col items-center justify-center text-gray-400"},ih={class:"text-white text-center"},lh={key:0,class:"absolute inset-0 bg-black bg-opacity-60 rounded-full flex items-center justify-center"},dh={class:"mt-4 text-center"},uh={class:"text-sm text-gray-600 mb-2"},ch={class:"text-xs text-gray-500"},mh={key:0,class:"flex justify-center space-x-2 mt-3"},ph=["disabled"],gh=["disabled"],fh={key:0,class:"mt-2 text-center"},vh={class:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-md px-3 py-2"},xh={key:1,class:"mt-2 text-center"},bh={class:"text-sm text-green-600 bg-green-50 border border-green-200 rounded-md px-3 py-2"},yh={__name:"AvatarUpload",props:{currentAvatarUrl:{type:String,default:null},uploadEndpoint:{type:String,default:"/user/avatar"},fieldName:{type:String,default:"avatar"},altText:{type:String,default:"Photo de profil"},helpText:{type:String,default:null},maxSizeMB:{type:Number,default:5}},emits:["success","error","upload-start","upload-end"],setup(_,{emit:y}){const w=_,p=y,{post:f}=ge(),a=R(null),c=R(null),n=R(null),r=R(!1),P=R(""),$=R(""),M=de(()=>w.maxSizeMB*1024*1024),D=()=>{r.value||a.value?.click()},m=v=>{const d=v.target.files?.[0];if(!d)return;if(P.value="",$.value="",!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(d.type)){P.value="Veuillez sélectionner un fichier image valide (JPG, PNG, GIF ou WEBP).";return}if(d.size>M.value){P.value=`La taille du fichier ne doit pas dépasser ${w.maxSizeMB}MB.`;return}c.value=d;const C=new FileReader;C.onload=x=>{n.value=x.target.result},C.readAsDataURL(d)},k=()=>{c.value=null,n.value=null,P.value="",$.value="",a.value&&(a.value.value="")},U=async()=>{if(c.value)try{r.value=!0,P.value="",$.value="",p("upload-start");const v=new FormData;v.append(w.fieldName,c.value),console.log("Uploading avatar to:",w.uploadEndpoint),console.log("File details:",{name:c.value.name,size:c.value.size,type:c.value.type,fieldName:w.fieldName});const d=await f(w.uploadEndpoint,v);if(console.log("Upload successful:",d),d&&(d.success||d.data)){const i=d.data?.avatar_url||d.avatar_url;$.value="Photo de profil mise à jour avec succès !",setTimeout(()=>{c.value=null,n.value=null,$.value=""},2e3),p("success",{avatar_url:i,response:d})}else throw new Error(d?.message||"Upload failed")}catch(v){console.error("Error uploading avatar:",v);let d="Erreur lors de l'upload de l'image.";if(v.response)if(console.error("Response error data:",v.response.data),console.error("Response status:",v.response.status),v.response.status===422&&v.response.data?.errors){const i=v.response.data.errors,C=Object.values(i)[0];d=Array.isArray(C)?C[0]:C}else v.response.status===413?d="Le fichier est trop volumineux. Veuillez réduire sa taille.":v.response.status===401?d="Session expirée. Veuillez vous reconnecter.":v.response.data?.message&&(d=v.response.data.message);else v.request&&(console.error("Request error:",v.request),d="Erreur de connexion au serveur. Vérifiez votre connexion internet.");if(v.response?.data?.message)d=v.response.data.message;else if(v.response?.data?.errors){const i=v.response.data.errors;d=Object.values(i).flat().join(", ")}else v.message&&(d=v.message);P.value=d,p("error",v)}finally{r.value=!1,p("upload-end")}},V=v=>{console.log("Avatar image failed to load, using placeholder"),sh(v,"Avatar")};return(v,d)=>(s(),o("div",oh,[e("div",rh,[e("div",{class:"w-24 h-24 rounded-full overflow-hidden border-4 border-gray-200 bg-gray-100 flex items-center justify-center cursor-pointer hover:border-blue-400 transition-colors duration-200",onClick:D},[n.value||_.currentAvatarUrl?(s(),o("img",{key:0,src:n.value||_.currentAvatarUrl,alt:_.altText,class:"w-full h-full object-cover",onError:V},null,40,ah)):(s(),o("div",nh,[g(l(ze),{class:"h-8 w-8 mb-1"}),d[0]||(d[0]=e("span",{class:"text-xs"},"Photo",-1))]))]),e("div",{class:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-200 cursor-pointer",onClick:D},[e("div",ih,[g(l(Os),{class:"h-6 w-6 mx-auto mb-1"}),d[1]||(d[1]=e("span",{class:"text-xs"},"Modifier",-1))])]),r.value?(s(),o("div",lh,d[2]||(d[2]=[e("div",{class:"text-white text-center"},[e("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-white mx-auto mb-1"}),e("span",{class:"text-xs"},"Upload...")],-1)]))):T("",!0)]),e("input",{ref_key:"fileInput",ref:a,type:"file",accept:"image/*",class:"hidden",onChange:m},null,544),e("div",dh,[e("p",uh,t(_.helpText||"Cliquez sur la photo pour la modifier"),1),e("p",ch," Formats acceptés: JPG, PNG, GIF (max "+t(_.maxSizeMB)+"MB) ",1),n.value?(s(),o("div",mh,[e("button",{onClick:U,disabled:r.value,class:"px-4 py-2 bg-blue-500 text-white text-sm rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1"},[g(l(Gs),{class:"h-4 w-4"}),z(" "+t(r.value?"Upload...":"Sauvegarder"),1)],8,ph),e("button",{onClick:k,disabled:r.value,class:"px-4 py-2 bg-gray-300 text-gray-700 text-sm rounded-md hover:bg-gray-400 disabled:opacity-50"}," Annuler ",8,gh)])):T("",!0)]),P.value?(s(),o("div",fh,[e("p",vh,t(P.value),1)])):T("",!0),$.value?(s(),o("div",xh,[e("p",bh,t($.value),1)])):T("",!0)]))}},ks=Ee(yh,[["__scopeId","data-v-151fa698"]]),hh={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},_h={class:"lg:col-span-1"},wh={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},$h={class:"text-center mb-6"},kh={class:"mt-4 text-lg font-semibold text-gray-900"},Ch={class:"text-sm text-gray-600"},Ah={key:0,class:"mb-6"},Ph=["disabled"],Eh={key:1,class:"w-5 h-5 mr-2 border-2 border-white border-t-transparent rounded-full animate-spin"},jh={class:"space-y-1"},Sh=["onClick"],Ih={class:"lg:col-span-2"},Dh={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Th={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Mh={class:"mt-6 p-4 bg-gray-50 rounded-lg"},Lh={class:"text-sm text-gray-600"},Vh={class:"mt-6 flex justify-end"},Rh=["disabled"],Fh={key:0},Nh={key:1},zh={key:1,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},qh={class:"space-y-4"},Uh={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Bh={class:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-600"},Oh={class:"mt-6 flex justify-end"},Gh=["disabled"],Hh={key:0},Kh={key:1},Wh={key:2,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Jh={class:"space-y-6"},Xh={class:"border-b border-gray-200 pb-6"},Yh=["disabled"],Qh={key:0},Zh={key:1},e_={class:"border-b border-gray-200 pb-6"},t_={class:"flex justify-between items-start"},s_={class:"space-y-3"},o_={class:"flex items-center"},r_={class:"font-medium text-gray-900"},a_={class:"text-sm text-gray-600"},n_={class:"flex items-center"},i_={key:0,class:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full mr-3"},l_=["onClick"],d_={key:3,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},u_={class:"space-y-6"},c_={class:"text-lg font-medium text-gray-900 mb-3"},m_={class:"space-y-3"},p_={class:"flex-1"},g_={class:"font-medium text-gray-900"},f_={class:"text-sm text-gray-600"},v_={class:"ml-4 flex space-x-4"},x_={class:"flex items-center"},b_=["onUpdate:modelValue"],y_={class:"flex items-center"},h_=["onUpdate:modelValue"],__={class:"mt-6 flex justify-end"},w_=["disabled"],$_={key:0},k_={key:1},C_={__name:"Profile",setup(_){const y=Pe(),{get:w,put:p,post:f}=ge(),a=R("personal"),c=R(!1),n=R(!1),r=R(!1),P=R(!1),$=R(null),M=R(!1),D=R(!1),m=async()=>{if(!M.value){M.value=!0;try{const J=await f("/user/become-seller",{seller_type:"individual"});if(J.success)await y.refreshUser(),D.value=!0,window.$toast&&window.$toast.success("Vous êtes maintenant un vendeur individuel ! Vous pouvez créer des tombolas avec 500 tickets fixes.","🎉 Félicitations !");else throw new Error(J?.message||"Erreur lors de l'activation du statut vendeur")}catch(J){console.error("Error becoming seller:",J);let G="Erreur lors de l'activation du statut vendeur";if(J.response?.status===422&&J.response?.data?.errors){const ue=J.response.data.errors;G=Object.values(ue).flat().join(", ")}else J.response?.data?.message?G=J.response.data.message:J.message&&(G=J.message);window.$toast&&window.$toast.error(G,"❌ Erreur")}finally{M.value=!1}}},k=()=>{const J=y.user;D.value=J?.roles?.some(G=>G.name==="Business Individual"||G.name==="Business Enterprise")||!1},U=de(()=>{const J=y.user;return J&&J.roles&&Array.isArray(J.roles)&&J.roles.length>0?J.roles.map(ue=>{switch(ue.name){case"Business Individual":return"Vendeur Individuel (simple-dashboard)";case"Business Enterprise":return"Vendeur Entreprise (dashboard complet)";case"Business":return"Vendeur (legacy)";case"Particulier":return"Client";case"Admin":return"Administrateur";case"Super Admin":return"Super Administrateur";case"Agent":return"Agent";default:return ue.name}}).join(", "):"Non défini"}),V=[{key:"personal",label:"Informations personnelles",icon:ze},{key:"address",label:"Adresse",icon:Rt},{key:"security",label:"Sécurité",icon:ut},{key:"notifications",label:"Notifications",icon:Gt}],v=xe({id:null,first_name:"",last_name:"",email:"",phone:"",birth_date:"",gender:"",avatar:null,two_factor_enabled:!1,address:{address:"",city:"",postal_code:"",country_id:null,state:""}}),d=xe({first_name:v.first_name,last_name:v.last_name,email:v.email,phone:v.phone,birth_date:v.birth_date,gender:v.gender}),i=xe({address:v.address.address,city:v.address.city,postal_code:v.address.postal_code,country_id:v.address.country_id}),C=xe({current_password:"",new_password:"",confirm_password:""}),x=R([]),I=R([]),N=[{key:"lottery",title:"Tombolas",notifications:[{key:"draw_results",title:"Résultats des tirages",description:"Être notifié des résultats des tombolas auxquelles vous participez"},{key:"new_lottery",title:"Nouvelles tombolas",description:"Être informé des nouveaux produits mis en tombola"},{key:"ending_soon",title:"Fin de tombola",description:"Rappel quand une tombola se termine bientôt"}]},{key:"account",title:"Compte",notifications:[{key:"login",title:"Nouvelle connexion",description:"Être alerté des nouvelles connexions à votre compte"},{key:"profile_update",title:"Modification du profil",description:"Confirmation des modifications de votre profil"}]}],u=xe({draw_results:{email:!0,sms:!0},new_lottery:{email:!0,sms:!1},ending_soon:{email:!0,sms:!0},login:{email:!0,sms:!1},profile_update:{email:!0,sms:!1}}),A=async()=>{if(!d.first_name||!d.first_name.trim()){window.$toast&&window.$toast.error("Le prénom est requis","❌ Validation");return}if(!d.last_name||!d.last_name.trim()){window.$toast&&window.$toast.error("Le nom de famille est requis","❌ Validation");return}if(!d.email||!d.email.trim()){window.$toast&&window.$toast.error("L'email est requis","❌ Validation");return}c.value=!0;try{console.log("Updating personal info with data:",d);const J=await p("/user/profile",d);if(console.log("Update personal info response:",J),J&&J.success)Object.assign(v,d),window.$toast&&window.$toast.success("Informations personnelles mises à jour avec succès","✅ Profil mis à jour");else throw new Error(J?.message||"Erreur lors de la mise à jour")}catch(J){if(console.error("Error updating personal info:",J),console.error("Error details:",J.response?.data),J.response?.status===422&&J.response?.data?.errors){const G=J.response.data.errors,ue=[];Object.keys(G).forEach(se=>{G[se].forEach(ke=>{let we=ke;ke.includes("validation.required")&&(we=`${{first_name:"Le prénom",last_name:"Le nom de famille",email:"L'email",phone:"Le téléphone"}[se]||se} est requis`),ue.push(we)})}),window.$toast&&window.$toast.error(ue.join(", "),"❌ Erreurs de validation")}else window.$toast&&window.$toast.error("Erreur lors de la mise à jour: "+(J.response?.data?.message||J.message),"❌ Erreur")}finally{c.value=!1}},H=async()=>{const J={first_name:d.first_name||v.first_name||"",last_name:d.last_name||v.last_name||"",email:d.email||v.email||"",phone:d.phone||v.phone||"",birth_date:d.birth_date||v.birth_date||null,gender:d.gender||v.gender||null,...i};if(!J.first_name||!J.first_name.trim()){window.$toast&&window.$toast.error("Le prénom est requis pour mettre à jour l'adresse","❌ Validation");return}if(!J.last_name||!J.last_name.trim()){window.$toast&&window.$toast.error("Le nom de famille est requis pour mettre à jour l'adresse","❌ Validation");return}n.value=!0;try{console.log("Updating address with data:",J);const G=await p("/user/profile",J);if(console.log("Update address response:",G),G&&G.success)Object.assign(v,i),window.$toast&&window.$toast.success("Adresse mise à jour avec succès","✅ Adresse");else throw new Error(G?.message||"Erreur lors de la mise à jour")}catch(G){if(console.error("Error updating address:",G),console.error("Error details:",G.response?.data),G.response?.status===422&&G.response?.data?.errors){const ue=G.response.data.errors,se=[];Object.keys(ue).forEach(fe=>{ue[fe].forEach(we=>{let ae=we;we.includes("validation.required")&&(ae=`${{first_name:"Le prénom",last_name:"Le nom de famille",email:"L'email",phone:"Le téléphone",address:"L'adresse",city:"La ville",postal_code:"Le code postal",country:"Le pays"}[fe]||fe} est requis`),se.push(ae)})}),window.$toast&&window.$toast.error(se.join(", "),"❌ Erreurs de validation")}else window.$toast&&window.$toast.error("Erreur lors de la mise à jour de l'adresse: "+(G.response?.data?.message||G.message),"❌ Erreur")}finally{n.value=!1}},j=async()=>{if(C.new_password!==C.confirm_password){window.$toast&&window.$toast.error("Les mots de passe ne correspondent pas","❌ Erreur de validation");return}r.value=!0;try{const J=await p("/user/password",{current_password:C.current_password,new_password:C.new_password,new_password_confirmation:C.confirm_password});if(J&&J.success)Object.assign(C,{current_password:"",new_password:"",confirm_password:""}),window.$toast&&window.$toast.success("Mot de passe mis à jour avec succès","✅ Sécurité");else throw new Error(J?.message||"Erreur lors de la mise à jour")}catch(J){console.error("Error updating password:",J),window.$toast&&window.$toast.error("Erreur lors de la mise à jour du mot de passe","❌ Erreur")}finally{r.value=!1}},h=async()=>{P.value=!0;try{const J=await p("/user/preferences/detailed",{email_notifications:{lottery_results:u.draw_results.email,new_lotteries:u.new_lottery.email,ending_soon:u.ending_soon.email,account_updates:u.profile_update.email,login_alerts:u.login.email},sms_notifications:{lottery_results:u.draw_results.sms,new_lotteries:u.new_lottery.sms,ending_soon:u.ending_soon.sms,account_updates:u.profile_update.sms,login_alerts:u.login.sms},push_notifications:!0,marketing_emails:!0});if(J&&J.success)window.$toast&&window.$toast.success("Préférences de notifications mises à jour","✅ Notifications");else throw new Error(J?.message||"Erreur lors de la mise à jour")}catch(J){console.error("Error updating notifications:",J),window.$toast&&window.$toast.error("Erreur lors de la mise à jour des notifications","❌ Erreur")}finally{P.value=!1}},b=async()=>{try{const J=await f("/user/2fa/toggle",{enabled:!v.two_factor_enabled});if(J&&J.success)v.two_factor_enabled=!v.two_factor_enabled,window.$toast&&window.$toast.success(`Authentification à deux facteurs ${v.two_factor_enabled?"activée":"désactivée"}`,"✅ Sécurité mise à jour");else throw new Error(J?.message||"Erreur lors de la modification")}catch(J){console.error("Error toggling two-factor authentication:",J),window.$toast&&window.$toast.error("Erreur lors de la modification de l'authentification à deux facteurs","❌ Erreur")}},ee=async J=>{try{const G=await f(`/user/sessions/${J}/revoke`);if(G&&G.success)I.value=I.value.filter(ue=>ue.id!==J),window.$toast&&window.$toast.success("Session révoquée avec succès","✅ Sécurité");else throw new Error(G?.message||"Erreur lors de la révocation")}catch(G){console.error("Error revoking session:",G),window.$toast&&window.$toast.error("Erreur lors de la révocation de la session","❌ Erreur")}},B=()=>`https://ui-avatars.com/api/?name=${encodeURIComponent((v.first_name||"")+"+"+(v.last_name||""))}&background=3b82f6&color=ffffff&size=128`,S=async J=>{console.log("Avatar upload success:",J),v.avatar_url=J.avatar_url,window.$toast&&window.$toast.success("Photo de profil mise à jour avec succès","✅ Avatar"),await F()},E=J=>{console.error("Avatar upload error:",J),window.$toast&&window.$toast.error("Erreur lors de l'upload de l'avatar","❌ Erreur")},F=async()=>{try{const J=await w("/user/profile");if(console.log("Profile API response:",J),J&&J.success&&J.data&&J.data.user){const G=J.data.user;Object.assign(v,G),Object.assign(d,{first_name:G.first_name||"",last_name:G.last_name||"",email:G.email||"",phone:G.phone||"",birth_date:G.birth_date||"",gender:G.gender||""}),Object.assign(i,{address:G.address||"",city:G.city||"",postal_code:G.postal_code||"",country_id:G.country_id||null}),console.log("User data loaded:",G),console.log("Personal form:",d),console.log("Address form:",i),setTimeout(()=>{$.value&&d.phone&&$.value.setNumber(d.phone)},100)}else if(J&&J.data){const G=J.data;Object.assign(v,G),Object.assign(d,{first_name:G.first_name||"",last_name:G.last_name||"",email:G.email||"",phone:G.phone||"",birth_date:G.birth_date||"",gender:G.gender||""}),Object.assign(i,{address:G.address||"",city:G.city||"",postal_code:G.postal_code||"",country_id:G.country_id||null}),setTimeout(()=>{$.value&&d.phone&&$.value.setNumber(d.phone)},100)}}catch(J){console.error("Error loading user profile:",J)}},q=async()=>{try{const J=await w("/countries");J&&J.data&&(x.value=J.data)}catch(J){console.error("Error loading countries:",J)}},O=async()=>{try{const J=await w("/user/preferences");if(J&&J.data&&J.data.preferences){const G=J.data.preferences;G.email_notifications&&(u.draw_results.email=G.email_notifications.lottery_results||!0,u.new_lottery.email=G.email_notifications.new_lotteries||!0,u.ending_soon.email=G.email_notifications.ending_soon||!0,u.profile_update.email=G.email_notifications.account_updates||!0,u.login.email=G.email_notifications.login_alerts||!0),G.sms_notifications&&(u.draw_results.sms=G.sms_notifications.lottery_results||!1,u.new_lottery.sms=G.sms_notifications.new_lotteries||!1,u.ending_soon.sms=G.sms_notifications.ending_soon||!1,u.profile_update.sms=G.sms_notifications.account_updates||!1,u.login.sms=G.sms_notifications.login_alerts||!1)}}catch(J){console.error("Error loading user preferences:",J)}},K=J=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(J)),W=async()=>{try{const J=await w("/user/sessions");J&&J.data&&J.data.sessions&&(I.value=J.data.sessions.map(G=>({id:G.id,device_name:G.user_agent?.includes("Mobile")?"Mobile":"Desktop",device_type:G.user_agent?.includes("Mobile")?"mobile":"desktop",location:`${G.city||"Inconnue"}, ${G.country||"Inconnue"}`,last_active:G.last_activity,is_current:G.is_current})))}catch(J){console.error("Error loading sessions:",J)}};return ve(async()=>{await Promise.all([F(),q(),O(),W()]),k()}),(J,G)=>{const ue=he("ShoppingBagIcon");return s(),o("div",null,[G[38]||(G[38]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Mon profil"),e("p",{class:"mt-2 text-gray-600"},"Gérez vos informations personnelles et préférences")],-1)),e("div",hh,[e("div",_h,[e("div",wh,[e("div",$h,[g(ks,{"current-avatar-url":v.avatar_url||B(),"upload-endpoint":"/user/avatar","field-name":"avatar","alt-text":`Photo de profil de ${v.first_name} ${v.last_name}`,"help-text":"Cliquez pour modifier votre photo de profil","max-size-m-b":5,onSuccess:S,onError:E},null,8,["current-avatar-url","alt-text"]),e("h3",kh,t(v.first_name)+" "+t(v.last_name),1),e("p",Ch,t(v.email),1)]),D.value?T("",!0):(s(),o("div",Ah,[e("button",{onClick:m,disabled:M.value,class:"w-full flex items-center justify-center px-4 py-3 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-medium rounded-lg transition-all duration-200 shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed"},[M.value?(s(),o("div",Eh)):(s(),ce(ue,{key:0,class:"w-5 h-5 mr-2"})),z(" "+t(M.value?"En cours...":"Devenir vendeur individuel"),1)],8,Ph),G[12]||(G[12]=e("p",{class:"text-xs text-gray-500 mt-2 text-center"}," Vendez vos produits avec 500 tickets par tombola ",-1))])),e("nav",jh,[(s(),o(ie,null,le(V,se=>e("button",{key:se.key,onClick:fe=>a.value=se.key,class:te(["w-full flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors",a.value===se.key?"bg-blue-50 text-blue-600 border-r-2 border-blue-600":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"])},[(s(),ce(Ie(se.icon),{class:"w-5 h-5 mr-3"})),z(" "+t(se.label),1)],10,Sh)),64))])])]),e("div",Ih,[a.value==="personal"?(s(),o("div",Dh,[G[21]||(G[21]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Informations personnelles",-1)),e("form",{onSubmit:_e(A,["prevent"])},[e("div",Th,[e("div",null,[G[13]||(G[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[z(" Prénom "),e("span",{class:"text-red-500"},"*")],-1)),Q(e("input",{"onUpdate:modelValue":G[0]||(G[0]=se=>d.first_name=se),type:"text",required:"",placeholder:"Votre prénom",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,d.first_name]])]),e("div",null,[G[14]||(G[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[z(" Nom "),e("span",{class:"text-red-500"},"*")],-1)),Q(e("input",{"onUpdate:modelValue":G[1]||(G[1]=se=>d.last_name=se),type:"text",required:"",placeholder:"Votre nom de famille",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,d.last_name]])]),e("div",null,[G[15]||(G[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[z(" Email "),e("span",{class:"text-red-500"},"*")],-1)),Q(e("input",{"onUpdate:modelValue":G[2]||(G[2]=se=>d.email=se),type:"email",required:"",placeholder:"votre@email.com",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,d.email]])]),e("div",null,[G[16]||(G[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Téléphone",-1)),g(tt,{ref_key:"phoneInputRef",ref:$,modelValue:d.phone,"onUpdate:modelValue":G[3]||(G[3]=se=>d.phone=se),class:"w-full","initial-country":"ga","preferred-countries":["ga","cm","ci","cg","cf","td","gq","bf","bj","tg","fr","ca"]},null,8,["modelValue"])]),e("div",null,[G[17]||(G[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de naissance",-1)),Q(e("input",{"onUpdate:modelValue":G[4]||(G[4]=se=>d.birth_date=se),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[ne,d.birth_date]])]),e("div",null,[G[19]||(G[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Genre",-1)),Q(e("select",{"onUpdate:modelValue":G[5]||(G[5]=se=>d.gender=se),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},G[18]||(G[18]=[e("option",{value:""},"Sélectionner...",-1),e("option",{value:"male"},"Homme",-1),e("option",{value:"female"},"Femme",-1),e("option",{value:"other"},"Autre",-1)]),512),[[me,d.gender]])])]),e("div",Mh,[G[20]||(G[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rôle",-1)),e("div",Lh,t(U.value),1)]),e("div",Vh,[e("button",{type:"submit",disabled:c.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400"},[c.value?(s(),o("span",Fh,"Mise à jour...")):(s(),o("span",Nh,"Mettre à jour"))],8,Rh)])],32)])):T("",!0),a.value==="address"?(s(),o("div",zh,[G[27]||(G[27]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Adresse",-1)),e("form",{onSubmit:_e(H,["prevent"])},[e("div",qh,[e("div",null,[G[22]||(G[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Adresse",-1)),Q(e("input",{"onUpdate:modelValue":G[6]||(G[6]=se=>i.address=se),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[ne,i.address]])]),e("div",Uh,[e("div",null,[G[23]||(G[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Ville",-1)),Q(e("input",{"onUpdate:modelValue":G[7]||(G[7]=se=>i.city=se),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[ne,i.city]])]),e("div",null,[G[24]||(G[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Code postal",-1)),Q(e("input",{"onUpdate:modelValue":G[8]||(G[8]=se=>i.postal_code=se),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[ne,i.postal_code]])])]),e("div",null,[G[26]||(G[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Pays",-1)),e("div",Bh,[z(t(v.country?.name||"Non spécifié")+" ",1),G[25]||(G[25]=e("div",{class:"text-xs text-gray-500 mt-1"},"Le pays n'est pas modifiable après l'inscription",-1))])])]),e("div",Oh,[e("button",{type:"submit",disabled:n.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400"},[n.value?(s(),o("span",Hh,"Mise à jour...")):(s(),o("span",Kh,"Mettre à jour"))],8,Gh)])],32)])):T("",!0),a.value==="security"?(s(),o("div",Wh,[G[34]||(G[34]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Sécurité",-1)),e("div",Jh,[e("div",Xh,[G[31]||(G[31]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Changer le mot de passe",-1)),e("form",{onSubmit:_e(j,["prevent"]),class:"space-y-4"},[e("div",null,[G[28]||(G[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mot de passe actuel",-1)),Q(e("input",{"onUpdate:modelValue":G[9]||(G[9]=se=>C.current_password=se),type:"password",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[ne,C.current_password]])]),e("div",null,[G[29]||(G[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nouveau mot de passe",-1)),Q(e("input",{"onUpdate:modelValue":G[10]||(G[10]=se=>C.new_password=se),type:"password",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[ne,C.new_password]])]),e("div",null,[G[30]||(G[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Confirmer le nouveau mot de passe",-1)),Q(e("input",{"onUpdate:modelValue":G[11]||(G[11]=se=>C.confirm_password=se),type:"password",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",style:{color:"#5f5f5f"}},null,512),[[ne,C.confirm_password]])]),e("button",{type:"submit",disabled:r.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400"},[r.value?(s(),o("span",Qh,"Mise à jour...")):(s(),o("span",Zh,"Changer le mot de passe"))],8,Yh)],32)]),e("div",e_,[e("div",t_,[G[32]||(G[32]=e("div",null,[e("h3",{class:"text-lg font-medium text-gray-900"},"Authentification à deux facteurs"),e("p",{class:"text-sm text-gray-600 mt-1"},"Ajoutez une couche de sécurité supplémentaire à votre compte")],-1)),e("button",{onClick:b,class:te(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2",v.two_factor_enabled?"bg-blue-600":"bg-gray-200"])},[e("span",{class:te(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",v.two_factor_enabled?"translate-x-5":"translate-x-0"])},null,2)],2)])]),e("div",null,[G[33]||(G[33]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Sessions de connexion",-1)),e("div",s_,[(s(!0),o(ie,null,le(I.value,se=>(s(),o("div",{key:se.id,class:"flex justify-between items-center p-4 border border-gray-200 rounded-lg"},[e("div",o_,[se.device_type==="mobile"?(s(),ce(l(mt),{key:0,class:"w-6 h-6 text-gray-600 mr-3"})):(s(),ce(l(cs),{key:1,class:"w-6 h-6 text-gray-600 mr-3"})),e("div",null,[e("p",r_,t(se.device_name),1),e("p",a_,t(se.location)+" • "+t(K(se.last_active)),1)])]),e("div",n_,[se.is_current?(s(),o("span",i_," Session actuelle ")):T("",!0),se.is_current?T("",!0):(s(),o("button",{key:1,onClick:fe=>ee(se.id),class:"text-sm text-red-600 hover:text-red-700"}," Révoquer ",8,l_))])]))),128))])])])])):T("",!0),a.value==="notifications"?(s(),o("div",d_,[G[37]||(G[37]=e("h2",{class:"text-xl font-semibold text-gray-900 mb-6"},"Préférences de notification",-1)),e("form",{onSubmit:_e(h,["prevent"])},[e("div",u_,[(s(),o(ie,null,le(N,se=>e("div",{key:se.key,class:"border-b border-gray-200 pb-6 last:border-b-0 last:pb-0"},[e("h3",c_,t(se.title),1),e("div",m_,[(s(!0),o(ie,null,le(se.notifications,fe=>(s(),o("div",{key:fe.key,class:"flex justify-between items-start"},[e("div",p_,[e("p",g_,t(fe.title),1),e("p",f_,t(fe.description),1)]),e("div",v_,[e("label",x_,[Q(e("input",{"onUpdate:modelValue":ke=>u[fe.key].email=ke,type:"checkbox",class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,8,b_),[[Ae,u[fe.key].email]]),G[35]||(G[35]=e("span",{class:"ml-2 text-sm text-gray-700"},"Email",-1))]),e("label",y_,[Q(e("input",{"onUpdate:modelValue":ke=>u[fe.key].sms=ke,type:"checkbox",class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,8,h_),[[Ae,u[fe.key].sms]]),G[36]||(G[36]=e("span",{class:"ml-2 text-sm text-gray-700"},"SMS",-1))])])]))),128))])])),64))]),e("div",__,[e("button",{type:"submit",disabled:P.value,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400"},[P.value?(s(),o("span",$_,"Mise à jour...")):(s(),o("span",k_,"Sauvegarder les préférences"))],8,w_)])],32)])):T("",!0)])])])}}};function A_(){const{get:_,post:y,loading:w,error:p}=ge(),f=R([]),a=R({totalTickets:0,prizesWon:0,totalSpent:0,activeTickets:0}),c=R(!1),n=R(1),r=R(!0),P=R(10),$=R(0),M=R(1),D=R(0),m=R(0),k=R({search:"",status:"",period:""}),U=de(()=>{let q=f.value;if(k.value.search){const O=k.value.search.toLowerCase();q=q.filter(K=>K.product.title.toLowerCase().includes(O)||K.product.description.toLowerCase().includes(O))}if(k.value.status&&(q=q.filter(O=>O.status===k.value.status)),k.value.period){const O=new Date,K=k.value.period;q=q.filter(W=>{const J=new Date(W.purchased_at);if(K==="week"){const G=new Date(O.getTime()-6048e5);return J>=G}else if(K==="month"){const G=new Date(O.getFullYear(),O.getMonth()-1,O.getDate());return J>=G}else if(K==="quarter"){const G=new Date(O.getFullYear(),O.getMonth()-3,O.getDate());return J>=G}return!0})}return q.sort((O,K)=>new Date(K.purchased_at)-new Date(O.purchased_at))}),V=de(()=>[{label:"Total tickets",value:a.value.totalTickets.toString(),color:"bg-blue-500",icon:"TicketIcon"},{label:"Prix gagnés",value:a.value.prizesWon.toString(),color:"bg-blue-500",icon:"TrophyIcon"},{label:"Total dépensé",value:B(a.value.totalSpent),color:"bg-yellow-500",icon:"CurrencyDollarIcon"},{label:"En cours",value:a.value.activeTickets.toString(),color:"bg-purple-500",icon:"ClockIcon"}]),v=async(q=1,O=!1)=>{try{const K=new URLSearchParams({page:q.toString(),per_page:P.value.toString()});k.value.search&&K.append("search",k.value.search),k.value.status&&K.append("status",k.value.status),k.value.period&&K.append("period",k.value.period);const W=await _(`/tickets/my-tickets?${K.toString()}`);if(W&&W.success){const J=W.data||[],G=W.pagination||{},ue=J.map(se=>({id:se.id,product:{id:se.lottery?.product?.id,title:(se.lottery?.product?.name||"Produit inconnu").replace(/[\r\n]+/g," ").trim(),description:(se.lottery?.product?.description||"").replace(/[\r\n]+/g," ").trim(),image_url:se.lottery?.product?.image_url||se.lottery?.product?.image,image:se.lottery?.product?.image_url||se.lottery?.product?.image||"/images/products/placeholder.jpg"},lottery:{id:se.lottery?.id,title:(se.lottery?.title||"").replace(/[\r\n]+/g," ").trim(),draw_date:se.lottery?.draw_date?new Date(se.lottery.draw_date):null,end_date:se.lottery?.end_date?new Date(se.lottery.end_date):null,progress:se.lottery?Math.round(se.lottery.sold_tickets/se.lottery.max_tickets*100):0,winning_number:se.lottery?.winner_ticket_number||null},quantity:1,total_price:se.price||0,status:se.status||"active",purchased_at:se.purchased_at?new Date(se.purchased_at):new Date(se.created_at),ticket_numbers:[se.ticket_number],winning_number:se.is_winner?se.ticket_number:null,prize_claimed:se.prize_claimed||!1}));O?f.value=[...f.value,...ue]:f.value=ue,n.value=G.current_page||q,$.value=G.total||ue.length,M.value=G.last_page||1,D.value=G.from||0,m.value=G.to||ue.length,r.value=G.current_page<G.last_page,await A()}}catch(K){console.error("Erreur lors du chargement des tickets:",K)}},d=async()=>{r.value&&!w.value&&await v(n.value+1,!0)},i=async q=>{q>=1&&q<=M.value&&q!==n.value&&!w.value&&await v(q,!1)},C=async q=>{P.value=q,n.value=1,await v(1,!1)},x=async()=>{n.value<M.value&&await i(n.value+1)},I=async()=>{n.value>1&&await i(n.value-1)},N=()=>{const q=[],K=Math.floor(2.5);let W=Math.max(1,n.value-K),J=Math.min(M.value,W+5-1);J-W+1<5&&(W=Math.max(1,J-5+1));for(let G=W;G<=J;G++)q.push(G);return q},u=async()=>{n.value=1,await v(1,!1)},A=async()=>{try{c.value=!0;const q=await _("/stats/customer/tickets");if(q&&q.success){const O=q.data;a.value={totalTickets:O.total_tickets||0,prizesWon:O.prizes_won||0,totalSpent:O.total_spent||0,activeTickets:O.active_tickets||0}}}catch(q){console.error("Erreur lors du chargement des statistiques:",q);const O=f.value.length,K=f.value.filter(G=>G.status==="won").length,W=f.value.reduce((G,ue)=>{const se=parseFloat(ue.total_price)||0;return G+se},0),J=f.value.filter(G=>G.status==="active"||G.status==="paid").length;a.value={totalTickets:O,prizesWon:K,totalSpent:W,activeTickets:J}}finally{c.value=!1}},H=async q=>{try{const O=await y(`/tickets/${q}/claim-prize`);if(O&&O.success){const K=f.value.findIndex(W=>W.id===q);return K!==-1&&(f.value[K].prize_claimed=!0),O}}catch(O){throw console.error("Erreur lors de la réclamation du prix:",O),O}},j=async q=>{try{const O=await _(`/tickets/${q}/download`);if(O)if(typeof O=="string"&&O.startsWith("http")){const K=document.createElement("a");K.href=O,K.setAttribute("download",`ticket-${q}.pdf`),K.setAttribute("target","_blank"),document.body.appendChild(K),K.click(),K.remove()}else{const K=window.URL.createObjectURL(new Blob([O])),W=document.createElement("a");W.href=K,W.setAttribute("download",`ticket-${q}.pdf`),document.body.appendChild(W),W.click(),W.remove(),window.URL.revokeObjectURL(K)}}catch(O){throw console.error("Erreur lors du téléchargement du ticket:",O),O}},h=()=>{k.value={search:"",status:"",period:""},u()},b=()=>{u()};De(()=>k.value,()=>{clearTimeout(ee),ee=setTimeout(()=>{b()},500)},{deep:!0});let ee=null;const B=q=>{const O=parseFloat(q)||0;return O>=1e6?(O/1e6).toFixed(1)+"M FCFA":O>=1e3?(O/1e3).toFixed(0)+"k FCFA":O.toLocaleString("fr-FR")+" FCFA"};return{tickets:f,filteredTickets:U,stats:V,filters:k,currentPage:n,hasMore:r,total:$,lastPage:M,from:D,to:m,perPage:P,loading:w,error:p,statsLoading:c,loadTickets:v,loadMore:d,refreshTickets:u,claimPrize:H,downloadTicket:j,resetFilters:h,applyFilters:b,goToPage:i,changePerPage:C,nextPage:x,previousPage:I,getPageNumbers:N,loadStats:A,formatCurrency:B,formatDate:q=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(q)),getRemainingTime:(q,O)=>{if(O==="lost"||O==="won")return"Tirage terminé";const K=new Date,J=new Date(q)-K;if(J<=0)return"Tirage en cours";const G=Math.floor(J/(1e3*60*60*24)),ue=Math.floor(J%(1e3*60*60*24)/(1e3*60*60));return G>0?`Tirage dans ${G} jour${G>1?"s":""}`:ue>0?`Tirage dans ${ue}h`:`Tirage dans ${Math.floor(J%36e5/6e4)}min`},getStatusLabel:q=>({active:"En cours",won:"Gagné",lost:"Perdu",pending:"Tirage imminent",reserved:"Réservé",paid:"Payé"})[q]||q}}const P_={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},E_={class:"flex items-center"},j_={class:"ml-4"},S_={class:"text-sm font-medium text-gray-600"},I_={class:"text-2xl font-bold text-gray-900"},D_={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-6"},T_={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},M_={class:"flex items-end"},L_={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},V_={class:"flex"},R_={class:"ml-3"},F_={class:"mt-2 text-sm text-red-700"},N_={class:"mt-4"},z_={class:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6"},q_={class:"p-4 border-b border-gray-200 flex justify-between items-center"},U_={class:"flex items-center space-x-4"},B_=["value"],O_={key:0,class:"text-sm text-gray-700"},G_={key:0,class:"text-center py-12"},H_={key:1,class:"text-center py-12"},K_={class:"text-lg font-medium text-gray-900 mb-2"},W_={class:"text-gray-600 mb-4"},J_={key:2,class:"overflow-x-auto"},X_={class:"min-w-full divide-y divide-gray-200"},Y_={class:"bg-white divide-y divide-gray-200"},Q_={class:"px-6 py-4 whitespace-nowrap"},Z_={class:"flex items-center"},e2={class:"flex-shrink-0 h-12 w-12"},t2=["src","alt"],s2={class:"ml-4"},o2={class:"text-sm font-medium text-gray-900"},r2={class:"text-sm text-gray-500 truncate max-w-xs"},a2={class:"px-6 py-4 whitespace-nowrap"},n2={class:"flex flex-wrap gap-1"},i2={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},l2={class:"px-6 py-4 whitespace-nowrap"},d2={key:0,class:"mt-1"},u2={class:"flex items-center text-xs text-blue-600"},c2={key:0,class:"mt-1"},m2=["onClick","disabled"],p2={key:1,class:"mt-1"},g2={class:"inline-flex items-center text-xs text-blue-600"},f2={key:1,class:"mt-1 text-xs text-red-600"},v2={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},x2={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},b2={class:"text-xs text-gray-500"},y2={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},h2={class:"flex justify-end space-x-2"},_2=["onClick","disabled"],w2={key:3,class:"px-6 py-4 border-t border-gray-200 bg-white"},$2={class:"flex items-center justify-between"},k2={class:"flex-1 flex justify-between sm:hidden"},C2=["disabled"],A2=["disabled"],P2={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},E2={class:"text-sm text-gray-700"},j2={class:"font-medium"},S2={class:"font-medium"},I2={class:"font-medium"},D2={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},T2=["disabled"],M2=["onClick"],L2=["disabled"],V2={__name:"MyTickets",setup(_){const{filteredTickets:y,stats:w,filters:p,currentPage:f,lastPage:a,total:c,from:n,to:r,perPage:P,loading:$,error:M,loadTickets:D,claimPrize:m,downloadTicket:k,resetFilters:U,goToPage:V,changePerPage:v,nextPage:d,previousPage:i,getPageNumbers:C,formatCurrency:x,formatDate:I,getRemainingTime:N,getStatusLabel:u}=A_(),A={TicketIcon:je,TrophyIcon:Je,CurrencyDollarIcon:Ke,ClockIcon:Te},H=async h=>{try{await m(h),console.log("Prix réclamé avec succès")}catch(b){console.error("Erreur lors de la réclamation du prix:",b),window.$toast&&window.$toast.error("Erreur lors de la réclamation du prix. Veuillez réessayer.","Erreur")}},j=async h=>{try{await k(h)}catch(b){console.error("Erreur lors du téléchargement:",b),window.$toast&&window.$toast.error("Erreur lors du téléchargement. Veuillez réessayer.","Erreur")}};return ve(()=>{D()}),(h,b)=>{const ee=he("router-link");return s(),o("div",null,[b[30]||(b[30]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Mes tickets"),e("p",{class:"mt-2 text-gray-600"},"Suivez vos participations aux tombolas")],-1)),e("div",P_,[(s(!0),o(ie,null,le(l(w),B=>(s(),o("div",{key:B.label,class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},[e("div",E_,[e("div",{class:te(["p-3 rounded-lg",B.color])},[(s(),ce(Ie(A[B.icon]),{class:"w-6 h-6 text-white"}))],2),e("div",j_,[e("p",S_,t(B.label),1),e("p",I_,t(B.value),1)])])]))),128))]),e("div",D_,[e("div",T_,[e("div",null,[b[10]||(b[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rechercher",-1)),Q(e("input",{"onUpdate:modelValue":b[0]||(b[0]=B=>l(p).search=B),type:"text",placeholder:"Nom du produit...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,l(p).search]])]),e("div",null,[b[12]||(b[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),Q(e("select",{"onUpdate:modelValue":b[1]||(b[1]=B=>l(p).status=B),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},b[11]||(b[11]=[pe('<option value="">Tous les statuts</option><option value="active">En cours</option><option value="won">Gagné</option><option value="lost">Perdu</option><option value="pending">En attente</option><option value="reserved">Réservé</option><option value="paid">Payé</option>',7)]),512),[[me,l(p).status]])]),e("div",null,[b[14]||(b[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Période",-1)),Q(e("select",{"onUpdate:modelValue":b[2]||(b[2]=B=>l(p).period=B),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},b[13]||(b[13]=[e("option",{value:""},"Toutes les périodes",-1),e("option",{value:"week"},"Cette semaine",-1),e("option",{value:"month"},"Ce mois",-1),e("option",{value:"quarter"},"Ce trimestre",-1)]),512),[[me,l(p).period]])]),e("div",M_,[e("button",{onClick:b[3]||(b[3]=(...B)=>l(U)&&l(U)(...B)),class:"w-full px-4 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"}," Réinitialiser ")])])]),l(M)?(s(),o("div",L_,[e("div",V_,[g(l(Se),{class:"h-5 w-5 text-red-400"}),e("div",R_,[b[15]||(b[15]=e("h3",{class:"text-sm font-medium text-red-800"}," Erreur de chargement ",-1)),e("div",F_,[e("p",null,t(l(M)),1)]),e("div",N_,[e("button",{onClick:b[4]||(b[4]=B=>l(D)()),class:"text-sm bg-red-100 text-red-800 px-3 py-1 rounded-md hover:bg-red-200 transition-colors"}," Réessayer ")])])])])):T("",!0),e("div",z_,[e("div",q_,[e("div",U_,[b[17]||(b[17]=e("span",{class:"text-sm text-gray-700"},"Afficher",-1)),e("select",{value:l(P),onChange:b[5]||(b[5]=B=>l(v)(parseInt(B.target.value))),class:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},b[16]||(b[16]=[e("option",{value:"5"},"5",-1),e("option",{value:"10"},"10",-1),e("option",{value:"25"},"25",-1),e("option",{value:"50"},"50",-1)]),40,B_),b[18]||(b[18]=e("span",{class:"text-sm text-gray-700"},"entrées",-1))]),l(c)>0?(s(),o("div",O_," Affichage de "+t(l(n))+" à "+t(l(r))+" sur "+t(l(c))+" tickets ",1)):T("",!0)]),l($)?(s(),o("div",G_,b[19]||(b[19]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement de vos tickets...",-1)]))):l(y).length===0?(s(),o("div",H_,[g(l(je),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e("h3",K_,t(l(y).length===0&&!l(p).search&&!l(p).status&&!l(p).period?"Aucun ticket acheté":"Aucun résultat trouvé"),1),e("p",W_,t(l(y).length===0&&!l(p).search&&!l(p).status&&!l(p).period?"Vous n'avez pas encore participé à des tombolas":"Essayez de modifier vos filtres de recherche"),1),l(y).length===0&&!l(p).search&&!l(p).status&&!l(p).period?(s(),ce(ee,{key:0,to:"/customer/products",class:"inline-block bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors"},{default:re(()=>b[20]||(b[20]=[z(" Découvrir les produits ",-1)])),_:1,__:[20]})):T("",!0)])):(s(),o("div",J_,[e("table",X_,[b[23]||(b[23]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Produit"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Numéro"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Prix"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Statut"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date d'achat"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tirage"),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Y_,[(s(!0),o(ie,null,le(l(y),B=>(s(),o("tr",{key:B.id,class:"hover:bg-gray-50"},[e("td",Q_,[e("div",Z_,[e("div",e2,[e("img",{class:"h-12 w-12 rounded-lg object-cover",src:B.product.image_url||B.product.main_image||B.product.image,alt:B.product.title},null,8,t2)]),e("div",s2,[e("div",o2,t(B.product.title),1),e("div",r2,t(B.product.description),1)])])]),e("td",a2,[e("div",n2,[(s(!0),o(ie,null,le(B.ticket_numbers,S=>(s(),o("span",{key:S,class:te(["px-2 py-1 text-xs font-mono rounded border",B.winning_number===S?"bg-blue-100 text-blue-800 border-blue-300":"bg-gray-50 text-gray-700 border-gray-300"])}," #"+t(S),3))),128))])]),e("td",i2,t(l(x)(B.total_price)),1),e("td",l2,[e("span",{class:te(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",B.status==="won"?"bg-blue-100 text-blue-800":B.status==="lost"?"bg-red-100 text-red-800":B.status==="active"?"bg-blue-100 text-blue-800":B.status==="reserved"?"bg-orange-100 text-orange-800":B.status==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"])},t(l(u)(B.status)),3),B.status==="won"?(s(),o("div",d2,[e("div",u2,[g(l(Je),{class:"w-3 h-3 mr-1"}),e("span",null,"Gagnant #"+t(B.winning_number),1)]),B.prize_claimed?(s(),o("div",p2,[e("span",g2,[g(l(Re),{class:"w-3 h-3 mr-1"}),b[21]||(b[21]=z(" Réclamé ",-1))])])):(s(),o("div",c2,[e("button",{onClick:S=>H(B.id),disabled:l($),class:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700 transition-colors disabled:opacity-50"}," Réclamer ",8,m2)]))])):T("",!0),B.status==="lost"?(s(),o("div",f2," Gagnant: #"+t(B.winning_number),1)):T("",!0)]),e("td",v2,t(l(I)(B.purchased_at)),1),e("td",x2,[z(t(l(I)(B.lottery.draw_date))+" ",1),e("div",b2,t(l(N)(B.lottery.draw_date,B.status)),1)]),e("td",y2,[e("div",h2,[g(ee,{to:`/customer/products/${B.product.id}`,class:"text-blue-600 hover:text-blue-900"},{default:re(()=>b[22]||(b[22]=[z(" Voir ",-1)])),_:2,__:[22]},1032,["to"]),e("button",{onClick:S=>j(B.id),disabled:l($),class:"text-gray-600 hover:text-gray-900 disabled:opacity-50"}," PDF ",8,_2)])])]))),128))])])])),!l($)&&l(y).length>0&&l(a)>1?(s(),o("div",w2,[e("div",$2,[e("div",k2,[e("button",{onClick:b[6]||(b[6]=(...B)=>l(i)&&l(i)(...B)),disabled:l(f)===1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Précédent ",8,C2),e("button",{onClick:b[7]||(b[7]=(...B)=>l(d)&&l(d)(...B)),disabled:l(f)===l(a),class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Suivant ",8,A2)]),e("div",P2,[e("div",null,[e("p",E2,[b[24]||(b[24]=z(" Affichage de ",-1)),e("span",j2,t(l(n)),1),b[25]||(b[25]=z(" à ",-1)),e("span",S2,t(l(r)),1),b[26]||(b[26]=z(" sur ",-1)),e("span",I2,t(l(c)),1),b[27]||(b[27]=z(" résultats ",-1))])]),e("div",null,[e("nav",D2,[e("button",{onClick:b[8]||(b[8]=(...B)=>l(i)&&l(i)(...B)),disabled:l(f)===1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[b[28]||(b[28]=e("span",{class:"sr-only"},"Précédent",-1)),g(l(Hs),{class:"h-5 w-5"})],8,T2),(s(!0),o(ie,null,le(l(C)(),B=>(s(),o("button",{key:B,onClick:S=>l(V)(B),class:te(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",B===l(f)?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"])},t(B),11,M2))),128)),e("button",{onClick:b[9]||(b[9]=(...B)=>l(d)&&l(d)(...B)),disabled:l(f)===l(a),class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},[b[29]||(b[29]=e("span",{class:"sr-only"},"Suivant",-1)),g(l(is),{class:"h-5 w-5"})],8,L2)])])])])])):T("",!0)])])}}},R2={class:"min-h-screen bg-gray-50 py-8"},F2={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},N2={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},z2={class:"flex items-center justify-between"},q2={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},U2={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},B2={class:"flex items-center"},O2={class:"text-2xl font-bold text-gray-900"},G2={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},H2={class:"flex items-center"},K2={class:"text-2xl font-bold text-gray-900"},W2={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},J2={class:"flex items-center"},X2={class:"text-2xl font-bold text-gray-900"},Y2={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},Q2={class:"flex items-center"},Z2={class:"text-2xl font-bold text-gray-900"},ew={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-8"},tw={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},sw={class:"flex items-center space-x-4"},ow={class:"text-sm text-gray-500"},rw={key:0,class:"text-center py-12"},aw={key:1,class:"text-center py-12"},nw={key:2,class:"space-y-4"},iw={class:"flex items-start justify-between"},lw={class:"flex-1"},dw={class:"flex items-center space-x-3 mb-2"},uw={class:"font-mono text-sm text-gray-600"},cw={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800"},mw={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4"},pw={class:"text-lg font-semibold text-gray-900"},gw={class:"text-sm font-medium"},fw={class:"text-sm"},vw={key:0,class:"bg-gray-50 rounded-lg p-3 mb-4"},xw={class:"font-medium"},bw={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4"},yw={class:"text-sm text-red-700 mt-1"},hw={key:2,class:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4"},_w={class:"text-sm text-blue-700 mt-1"},ww={class:"flex space-x-2 ml-4"},$w=["onClick"],kw=["onClick"],Cw={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Aw={class:"flex items-center justify-center min-h-screen px-4"},Pw={class:"relative bg-white rounded-lg max-w-lg w-full"},Ew={class:"p-6"},jw={class:"flex items-center justify-between mb-4"},Sw={class:"space-y-4"},Iw=["value"],Dw={class:"flex justify-end space-x-3 mt-6"},Tw=["disabled"],Mw={key:1,class:"fixed inset-0 z-50 overflow-y-auto"},Lw={class:"flex items-center justify-center min-h-screen px-4"},Vw={class:"relative bg-white rounded-lg max-w-2xl w-full max-h-screen overflow-y-auto"},Rw={class:"p-6"},Fw={class:"flex items-center justify-between mb-6"},Nw={class:"space-y-6"},zw={class:"grid grid-cols-2 gap-4"},qw={class:"font-mono font-medium"},Uw={class:"grid grid-cols-2 gap-4"},Bw={class:"text-xl font-semibold text-blue-600"},Ow={class:"bg-gray-50 rounded-lg p-4"},Gw={class:"grid grid-cols-2 gap-4"},Hw={class:"font-mono"},Kw={key:0,class:"bg-blue-50 rounded-lg p-4"},Ww={class:"mt-2"},Jw={class:"space-y-2"},Xw={class:"flex justify-between"},Yw={class:"text-sm"},Qw={key:0,class:"flex justify-between"},Zw={class:"text-sm"},e4={key:1,class:"flex justify-between"},t4={class:"text-sm"},s4={key:2,class:"flex justify-between"},o4={class:"text-sm"},r4={__name:"Refunds",setup(_){const{get:y,post:w}=ge(),p=R([]),f=R({}),a=R(!1),c=R(""),n=R(!1),r=R(!1),P=R(null),$=R([]),M=R({transaction_id:"",reason:"",notes:""}),D=async()=>{a.value=!0;try{const H=new URLSearchParams({limit:50});c.value&&H.append("status",c.value);const j=await y(`/refunds?${H}`);p.value=j.data.refunds||[],f.value=j.data.stats||{}}catch(H){console.error("Error loading refunds:",H)}finally{a.value=!1}},m=async()=>{try{const H=await y("/transactions?status=completed&limit=100");$.value=H.data.transactions?.filter(j=>!j.has_refund)||[]}catch(H){console.error("Error loading transactions:",H)}},k=async()=>{r.value=!0;try{const H=await w("/refunds",M.value);p.value.unshift(H.data.refund),f.value.total_refunds=(f.value.total_refunds||0)+1,f.value.pending_refunds=(f.value.pending_refunds||0)+1,M.value={transaction_id:"",reason:"",notes:""},n.value=!1,window.$toast&&window.$toast.success("Demande de remboursement créée avec succès!","✅ Demande créée")}catch(H){console.error("Error creating refund:",H),window.$toast&&window.$toast.error("Erreur lors de la création de la demande","❌ Erreur")}finally{r.value=!1}},U=async H=>{if(confirm("Êtes-vous sûr de vouloir annuler cette demande ?"))try{await w(`/refunds/${H.id}/cancel`);const j=p.value.findIndex(h=>h.id===H.id);j!==-1&&(p.value[j].status="rejected",p.value[j].rejection_reason="Annulé par l'utilisateur"),window.$toast&&window.$toast.success("Demande annulée avec succès","✅ Annulation")}catch(j){console.error("Error cancelling refund:",j),window.$toast&&window.$toast.error("Erreur lors de l'annulation","❌ Erreur")}},V=H=>{P.value=H},v=()=>{n.value=!1,M.value={transaction_id:"",reason:"",notes:""}},d=()=>{c.value="",D()},i=H=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(H||0)+" FCFA",C=H=>H?H>=1e6?(H/1e6).toFixed(1)+"M":H>=1e3?(H/1e3).toFixed(0)+"K":H.toString():"0",x=H=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(H)),I=H=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",processed:"bg-purple-100 text-purple-800",completed:"bg-blue-100 text-blue-800",rejected:"bg-red-100 text-red-800",failed:"bg-red-100 text-red-800"})[H]||"bg-gray-100 text-gray-800",N=H=>({pending:"⏳ En attente",approved:"✅ Approuvé",processed:"🔄 En traitement",completed:"✅ Terminé",rejected:"❌ Rejeté",failed:"❌ Échec"})[H]||H,u=H=>({insufficient_participants:"Participants insuffisants",lottery_cancelled:"Tombola annulée",accidental_purchase:"Achat accidentel",changed_mind:"Changement d'avis",duplicate_purchase:"Achat en double",technical_issue:"Problème technique",system_error:"Erreur système",other:"Autre"})[H]||H,A=H=>({mobile_money:"Mobile Money",bank_transfer:"Virement bancaire",wallet_credit:"Crédit portefeuille"})[H]||H;return ve(async()=>{await Promise.all([D(),m()])}),(H,j)=>(s(),o("div",R2,[e("div",F2,[e("div",N2,[e("div",z2,[j[8]||(j[8]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"💸 Mes Remboursements"),e("p",{class:"text-gray-600 mt-1"},"Gérez vos demandes de remboursement")],-1)),e("button",{onClick:j[0]||(j[0]=h=>n.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"}," ➕ Nouvelle demande ")])]),e("div",q2,[e("div",U2,[e("div",B2,[j[10]||(j[10]=e("div",{class:"p-3 rounded-full bg-blue-100 text-blue-600 mr-4"}," 💰 ",-1)),e("div",null,[e("div",O2,t(f.value.total_refunds||0),1),j[9]||(j[9]=e("div",{class:"text-sm text-gray-600"},"Remboursements",-1))])])]),e("div",G2,[e("div",H2,[j[12]||(j[12]=e("div",{class:"p-3 rounded-full bg-blue-100 text-blue-600 mr-4"}," ✅ ",-1)),e("div",null,[e("div",K2,t(C(f.value.total_amount_refunded)),1),j[11]||(j[11]=e("div",{class:"text-sm text-gray-600"},"Montant remboursé",-1))])])]),e("div",W2,[e("div",J2,[j[14]||(j[14]=e("div",{class:"p-3 rounded-full bg-yellow-100 text-yellow-600 mr-4"}," ⏳ ",-1)),e("div",null,[e("div",X2,t(f.value.pending_refunds||0),1),j[13]||(j[13]=e("div",{class:"text-sm text-gray-600"},"En attente",-1))])])]),e("div",Y2,[e("div",Q2,[j[16]||(j[16]=e("div",{class:"p-3 rounded-full bg-red-100 text-red-600 mr-4"}," X ",-1)),e("div",null,[e("div",Z2,t(f.value.rejected_refunds||0),1),j[15]||(j[15]=e("div",{class:"text-sm text-gray-600"},"Rejetées",-1))])])])]),e("div",ew,[e("div",tw,[e("div",sw,[Q(e("select",{"onUpdate:modelValue":j[1]||(j[1]=h=>c.value=h),onChange:D,class:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},j[17]||(j[17]=[pe('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="approved">Approuvé</option><option value="processed">Traité</option><option value="completed">Terminé</option><option value="rejected">Rejeté</option>',6)]),544),[[me,c.value]]),e("button",{onClick:d,class:"px-3 py-2 text-gray-600 hover:text-gray-800 text-sm"}," Réinitialiser ")]),e("div",ow,t(p.value.length)+" remboursement(s) ",1)])]),a.value?(s(),o("div",rw,j[18]||(j[18]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement des remboursements...",-1)]))):p.value.length===0?(s(),o("div",aw,[g(l(Ge),{class:"mx-auto h-16 w-16 text-gray-400 mb-4"}),j[19]||(j[19]=e("h3",{class:"text-xl font-medium text-gray-900 mb-2"},"Aucun remboursement",-1)),j[20]||(j[20]=e("p",{class:"text-gray-600 mb-6"},"Vous n'avez pas encore de demande de remboursement.",-1)),e("button",{onClick:j[2]||(j[2]=h=>n.value=!0),class:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Faire une demande ")])):(s(),o("div",nw,[(s(!0),o(ie,null,le(p.value,h=>(s(),o("div",{key:h.id,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow"},[e("div",iw,[e("div",lw,[e("div",dw,[e("span",uw,t(h.refund_number),1),e("span",{class:te(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",I(h.status)])},t(N(h.status)),3),h.auto_processed?(s(),o("span",cw," 🤖 Automatique ")):T("",!0)]),e("div",mw,[e("div",null,[j[21]||(j[21]=e("div",{class:"text-sm text-gray-600"},"Montant",-1)),e("div",pw,t(i(h.amount)),1)]),e("div",null,[j[22]||(j[22]=e("div",{class:"text-sm text-gray-600"},"Raison",-1)),e("div",gw,t(u(h.reason)),1)]),e("div",null,[j[23]||(j[23]=e("div",{class:"text-sm text-gray-600"},"Date de demande",-1)),e("div",fw,t(x(h.created_at)),1)])]),h.lottery?(s(),o("div",vw,[j[24]||(j[24]=e("div",{class:"text-sm text-gray-600"},"Tombola concernée",-1)),e("div",xw,t(h.lottery.lottery_number)+" - "+t(h.lottery.product_title),1)])):T("",!0),h.rejection_reason?(s(),o("div",bw,[j[25]||(j[25]=e("div",{class:"text-sm font-medium text-red-800"},"Raison du rejet",-1)),e("div",yw,t(h.rejection_reason),1)])):T("",!0),h.notes?(s(),o("div",hw,[j[26]||(j[26]=e("div",{class:"text-sm font-medium text-blue-800"},"Notes",-1)),e("div",_w,t(h.notes),1)])):T("",!0)]),e("div",ww,[e("button",{onClick:b=>V(h),class:"px-3 py-2 text-blue-600 hover:text-blue-700 text-sm font-medium"}," Détails ",8,$w),h.status==="pending"?(s(),o("button",{key:0,onClick:b=>U(h),class:"px-3 py-2 text-red-600 hover:text-red-700 text-sm font-medium"}," Annuler ",8,kw)):T("",!0)])])]))),128))]))]),n.value?(s(),o("div",Cw,[e("div",Aw,[e("div",{class:"fixed inset-0 bg-black/40",onClick:v}),e("div",Pw,[e("div",Ew,[e("div",jw,[j[27]||(j[27]=e("h3",{class:"text-lg font-semibold"},"Nouvelle demande de remboursement",-1)),e("button",{onClick:v,class:"text-gray-400 hover:text-gray-600"},[g(l(Le),{class:"w-6 h-6"})])]),e("form",{onSubmit:_e(k,["prevent"])},[e("div",Sw,[e("div",null,[j[29]||(j[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Transaction à rembourser",-1)),Q(e("select",{"onUpdate:modelValue":j[3]||(j[3]=h=>M.value.transaction_id=h),required:"",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},[j[28]||(j[28]=e("option",{value:""},"Sélectionnez une transaction",-1)),(s(!0),o(ie,null,le($.value,h=>(s(),o("option",{key:h.id,value:h.id},t(h.reference)+" - "+t(i(h.amount))+" "+t(h.lottery?`(${h.lottery.lottery_number})`:""),9,Iw))),128))],512),[[me,M.value.transaction_id]])]),e("div",null,[j[31]||(j[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Raison du remboursement",-1)),Q(e("select",{"onUpdate:modelValue":j[4]||(j[4]=h=>M.value.reason=h),required:"",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},j[30]||(j[30]=[pe('<option value="">Sélectionnez une raison</option><option value="accidental_purchase">Achat accidentel</option><option value="changed_mind">Changement d&#39;avis</option><option value="duplicate_purchase">Achat en double</option><option value="technical_issue">Problème technique</option><option value="other">Autre</option>',6)]),512),[[me,M.value.reason]])]),e("div",null,[j[32]||(j[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Explication (optionnel)",-1)),Q(e("textarea",{"onUpdate:modelValue":j[5]||(j[5]=h=>M.value.notes=h),rows:"3",class:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Décrivez votre situation..."},null,512),[[ne,M.value.notes]])])]),e("div",Dw,[e("button",{type:"button",onClick:v,class:"px-4 py-2 text-gray-700 bg-gray-200 hover:bg-gray-300 rounded-lg"}," Annuler "),e("button",{type:"submit",disabled:r.value,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50"},t(r.value?"Création...":"Créer la demande"),9,Tw)])],32)])])])])):T("",!0),P.value?(s(),o("div",Mw,[e("div",Lw,[e("div",{class:"fixed inset-0 bg-black/40",onClick:j[6]||(j[6]=h=>P.value=null)}),e("div",Vw,[e("div",Rw,[e("div",Fw,[j[33]||(j[33]=e("h3",{class:"text-lg font-semibold"},"Détails du remboursement",-1)),e("button",{onClick:j[7]||(j[7]=h=>P.value=null),class:"text-gray-400 hover:text-gray-600"},[g(l(Le),{class:"w-6 h-6"})])]),e("div",Nw,[e("div",zw,[e("div",null,[j[34]||(j[34]=e("div",{class:"text-sm text-gray-600"},"Numéro",-1)),e("div",qw,t(P.value.refund_number),1)]),e("div",null,[j[35]||(j[35]=e("div",{class:"text-sm text-gray-600"},"Statut",-1)),e("span",{class:te(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",I(P.value.status)])},t(N(P.value.status)),3)])]),e("div",Uw,[e("div",null,[j[36]||(j[36]=e("div",{class:"text-sm text-gray-600"},"Montant",-1)),e("div",Bw,t(i(P.value.amount)),1)]),e("div",null,[j[37]||(j[37]=e("div",{class:"text-sm text-gray-600"},"Méthode de remboursement",-1)),e("div",null,t(A(P.value.refund_method)),1)])]),e("div",Ow,[j[40]||(j[40]=e("h4",{class:"font-medium text-gray-900 mb-3"},"Transaction originale",-1)),e("div",Gw,[e("div",null,[j[38]||(j[38]=e("div",{class:"text-sm text-gray-600"},"Référence",-1)),e("div",Hw,t(P.value.transaction.reference),1)]),e("div",null,[j[39]||(j[39]=e("div",{class:"text-sm text-gray-600"},"Montant",-1)),e("div",null,t(i(P.value.transaction.amount)),1)])])]),P.value.lottery?(s(),o("div",Kw,[j[43]||(j[43]=e("h4",{class:"font-medium text-gray-900 mb-3"},"Tombola concernée",-1)),e("div",null,[j[41]||(j[41]=e("div",{class:"text-sm text-gray-600"},"Numéro",-1)),e("div",null,t(P.value.lottery.lottery_number),1)]),e("div",Ww,[j[42]||(j[42]=e("div",{class:"text-sm text-gray-600"},"Produit",-1)),e("div",null,t(P.value.lottery.product_title),1)])])):T("",!0),e("div",null,[j[48]||(j[48]=e("h4",{class:"font-medium text-gray-900 mb-3"},"Chronologie",-1)),e("div",Jw,[e("div",Xw,[j[44]||(j[44]=e("span",{class:"text-sm text-gray-600"},"Demande créée",-1)),e("span",Yw,t(x(P.value.created_at)),1)]),P.value.approved_at?(s(),o("div",Qw,[j[45]||(j[45]=e("span",{class:"text-sm text-gray-600"},"Approuvé",-1)),e("span",Zw,t(x(P.value.approved_at)),1)])):T("",!0),P.value.processed_at?(s(),o("div",e4,[j[46]||(j[46]=e("span",{class:"text-sm text-gray-600"},"Traité",-1)),e("span",t4,t(x(P.value.processed_at)),1)])):T("",!0),P.value.rejected_at?(s(),o("div",s4,[j[47]||(j[47]=e("span",{class:"text-sm text-gray-600"},"Rejeté",-1)),e("span",o4,t(x(P.value.rejected_at)),1)])):T("",!0)])])])])])])])):T("",!0)]))}};function bt(){const _=(y,w="info",p=3e3)=>{w==="error"?(console.error(y),alert("Erreur: "+y)):(console.log(y),alert(y))};return{success:y=>_(y,"success"),error:y=>_(y,"error"),info:y=>_(y,"info"),warning:y=>_(y,"warning")}}const a4={class:"order-tracking"},n4={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8"},i4={class:"bg-white rounded-lg shadow p-6"},l4={class:"flex items-center"},d4={class:"ml-4"},u4={class:"text-2xl font-semibold text-gray-900"},c4={class:"bg-white rounded-lg shadow p-6"},m4={class:"flex items-center"},p4={class:"ml-4"},g4={class:"text-2xl font-semibold text-gray-900"},f4={class:"bg-white rounded-lg shadow p-6"},v4={class:"flex items-center"},x4={class:"ml-4"},b4={class:"text-2xl font-semibold text-gray-900"},y4={class:"bg-white rounded-lg shadow p-6"},h4={class:"flex items-center"},_4={class:"ml-4"},w4={class:"text-2xl font-semibold text-gray-900"},$4={class:"bg-white rounded-lg shadow p-6"},k4={class:"flex items-center"},C4={class:"ml-4"},A4={class:"text-2xl font-semibold text-gray-900"},P4={class:"bg-white rounded-lg shadow p-6 mb-8"},E4={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},j4={class:"flex items-end"},S4={class:"bg-white rounded-lg shadow overflow-hidden"},I4={key:0,class:"p-8 text-center"},D4={key:1,class:"p-8 text-center"},T4={key:2},M4={class:"px-6 py-4"},L4={class:"flex justify-between items-start"},V4={class:"flex-1"},R4={class:"flex items-center space-x-3 mb-2"},F4={class:"text-lg font-medium text-gray-900"},N4={class:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full"},z4={class:"text-sm text-gray-600 mb-2"},q4={key:0},U4={class:"flex items-center space-x-4 text-sm text-gray-500"},B4={key:0},O4={class:"flex space-x-2"},G4=["onClick","disabled"],H4=["onClick"],K4={key:3,class:"px-6 py-4 border-t border-gray-200 bg-gray-50"},W4={class:"flex justify-between items-center"},J4={class:"text-sm text-gray-600"},X4={class:"flex space-x-1"},Y4=["disabled"],Q4=["onClick"],Z4=["disabled"],e$={key:0,class:"fixed inset-0 bg-black/40 overflow-y-auto h-full w-full z-50"},t$={class:"relative top-20 mx-auto p-5 border w-11/12 max-w-4xl shadow-lg rounded-md bg-white"},s$={class:"mt-3"},o$={key:0},r$={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},a$={class:"space-y-2"},n$={class:"flex justify-between"},i$={class:"text-sm font-medium"},l$={class:"flex justify-between"},d$={class:"flex justify-between"},u$={class:"text-sm"},c$={class:"flex justify-between"},m$={class:"text-sm font-medium"},p$={class:"flex justify-between"},g$={class:"text-sm"},f$={class:"flex justify-between"},v$={class:"text-sm"},x$={key:0,class:"flex justify-between"},b$={class:"text-sm"},y$={key:1,class:"flex justify-between"},h$={class:"text-sm"},_$={key:0},w$={class:"border rounded-lg p-4"},$$={class:"font-medium"},k$={class:"text-sm text-gray-600 mt-1"},C$={key:1,class:"mt-6"},A$={class:"border rounded-lg p-4"},P$={class:"font-medium"},E$={class:"text-sm text-gray-600 mt-2"},j$={key:0},S$={key:0,class:"mt-6"},I$={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},D$={class:"flex justify-between items-start"},T$={class:"font-medium"},M$={class:"text-sm text-gray-600"},L$={class:"text-right"},V$={key:0,class:"text-sm text-green-600 mt-1 flex items-center"},R$={key:1,class:"mt-6"},F$={class:"space-y-3"},N$={class:"flex justify-between items-start"},z$={class:"font-medium"},q$={class:"text-sm text-gray-600"},U$={class:"text-sm text-gray-500"},B$={class:"text-right"},O$={key:0,class:"text-sm text-gray-500 mt-1"},G$={__name:"OrderTracking",setup(_){const{get:y,post:w}=ge(),{showError:p,showSuccess:f}=bt(),a=R([]),c=R({total_orders:0,paid_orders:0,shipping_orders:0,pending_orders:0,failed_orders:0,fulfilled_orders:0,total_amount_spent:0,lottery_orders:0,direct_orders:0,total_tickets_purchased:0,winning_tickets:0}),n=R(null),r=R(!1),P=R(!1),$=R(null),M=R({}),D=xe({search:"",status:"",type:""}),m=async()=>{try{const u=await y("/orders/stats");c.value=u.data}catch(u){console.error("Erreur lors du chargement des statistiques:",u)}},k=async(u=1)=>{r.value=!0;try{const A=new URLSearchParams({page:u,per_page:10});D.search&&A.append("q",D.search),D.status&&A.append("status",D.status),D.type&&A.append("type",D.type);const H=await y(`/orders?${A.toString()}`);a.value=H.data,n.value=H.pagination}catch(A){p("Erreur lors du chargement des commandes"),console.error("Erreur:",A)}finally{r.value=!1}},U=async u=>{try{const A=await fetch(`/api/orders/${u}/invoice`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/pdf"}});if(!A.ok)throw new Error("Erreur lors du téléchargement");const H=await A.blob(),j=window.URL.createObjectURL(H),h=document.createElement("a");h.href=j,h.download=`facture-${u}.pdf`,document.body.appendChild(h),h.click(),window.URL.revokeObjectURL(j),document.body.removeChild(h)}catch(A){p("Erreur lors du téléchargement de la facture"),console.error("Erreur:",A)}},V=()=>{P.value=!1,$.value=null},v=u=>({pending:"En attente",awaiting_payment:"En attente de paiement",paid:"Payé",shipping:"En cours de livraison",failed:"Échoué",cancelled:"Annulé",fulfilled:"Livré",refunded:"Remboursé",expired:"Expiré",completed:"Complété",payment_initiated:"Paiement initié",active:"Actif"})[u]||u,d=u=>({lottery:"Tombola",direct:"Achat direct",ticket_purchase:"Achat de billet",direct_purchase:"Achat direct"})[u]||u,i=u=>`px-2 py-1 text-xs rounded-full font-medium ${{pending:"bg-yellow-100 text-yellow-800",awaiting_payment:"bg-blue-100 text-blue-800",paid:"bg-green-100 text-green-800",shipping:"bg-orange-100 text-orange-800",failed:"bg-red-100 text-red-800",cancelled:"bg-gray-100 text-gray-800",fulfilled:"bg-green-100 text-green-800",refunded:"bg-purple-100 text-purple-800",expired:"bg-orange-100 text-orange-800",completed:"bg-green-100 text-green-800",payment_initiated:"bg-blue-100 text-blue-800",active:"bg-blue-100 text-blue-800"}[u]||"bg-gray-100 text-gray-800"}`,C=u=>u?new Date(u).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Non défini",x=u=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(u||0).replace("XAF","FCFA"),I=()=>{if(!n.value)return[];const u=n.value.current_page,A=n.value.last_page,H=[];for(let j=Math.max(1,u-2);j<=Math.min(A,u+2);j++)H.push(j);return H},N=async u=>{if(confirm(`Confirmer la réception de la commande ${u.order_number} ?`))try{M.value[u.order_number]=!0;const A=await w(`/orders/${u.order_number}/confirm-delivery`,{});if(A.success){f("Réception confirmée avec succès");const H=a.value.findIndex(j=>j.order_number===u.order_number);H!==-1&&(a.value[H].status="fulfilled"),await m()}else p(A.message||"Erreur lors de la confirmation")}catch(A){console.error("Erreur lors de la confirmation:",A),p(A.response?.data?.message||"Erreur lors de la confirmation de réception")}finally{M.value[u.order_number]=!1}};return De(()=>[D.status,D.type],()=>{k(1)},{deep:!0}),ve(()=>{m(),k()}),(u,A)=>{const H=he("router-link");return s(),o("div",a4,[A[42]||(A[42]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Suivi de mes commandes"),e("p",{class:"text-gray-600"},"Suivez l'état de vos commandes et billets de tombola")],-1)),e("div",n4,[e("div",i4,[e("div",l4,[A[8]||(A[8]=e("div",{class:"p-3 rounded-full bg-blue-100"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})])],-1)),e("div",d4,[A[7]||(A[7]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Commandes",-1)),e("p",u4,t(c.value.total_orders),1)])])]),e("div",c4,[e("div",m4,[A[10]||(A[10]=e("div",{class:"p-3 rounded-full bg-green-100"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",p4,[A[9]||(A[9]=e("p",{class:"text-sm font-medium text-gray-600"},"Payées",-1)),e("p",g4,t(c.value.paid_orders),1)])])]),e("div",f4,[e("div",v4,[A[12]||(A[12]=e("div",{class:"p-3 rounded-full bg-orange-100"},[e("svg",{class:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})])],-1)),e("div",x4,[A[11]||(A[11]=e("p",{class:"text-sm font-medium text-gray-600"},"En livraison",-1)),e("p",b4,t(c.value.shipping_orders||0),1)])])]),e("div",y4,[e("div",h4,[A[14]||(A[14]=e("div",{class:"p-3 rounded-full bg-yellow-100"},[e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",_4,[A[13]||(A[13]=e("p",{class:"text-sm font-medium text-gray-600"},"En attente",-1)),e("p",w4,t(c.value.pending_orders),1)])])]),e("div",$4,[e("div",k4,[A[16]||(A[16]=e("div",{class:"p-3 rounded-full bg-purple-100"},[e("svg",{class:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"})])],-1)),e("div",C4,[A[15]||(A[15]=e("p",{class:"text-sm font-medium text-gray-600"},"Billets Achetés",-1)),e("p",A4,t(c.value.total_tickets_purchased),1)])])])]),e("div",P4,[e("div",E4,[e("div",null,[A[17]||(A[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Recherche",-1)),Q(e("input",{type:"text","onUpdate:modelValue":A[0]||(A[0]=j=>D.search=j),placeholder:"Numéro de commande ou ticket...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyup:A[1]||(A[1]=xt(j=>k(1),["enter"]))},null,544),[[ne,D.search]])]),e("div",null,[A[19]||(A[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),Q(e("select",{"onUpdate:modelValue":A[2]||(A[2]=j=>D.status=j),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},A[18]||(A[18]=[pe('<option value="" data-v-0c24b5eb>Tous les statuts</option><option value="paid" data-v-0c24b5eb>Payé</option><option value="shipping" data-v-0c24b5eb>En cours de livraison</option><option value="pending" data-v-0c24b5eb>En attente</option><option value="awaiting_payment" data-v-0c24b5eb>En attente de paiement</option><option value="failed" data-v-0c24b5eb>Échoué</option><option value="cancelled" data-v-0c24b5eb>Annulé</option><option value="fulfilled" data-v-0c24b5eb>Livré</option><option value="refunded" data-v-0c24b5eb>Remboursé</option><option value="expired" data-v-0c24b5eb>Expiré</option>',10)]),512),[[me,D.status]])]),e("div",null,[A[21]||(A[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type",-1)),Q(e("select",{"onUpdate:modelValue":A[3]||(A[3]=j=>D.type=j),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},A[20]||(A[20]=[e("option",{value:""},"Tous les types",-1),e("option",{value:"lottery"},"Tombola",-1),e("option",{value:"direct"},"Achat direct",-1)]),512),[[me,D.type]])]),e("div",j4,[e("button",{onClick:A[4]||(A[4]=j=>k(1)),class:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-200"}," Rechercher ")])])]),e("div",S4,[A[25]||(A[25]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h2",{class:"text-lg font-medium text-gray-900"},"Mes commandes")],-1)),r.value?(s(),o("div",I4,A[22]||(A[22]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"text-gray-500 mt-4"},"Chargement des commandes...",-1)]))):a.value.length===0?(s(),o("div",D4,A[23]||(A[23]=[e("svg",{class:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2 2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-4.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 009.586 13H7"})],-1),e("p",{class:"text-gray-500"},"Aucune commande trouvée",-1)]))):(s(),o("div",T4,[(s(!0),o(ie,null,le(a.value,j=>(s(),o("div",{key:j.id,class:"border-b border-gray-200 hover:bg-gray-50 transition duration-200"},[e("div",M4,[e("div",L4,[e("div",V4,[e("div",R4,[e("h3",F4,"#"+t(j.order_number),1),e("span",{class:te(i(j.status))},t(v(j.status)),3),e("span",N4,t(d(j.type)),1)]),e("div",z4,[z(t(j.lottery?.product?.name||j.product?.name||"Produit non disponible")+" ",1),j.lottery?(s(),o("span",q4," - Tombola #"+t(j.lottery.lottery_number),1)):T("",!0)]),e("div",U4,[e("span",null,t(C(j.created_at)),1),e("span",null,t(x(j.total_amount)),1),j.payments_count?(s(),o("span",B4,t(j.payments_count)+" paiement(s)",1)):T("",!0)])]),e("div",O4,[g(H,{to:{name:"customer.order.detail",params:{id:j.order_number}},class:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"},{default:re(()=>A[24]||(A[24]=[z(" Détails ",-1)])),_:2,__:[24]},1032,["to"]),(j.status==="paid"||j.status==="shipping")&&(j.type!=="lottery"||j.has_winning_ticket)?(s(),o("button",{key:0,onClick:h=>N(j),disabled:M.value[j.order_number],class:"bg-orange-600 text-white px-3 py-1 rounded text-sm hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed"},t(M.value[j.order_number]?"Validation...":"Confirmer réception"),9,G4)):T("",!0),["paid","shipping","fulfilled"].includes(j.status)?(s(),o("button",{key:1,onClick:h=>U(j.order_number),class:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700"}," Facture ",8,H4)):T("",!0)])])])]))),128))])),n.value&&n.value.last_page>1?(s(),o("div",K4,[e("div",W4,[e("div",J4," Affichage de "+t((n.value.current_page-1)*n.value.per_page+1)+" à "+t(Math.min(n.value.current_page*n.value.per_page,n.value.total))+" sur "+t(n.value.total)+" résultats ",1),e("div",X4,[e("button",{onClick:A[5]||(A[5]=j=>k(n.value.current_page-1)),disabled:n.value.current_page<=1,class:"px-3 py-1 border rounded text-gray-700 hover:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed"}," Précédent ",8,Y4),(s(!0),o(ie,null,le(I(),j=>(s(),o("button",{key:j,onClick:h=>k(j),class:te(["px-3 py-1 border rounded",j===n.value.current_page?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"])},t(j),11,Q4))),128)),e("button",{onClick:A[6]||(A[6]=j=>k(n.value.current_page+1)),disabled:n.value.current_page>=n.value.last_page,class:"px-3 py-1 border rounded text-gray-700 hover:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed"}," Suivant ",8,Z4)])])])):T("",!0)]),P.value?(s(),o("div",e$,[e("div",t$,[e("div",s$,[e("div",{class:"flex justify-between items-center mb-4"},[A[27]||(A[27]=e("h3",{class:"text-lg font-medium text-gray-900"},"Détails de la commande",-1)),e("button",{onClick:V,class:"text-gray-400 hover:text-gray-600"},A[26]||(A[26]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),$.value?(s(),o("div",o$,[e("div",r$,[e("div",null,[A[36]||(A[36]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Informations de la commande",-1)),e("dl",a$,[e("div",n$,[A[28]||(A[28]=e("dt",{class:"text-sm text-gray-600"},"Numéro de commande:",-1)),e("dd",i$,t($.value.order_number),1)]),e("div",l$,[A[29]||(A[29]=e("dt",{class:"text-sm text-gray-600"},"Statut:",-1)),e("dd",null,[e("span",{class:te(i($.value.status))},t(v($.value.status)),3)])]),e("div",d$,[A[30]||(A[30]=e("dt",{class:"text-sm text-gray-600"},"Type:",-1)),e("dd",u$,t(d($.value.type)),1)]),e("div",c$,[A[31]||(A[31]=e("dt",{class:"text-sm text-gray-600"},"Montant:",-1)),e("dd",m$,t(x($.value.total_amount)),1)]),e("div",p$,[A[32]||(A[32]=e("dt",{class:"text-sm text-gray-600"},"Méthode de paiement:",-1)),e("dd",g$,t($.value.payment_method||"Non spécifié"),1)]),e("div",f$,[A[33]||(A[33]=e("dt",{class:"text-sm text-gray-600"},"Date de création:",-1)),e("dd",v$,t(C($.value.created_at)),1)]),$.value.paid_at?(s(),o("div",x$,[A[34]||(A[34]=e("dt",{class:"text-sm text-gray-600"},"Date de paiement:",-1)),e("dd",b$,t(C($.value.paid_at)),1)])):T("",!0),$.value.fulfilled_at?(s(),o("div",y$,[A[35]||(A[35]=e("dt",{class:"text-sm text-gray-600"},"Date de livraison:",-1)),e("dd",h$,t(C($.value.fulfilled_at)),1)])):T("",!0)])]),e("div",null,[$.value.product?(s(),o("div",_$,[A[37]||(A[37]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Produit",-1)),e("div",w$,[e("h5",$$,t($.value.product.name),1),e("p",k$,t($.value.product.description||""),1)])])):T("",!0),$.value.lottery?(s(),o("div",C$,[A[38]||(A[38]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Tombola",-1)),e("div",A$,[e("h5",P$,t($.value.lottery.title),1),e("div",E$,[e("p",null,"Numéro: "+t($.value.lottery.lottery_number),1),e("p",null,"Prix du billet: "+t($.value.lottery.ticket_price)+" "+t($.value.currency),1),e("p",null,"Billets vendus: "+t($.value.lottery.sold_tickets)+"/"+t($.value.lottery.max_tickets),1),$.value.lottery.draw_date?(s(),o("p",j$,"Date du tirage: "+t(C($.value.lottery.draw_date)),1)):T("",!0)])])])):T("",!0)])]),$.value.tickets&&$.value.tickets.length>0?(s(),o("div",S$,[A[40]||(A[40]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Billets de tombola",-1)),e("div",I$,[(s(!0),o(ie,null,le($.value.tickets,j=>(s(),o("div",{key:j.id,class:te(["border rounded-lg p-4",j.is_winner?"bg-green-50 border-green-200":"bg-gray-50"])},[e("div",D$,[e("div",null,[e("p",T$,t(j.ticket_number),1),e("p",M$,t(x(j.price_paid)),1)]),e("div",L$,[e("span",{class:te(i(j.status))},t(v(j.status)),3),j.is_winner?(s(),o("p",V$,[g(l(Je),{class:"w-4 h-4 mr-1"}),A[39]||(A[39]=z(" Gagnant! ",-1))])):T("",!0)])])],2))),128))])])):T("",!0),$.value.payments&&$.value.payments.length>0?(s(),o("div",R$,[A[41]||(A[41]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Paiements",-1)),e("div",F$,[(s(!0),o(ie,null,le($.value.payments,j=>(s(),o("div",{key:j.id,class:"border rounded-lg p-4 bg-gray-50"},[e("div",N$,[e("div",null,[e("p",z$,t(j.reference),1),e("p",q$,t(x(j.amount)),1),e("p",U$,t(j.payment_method||"Non spécifié"),1)]),e("div",B$,[e("span",{class:te(i(j.status))},t(v(j.status)),3),j.paid_at?(s(),o("p",O$,t(C(j.paid_at)),1)):T("",!0)])])]))),128))])])):T("",!0)])):T("",!0)])])])):T("",!0)])}}},H$=Ee(G$,[["__scopeId","data-v-0c24b5eb"]]),K$={class:"payments-page"},W$={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},J$={class:"bg-white rounded-lg shadow p-6"},X$={class:"flex items-center"},Y$={class:"ml-4"},Q$={class:"text-2xl font-semibold text-gray-900"},Z$={class:"bg-white rounded-lg shadow p-6"},e3={class:"flex items-center"},t3={class:"ml-4"},s3={class:"text-2xl font-semibold text-gray-900"},o3={class:"bg-white rounded-lg shadow p-6"},r3={class:"flex items-center"},a3={class:"ml-4"},n3={class:"text-2xl font-semibold text-gray-900"},i3={class:"bg-white rounded-lg shadow p-6"},l3={class:"flex items-center"},d3={class:"ml-4"},u3={class:"text-2xl font-semibold text-gray-900"},c3={class:"bg-white rounded-lg shadow p-6 mb-8"},m3={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},p3={class:"flex items-end"},g3={class:"bg-white rounded-lg shadow overflow-hidden"},f3={key:0,class:"p-8 text-center"},v3={key:1,class:"p-8 text-center"},x3={key:2},b3={class:"px-6 py-4"},y3={class:"flex justify-between items-start"},h3={class:"flex-1"},_3={class:"flex items-center space-x-3 mb-2"},w3={class:"text-lg font-medium text-gray-900"},$3={class:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full"},k3={class:"text-sm text-gray-600 mb-2"},C3={key:0},A3={key:0},P3={key:1},E3={key:1},j3={key:2},S3={key:3},I3={class:"flex items-center space-x-4 text-sm text-gray-500"},D3={key:0},T3={key:0,class:"mt-2 text-xs text-orange-600"},M3={key:1,class:"mt-2 text-xs text-red-600"},L3={class:"flex space-x-2"},V3={class:"flex flex-col space-y-1"},R3=["onClick"],F3={key:3,class:"px-6 py-4 border-t border-gray-200 bg-gray-50"},N3={class:"flex justify-between items-center"},z3={class:"text-sm text-gray-600"},q3={class:"flex space-x-1"},U3=["disabled"],B3=["onClick"],O3=["disabled"],G3={key:0,class:"fixed inset-0 bg-black/40 overflow-y-auto h-full w-full z-50"},H3={class:"relative top-20 mx-auto p-5 border w-11/12 max-w-2xl shadow-lg rounded-md bg-white"},K3={class:"mt-3"},W3={key:0},J3={class:"grid grid-cols-1 gap-6"},X3={class:"space-y-2"},Y3={class:"flex justify-between"},Q3={class:"text-sm font-medium"},Z3={class:"flex justify-between"},e6={class:"flex justify-between"},t6={class:"text-sm font-medium"},s6={class:"flex justify-between"},o6={class:"text-sm"},r6={key:0,class:"flex justify-between"},a6={class:"text-sm"},n6={class:"flex justify-between"},i6={class:"text-sm"},l6={key:1,class:"flex justify-between"},d6={class:"text-sm"},u6={key:2,class:"flex justify-between"},c6={class:"text-sm"},m6={key:0},p6={class:"border rounded-lg p-4 bg-gray-50"},g6={class:"flex items-center justify-between mb-2"},f6={class:"font-medium"},v6={class:"text-sm text-gray-600 mt-1"},x6={class:"grid grid-cols-2 gap-4 mt-3 text-xs"},b6={class:"ml-1 font-medium"},y6={class:"ml-1"},h6={class:"ml-1 font-medium"},_6={class:"ml-1"},w6={key:1},$6={class:"border rounded-lg p-4 bg-gray-50"},k6={class:"font-medium"},C6={class:"text-sm text-gray-600 mt-1"},A6={class:"mt-2 text-xs text-gray-500"},P6={__name:"Payments",setup(_){const y=$e(),{get:w}=ge(),{showError:p}=bt(),f=R([]),a=R({successful_payments:0,pending_payments:0,failed_payments:0,total_amount:0}),c=R(null),n=R(!1),r=R(!1),P=R(null),$=xe({search:"",status:"",method:""}),M=async()=>{try{const N=await w("/payments/stats");N.success&&(a.value=N.data)}catch(N){console.error("Erreur lors du chargement des statistiques:",N);try{const u=await w("/orders/stats");u.success&&(a.value={successful_payments:u.data.completed_orders,pending_payments:u.data.pending_orders,failed_payments:u.data.failed_orders,total_amount:u.data.total_amount_spent||0})}catch(u){console.error("Erreur lors du chargement des statistiques de fallback:",u)}}},D=async(N=1)=>{n.value=!0;try{const u=new URLSearchParams({page:N,per_page:10});$.search&&u.append("search",$.search),$.status&&u.append("status",$.status),$.method&&u.append("method",$.method);try{const H=await w(`/payments?${u.toString()}`);if(H.success){f.value=H.data,c.value=H.pagination;return}}catch(H){console.log("API paiements dédiée non disponible:",H)}const A=await w(`/orders?${u.toString()}`);if(A.success){const H=[];A.data.forEach(j=>{j.payments&&j.payments.length>0&&j.payments.forEach(h=>{H.push({...h,order:j,transaction_id:null,timeout_at:h.status==="pending"?h.expires_at:null})})}),H.sort((j,h)=>new Date(h.created_at)-new Date(j.created_at)),f.value=H,c.value=A.pagination}}catch(u){p("Erreur lors du chargement des paiements"),console.error("Erreur:",u)}finally{n.value=!1}},m=N=>{N.order&&N.order.order_number?y.push({name:"payment.phone",query:{order_number:N.order.order_number,retry:"true"}}):N.transaction_id?y.push({name:"payment.phone",query:{transaction_id:N.transaction_id,retry:"true"}}):p("Impossible de relancer ce paiement. Informations manquantes.")},k=()=>{r.value=!1,P.value=null},U=N=>({paid:"Payé",pending:"En attente",payment_initiated:"Paiement initié",failed:"Échoué",expired:"Expiré",completed:"Payé"})[N]||N,V=N=>({airtel_money:"Airtel Money",moov_money:"Moov Money"})[N]||N||"Non spécifié",v=N=>({ticket_purchase:"Achat de billet",direct_purchase:"Achat direct"})[N]||N,d=N=>({lottery:"Tombola",direct:"Achat direct"})[N]||N,i=N=>`px-2 py-1 text-xs rounded-full font-medium ${{paid:"bg-green-100 text-green-800",completed:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",payment_initiated:"bg-blue-100 text-blue-800",failed:"bg-red-100 text-red-800",expired:"bg-gray-100 text-gray-800"}[N]||"bg-gray-100 text-gray-800"}`,C=N=>new Date(N).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),x=N=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(N||0).replace("XAF","FCFA"),I=()=>{if(!c.value)return[];const N=c.value.current_page,u=c.value.last_page,A=[];for(let H=Math.max(1,N-2);H<=Math.min(u,N+2);H++)A.push(H);return A};return De(()=>[$.status,$.method],()=>{D(1)},{deep:!0}),ve(()=>{M(),D()}),(N,u)=>{const A=he("router-link");return s(),o("div",K$,[u[44]||(u[44]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Mes Paiements"),e("p",{class:"text-gray-600"},"Consultez l'historique de vos paiements et transactions")],-1)),e("div",W$,[e("div",J$,[e("div",X$,[u[8]||(u[8]=e("div",{class:"p-3 rounded-full bg-green-100"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",Y$,[u[7]||(u[7]=e("p",{class:"text-sm font-medium text-gray-600"},"Paiements Réussis",-1)),e("p",Q$,t(a.value.successful_payments),1)])])]),e("div",Z$,[e("div",e3,[u[10]||(u[10]=e("div",{class:"p-3 rounded-full bg-yellow-100"},[e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",t3,[u[9]||(u[9]=e("p",{class:"text-sm font-medium text-gray-600"},"En Attente",-1)),e("p",s3,t(a.value.pending_payments),1)])])]),e("div",o3,[e("div",r3,[u[12]||(u[12]=e("div",{class:"p-3 rounded-full bg-red-100"},[e("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1)),e("div",a3,[u[11]||(u[11]=e("p",{class:"text-sm font-medium text-gray-600"},"Échoués",-1)),e("p",n3,t(a.value.failed_payments),1)])])]),e("div",i3,[e("div",l3,[u[14]||(u[14]=e("div",{class:"p-3 rounded-full bg-blue-100"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1)),e("div",d3,[u[13]||(u[13]=e("p",{class:"text-sm font-medium text-gray-600"},"Total Payé",-1)),e("p",u3,t(x(a.value.total_amount)),1)])])])]),e("div",c3,[e("div",m3,[e("div",null,[u[15]||(u[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Recherche",-1)),Q(e("input",{type:"text","onUpdate:modelValue":u[0]||(u[0]=H=>$.search=H),placeholder:"Référence ou ID de paiement...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyup:u[1]||(u[1]=xt(H=>D(1),["enter"]))},null,544),[[ne,$.search]])]),e("div",null,[u[17]||(u[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),Q(e("select",{"onUpdate:modelValue":u[2]||(u[2]=H=>$.status=H),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},u[16]||(u[16]=[pe('<option value="" data-v-34a156f6>Tous les statuts</option><option value="paid" data-v-34a156f6>Payé</option><option value="pending" data-v-34a156f6>En attente</option><option value="failed" data-v-34a156f6>Échoué</option><option value="expired" data-v-34a156f6>Expiré</option>',5)]),512),[[me,$.status]])]),e("div",null,[u[19]||(u[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Méthode",-1)),Q(e("select",{"onUpdate:modelValue":u[3]||(u[3]=H=>$.method=H),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},u[18]||(u[18]=[e("option",{value:""},"Toutes les méthodes",-1),e("option",{value:"airtel_money"},"Airtel Money",-1),e("option",{value:"moov_money"},"Moov Money",-1)]),512),[[me,$.method]])]),e("div",p3,[e("button",{onClick:u[4]||(u[4]=H=>D(1)),class:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition duration-200"}," Rechercher ")])])]),e("div",g3,[u[25]||(u[25]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h2",{class:"text-lg font-medium text-gray-900"},"Historique des paiements")],-1)),n.value?(s(),o("div",f3,u[20]||(u[20]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"text-gray-500 mt-4"},"Chargement des paiements...",-1)]))):f.value.length===0?(s(),o("div",v3,u[21]||(u[21]=[e("svg",{class:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("p",{class:"text-gray-500"},"Aucun paiement trouvé",-1)]))):(s(),o("div",x3,[(s(!0),o(ie,null,le(f.value,H=>(s(),o("div",{key:H.id,class:"border-b border-gray-200 hover:bg-gray-50 transition duration-200"},[e("div",b3,[e("div",y3,[e("div",h3,[e("div",_3,[e("h3",w3,"#"+t(H.billing_id||H.id),1),e("span",{class:te(i(H.status))},t(U(H.status)),3),e("span",$3,t(V(H.payment_method)),1)]),e("div",k3,[H.order?(s(),o("span",C3,[g(A,{to:{name:"customer.order.detail",params:{id:H.order.order_number}},class:"text-blue-600 hover:text-blue-800 font-medium"},{default:re(()=>[z(" Commande #"+t(H.order.order_number),1)]),_:2},1032,["to"]),u[22]||(u[22]=e("span",{class:"text-gray-400 mx-2"},"•",-1)),H.order.product?(s(),o("span",A3,t(H.order.product.name),1)):H.order.lottery?(s(),o("span",P3," Tombola #"+t(H.order.lottery.lottery_number),1)):T("",!0)])):H.transaction&&H.transaction.product?(s(),o("span",E3,t(H.transaction.product.name)+" (Legacy) ",1)):H.transaction&&H.transaction.lottery?(s(),o("span",j3," Tombola #"+t(H.transaction.lottery.lottery_number)+" (Legacy) ",1)):(s(),o("span",S3," Paiement sans commande associée "))]),e("div",I3,[e("span",null,t(C(H.created_at)),1),e("span",null,t(x(H.amount)),1),H.phone_number?(s(),o("span",D3,t(H.phone_number),1)):T("",!0)]),H.status==="pending"&&H.timeout_at?(s(),o("div",T3," ⏰ Expire le "+t(C(H.timeout_at)),1)):H.status==="expired"?(s(),o("div",M3," ❌ Expiré le "+t(C(H.timeout_at||H.updated_at)),1)):T("",!0)]),e("div",L3,[g(A,{to:{name:"customer.payment.detail",params:{id:H.id}},class:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"},{default:re(()=>u[23]||(u[23]=[z(" Détails ",-1)])),_:2,__:[23]},1032,["to"]),e("div",V3,[H.order?(s(),ce(A,{key:0,to:{name:"customer.order.detail",params:{id:H.order.order_number}},class:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 text-center"},{default:re(()=>u[24]||(u[24]=[z(" Voir commande ",-1)])),_:2,__:[24]},1032,["to"])):T("",!0),H.status==="expired"&&(H.order||H.transaction_id)?(s(),o("button",{key:1,onClick:j=>m(H),class:"bg-orange-600 text-white px-3 py-1 rounded text-sm hover:bg-orange-700"}," 🔄 Relancer ",8,R3)):T("",!0)])])])])]))),128))])),c.value&&c.value.last_page>1?(s(),o("div",F3,[e("div",N3,[e("div",z3," Affichage de "+t((c.value.current_page-1)*c.value.per_page+1)+" à "+t(Math.min(c.value.current_page*c.value.per_page,c.value.total))+" sur "+t(c.value.total)+" résultats ",1),e("div",q3,[e("button",{onClick:u[5]||(u[5]=H=>D(c.value.current_page-1)),disabled:c.value.current_page<=1,class:"px-3 py-1 border rounded text-gray-700 hover:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed"}," Précédent ",8,U3),(s(!0),o(ie,null,le(I(),H=>(s(),o("button",{key:H,onClick:j=>D(H),class:te(["px-3 py-1 border rounded",H===c.value.current_page?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100"])},t(H),11,B3))),128)),e("button",{onClick:u[6]||(u[6]=H=>D(c.value.current_page+1)),disabled:c.value.current_page>=c.value.last_page,class:"px-3 py-1 border rounded text-gray-700 hover:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed"}," Suivant ",8,O3)])])])):T("",!0)]),r.value?(s(),o("div",G3,[e("div",H3,[e("div",K3,[e("div",{class:"flex justify-between items-center mb-4"},[u[27]||(u[27]=e("h3",{class:"text-lg font-medium text-gray-900"},"Détails du paiement",-1)),e("button",{onClick:k,class:"text-gray-400 hover:text-gray-600"},u[26]||(u[26]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),P.value?(s(),o("div",W3,[e("div",J3,[e("div",null,[u[36]||(u[36]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Informations du paiement",-1)),e("dl",X3,[e("div",Y3,[u[28]||(u[28]=e("dt",{class:"text-sm text-gray-600"},"ID de paiement:",-1)),e("dd",Q3,t(P.value.billing_id||P.value.id),1)]),e("div",Z3,[u[29]||(u[29]=e("dt",{class:"text-sm text-gray-600"},"Statut:",-1)),e("dd",null,[e("span",{class:te(i(P.value.status))},t(U(P.value.status)),3)])]),e("div",e6,[u[30]||(u[30]=e("dt",{class:"text-sm text-gray-600"},"Montant:",-1)),e("dd",t6,t(x(P.value.amount)),1)]),e("div",s6,[u[31]||(u[31]=e("dt",{class:"text-sm text-gray-600"},"Méthode:",-1)),e("dd",o6,t(V(P.value.payment_method)),1)]),P.value.phone_number?(s(),o("div",r6,[u[32]||(u[32]=e("dt",{class:"text-sm text-gray-600"},"Téléphone:",-1)),e("dd",a6,"+241 "+t(P.value.phone_number),1)])):T("",!0),e("div",n6,[u[33]||(u[33]=e("dt",{class:"text-sm text-gray-600"},"Date de création:",-1)),e("dd",i6,t(C(P.value.created_at)),1)]),P.value.updated_at?(s(),o("div",l6,[u[34]||(u[34]=e("dt",{class:"text-sm text-gray-600"},"Dernière mise à jour:",-1)),e("dd",d6,t(C(P.value.updated_at)),1)])):T("",!0),P.value.timeout_at?(s(),o("div",u6,[u[35]||(u[35]=e("dt",{class:"text-sm text-gray-600"},"Expiration:",-1)),e("dd",c6,t(C(P.value.timeout_at)),1)])):T("",!0)])]),P.value.order?(s(),o("div",m6,[u[42]||(u[42]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Commande associée",-1)),e("div",p6,[e("div",g6,[e("p",f6,t(P.value.order.order_number),1),g(A,{to:{name:"customer.order.detail",params:{id:P.value.order.order_number}},class:"text-blue-600 hover:text-blue-800 text-sm"},{default:re(()=>u[37]||(u[37]=[z(" Voir détails → ",-1)])),_:1,__:[37]},8,["to"])]),e("p",v6,t(P.value.order.product?.name||P.value.order.lottery?.title||"Commande"),1),e("div",x6,[e("div",null,[u[38]||(u[38]=e("span",{class:"text-gray-500"},"Type:",-1)),e("span",b6,t(d(P.value.order.type)),1)]),e("div",null,[u[39]||(u[39]=e("span",{class:"text-gray-500"},"Statut:",-1)),e("span",y6,[e("span",{class:te([i(P.value.order.status),"text-xs"])},t(U(P.value.order.status)),3)])]),e("div",null,[u[40]||(u[40]=e("span",{class:"text-gray-500"},"Total:",-1)),e("span",h6,t(x(P.value.order.total_amount)),1)]),e("div",null,[u[41]||(u[41]=e("span",{class:"text-gray-500"},"Créée le:",-1)),e("span",_6,t(C(P.value.order.created_at)),1)])])])])):P.value.transaction?(s(),o("div",w6,[u[43]||(u[43]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Transaction associée (Legacy)",-1)),e("div",$6,[e("p",k6,t(P.value.transaction.reference),1),e("p",C6,t(P.value.transaction.description||"Aucune description"),1),e("div",A6," Type: "+t(v(P.value.transaction.type)),1)])])):T("",!0)])])):T("",!0)])])])):T("",!0)])}}},E6=Ee(P6,[["__scopeId","data-v-34a156f6"]]),j6={class:"order-detail"},S6={key:0,class:"min-h-screen flex items-center justify-center"},I6={key:1,class:"min-h-screen flex items-center justify-center"},D6={class:"text-center max-w-md mx-auto px-4"},T6={class:"mb-6"},M6={class:"text-gray-600 mb-6"},L6={class:"space-y-3"},V6={key:2},R6={class:"mb-8"},F6={class:"flex items-center justify-between"},N6={class:"text-3xl font-bold text-gray-900"},z6={class:"flex items-center space-x-4 mt-2"},q6={class:"text-gray-600"},U6={class:"text-sm text-gray-600"},B6={class:"flex items-center space-x-3"},O6=["disabled"],G6={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},H6={class:"bg-white rounded-lg shadow p-6 mb-8"},K6={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},W6={class:"space-y-3"},J6={class:"text-sm text-gray-900"},X6={class:"text-sm text-gray-900"},Y6={class:"space-y-3"},Q6={class:"text-sm text-gray-900"},Z6={class:"text-sm text-gray-900"},e5={class:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8"},t5={class:"lg:col-span-2 space-y-6"},s5={class:"bg-white rounded-lg shadow p-6"},o5={class:"space-y-4"},r5={class:"flex items-center"},a5={class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},n5={class:"ml-4"},i5={class:"text-sm text-gray-500"},l5={key:0,class:"flex items-center"},d5={class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},u5={class:"ml-4"},c5={class:"text-sm text-gray-500"},m5={key:1,class:"flex items-center"},p5={class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},g5={class:"ml-4"},f5={class:"text-sm text-gray-500"},v5={key:2,class:"flex items-center"},x5={class:"flex-shrink-0 w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center"},b5={class:"ml-4"},y5={class:"text-sm font-medium text-gray-900"},h5={class:"text-sm text-gray-500"},_5={key:3,class:"flex items-center"},w5={class:"flex-shrink-0 w-8 h-8 bg-red-100 rounded-full flex items-center justify-center"},$5={class:"ml-4"},k5={class:"text-sm font-medium text-gray-900"},C5={class:"text-sm text-gray-500"},A5={key:0,class:"text-sm text-gray-500"},P5={class:"bg-white rounded-lg shadow p-6"},E5={key:0,class:"flex items-start space-x-4 mb-6"},j5={class:"flex-shrink-0 w-16 h-16 bg-gray-200 rounded-lg overflow-hidden"},S5=["src","alt"],I5={key:1,class:"w-full h-full flex items-center justify-center"},D5={class:"flex-1"},T5={class:"text-lg font-medium text-gray-900"},M5={class:"text-sm text-gray-600 mt-1"},L5={class:"mt-2 flex items-center space-x-4 text-sm text-gray-500"},V5={key:1,class:"border rounded-lg p-4 bg-blue-50"},R5={class:"flex items-center mb-3"},F5={class:"text-lg font-medium text-gray-900"},N5={class:"grid grid-cols-2 gap-4 text-sm"},z5={class:"font-medium ml-2"},q5={class:"font-medium ml-2"},U5={class:"font-medium ml-2"},B5={key:0},O5={class:"font-medium ml-2"},G5={key:0,class:"mt-3 p-3 bg-green-100 rounded-lg"},H5={class:"flex items-center"},K5={class:"text-sm font-medium text-green-800"},W5={class:"bg-white rounded-lg shadow p-6"},J5={class:"border-b border-gray-200 pb-4 mb-4"},X5={class:"flex justify-between items-start"},Y5={class:"flex-1"},Q5={class:"font-medium text-gray-900"},Z5={class:"text-sm text-gray-600 mt-1"},ek={class:"flex items-center space-x-2 mt-2"},tk={class:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"},sk={key:0,class:"text-xs bg-purple-100 text-purple-800 px-2 py-1 rounded"},ok={class:"text-right"},rk={class:"font-medium text-gray-900"},ak={class:"text-sm text-gray-500"},nk={key:0},ik={class:"font-medium text-gray-900 mb-3"},lk={class:"space-y-3 max-h-64 overflow-y-auto"},dk={class:"flex justify-between items-start"},uk={class:"font-medium text-gray-900 text-sm"},ck={class:"text-xs text-gray-600"},mk={key:0,class:"text-xs text-gray-500 mt-1"},pk={class:"text-right"},gk={key:0,class:"mt-1"},fk={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},vk={class:"border-t border-gray-200 pt-4 mt-4"},xk={class:"flex justify-between items-center"},bk={class:"text-xl font-bold text-gray-900"},yk={class:"bg-white rounded-lg shadow p-6"},hk={key:0,class:"space-y-4"},_k={class:"flex justify-between items-start mb-3"},wk={class:"font-medium text-gray-900 text-sm"},$k={class:"text-xs text-gray-500 font-mono"},kk={class:"grid grid-cols-2 gap-3 text-xs"},Ck={class:"font-medium"},Ak={class:"font-medium"},Pk={key:0},Ek={key:1,class:"col-span-2"},jk={class:"font-mono text-xs"},Sk={key:1,class:"text-center py-8"},Ik={class:"space-y-6"},Dk={class:"bg-white rounded-lg shadow p-6"},Tk={class:"space-y-3"},Mk={class:"flex justify-between text-sm"},Lk={class:"font-medium"},Vk={class:"border-t pt-3"},Rk={class:"flex justify-between"},Fk={class:"text-base font-medium text-gray-900"},Nk={class:"bg-white rounded-lg shadow p-6"},zk={class:"space-y-3 text-sm"},qk={class:"font-medium font-mono"},Uk={key:0},Bk={class:"text-xs text-gray-500"},Ok={class:"font-medium"},Gk={class:"bg-white rounded-lg shadow p-6"},Hk={class:"space-y-3"},Kk=["disabled"],Wk={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2 flex-shrink-0"},Jk=["disabled"],Xk={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Yk=["disabled"],Qk={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},Zk={key:4,class:"w-full p-3 bg-gray-50 border border-gray-200 rounded-md"},e9={class:"flex items-center"},t9={key:5,class:"w-full p-3 bg-green-50 border border-green-200 rounded-md"},s9={class:"flex items-center"},o9={class:"text-xs text-green-600"},r9={key:6,class:"text-center p-3 bg-gray-50 rounded-md"},a9={class:"flex items-center justify-center space-x-2 text-xs text-gray-400"},n9={key:3,class:"fixed inset-0 bg-black/40 flex items-center justify-center z-50"},i9={class:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4"},l9={class:"p-6"},d9={class:"flex items-center mb-4"},u9={class:"mb-4"},c9={class:"flex space-x-3"},m9=["disabled"],p9=["disabled"],g9={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},f9={__name:"OrderDetail",setup(_){const y=Be(),w=$e(),{get:p,post:f}=ge(),{showError:a,showSuccess:c}=bt(),n=R(null),r=R(!0),P=R(null),$=R(!1),M=R(!1),D=R(!1),m=R(!1),k=R(""),U=async()=>{try{r.value=!0,P.value=null;const h=y.params.id;if(!h){P.value="Numéro de commande manquant";return}const b=await p(`/orders/${h}`);b.success?n.value=b.data:P.value=b.message||"Commande non trouvée"}catch(h){console.error("Erreur lors du chargement de la commande:",h),h.response?.status===404?P.value="Commande introuvable. Vérifiez le numéro de commande.":h.response?.status===403?P.value="Vous n'êtes pas autorisé à voir cette commande.":P.value="Erreur lors du chargement de la commande. Veuillez réessayer."}finally{r.value=!1}},V=()=>{U()},v=()=>{w.push({name:"payment.phone",query:{order_number:n.value.order_number,retry:"true"}})},d=async()=>{if(!["paid","shipping","fulfilled"].includes(n.value.status)){a("La facture n'est disponible que pour les commandes payées");return}try{$.value=!0;const h=await fetch(`/api/orders/${n.value.order_number}/invoice`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,Accept:"application/pdf"}});if(!h.ok)throw new Error("Erreur lors du téléchargement");const b=await h.blob(),ee=window.URL.createObjectURL(b),B=document.createElement("a");B.href=ee,B.download=`facture-${n.value.order_number}.pdf`,document.body.appendChild(B),B.click(),window.URL.revokeObjectURL(ee),document.body.removeChild(B),c("Facture téléchargée avec succès")}catch(h){a("Erreur lors du téléchargement de la facture"),console.error("Erreur:",h)}finally{$.value=!1}},i=async()=>{if(!["paid","shipping","fulfilled"].includes(n.value.status)){a("L'impression n'est disponible que pour les commandes payées");return}try{M.value=!0;const h=await fetch(`/api/orders/${n.value.order_number}/invoice`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,Accept:"application/pdf"}});if(!h.ok)throw new Error("Erreur lors de la génération de la facture");const b=await h.blob(),ee=window.URL.createObjectURL(b),B=window.open(ee,"_blank");if(B)B.addEventListener("load",()=>{B.print()}),c("Facture ouverte pour impression");else{const S=document.createElement("a");S.href=ee,S.download=`facture-${n.value.order_number}.pdf`,document.body.appendChild(S),S.click(),document.body.removeChild(S),a("Popup bloqué. La facture a été téléchargée à la place.")}window.URL.revokeObjectURL(ee)}catch(h){a("Erreur lors de l'impression de la facture"),console.error("Erreur:",h)}finally{M.value=!1}},C=async()=>{if(n.value)try{D.value=!0;const h={};k.value.trim()&&(h.notes=k.value.trim());const b=await f(`/orders/${n.value.order_number}/confirm-delivery`,h);b.success?(c("Réception du produit confirmée avec succès"),n.value.status="fulfilled",n.value.fulfilled_at=b.data.fulfilled_at,m.value=!1,k.value=""):a(b.message||"Erreur lors de la confirmation de réception")}catch(h){console.error("Erreur lors de la confirmation de réception:",h),h.response?.status===409?a("Cette commande est déjà marquée comme reçue"):h.response?.status===400?a(h.response.data?.message||"Cette commande ne peut pas être marquée comme reçue"):a("Erreur lors de la confirmation de réception. Veuillez réessayer.")}finally{D.value=!1}},x=h=>({pending:"En attente",awaiting_payment:"En attente de paiement",paid:"Payé",shipping:"En cours de livraison",failed:"Échoué",cancelled:"Annulé",fulfilled:"Livré",refunded:"Remboursé",expired:"Expiré",completed:"Complété",payment_initiated:"Paiement initié",active:"Actif"})[h]||h,I=h=>({lottery:"Tombola",direct:"Achat direct",ticket_purchase:"Achat de billet",direct_purchase:"Achat direct"})[h]||h,N=h=>({lottery:"Tombola",direct:"Achat direct"})[h]||h,u=h=>({airtel_money:"Airtel Money",moov_money:"Moov Money"})[h]||h||"Non spécifié",A=h=>`px-2 py-1 text-xs rounded-full font-medium ${{pending:"bg-yellow-100 text-yellow-800",awaiting_payment:"bg-blue-100 text-blue-800",paid:"bg-green-100 text-green-800",shipping:"bg-blue-100 text-blue-800",failed:"bg-red-100 text-red-800",cancelled:"bg-gray-100 text-gray-800",fulfilled:"bg-green-100 text-green-800",refunded:"bg-purple-100 text-purple-800",expired:"bg-orange-100 text-orange-800",completed:"bg-green-100 text-green-800",payment_initiated:"bg-blue-100 text-blue-800",active:"bg-blue-100 text-blue-800"}[h]||"bg-gray-100 text-gray-800"}`,H=h=>h?new Date(h).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Non défini",j=h=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(h||0).replace("XAF","FCFA");return ve(()=>{U()}),(h,b)=>{const ee=he("router-link");return s(),o("div",j6,[r.value?(s(),o("div",S6,b[4]||(b[4]=[e("div",{class:"text-center"},[e("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}),e("p",{class:"text-gray-600 mt-4 text-lg"},"Chargement de la commande..."),e("p",{class:"text-gray-400 text-sm mt-2"},"Veuillez patienter")],-1)]))):P.value?(s(),o("div",I6,[e("div",D6,[e("div",T6,[b[5]||(b[5]=e("svg",{class:"w-20 h-20 text-red-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),b[6]||(b[6]=e("h2",{class:"text-3xl font-bold text-gray-900 mb-2"},"Commande introuvable",-1)),e("p",M6,t(P.value),1)]),e("div",L6,[g(ee,{to:"/customer/orders",class:"block bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors"},{default:re(()=>[g(l(at),{class:"w-5 h-5 inline mr-2"}),b[7]||(b[7]=z(" Retour aux commandes ",-1))]),_:1,__:[7]}),e("button",{onClick:V,class:"block w-full bg-gray-200 text-gray-700 px-6 py-3 rounded-md hover:bg-gray-300 transition-colors"},[g(l(Fe),{class:"w-5 h-5 inline mr-2"}),b[8]||(b[8]=z(" Réessayer ",-1))])])])])):n.value?(s(),o("div",V6,[e("div",R6,[e("div",F6,[e("div",null,[e("h1",N6,"Commande #"+t(n.value.order_number),1),e("div",z6,[e("p",q6,t(H(n.value.created_at)),1),b[9]||(b[9]=e("span",{class:"text-gray-400"},"•",-1)),e("span",U6,"Type: "+t(I(n.value.type)),1)])]),e("div",B6,[e("span",{class:te(A(n.value.status))},t(x(n.value.status)),3),["paid","shipping","fulfilled"].includes(n.value.status)?(s(),o("button",{key:0,onClick:i,disabled:M.value,class:te(["px-4 py-2 rounded-md transition-colors flex items-center",M.value?"bg-green-400 text-white cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"])},[M.value?(s(),o("div",G6)):(s(),ce(l(Et),{key:1,class:"w-4 h-4 mr-2"})),z(" "+t(M.value?"Génération...":"Imprimer facture"),1)],10,O6)):T("",!0),e("button",{onClick:b[0]||(b[0]=B=>h.$router.go(-1)),class:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 transition-colors"},[g(l(at),{class:"w-4 h-4 inline mr-2"}),b[10]||(b[10]=z(" Retour ",-1))])])])]),e("div",H6,[b[15]||(b[15]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Informations client",-1)),e("div",K6,[e("div",null,[e("dl",W6,[e("div",null,[b[11]||(b[11]=e("dt",{class:"text-sm font-medium text-gray-600"},"Nom complet",-1)),e("dd",J6,t(n.value.client?.full_name||"Non renseigné"),1)]),e("div",null,[b[12]||(b[12]=e("dt",{class:"text-sm font-medium text-gray-600"},"Email",-1)),e("dd",X6,t(n.value.client?.email||"Non renseigné"),1)])])]),e("div",null,[e("dl",Y6,[e("div",null,[b[13]||(b[13]=e("dt",{class:"text-sm font-medium text-gray-600"},"Téléphone",-1)),e("dd",Q6,t(n.value.client?.phone||"Non renseigné"),1)]),e("div",null,[b[14]||(b[14]=e("dt",{class:"text-sm font-medium text-gray-600"},"Date d'inscription",-1)),e("dd",Z6,t(n.value.client?.created_at?H(n.value.client.created_at):"Non disponible"),1)])])])])]),e("div",e5,[e("div",t5,[e("div",s5,[b[19]||(b[19]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Statut de la commande",-1)),e("div",o5,[e("div",r5,[e("div",a5,[g(l(be),{class:"w-5 h-5 text-green-600"})]),e("div",n5,[b[16]||(b[16]=e("p",{class:"text-sm font-medium text-gray-900"},"Commande créée",-1)),e("p",i5,t(H(n.value.created_at)),1)])]),n.value.paid_at?(s(),o("div",l5,[e("div",d5,[g(l(be),{class:"w-5 h-5 text-green-600"})]),e("div",u5,[b[17]||(b[17]=e("p",{class:"text-sm font-medium text-gray-900"},"Paiement confirmé",-1)),e("p",c5,t(H(n.value.paid_at)),1)])])):T("",!0),n.value.fulfilled_at?(s(),o("div",m5,[e("div",p5,[g(l(be),{class:"w-5 h-5 text-green-600"})]),e("div",g5,[b[18]||(b[18]=e("p",{class:"text-sm font-medium text-gray-900"},"Commande livrée",-1)),e("p",f5,t(H(n.value.fulfilled_at)),1)])])):T("",!0),["pending","awaiting_payment"].includes(n.value.status)?(s(),o("div",v5,[e("div",x5,[g(l(Te),{class:"w-5 h-5 text-yellow-600"})]),e("div",b5,[e("p",y5,t(n.value.status==="pending"?"En attente":"En attente de paiement"),1),e("p",h5,"Créé le "+t(H(n.value.created_at)),1)])])):T("",!0),["failed","cancelled"].includes(n.value.status)?(s(),o("div",_5,[e("div",w5,[g(l(Le),{class:"w-5 h-5 text-red-600"})]),e("div",$5,[e("p",k5,t(n.value.status==="failed"?"Commande échouée":"Commande annulée"),1),e("p",C5,t(n.value.notes||"Aucune raison spécifiée"),1),n.value.cancelled_at?(s(),o("p",A5,t(H(n.value.cancelled_at)),1)):T("",!0)])])):T("",!0)])]),e("div",P5,[b[24]||(b[24]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Détails de l'achat",-1)),n.value.product?(s(),o("div",E5,[e("div",j5,[n.value.product.image?(s(),o("img",{key:0,src:n.value.product.image,alt:n.value.product.name,class:"w-full h-full object-cover"},null,8,S5)):(s(),o("div",I5,[g(l(qe),{class:"w-8 h-8 text-gray-400"})]))]),e("div",D5,[e("h3",T5,t(n.value.product.name),1),e("p",M5,t(n.value.product.description),1),e("div",L5,[e("span",null,"Mode: "+t(N(n.value.product.sale_mode)),1),e("span",null,"Type: "+t(I(n.value.type)),1)])])])):T("",!0),n.value.lottery?(s(),o("div",V5,[e("div",R5,[g(l(je),{class:"w-5 h-5 text-blue-600 mr-2"}),e("h3",F5,t(n.value.lottery.title),1)]),e("div",N5,[e("div",null,[b[20]||(b[20]=e("span",{class:"text-gray-600"},"Numéro de tombola:",-1)),e("span",z5,t(n.value.lottery.lottery_number),1)]),e("div",null,[b[21]||(b[21]=e("span",{class:"text-gray-600"},"Prix du billet:",-1)),e("span",q5,t(j(n.value.lottery.ticket_price)),1)]),e("div",null,[b[22]||(b[22]=e("span",{class:"text-gray-600"},"Billets vendus:",-1)),e("span",U5,t(n.value.lottery.sold_tickets)+"/"+t(n.value.lottery.max_tickets),1)]),n.value.lottery.draw_date?(s(),o("div",B5,[b[23]||(b[23]=e("span",{class:"text-gray-600"},"Date du tirage:",-1)),e("span",O5,t(H(n.value.lottery.draw_date)),1)])):T("",!0)]),n.value.lottery.winning_ticket_number?(s(),o("div",G5,[e("div",H5,[g(l(Je),{class:"w-5 h-5 text-green-600 mr-2"}),e("span",K5," Billet gagnant: "+t(n.value.lottery.winning_ticket_number),1)])])):T("",!0)])):T("",!0)]),e("div",W5,[b[27]||(b[27]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Détails de la commande",-1)),e("div",J5,[e("div",X5,[e("div",Y5,[e("h3",Q5,t(n.value.product?.name||"Produit non disponible"),1),e("p",Z5,t(n.value.product?.description||""),1),e("div",ek,[e("span",tk,t(I(n.value.type)),1),n.value.lottery?(s(),o("span",sk,t(n.value.lottery.title),1)):T("",!0)])]),e("div",ok,[e("p",rk,t(j(n.value.total_amount)),1),e("p",ak,t(n.value.currency),1)])])]),n.value.tickets&&n.value.tickets.length>0?(s(),o("div",nk,[e("h3",ik,"Billets de tombola ("+t(n.value.tickets.length)+")",1),e("div",lk,[(s(!0),o(ie,null,le(n.value.tickets,B=>(s(),o("div",{key:B.id,class:te(["border rounded-lg p-3 transition-colors",B.is_winner?"bg-green-50 border-green-200 ring-1 ring-green-300":"bg-gray-50 border-gray-200"])},[e("div",dk,[e("div",null,[e("p",uk,t(B.ticket_number),1),e("p",ck,t(j(B.price_paid)),1),B.purchased_at?(s(),o("p",mk," Acheté le "+t(H(B.purchased_at)),1)):T("",!0)]),e("div",pk,[e("span",{class:te([A(B.status),"text-xs"])},t(x(B.status)),3),B.is_winner?(s(),o("div",gk,[e("span",fk,[g(l(Je),{class:"w-3 h-3 mr-1"}),b[25]||(b[25]=z(" Gagnant! ",-1))])])):T("",!0)])])],2))),128))])])):T("",!0),e("div",vk,[e("div",xk,[b[26]||(b[26]=e("span",{class:"text-base font-medium text-gray-900"},"Total de la commande",-1)),e("span",bk,t(j(n.value.total_amount)),1)])])]),e("div",yk,[b[34]||(b[34]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Paiements liés",-1)),n.value.payments&&n.value.payments.length>0?(s(),o("div",hk,[(s(!0),o(ie,null,le(n.value.payments,B=>(s(),o("div",{key:B.id,class:"border border-gray-200 rounded-lg p-4"},[e("div",_k,[e("div",null,[e("p",wk,t(B.reference),1),e("p",$k,t(B.ebilling_id||"ID non disponible"),1)]),e("span",{class:te([A(B.status),"text-xs"])},t(x(B.status)),3)]),e("dl",kk,[e("div",null,[b[28]||(b[28]=e("dt",{class:"text-gray-600"},"Montant",-1)),e("dd",Ck,t(j(B.amount)),1)]),e("div",null,[b[29]||(b[29]=e("dt",{class:"text-gray-600"},"Méthode",-1)),e("dd",Ak,t(u(B.payment_method)),1)]),e("div",null,[b[30]||(b[30]=e("dt",{class:"text-gray-600"},"Créé le",-1)),e("dd",null,t(H(B.created_at)),1)]),B.paid_at?(s(),o("div",Pk,[b[31]||(b[31]=e("dt",{class:"text-gray-600"},"Payé le",-1)),e("dd",null,t(H(B.paid_at)),1)])):T("",!0),B.external_transaction_id?(s(),o("div",Ek,[b[32]||(b[32]=e("dt",{class:"text-gray-600"},"ID Transaction externe",-1)),e("dd",jk,t(B.external_transaction_id),1)])):T("",!0)])]))),128))])):(s(),o("div",Sk,[g(l(Xe),{class:"w-12 h-12 text-gray-400 mx-auto mb-3"}),b[33]||(b[33]=e("p",{class:"text-gray-500"},"Aucun paiement associé",-1))]))])]),e("div",Ik,[e("div",Dk,[b[37]||(b[37]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Résumé financier",-1)),e("dl",Tk,[e("div",Mk,[b[35]||(b[35]=e("dt",{class:"text-gray-600"},"Sous-total:",-1)),e("dd",Lk,t(j(n.value.total_amount)),1)]),e("div",Vk,[e("div",Rk,[b[36]||(b[36]=e("dt",{class:"text-base font-medium text-gray-900"},"Total:",-1)),e("dd",Fk,t(j(n.value.total_amount)),1)])])])]),e("div",Nk,[b[40]||(b[40]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Informations de paiement",-1)),e("dl",zk,[e("div",null,[b[38]||(b[38]=e("dt",{class:"text-gray-600"},"Numéro de commande:",-1)),e("dd",qk,t(n.value.order_number),1)]),n.value.payments&&n.value.payments.length>0?(s(),o("div",Uk,[b[39]||(b[39]=e("dt",{class:"text-gray-600"},"Paiements:",-1)),e("dd",null,[(s(!0),o(ie,null,le(n.value.payments,B=>(s(),o("div",{key:B.id,class:"mt-1"},[e("div",Bk,t(B.reference),1),e("div",Ok,t(u(B.payment_method)),1),e("span",{class:te([A(B.status),"text-xs"])},t(x(B.status)),3)]))),128))])])):T("",!0)])]),e("div",Gk,[b[49]||(b[49]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Actions disponibles",-1)),e("div",Hk,[n.value.status==="failed"?(s(),o("button",{key:0,onClick:v,class:"w-full bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors flex items-center justify-center"},[g(l(Fe),{class:"w-4 h-4 mr-2"}),b[41]||(b[41]=z(" Réessayer le paiement ",-1))])):T("",!0),["paid","shipping","fulfilled"].includes(n.value.status)?(s(),o("button",{key:1,onClick:d,disabled:$.value,class:te(["w-full px-4 py-2 rounded-md transition-colors flex items-center justify-center whitespace-nowrap",$.value?"bg-green-400 text-white cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"])},[$.value?(s(),o("div",Wk)):(s(),ce(l(dt),{key:1,class:"w-4 h-4 mr-2 flex-shrink-0"})),z(" "+t($.value?"Téléchargement...":"Télécharger la facture"),1)],10,Kk)):T("",!0),["paid","shipping","fulfilled"].includes(n.value.status)?(s(),o("button",{key:2,onClick:i,disabled:M.value,class:te(["w-full px-4 py-2 rounded-md transition-colors flex items-center justify-center",M.value?"bg-blue-400 text-white cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"])},[M.value?(s(),o("div",Xk)):(s(),ce(l(Et),{key:1,class:"w-4 h-4 mr-2"})),z(" "+t(M.value?"Génération...":"Imprimer la facture"),1)],10,Jk)):T("",!0),(n.value.status==="paid"||n.value.status==="shipping")&&(n.value.type!=="lottery"||n.value.has_winning_ticket)?(s(),o("button",{key:3,onClick:b[1]||(b[1]=B=>m.value=!0),disabled:D.value,class:te(["w-full px-4 py-2 rounded-md transition-colors flex items-center justify-center",D.value?"bg-orange-400 text-white cursor-not-allowed":"bg-orange-600 text-white hover:bg-orange-700"])},[D.value?(s(),o("div",Qk)):(s(),ce(l(be),{key:1,class:"w-4 h-4 mr-2"})),z(" "+t(D.value?"Validation...":"Confirmer la réception"),1)],10,Yk)):T("",!0),(n.value.status==="paid"||n.value.status==="shipping")&&n.value.type==="lottery"&&!n.value.has_winning_ticket?(s(),o("div",Zk,[e("div",e9,[g(l(We),{class:"w-5 h-5 text-gray-500 mr-2 flex-shrink-0"}),b[42]||(b[42]=e("div",null,[e("p",{class:"text-sm font-medium text-gray-700"},"Ticket de tombola non gagnant"),e("p",{class:"text-xs text-gray-500"},"Aucune livraison n'est prévue pour ce ticket")],-1))])])):T("",!0),n.value.status==="fulfilled"?(s(),o("div",t9,[e("div",s9,[g(l(be),{class:"w-5 h-5 text-green-600 mr-2 flex-shrink-0"}),e("div",null,[b[43]||(b[43]=e("p",{class:"text-sm font-medium text-green-800"},"Produit reçu",-1)),e("p",o9,t(H(n.value.fulfilled_at)),1)])])])):T("",!0),["paid","shipping","fulfilled"].includes(n.value.status)?T("",!0):(s(),o("div",r9,[b[47]||(b[47]=e("p",{class:"text-sm text-gray-500 mb-2"},"Actions disponibles après paiement:",-1)),e("div",a9,[g(l(dt),{class:"w-4 h-4"}),b[44]||(b[44]=e("span",null,"Téléchargement facture",-1)),b[45]||(b[45]=e("span",null,"•",-1)),g(l(Et),{class:"w-4 h-4"}),b[46]||(b[46]=e("span",null,"Impression facture",-1))])])),g(ee,{to:"/customer/orders",class:"w-full block text-center bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors"},{default:re(()=>[g(l(at),{class:"w-4 h-4 inline mr-2"}),b[48]||(b[48]=z(" Retour aux commandes ",-1))]),_:1,__:[48]})])])])])])):T("",!0),m.value?(s(),o("div",n9,[e("div",i9,[e("div",l9,[e("div",d9,[g(l(be),{class:"w-8 h-8 text-orange-600 mr-3"}),b[50]||(b[50]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Confirmer la réception",-1))]),b[52]||(b[52]=e("p",{class:"text-gray-600 mb-4"}," Confirmez-vous avoir bien reçu le produit de cette commande ? Cette action ne peut pas être annulée. ",-1)),e("div",u9,[b[51]||(b[51]=e("label",{for:"delivery-notes",class:"block text-sm font-medium text-gray-700 mb-2"}," Commentaire (optionnel) ",-1)),Q(e("textarea",{id:"delivery-notes","onUpdate:modelValue":b[2]||(b[2]=B=>k.value=B),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-orange-500 focus:border-orange-500",placeholder:"Ajoutez un commentaire sur la réception du produit..."},null,512),[[ne,k.value]])]),e("div",c9,[e("button",{onClick:b[3]||(b[3]=B=>m.value=!1),disabled:D.value,class:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50"}," Annuler ",8,m9),e("button",{onClick:C,disabled:D.value,class:te(["flex-1 px-4 py-2 rounded-md text-white transition-colors flex items-center justify-center",D.value?"bg-orange-400 cursor-not-allowed":"bg-orange-600 hover:bg-orange-700"])},[D.value?(s(),o("div",g9)):T("",!0),z(" "+t(D.value?"Validation...":"Confirmer"),1)],10,p9)])])])])):T("",!0)])}}},v9=Ee(f9,[["__scopeId","data-v-ef2606a8"]]),Ht="/build/assets/am-CfOZUG_l.png",Kt="/build/assets/mm-BaxcDjGZ.png",x9={class:"payment-detail"},b9={key:0,class:"flex justify-center items-center min-h-64"},y9={key:1,class:"text-center py-12"},h9={class:"text-gray-600 mb-4"},_9={key:2},w9={class:"mb-8"},$9={class:"flex items-center justify-between"},k9={class:"text-3xl font-bold text-gray-900"},C9={class:"text-gray-600 mt-2"},A9={class:"flex items-center space-x-3"},P9={class:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8"},E9={class:"lg:col-span-2 space-y-6"},j9={class:"bg-white rounded-lg shadow p-6"},S9={class:"space-y-4"},I9={class:"flex items-center"},D9={class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},T9={class:"ml-4"},M9={class:"text-sm text-gray-500"},L9={key:0,class:"flex items-center"},V9={class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},R9={class:"ml-4"},F9={class:"text-sm text-gray-500"},N9={key:1,class:"flex items-center"},z9={class:"flex-shrink-0 w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},q9={class:"ml-4"},U9={class:"text-sm text-gray-500"},B9={key:2,class:"flex items-center"},O9={class:"flex-shrink-0 w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center"},G9={key:3,class:"flex items-center"},H9={class:"flex-shrink-0 w-8 h-8 bg-red-100 rounded-full flex items-center justify-center"},K9={class:"ml-4"},W9={class:"text-sm font-medium text-gray-900"},J9={key:0,class:"text-sm text-gray-500"},X9={class:"bg-white rounded-lg shadow p-6"},Y9={class:"flex items-center space-x-4"},Q9={class:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center"},Z9=["src","alt"],e8={class:"text-lg font-medium text-gray-900"},t8={key:0,class:"text-sm text-gray-600"},s8={key:1,class:"text-sm text-gray-500"},o8={key:0,class:"bg-white rounded-lg shadow p-6"},r8={key:0,class:"flex items-start space-x-4 mb-4"},a8={class:"flex-shrink-0 w-16 h-16 bg-gray-200 rounded-lg overflow-hidden"},n8=["src","alt"],i8={key:1,class:"w-full h-full flex items-center justify-center"},l8={class:"flex-1"},d8={class:"text-lg font-medium text-gray-900"},u8={class:"text-sm text-gray-600 mt-1"},c8={class:"mt-2 flex items-center space-x-4 text-sm text-gray-500"},m8={key:0},p8={key:1,class:"border rounded-lg p-4 bg-blue-50"},g8={class:"flex items-center mb-3"},f8={class:"text-lg font-medium text-gray-900"},v8={class:"grid grid-cols-2 gap-4 text-sm"},x8={class:"font-medium ml-2"},b8={class:"font-medium ml-2"},y8={key:2,class:"mt-4"},h8={class:"text-md font-medium text-gray-900 mb-3"},_8={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},w8={class:"flex justify-between items-center"},$8={class:"font-medium"},k8={class:"flex items-center space-x-2"},C8={key:1,class:"bg-white rounded-lg shadow p-6"},A8={class:"bg-gray-50 rounded-lg p-4"},P8={class:"text-sm text-gray-700 whitespace-pre-wrap"},E8={class:"space-y-6"},j8={class:"bg-white rounded-lg shadow p-6"},S8={class:"space-y-3"},I8={class:"flex justify-between text-sm"},D8={class:"font-medium"},T8={class:"flex justify-between text-sm"},M8={class:"font-medium"},L8={class:"border-t pt-3"},V8={class:"flex justify-between"},R8={class:"text-base font-medium text-gray-900"},F8={class:"bg-white rounded-lg shadow p-6"},N8={class:"space-y-3 text-sm"},z8={key:0},q8={class:"font-medium font-mono break-all"},U8={key:1},B8={class:"font-medium font-mono"},O8={key:2},G8={class:"font-medium font-mono break-all"},H8={key:3},K8={class:"font-medium"},W8={key:4},J8={class:"font-medium"},X8={class:"bg-white rounded-lg shadow p-6"},Y8={class:"space-y-3"},Q8={__name:"PaymentDetail",setup(_){const y=Be(),w=$e(),{get:p}=ge(),{success:f}=bt(),a=R(null),c=R(!0),n=R(null),r=async()=>{try{c.value=!0;const d=y.params.id,i=await p(`/payments/${d}`);i.success?a.value=i.data:n.value=i.message||"Paiement non trouvé"}catch(d){console.error("Erreur lors du chargement du paiement:",d),n.value="Erreur lors du chargement du paiement"}finally{c.value=!1}},P=()=>{a.value.transaction&&w.push({name:"payment.phone",query:{transaction_id:a.value.transaction.transaction_id,retry:"true"}})},$=()=>{a.value.transaction&&w.push({name:"customer.order.detail",params:{id:a.value.transaction.transaction_id}})},M=()=>{f("Fonctionnalité de téléchargement en cours de développement")},D=d=>({paid:"Payé",pending:"En attente",failed:"Échoué",expired:"Expiré",processed:"Traité"})[d]||d,m=d=>({airtel_money:"Airtel Money",moov_money:"Moov Money"})[d]||d||"Non spécifié",k=d=>({airtel_money:Ht,moov_money:Kt})[d],U=(d,i=!1)=>`${i?"px-1 py-0.5 text-xs":"px-2 py-1 text-xs"} rounded-full font-medium ${{paid:"bg-green-100 text-green-800",processed:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",failed:"bg-red-100 text-red-800",expired:"bg-gray-100 text-gray-800"}[d]||"bg-gray-100 text-gray-800"}`,V=d=>d?new Date(d).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Non défini",v=d=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(d||0).replace("XAF","FCFA");return ve(()=>{r()}),(d,i)=>{const C=he("router-link");return s(),o("div",x9,[c.value?(s(),o("div",b9,i[1]||(i[1]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"},null,-1)]))):n.value?(s(),o("div",y9,[i[3]||(i[3]=e("svg",{class:"w-16 h-16 text-red-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),i[4]||(i[4]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-2"},"Paiement introuvable",-1)),e("p",h9,t(n.value),1),g(C,{to:"/customer/payments",class:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700"},{default:re(()=>i[2]||(i[2]=[z(" Retour aux paiements ",-1)])),_:1,__:[2]})])):a.value?(s(),o("div",_9,[e("div",w9,[e("div",$9,[e("div",null,[e("h1",k9," Paiement #"+t(a.value.ebilling_id||a.value.id),1),e("p",C9,t(V(a.value.created_at)),1)]),e("div",A9,[e("span",{class:te(U(a.value.status))},t(D(a.value.status)),3),e("button",{onClick:i[0]||(i[0]=x=>d.$router.go(-1)),class:"bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 transition-colors"},[g(l(at),{class:"w-4 h-4 inline mr-2"}),i[5]||(i[5]=z(" Retour ",-1))])])])]),e("div",P9,[e("div",E9,[e("div",j9,[i[10]||(i[10]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Statut du paiement",-1)),e("div",S9,[e("div",I9,[e("div",D9,[g(l(be),{class:"w-5 h-5 text-green-600"})]),e("div",T9,[i[6]||(i[6]=e("p",{class:"text-sm font-medium text-gray-900"},"Paiement initié",-1)),e("p",M9,t(V(a.value.created_at)),1)])]),a.value.paid_at?(s(),o("div",L9,[e("div",V9,[g(l(be),{class:"w-5 h-5 text-green-600"})]),e("div",R9,[i[7]||(i[7]=e("p",{class:"text-sm font-medium text-gray-900"},"Paiement confirmé",-1)),e("p",F9,t(V(a.value.paid_at)),1)])])):T("",!0),a.value.processed_at?(s(),o("div",N9,[e("div",z9,[g(l(be),{class:"w-5 h-5 text-green-600"})]),e("div",q9,[i[8]||(i[8]=e("p",{class:"text-sm font-medium text-gray-900"},"Paiement traité",-1)),e("p",U9,t(V(a.value.processed_at)),1)])])):T("",!0),a.value.status==="pending"?(s(),o("div",B9,[e("div",O9,[g(l(Te),{class:"w-5 h-5 text-yellow-600"})]),i[9]||(i[9]=e("div",{class:"ml-4"},[e("p",{class:"text-sm font-medium text-gray-900"},"En attente de confirmation"),e("p",{class:"text-sm text-gray-500"},"Veuillez confirmer sur votre téléphone")],-1))])):T("",!0),a.value.status==="failed"||a.value.status==="expired"?(s(),o("div",G9,[e("div",H9,[g(l(Le),{class:"w-5 h-5 text-red-600"})]),e("div",K9,[e("p",W9,t(a.value.status==="expired"?"Paiement expiré":"Paiement échoué"),1),a.value.gateway_response&&a.value.gateway_response.failure_reason?(s(),o("p",J9,t(a.value.gateway_response.failure_reason),1)):T("",!0)])])):T("",!0)])]),e("div",X9,[i[11]||(i[11]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Méthode de paiement",-1)),e("div",Y9,[e("div",Q9,[k(a.value.payment_method)?(s(),o("img",{key:0,src:k(a.value.payment_method),alt:m(a.value.payment_method),class:"w-12 h-12 object-contain"},null,8,Z9)):(s(),ce(l(Xe),{key:1,class:"w-8 h-8 text-gray-400"}))]),e("div",null,[e("h3",e8,t(m(a.value.payment_method)),1),a.value.customer_phone?(s(),o("p",t8," +241 "+t(a.value.customer_phone),1)):T("",!0),a.value.gateway?(s(),o("p",s8," Via "+t(a.value.gateway.display_name),1)):T("",!0)])])]),a.value.transaction?(s(),o("div",o8,[i[14]||(i[14]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Transaction associée",-1)),a.value.transaction.product?(s(),o("div",r8,[e("div",a8,[a.value.transaction.product.image?(s(),o("img",{key:0,src:a.value.transaction.product.image,alt:a.value.transaction.product.name,class:"w-full h-full object-cover"},null,8,n8)):(s(),o("div",i8,[g(l(qe),{class:"w-8 h-8 text-gray-400"})]))]),e("div",l8,[e("h3",d8,t(a.value.transaction.product.name),1),e("p",u8,t(a.value.transaction.product.description),1),e("div",c8,[e("span",null,"Référence: "+t(a.value.transaction.reference),1),a.value.transaction.quantity?(s(),o("span",m8,"Quantité: "+t(a.value.transaction.quantity),1)):T("",!0)])])])):T("",!0),a.value.transaction.lottery?(s(),o("div",p8,[e("div",g8,[g(l(je),{class:"w-5 h-5 text-blue-600 mr-2"}),e("h3",f8,t(a.value.transaction.lottery.title),1)]),e("div",v8,[e("div",null,[i[12]||(i[12]=e("span",{class:"text-gray-600"},"Numéro de tombola:",-1)),e("span",x8,t(a.value.transaction.lottery.lottery_number),1)]),e("div",null,[i[13]||(i[13]=e("span",{class:"text-gray-600"},"Prix du billet:",-1)),e("span",b8,t(v(a.value.transaction.lottery.ticket_price)),1)])])])):T("",!0),a.value.transaction.tickets&&a.value.transaction.tickets.length>0?(s(),o("div",y8,[e("h3",h8," Billets achetés ("+t(a.value.transaction.tickets.length)+") ",1),e("div",_8,[(s(!0),o(ie,null,le(a.value.transaction.tickets,x=>(s(),o("div",{key:x.id,class:te(["border rounded-lg p-3 text-sm",x.is_winner?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"])},[e("div",w8,[e("span",$8,t(x.ticket_number),1),e("div",k8,[e("span",{class:te(U(x.status,!0))},t(D(x.status)),3),x.is_winner?(s(),ce(l(Je),{key:0,class:"w-4 h-4 text-green-600"})):T("",!0)])])],2))),128))])])):T("",!0)])):T("",!0),a.value.gateway_response?(s(),o("div",C8,[i[15]||(i[15]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Réponse de la passerelle",-1)),e("div",A8,[e("pre",P8,t(JSON.stringify(a.value.gateway_response,null,2)),1)])])):T("",!0)]),e("div",E8,[e("div",j8,[i[19]||(i[19]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Résumé du paiement",-1)),e("dl",S8,[e("div",I8,[i[16]||(i[16]=e("dt",{class:"text-gray-600"},"Montant:",-1)),e("dd",D8,t(v(a.value.amount)),1)]),e("div",T8,[i[17]||(i[17]=e("dt",{class:"text-gray-600"},"Devise:",-1)),e("dd",M8,t(a.value.currency||"XAF"),1)]),e("div",L8,[e("div",V8,[i[18]||(i[18]=e("dt",{class:"text-base font-medium text-gray-900"},"Total:",-1)),e("dd",R8,t(v(a.value.amount)),1)])])])]),e("div",F8,[i[25]||(i[25]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Détails techniques",-1)),e("dl",N8,[a.value.reference?(s(),o("div",z8,[i[20]||(i[20]=e("dt",{class:"text-gray-600"},"Référence:",-1)),e("dd",q8,t(a.value.reference),1)])):T("",!0),a.value.ebilling_id?(s(),o("div",U8,[i[21]||(i[21]=e("dt",{class:"text-gray-600"},"ID E-Billing:",-1)),e("dd",B8,t(a.value.ebilling_id),1)])):T("",!0),a.value.external_transaction_id?(s(),o("div",O8,[i[22]||(i[22]=e("dt",{class:"text-gray-600"},"ID Transaction externe:",-1)),e("dd",G8,t(a.value.external_transaction_id),1)])):T("",!0),a.value.customer_name?(s(),o("div",H8,[i[23]||(i[23]=e("dt",{class:"text-gray-600"},"Nom du client:",-1)),e("dd",K8,t(a.value.customer_name),1)])):T("",!0),a.value.customer_email?(s(),o("div",W8,[i[24]||(i[24]=e("dt",{class:"text-gray-600"},"Email:",-1)),e("dd",J8,t(a.value.customer_email),1)])):T("",!0)])]),e("div",X8,[i[30]||(i[30]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Actions",-1)),e("div",Y8,[a.value.status==="failed"||a.value.status==="expired"?(s(),o("button",{key:0,onClick:P,class:"w-full bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors"},[g(l(Fe),{class:"w-4 h-4 inline mr-2"}),i[26]||(i[26]=z(" Réessayer le paiement ",-1))])):T("",!0),a.value.transaction?(s(),o("button",{key:1,onClick:$,class:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors"},[g(l(Ue),{class:"w-4 h-4 inline mr-2"}),i[27]||(i[27]=z(" Voir la commande ",-1))])):T("",!0),e("button",{onClick:M,class:"w-full bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300 transition-colors"},[g(l(dt),{class:"w-4 h-4 inline mr-2"}),i[28]||(i[28]=z(" Télécharger le reçu ",-1))]),g(C,{to:"/customer/payments",class:"w-full block text-center bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors"},{default:re(()=>i[29]||(i[29]=[z(" Voir tous les paiements ",-1)])),_:1,__:[29]})])])])])])):T("",!0)])}}},Z8=Ee(Q8,[["__scopeId","data-v-6b9666f3"]]),e7={name:"Notifications",setup(){const _=$e(),y=Pe(),w=R([]),p=xe({total:0,unread:0,recent:0,by_type:{}}),f=R("all"),a=R(!0),c=R(!1),n=R(1),r=20,P=de(()=>w.value.length>=n.value*r),$=async(I=!1)=>{if(y.isAuthenticated){I?c.value=!0:(a.value=!0,n.value=1);try{const N={limit:r,offset:I?w.value.length:0};f.value!=="all"&&(f.value==="unread"?N.unread_only=!0:N.type=f.value);const u=await Ce.get("/notifications",{params:N});if(u.data.success){const A=u.data.data.notifications;I?w.value.push(...A):w.value=A,Object.assign(p,u.data.data.stats)}}catch(N){console.error("Erreur lors du chargement des notifications:",N)}finally{a.value=!1,c.value=!1}}},M=()=>{n.value++,$(!0)},D=async I=>{try{await Ce.post(`/notifications/${I}/read`);const N=w.value.find(u=>u.id===I);N&&!N.is_read&&(N.is_read=!0,p.unread=Math.max(0,p.unread-1))}catch(N){console.error("Erreur lors du marquage de la notification:",N)}},m=async()=>{c.value=!0;try{await Ce.post("/notifications/mark-all-read"),w.value.forEach(I=>{I.is_read=!0}),p.unread=0}catch(I){console.error("Erreur lors du marquage de toutes les notifications:",I)}finally{c.value=!1}},k=async I=>{try{await Ce.delete(`/notifications/${I}`);const N=w.value.findIndex(u=>u.id===I);if(N>-1){const u=w.value[N];w.value.splice(N,1),p.total=Math.max(0,p.total-1),u.is_read||(p.unread=Math.max(0,p.unread-1))}}catch(N){console.error("Erreur lors de la suppression de la notification:",N)}},U=async I=>{I.is_read||await D(I.id);const N=V(I);N&&_.push(N)},V=I=>{switch(I.type){case"order_status_changed":return`/customer/orders/${I.data?.order_number||""}`;case"lottery_winner":case"ticket_purchase":return"/customer/tickets";case"lottery_draw_result":return`/lotteries/${I.data?.lottery_id||""}`;case"merchant_payment":return"/merchant/orders";case"admin_alert":return"/admin/dashboard";default:return null}},v=I=>({order_status_changed:"📦",lottery_winner:"🎉",ticket_purchase:"🎫",lottery_draw_result:"📊",merchant_payment:"💰",admin_alert:"⚠️",welcome:"👋",reminder:"⏰",system:"🔔"})[I]||"🔔",d=I=>({order_status_changed:"bg-blue-500",lottery_winner:"bg-green-500",ticket_purchase:"bg-purple-500",lottery_draw_result:"bg-orange-500",merchant_payment:"bg-yellow-500",admin_alert:"bg-red-500",welcome:"bg-blue-500",reminder:"bg-orange-500",system:"bg-gray-500"})[I]||"bg-gray-500",i=I=>({order_status_changed:"Commande",lottery_winner:"Gain",ticket_purchase:"Achat",lottery_draw_result:"Tirage",merchant_payment:"Paiement",admin_alert:"Alerte",welcome:"Bienvenue",reminder:"Rappel",system:"Système"})[I]||"Notification",C=I=>({order_status_changed:"bg-blue-100 text-blue-800",lottery_winner:"bg-green-100 text-green-800",ticket_purchase:"bg-purple-100 text-purple-800",lottery_draw_result:"bg-orange-100 text-orange-800",merchant_payment:"bg-yellow-100 text-yellow-800",admin_alert:"bg-red-100 text-red-800",welcome:"bg-blue-100 text-blue-800",reminder:"bg-orange-100 text-orange-800",system:"bg-gray-100 text-gray-800"})[I]||"bg-gray-100 text-gray-800",x=I=>{const N=new Date,u=new Date(I),A=Math.floor((N-u)/1e3);return A<60?"À l'instant":A<3600?`Il y a ${Math.floor(A/60)} min`:A<86400?`Il y a ${Math.floor(A/3600)}h`:A<604800?`Il y a ${Math.floor(A/86400)} jour${Math.floor(A/86400)>1?"s":""}`:u.toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:u.getFullYear()!==N.getFullYear()?"numeric":void 0})};return ve(()=>{$()}),{notifications:w,stats:p,selectedFilter:f,initialLoading:a,loading:c,hasMoreNotifications:P,loadNotifications:$,loadMoreNotifications:M,markAllAsRead:m,deleteNotification:k,handleNotificationClick:U,getNotificationIcon:v,getNotificationIconClass:d,getNotificationTypeLabel:i,getNotificationTypeClass:C,formatTimeAgo:x}}},t7={class:"max-w-4xl mx-auto px-4 py-6"},s7={class:"mb-8"},o7={class:"flex items-center justify-between"},r7={class:"text-gray-600"},a7={key:0,class:"text-blue-600 font-medium"},n7={class:"flex items-center space-x-4"},i7=["disabled"],l7={key:0,class:"flex items-center justify-center py-12"},d7={key:1,class:"space-y-4"},u7=["onClick"],c7={class:"p-6"},m7={class:"flex items-start space-x-4"},p7={class:"flex-shrink-0"},g7={class:"flex-1 min-w-0"},f7={class:"flex items-start justify-between mb-2"},v7=["innerHTML"],x7={class:"flex items-center space-x-2"},b7={class:"text-sm text-gray-400"},y7=["onClick"],h7=["innerHTML"],_7={class:"flex items-center justify-between"},w7={class:"flex items-center space-x-3"},$7={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},k7={key:0,class:"w-3 h-3 bg-blue-600 rounded-full"},C7={key:0,class:"text-center py-6"},A7=["disabled"],P7={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4"},E7={key:2,class:"text-center py-12"},j7={class:"text-lg font-medium text-gray-900 mb-2"},S7={class:"text-gray-500"};function I7(_,y,w,p,f,a){return s(),o("div",t7,[e("div",s7,[y[5]||(y[5]=e("h1",{class:"text-2xl font-bold text-gray-900 mb-2"},"Notifications",-1)),e("div",o7,[e("p",r7,[z(t(p.stats.total)+" notification"+t(p.stats.total>1?"s":"")+" ",1),p.stats.unread>0?(s(),o("span",a7," ("+t(p.stats.unread)+" non lue"+t(p.stats.unread>1?"s":"")+") ",1)):T("",!0)]),e("div",n7,[p.stats.unread>0?(s(),o("button",{key:0,onClick:y[0]||(y[0]=(...c)=>p.markAllAsRead&&p.markAllAsRead(...c)),disabled:p.loading,class:"text-sm text-blue-600 hover:text-blue-800 font-medium disabled:opacity-50"}," Tout marquer comme lu ",8,i7)):T("",!0),Q(e("select",{"onUpdate:modelValue":y[1]||(y[1]=c=>p.selectedFilter=c),onChange:y[2]||(y[2]=(...c)=>p.loadNotifications&&p.loadNotifications(...c)),class:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},y[4]||(y[4]=[pe('<option value="all">Toutes</option><option value="unread">Non lues</option><option value="order_status_changed">Commandes</option><option value="lottery_winner">Gains</option><option value="ticket_purchase">Achats</option><option value="reminder">Rappels</option>',6)]),544),[[me,p.selectedFilter]])])])]),p.initialLoading?(s(),o("div",l7,y[6]||(y[6]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1)]))):p.notifications.length>0?(s(),o("div",d7,[(s(!0),o(ie,null,le(p.notifications,c=>(s(),o("div",{key:c.id,onClick:n=>p.handleNotificationClick(c),class:te(["bg-white rounded-lg border shadow-sm hover:shadow-md transition-shadow duration-200 cursor-pointer overflow-hidden",{"border-l-4 border-l-blue-500 bg-blue-50":!c.is_read,"opacity-75":c.is_read}])},[e("div",c7,[e("div",m7,[e("div",p7,[e("div",{class:te(["w-12 h-12 rounded-full flex items-center justify-center text-white text-lg font-medium",p.getNotificationIconClass(c.type)])},t(p.getNotificationIcon(c.type)),3)]),e("div",g7,[e("div",f7,[e("h3",{class:te(["text-lg font-medium text-gray-900",{"font-semibold":!c.is_read}]),innerHTML:c.title},null,10,v7),e("div",x7,[e("span",b7,t(p.formatTimeAgo(c.created_at)),1),e("button",{onClick:_e(n=>p.deleteNotification(c.id),["stop"]),class:"text-gray-400 hover:text-red-500 transition-colors duration-200",title:"Supprimer"},y[7]||(y[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,y7)])]),e("p",{class:"text-gray-600 text-sm mb-3",innerHTML:c.message},null,8,h7),e("div",_7,[e("div",w7,[e("span",{class:te(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",p.getNotificationTypeClass(c.type)])},t(p.getNotificationTypeLabel(c.type)),3),c.is_read?T("",!0):(s(),o("span",$7," Nouveau "))]),c.is_read?T("",!0):(s(),o("div",k7))])])])])],10,u7))),128)),p.hasMoreNotifications?(s(),o("div",C7,[e("button",{onClick:y[3]||(y[3]=(...c)=>p.loadMoreNotifications&&p.loadMoreNotifications(...c)),disabled:p.loading,class:"inline-flex items-center px-6 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[p.loading?(s(),o("span",P7,y[8]||(y[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("circle",{cx:"12",cy:"12",r:"10","stroke-width":"4",class:"opacity-25"}),e("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",class:"opacity-75"})],-1)]))):T("",!0),z(" "+t(p.loading?"Chargement...":"Charger plus"),1)],8,A7)])):T("",!0)])):(s(),o("div",E7,[y[9]||(y[9]=e("svg",{class:"w-24 h-24 mx-auto text-gray-300 mb-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)),e("h3",j7,t(p.selectedFilter==="unread"?"Aucune notification non lue":"Aucune notification"),1),e("p",S7,t(p.selectedFilter==="unread"?"Toutes vos notifications ont été lues.":"Vous n'avez encore reçu aucune notification."),1)]))])}const Vt=Ee(e7,[["render",I7]]),D7={class:"min-h-screen bg-gray-50 py-8"},T7={class:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8"},M7={class:"text-center mb-8"},L7={class:"mb-6"},V7=["src"],R7={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},F7={class:"flex items-center space-x-4 mb-4"},N7=["src","alt"],z7={class:"flex-1"},q7={class:"font-medium text-gray-900"},U7={class:"text-sm text-gray-600"},B7={key:0},O7={key:1},G7={class:"text-right"},H7={class:"text-lg font-bold text-gray-900"},K7={key:0,class:"text-sm text-gray-500"},W7={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},J7={class:"space-y-4"},X7={class:"space-y-3"},Y7={class:"text-sm font-medium text-gray-700 flex items-center gap-2"},Q7={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Z7={class:"flex items-center space-x-3"},eC={class:"w-12 h-12 rounded-lg overflow-hidden flex items-center justify-center bg-white border border-gray-200"},tC=["src"],sC={class:"ml-auto"},oC={key:0,class:"w-full h-full rounded-full bg-white transform scale-50"},rC={class:"flex items-center space-x-3"},aC={class:"w-12 h-12 rounded-lg overflow-hidden flex items-center justify-center bg-white border border-gray-200"},nC=["src"],iC={class:"ml-auto"},lC={key:0,class:"w-full h-full rounded-full bg-white transform scale-50"},dC={class:"mt-8 flex items-center justify-between"},uC=["disabled"],cC={key:0},mC={class:"mt-6 text-center"},pC={class:"flex items-center justify-center gap-2 text-sm text-gray-500"},gC={__name:"PaymentMethod",setup(_){const y=Be(),w=$e(),p=R(""),f=R(!1),a=R({type:"ticket",productName:"",quantity:1,unitPrice:0,totalAmount:0,image:"",transactionId:null}),c=$=>{p.value=$},n=()=>{w.back()},r=()=>{if(!p.value)return;f.value=!0;const $={method:p.value,amount:a.value.totalAmount,type:a.value.type};a.value.orderNumber?$.order_number=a.value.orderNumber:a.value.transactionId&&($.transaction_id=a.value.transactionId),w.push({name:"payment.phone",query:$})},P=$=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format($).replace("XAF","FCFA");return ve(async()=>{const{type:$,product:M,quantity:D,amount:m,transaction_id:k,order_number:U,lottery_id:V}=y.query;if(!(U||k)){w.push("/");return}if(a.value={type:$||"ticket",productName:M||"Produit",quantity:parseInt(D)||1,unitPrice:parseFloat(m)/(parseInt(D)||1),totalAmount:parseFloat(m)||0,image:"/images/products/placeholder.jpg",transactionId:k,orderNumber:U},V)try{const i=await(await fetch(`/api/lotteries/${V}`)).json();i.success&&i.lottery?.product&&(a.value.image=i.lottery.product.image_url||i.lottery.product.main_image||"/images/products/placeholder.jpg",a.value.productName=i.lottery.product.name||i.lottery.title||a.value.productName)}catch(d){console.error("Error fetching lottery details:",d)}}),($,M)=>{const D=he("router-link");return s(),o("div",D7,[e("div",T7,[e("div",M7,[e("div",L7,[g(D,{to:"/"},{default:re(()=>[e("img",{src:l(Ye),alt:"Koumbaya",class:"h-12 mx-auto hover:opacity-80 transition-opacity"},null,8,V7)]),_:1})]),M[2]||(M[2]=e("h1",{class:"text-3xl font-bold text-gray-900"},"Méthode de paiement",-1)),M[3]||(M[3]=e("p",{class:"mt-2 text-gray-600"},"Choisissez votre mode de paiement préféré",-1))]),e("div",R7,[M[4]||(M[4]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Résumé de votre commande",-1)),e("div",F7,[e("img",{src:a.value.image||"/images/products/placeholder.jpg",alt:a.value.productName,class:"w-16 h-16 object-cover rounded-lg"},null,8,N7),e("div",z7,[e("h3",q7,t(a.value.productName),1),e("p",U7,[a.value.type==="ticket"?(s(),o("span",B7,t(a.value.quantity)+" ticket(s) • "+t(P(a.value.unitPrice))+"/ticket ",1)):(s(),o("span",O7," Achat direct • "+t(P(a.value.unitPrice)),1))])]),e("div",G7,[e("div",H7,t(P(a.value.totalAmount)),1),a.value.type==="ticket"?(s(),o("div",K7,t(a.value.quantity)+" x "+t(P(a.value.unitPrice)),1)):T("",!0)])])]),e("div",W7,[M[10]||(M[10]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-6"},"Sélectionnez votre méthode de paiement",-1)),e("div",J7,[e("div",X7,[e("h3",Y7,[g(l(et),{class:"h-5 w-5 text-blue-500"}),M[5]||(M[5]=z(" Mobile Money ",-1))]),e("div",Q7,[e("div",{onClick:M[0]||(M[0]=m=>c("airtel_money")),class:te(["p-4 border-2 rounded-lg cursor-pointer transition-all duration-200",p.value==="airtel_money"?"border-red-500 bg-red-50 ring-2 ring-red-200":"border-gray-200 hover:border-red-300 hover:bg-red-50"])},[e("div",Z7,[e("div",eC,[e("img",{src:l(Ht),alt:"Airtel Money",class:"w-10 h-10 object-contain"},null,8,tC)]),M[6]||(M[6]=e("div",{class:"flex-1"},[e("div",{class:"font-medium text-gray-900"},"Airtel Money"),e("div",{class:"text-sm text-gray-500"},"Paiement mobile")],-1)),e("div",sC,[e("div",{class:te(["w-4 h-4 rounded-full border-2",p.value==="airtel_money"?"border-red-500 bg-red-500":"border-gray-300"])},[p.value==="airtel_money"?(s(),o("div",oC)):T("",!0)],2)])])],2),e("div",{onClick:M[1]||(M[1]=m=>c("moov_money")),class:te(["p-4 border-2 rounded-lg cursor-pointer transition-all duration-200",p.value==="moov_money"?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-gray-200 hover:border-blue-300 hover:bg-blue-50"])},[e("div",rC,[e("div",aC,[e("img",{src:l(Kt),alt:"Moov Money",class:"w-10 h-10 object-contain"},null,8,nC)]),M[7]||(M[7]=e("div",{class:"flex-1"},[e("div",{class:"font-medium text-gray-900"},"Moov Money"),e("div",{class:"text-sm text-gray-500"},"Paiement mobile")],-1)),e("div",iC,[e("div",{class:te(["w-4 h-4 rounded-full border-2",p.value==="moov_money"?"border-blue-500 bg-blue-500":"border-gray-300"])},[p.value==="moov_money"?(s(),o("div",lC)):T("",!0)],2)])])],2)])])]),e("div",dC,[e("button",{onClick:n,class:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors"},[g(l(at),{class:"h-5 w-5"}),M[8]||(M[8]=z(" Retour ",-1))]),e("button",{onClick:r,disabled:!p.value||f.value,class:"bg-[#0099cc] hover:bg-[#0088bb] disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-semibold px-8 py-3 rounded-xl transition-all duration-200 flex items-center gap-2"},[f.value?(s(),o("span",cC,"Traitement...")):(s(),o(ie,{key:1},[M[9]||(M[9]=e("span",null,"Continuer",-1)),g(l(Ze),{class:"h-5 w-5"})],64))],8,uC)])]),e("div",mC,[e("div",pC,[g(l(ut),{class:"h-5 w-5 text-green-500"}),M[11]||(M[11]=z(" Paiement 100% sécurisé et chiffré ",-1))])])])])}}},fC={class:"min-h-screen bg-gray-50 py-8"},vC={class:"max-w-md mx-auto px-4 sm:px-6 lg:px-8"},xC={class:"text-center mb-8"},bC={class:"mb-6"},yC=["src"],hC={class:"w-20 h-20 mx-auto mb-4 rounded-lg overflow-hidden flex items-center justify-center bg-white border border-gray-200 shadow-sm"},_C=["src","alt"],wC={class:"text-2xl font-bold text-gray-900"},$C={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6 text-center"},kC={class:"text-3xl font-bold text-gray-900"},CC={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},AC=["placeholder"],PC={key:0,class:"mt-1 text-sm text-red-600"},EC={class:"mt-2 text-xs text-gray-500"},jC={class:"space-y-3"},SC=["disabled"],IC={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},DC={class:"flex items-start gap-3"},TC={__name:"PhoneInput",setup(_){const y=Be(),w=$e(),{post:p}=ge(),f=R("airtel_money"),a=R("airtel"),c=R(""),n=R(!1),r=R({}),P=R(0),$=R(null),M=de(()=>a.value&&c.value.length===9&&m()),D=d=>{let i=d.target.value.replace(/\D/g,"");i.length<=9&&(c.value=i),k()},m=()=>{const d=c.value;return a.value==="airtel"?d.startsWith("074")||d.startsWith("077")||d.startsWith("076"):a.value==="moov"?d.startsWith("065")||d.startsWith("062")||d.startsWith("066")||d.startsWith("060"):!1},k=()=>{r.value={};const d=c.value;if(!d)return r.value.phone="Le numéro de téléphone est requis",!1;if(d.length!==9)return r.value.phone="Le numéro doit contenir 9 chiffres",!1;if(!m()){const i=a.value==="airtel"?"074, 077 ou 076":"065, 062, 066 ou 060";return r.value.phone=`Le numéro doit commencer par ${i} pour ${a.value==="airtel"?"Airtel":"Moov"}`,!1}return!0},U=async()=>{if(!(!k()||!M.value)){if(!$.value){window.$toast&&window.$toast.error("Aucun numéro de commande fourni","❌ Erreur");return}n.value=!0;try{const d={phone:c.value,operator:a.value};y.query.order_number?d.order_number=$.value:y.query.transaction_id?d.transaction_id=$.value:d.order_number=$.value;const i=await p("/payments/initiate-from-transaction",d);i.success?w.push({name:"payment.confirmation",query:{bill_id:i.data.bill_id,reference:i.data.reference,amount:i.data.amount,phone:c.value,operator:a.value,transaction_id:i.data.transaction_id,type:y.query.type,order_number:i.data.order_number||y.query.order_number}}):i.error_code==="ORDER_EXPIRED"?(window.$toast&&window.$toast.error("Cette commande a expiré. Veuillez créer une nouvelle commande.","⏰ Commande expirée"),setTimeout(()=>{w.push("/")},2e3)):window.$toast&&window.$toast.error(i.message||"Erreur lors de l'initiation du paiement","❌ Erreur")}catch(d){console.error("Payment initiation error:",d),window.$toast&&window.$toast.error("Erreur lors de l'initiation du paiement","❌ Erreur")}finally{n.value=!1}}},V=()=>{w.back()},v=d=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(d).replace("XAF","FCFA");return ve(()=>{if(f.value=y.query.method||"airtel_money",P.value=parseFloat(y.query.amount)||0,$.value=y.query.order_number||y.query.transaction_id,f.value==="airtel_money"?a.value="airtel":f.value==="moov_money"&&(a.value="moov"),!$.value){window.$toast&&window.$toast.error("Paramètres de paiement manquants","❌ Erreur"),w.push("/");return}if(!P.value||P.value<=0){window.$toast&&window.$toast.error("Montant invalide","❌ Erreur"),w.push("/");return}}),(d,i)=>{const C=he("router-link");return s(),o("div",fC,[e("div",vC,[e("div",xC,[e("div",bC,[g(C,{to:"/"},{default:re(()=>[e("img",{src:l(Ye),alt:"Koumbaya",class:"h-12 mx-auto hover:opacity-80 transition-opacity"},null,8,yC)]),_:1})]),e("div",hC,[e("img",{src:f.value==="airtel_money"?l(Ht):l(Kt),alt:f.value==="airtel_money"?"Airtel Money":"Moov Money",class:"w-16 h-16 object-contain"},null,8,_C)]),e("h1",wC,t(f.value==="airtel_money"?"Airtel Money":"Moov Money"),1),i[1]||(i[1]=e("p",{class:"mt-2 text-gray-600"},"Saisissez votre numéro de téléphone",-1))]),e("div",$C,[i[2]||(i[2]=e("div",{class:"text-sm text-gray-500 mb-1"},"Montant à payer",-1)),e("div",kC,t(v(P.value)),1)]),e("div",CC,[e("form",{onSubmit:_e(U,["prevent"]),class:"space-y-6"},[e("div",null,[i[3]||(i[3]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Numéro de téléphone ",-1)),Q(e("input",{"onUpdate:modelValue":i[0]||(i[0]=x=>c.value=x),type:"tel",placeholder:a.value==="airtel"?"074010203":"065010203",maxlength:"9",class:te(["w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:border-transparent",a.value==="airtel"?"focus:ring-red-500":"focus:ring-blue-500",r.value.phone?"border-red-300":""]),onInput:D},null,42,AC),[[ne,c.value]]),r.value.phone?(s(),o("div",PC,t(r.value.phone),1)):T("",!0),e("div",EC," Format: "+t(a.value==="airtel"?"074010203 (074, 077, 076 pour Airtel)":"065010203 (065, 062, 066, 060 pour Moov)"),1)]),e("div",jC,[e("button",{type:"submit",disabled:!M.value||n.value,class:te(["w-full py-3 px-4 rounded-lg font-semibold transition-all duration-200 flex items-center justify-center",a.value==="airtel"?"bg-red-600 hover:bg-red-700 disabled:bg-red-300":"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300","text-white disabled:cursor-not-allowed"])},[n.value?(s(),o(ie,{key:0},[i[4]||(i[4]=e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"},null,-1)),i[5]||(i[5]=e("span",null,"Traitement...",-1))],64)):(s(),o(ie,{key:1},[e("span",null,"Payer "+t(v(P.value)),1),g(l(Ze),{class:"h-5 w-5"})],64))],10,SC),e("button",{type:"button",onClick:V,class:"w-full py-3 px-4 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition-colors"}," Retour ")])],32)]),e("div",IC,[e("div",DC,[g(l(Oe),{class:"h-5 w-5 text-blue-500 mt-0.5 flex-shrink-0"}),i[6]||(i[6]=e("div",{class:"text-sm text-blue-700"},[e("p",{class:"font-medium mb-1"},"Instructions de paiement :"),e("ul",{class:"space-y-1 text-xs"},[e("li",null,"• Assurez-vous d'avoir suffisamment de crédit"),e("li",null,"• Gardez votre téléphone près de vous"),e("li",null,"• Vous recevrez un code de confirmation USSD")])],-1))])])])])}}},MC={class:"min-h-screen bg-gray-50 py-8"},LC={class:"max-w-md mx-auto px-4 sm:px-6 lg:px-8"},VC={class:"text-center mb-8"},RC={class:"mb-6"},FC=["src"],NC={class:"text-2xl font-bold text-gray-900 mb-2"},zC={class:"text-gray-600"},qC={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},UC={class:"text-center"},BC={class:"w-full bg-gray-200 rounded-full h-2 mb-4"},OC={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},GC={class:"space-y-3"},HC={class:"flex justify-between"},KC={class:"font-semibold text-gray-900"},WC={class:"flex justify-between"},JC={class:"font-semibold text-gray-900"},XC={class:"flex justify-between"},YC={class:"font-semibold text-gray-900"},QC={class:"flex justify-between"},ZC={class:"font-semibold text-gray-900 font-mono text-sm"},eA={class:"flex justify-between text-lg"},tA={class:"font-bold text-gray-900"},sA={key:1,class:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},oA={class:"flex items-start gap-3"},rA={class:"text-sm text-blue-700"},aA={class:"space-y-1 text-xs"},nA={key:2,class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6"},iA={class:"flex items-start gap-3"},lA={class:"text-sm text-red-700"},dA={class:"text-xs"},uA={key:3,class:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6"},cA={class:"flex items-start gap-3"},mA={key:4,class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6"},pA={class:"flex items-start gap-3"},gA={class:"space-y-3"},fA=["disabled"],vA={key:0,class:"flex items-center gap-2"},xA={key:1,class:"flex items-center gap-2"},bA={__name:"PaymentConfirmation",setup(_){const y=Be(),w=$e(),{get:p,post:f}=ge(),a=R("pending"),c=R(90),n=R(!1),r=R(""),P=R(null),$=R(null),M=R(""),D=R(""),m=R(0),k=R(""),U=R(""),V=R(""),v=R(""),d=()=>{switch(a.value){case"pending":return{bg:"bg-blue-100",icon:"text-blue-600"};case"success":return{bg:"bg-green-100",icon:"text-green-600"};case"failed":return{bg:"bg-red-100",icon:"text-red-600"};case"expired":return{bg:"bg-orange-100",icon:"text-orange-600"};default:return{bg:"bg-gray-100",icon:"text-gray-600"}}},i=()=>{switch(a.value){case"pending":return Te;case"success":return Re;case"failed":case"expired":return We;default:return Te}},C=()=>{switch(a.value){case"pending":return"Paiement en cours...";case"success":return"Paiement réussi !";case"failed":return"Paiement échoué";case"expired":return"Paiement expiré";default:return"Traitement..."}},x=()=>{switch(a.value){case"pending":return"Confirmez le paiement sur votre téléphone";case"success":return"Votre paiement a été traité avec succès";case"failed":return"Une erreur est survenue lors du paiement";case"expired":return"Le délai de paiement a expiré";default:return"Veuillez patienter..."}},I=S=>{const E=Math.floor(S/60),F=S%60;return`${E}:${F.toString().padStart(2,"0")}`},N=S=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"XAF",minimumFractionDigits:0}).format(S).replace("XAF","FCFA"),u=()=>{P.value=setInterval(()=>{c.value>0?c.value--:(a.value="expired",clearInterval(P.value),clearInterval($.value))},1e3)},A=async()=>{if(M.value){n.value=!0;try{const S=await p(`/payments/status/${M.value}`);if(S.success){const E=S.data.status;E==="paid"?(a.value="success",clearInterval(P.value),clearInterval($.value),window.$toast&&window.$toast.success("Paiement confirmé avec succès !","✅ Succès")):E==="failed"&&(a.value="failed",r.value=S.data.error_message||"",clearInterval(P.value),clearInterval($.value))}}catch(S){console.error("Error checking payment status:",S)}finally{n.value=!1}}},H=()=>{$.value=setInterval(()=>{a.value==="pending"&&A()},5e3)},j=async()=>{if(!(!M.value||!U.value)){n.value=!0;try{const S=await f("/payments/retry-ussd",{bill_id:M.value,operator:U.value});S.success?(a.value="pending",c.value=90,u(),H(),window.$toast&&window.$toast.success("Push USSD relancé avec succès !","✅ Succès")):window.$toast&&window.$toast.error(S.message||"Erreur lors du relancement du push USSD","❌ Erreur")}catch(S){console.error("Error retrying USSD push:",S),window.$toast&&window.$toast.error("Erreur lors du relancement du push USSD","❌ Erreur")}finally{n.value=!1}}},h=()=>{w.push({name:"payment.phone",query:y.query})},b=()=>{V.value==="ticket"||V.value==="lottery"?w.push({name:"customer.tickets"}):V.value==="product"&&v.value?w.push({name:"customer.order-detail",params:{orderNumber:v.value}}):V.value==="product"?w.push({name:"customer.orders"}):w.push({name:"customer.dashboard"})},ee=()=>{w.push("/")},B=()=>V.value==="ticket"||V.value==="lottery"?"Voir mes tickets":V.value==="product"?v.value?"Voir ma commande":"Voir mes commandes":"Voir mes achats";return ve(()=>{if(M.value=y.query.bill_id||"",D.value=y.query.reference||"",m.value=parseFloat(y.query.amount)||0,k.value=y.query.phone||"",U.value=y.query.operator||"",V.value=y.query.type||"",v.value=y.query.order_number||"",!M.value||!m.value){w.push("/");return}u(),H(),A()}),st(()=>{P.value&&clearInterval(P.value),$.value&&clearInterval($.value)}),(S,E)=>{const F=he("router-link");return s(),o("div",MC,[e("div",LC,[e("div",VC,[e("div",RC,[g(F,{to:"/"},{default:re(()=>[e("img",{src:l(Ye),alt:"Koumbaya",class:"h-12 mx-auto hover:opacity-80 transition-opacity"},null,8,FC)]),_:1})]),e("div",{class:te(["w-20 h-20 mx-auto mb-4 rounded-full flex items-center justify-center",d().bg])},[(s(),ce(Ie(i()),{class:te(["h-10 w-10",d().icon])},null,8,["class"]))],2),e("h1",NC,t(C()),1),e("p",zC,t(x()),1)]),a.value==="pending"?(s(),o("div",qC,[e("div",UC,[e("div",{class:te(["text-4xl font-bold mb-2",c.value<=30?"text-red-600":"text-blue-600"])},t(I(c.value)),3),E[0]||(E[0]=e("div",{class:"text-sm text-gray-500 mb-4"}," Temps restant pour confirmer le paiement ",-1)),e("div",BC,[e("div",{class:te(["h-2 rounded-full transition-all duration-1000",c.value<=30?"bg-red-500":"bg-blue-500"]),style:Me({width:c.value/90*100+"%"})},null,6)]),E[1]||(E[1]=e("div",{class:"text-xs text-gray-400"}," Le paiement expirera automatiquement à la fin du timer ",-1))])])):T("",!0),e("div",OC,[E[8]||(E[8]=e("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Détails du paiement",-1)),e("div",GC,[e("div",HC,[E[2]||(E[2]=e("span",{class:"text-gray-600"},"Montant",-1)),e("span",KC,t(N(m.value)),1)]),e("div",WC,[E[3]||(E[3]=e("span",{class:"text-gray-600"},"Opérateur",-1)),e("span",JC,t(U.value==="airtel"?"Airtel Money":"Moov Money"),1)]),e("div",XC,[E[4]||(E[4]=e("span",{class:"text-gray-600"},"Téléphone",-1)),e("span",YC,"+241 "+t(k.value),1)]),e("div",QC,[E[5]||(E[5]=e("span",{class:"text-gray-600"},"Référence",-1)),e("span",ZC,t(D.value),1)]),E[7]||(E[7]=e("hr",{class:"my-3"},null,-1)),e("div",eA,[E[6]||(E[6]=e("span",{class:"font-semibold text-gray-900"},"Total",-1)),e("span",tA,t(N(m.value)),1)])])]),a.value==="pending"?(s(),o("div",sA,[e("div",oA,[g(l(Oe),{class:"h-5 w-5 text-blue-500 mt-0.5 flex-shrink-0"}),e("div",rA,[E[13]||(E[13]=e("p",{class:"font-medium mb-2"},"Instructions importantes :",-1)),E[14]||(E[14]=e("div",{class:"bg-white rounded-lg p-3 mb-3 border border-blue-200"},[e("p",{class:"font-semibold text-blue-800 text-sm"},"📱 Gardez votre téléphone à portée de main"),e("p",{class:"text-xs text-blue-600 mt-1"},"Vous devez valider la transaction avec votre code PIN secret")],-1)),e("ol",aA,[E[9]||(E[9]=e("li",null,"1. Vous allez recevoir un code USSD sur votre téléphone",-1)),E[10]||(E[10]=e("li",null,"2. Composez le code reçu sur votre clavier",-1)),e("li",null,"3. Suivez les instructions de "+t(U.value==="airtel"?"Airtel Money":"Moov Money"),1),E[11]||(E[11]=e("li",null,"4. Confirmez le paiement avec votre code PIN secret",-1)),E[12]||(E[12]=e("li",null,"5. Le paiement sera confirmé automatiquement",-1))])])])])):a.value==="failed"?(s(),o("div",nA,[e("div",iA,[g(l(We),{class:"h-5 w-5 text-red-500 mt-0.5 flex-shrink-0"}),e("div",lA,[E[15]||(E[15]=e("p",{class:"font-medium mb-2"},"Le paiement a échoué",-1)),e("p",dA,t(r.value||"Veuillez réessayer ou vérifier votre solde."),1)])])])):a.value==="expired"?(s(),o("div",uA,[e("div",cA,[g(l(Te),{class:"h-5 w-5 text-orange-500 mt-0.5 flex-shrink-0"}),E[16]||(E[16]=e("div",{class:"text-sm text-orange-700"},[e("p",{class:"font-medium mb-2"},"Paiement expiré"),e("p",{class:"text-xs"},"Le délai de 90 secondes est écoulé. Veuillez recommencer le processus.")],-1))])])):a.value==="success"?(s(),o("div",mA,[e("div",pA,[g(l(Re),{class:"h-5 w-5 text-green-500 mt-0.5 flex-shrink-0"}),E[17]||(E[17]=e("div",{class:"text-sm text-green-700"},[e("p",{class:"font-medium mb-2"},"Paiement confirmé !"),e("p",{class:"text-xs"},"Votre commande a été traitée avec succès. Vous allez recevoir une confirmation par email.")],-1))])])):T("",!0),e("div",gA,[a.value==="success"?(s(),o("button",{key:0,onClick:b,class:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg transition-all duration-200 flex items-center justify-center gap-2"},[g(l(ze),{class:"h-5 w-5"}),z(" "+t(B()),1)])):T("",!0),a.value==="expired"?(s(),o("button",{key:1,onClick:j,disabled:n.value,class:"w-full py-3 px-4 bg-orange-600 hover:bg-orange-700 disabled:bg-orange-300 text-white font-semibold rounded-lg transition-all duration-200 btn-responsive btn-wrap-mobile"},[n.value?(s(),o("span",vA,E[18]||(E[18]=[e("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-white flex-shrink-0"},null,-1),z(" Relance... ",-1)]))):(s(),o("span",xA,[g(l(Fe),{class:"h-5 w-5 flex-shrink-0"}),E[19]||(E[19]=z(" Relancer le push USSD ",-1))]))],8,fA)):T("",!0),a.value==="failed"?(s(),o("button",{key:2,onClick:h,class:"w-full py-3 px-4 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg transition-all duration-200 flex items-center justify-center gap-2"},[g(l(Fe),{class:"h-5 w-5"}),E[20]||(E[20]=z(" Réessayer le paiement ",-1))])):T("",!0),e("button",{onClick:ee,class:"w-full py-3 px-4 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition-colors"}," Retour à l'accueil ")])])])}}};function yA(){const{get:_,loading:y,error:w}=ge(),p=R({users:{total:0,active:0,growth:0},products:{total:0,active:0,growth:0},lotteries:{total:0,active:0,growth:0},revenue:{total:0,monthly:0,growth:0}}),f=R([]),a=R([]),c=R([]),n=de(()=>[{label:"Utilisateurs actifs",value:D(p.value.users.active),change:p.value.users.growth,icon:"UsersIcon",bgColor:"bg-[#0099cc]/10",iconColor:"text-[#0099cc]"},{label:"Produits en vente",value:D(p.value.products.active),change:p.value.products.growth,icon:"ShoppingBagIcon",bgColor:"bg-blue-100",iconColor:"text-blue-600"},{label:"Tombolas actives",value:D(p.value.lotteries.active),change:p.value.lotteries.growth,icon:"GiftIcon",bgColor:"bg-yellow-100",iconColor:"text-yellow-600"},{label:"Revenus mensuel",value:m(p.value.revenue.monthly),change:p.value.revenue.growth,icon:"CurrencyDollarIcon",bgColor:"bg-purple-100",iconColor:"text-purple-600"}]),r=async()=>{try{const v=await _("/admin/dashboard/stats");v&&v.success&&(p.value={users:{total:v.data.users?.total||0,active:v.data.users?.active||0,growth:v.data.users?.growth||0},products:{total:v.data.products?.total||0,active:v.data.products?.active||0,growth:v.data.products?.growth||0},lotteries:{total:v.data.lotteries?.total||0,active:v.data.lotteries?.active||0,growth:v.data.lotteries?.growth||0},revenue:{total:v.data.revenue?.total||0,monthly:v.data.revenue?.monthly||0,growth:v.data.revenue?.growth||0}})}catch(v){console.error("Erreur lors du chargement des statistiques:",v),p.value={users:{total:2543,active:1876,growth:12.5},products:{total:186,active:134,growth:8.2},lotteries:{total:45,active:24,growth:-2.1},revenue:{total:125e6,monthly:452e5,growth:15.3}}}},P=async()=>{try{const v=await _("/admin/lotteries/recent?limit=5");v&&v.success&&(f.value=v.data.map(d=>({id:d.id,lottery_number:d.lottery_number,product:{name:d.product?.name||"Produit inconnu",image:d.product?.image_url||d.product?.main_image||"/images/products/placeholder.jpg"},status:d.status,statusLabel:k(d.status),sold_tickets:d.sold_tickets||0,total_tickets:d.total_tickets||0,end_date:d.end_date})))}catch(v){console.error("Erreur lors du chargement des tombolas récentes:",v),f.value=[]}},$=async()=>{try{const v=await _("/admin/activities/recent?limit=10");v&&v.success&&(a.value=v.data.map(d=>({id:d.id,type:d.type,icon:U(d.type),title:d.title,description:d.description,time:new Date(d.created_at)})))}catch(v){console.error("Erreur lors du chargement des activités récentes:",v),a.value=[]}},M=async()=>{try{const v=await _("/admin/products/top?limit=5");v&&v.success&&(c.value=v.data.map(d=>({id:d.id,title:d.name,sales:d.total_tickets_sold||0,growth:d.growth_percentage||0,image:d.image_url||d.main_image||"/images/products/placeholder.jpg"})))}catch(v){console.error("Erreur lors du chargement des produits populaires:",v),c.value=[]}},D=v=>v>=1e6?(v/1e6).toFixed(1)+"M":v>=1e3?(v/1e3).toFixed(1)+"k":v.toLocaleString(),m=v=>v>=1e6?(v/1e6).toFixed(1)+"M FCFA":v>=1e3?(v/1e3).toFixed(0)+"k FCFA":v.toLocaleString()+" FCFA",k=v=>({active:"Active",completed:"Terminée",pending:"En attente",cancelled:"Annulée",draft:"Brouillon"})[v]||v,U=v=>({user:"UsersIcon",product:"ShoppingBagIcon",payment:"CurrencyDollarIcon",lottery:"GiftIcon",transaction:"BanknotesIcon"})[v]||"InformationCircleIcon";return{stats:n,recentLotteries:f,recentActivities:a,topProducts:c,loading:y,error:w,loadDashboardData:async()=>{await Promise.all([r(),P(),$(),M()])},loadDashboardStats:r,loadRecentLotteries:P,loadRecentActivities:$,loadTopProducts:M,formatNumber:D,formatCurrency:m,getStatusLabel:k,getActivityIcon:U}}const hA={class:"space-y-6"},_A={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},wA={class:"flex items-center"},$A={class:"ml-4"},kA={class:"text-sm font-medium text-gray-600"},CA={class:"text-2xl font-bold text-gray-900"},AA={class:"mt-4 pt-4 border-t border-gray-100"},PA={class:"flex items-center text-sm"},EA={key:0,class:"mb-6 bg-red-50 border border-red-200 rounded-lg p-4"},jA={class:"flex"},SA={class:"ml-3"},IA={class:"mt-1 text-sm text-red-700"},DA={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},TA={class:"lg:col-span-2 space-y-6"},MA={class:"admin-card"},LA={class:"h-64 flex items-center justify-center bg-gray-50 rounded-lg"},VA={class:"text-center"},RA={class:"admin-card"},FA={class:"overflow-x-auto"},NA={class:"min-w-full"},zA={class:"bg-white divide-y divide-gray-200"},qA={class:"px-6 py-4 whitespace-nowrap"},UA={class:"flex items-center"},BA={class:"ml-4"},OA={class:"text-sm font-medium text-gray-900"},GA={class:"text-sm text-gray-500"},HA={class:"px-6 py-4 whitespace-nowrap"},KA={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},WA={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},JA={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},XA=["onClick"],YA={class:"space-y-6"},QA={class:"admin-card"},ZA={key:0,class:"space-y-4"},eP={key:1,class:"space-y-4"},tP={class:"flex-1 min-w-0"},sP={class:"text-sm font-medium text-gray-900"},oP={class:"text-sm text-gray-600"},rP={class:"text-xs text-gray-500 mt-1"},aP={key:2,class:"text-center py-6 text-gray-500"},nP={class:"admin-card"},iP={class:"space-y-4"},lP={class:"flex-shrink-0"},dP={class:"inline-flex items-center justify-center w-6 h-6 text-sm font-bold text-gray-600"},uP={class:"flex-1 min-w-0"},cP={class:"text-sm font-medium text-gray-900 truncate"},mP={class:"flex items-center space-x-2 mt-1"},pP={class:"text-xs text-gray-500"},gP={class:"admin-card"},fP={class:"space-y-3"},vP={__name:"Dashboard",setup(_){const y=$e();ge();const{stats:w,recentLotteries:p,recentActivities:f,topProducts:a,loading:c,error:n,loadDashboardData:r}=yA(),P={UsersIcon:vt,ShoppingBagIcon:qe,GiftIcon:ot,CurrencyDollarIcon:Ke,BanknotesIcon:Ge,InformationCircleIcon:Oe},$=de(()=>w.value.map(C=>({...C,icon:P[C.icon]||Oe}))),M=de(()=>f.value.map(C=>({...C,icon:P[C.icon]||Oe}))),D=C=>new Date(C).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}),m=C=>{const I=Math.floor((new Date-C)/1e3);return I<60?`il y a ${I}s`:I<3600?`il y a ${Math.floor(I/60)}min`:I<86400?`il y a ${Math.floor(I/3600)}h`:`il y a ${Math.floor(I/86400)}j`},k=async()=>{await r()},U=()=>{y.push("/admin/users")},V=()=>{y.push("/admin/lotteries")},v=()=>{window.$toast&&window.$toast.info("Fonctionnalité des activités détaillées en cours de développement","ℹ️ Information")},d=C=>{window.$toast&&window.$toast.info(`Affichage des détails de la tombola ${C.lottery_number}`,"👁️ Détails")},i=async()=>{try{window.$toast&&window.$toast.info("Génération du rapport en cours...","📊 Rapport"),await new Promise(C=>setTimeout(C,2e3)),window.$toast&&window.$toast.success("Rapport généré avec succès!","✅ Rapport")}catch{window.$toast&&window.$toast.error("Erreur lors de la génération du rapport","❌ Erreur")}};return ve(async()=>{await r()}),(C,x)=>(s(),o("div",hA,[x[15]||(x[15]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900"},"Tableau de bord"),e("p",{class:"mt-2 text-gray-600"},"Vue d'ensemble des activités de la plateforme Koumbaya")],-1)),e("div",_A,[l(c)?(s(),o(ie,{key:0},le(4,I=>e("div",{key:I,class:"admin-card animate-pulse"},x[0]||(x[0]=[pe('<div class="flex items-center"><div class="p-3 rounded-lg bg-gray-200"></div><div class="ml-4 flex-1"><div class="h-4 bg-gray-200 rounded w-20 mb-2"></div><div class="h-6 bg-gray-200 rounded w-16"></div></div></div><div class="mt-4 pt-4 border-t border-gray-100"><div class="h-4 bg-gray-200 rounded w-24"></div></div>',2)]))),64)):(s(!0),o(ie,{key:1},le($.value,I=>(s(),o("div",{key:I.label,class:"admin-card hover:shadow-md transition-shadow duration-200"},[e("div",wA,[e("div",{class:te(["p-3 rounded-lg",I.bgColor])},[(s(),ce(Ie(I.icon),{class:te(["w-6 h-6",I.iconColor])},null,8,["class"]))],2),e("div",$A,[e("p",kA,t(I.label),1),e("p",CA,t(I.value),1)])]),e("div",AA,[e("div",PA,[e("span",{class:te(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",I.change>=0?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"])},[(s(),ce(Ie(I.change>=0?l(ps):l(gs)),{class:"w-3 h-3 mr-1"})),z(" "+t(Math.abs(I.change))+"% ",1)],2),x[1]||(x[1]=e("span",{class:"ml-2 text-gray-500"},"vs mois dernier",-1))])])]))),128))]),l(n)&&!l(c)?(s(),o("div",EA,[e("div",jA,[e("div",SA,[x[2]||(x[2]=e("h3",{class:"text-sm font-medium text-red-800"},"Erreur de chargement",-1)),e("p",IA,t(l(n)),1),e("button",{onClick:k,class:"mt-2 text-sm bg-red-100 hover:bg-red-200 text-red-800 px-3 py-1 rounded"}," Réessayer ")])])])):T("",!0),e("div",DA,[e("div",TA,[e("div",MA,[x[5]||(x[5]=pe('<div class="admin-card-header"><div class="flex items-center justify-between"><h3 class="text-lg font-semibold text-gray-900">Revenus mensuels</h3><div class="flex items-center space-x-2"><button class="text-sm text-gray-500 hover:text-gray-700 px-3 py-1 rounded-md hover:bg-gray-100">30j</button><button class="text-sm bg-[#0099cc]/10 text-[#0099cc] px-3 py-1 rounded-md">90j</button><button class="text-sm text-gray-500 hover:text-gray-700 px-3 py-1 rounded-md hover:bg-gray-100">1an</button></div></div></div>',1)),e("div",LA,[e("div",VA,[g(l(Ct),{class:"w-12 h-12 text-gray-400 mx-auto mb-2"}),x[3]||(x[3]=e("p",{class:"text-gray-500"},"Graphique des revenus",-1)),x[4]||(x[4]=e("p",{class:"text-xs text-gray-400"},"Données en cours de chargement...",-1))])])]),e("div",RA,[x[7]||(x[7]=e("div",{class:"admin-card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Tombolas récentes")],-1)),e("div",FA,[e("table",NA,[x[6]||(x[6]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Produit"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Statut"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Tickets"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date de fin"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",zA,[(s(!0),o(ie,null,le(l(p),I=>(s(),o("tr",{key:I.id,class:"hover:bg-gray-50"},[e("td",qA,[e("div",UA,[g(He,{src:I.product.image_url||I.product.main_image||I.product.image,alt:I.product.name,"container-class":"h-10 w-10 rounded-lg","image-class":"h-full w-full object-cover rounded-lg","fallback-class":"h-full w-full rounded-lg"},null,8,["src","alt"]),e("div",BA,[e("div",OA,t(I.product.name),1),e("div",GA,t(I.lottery_number),1)])])]),e("td",HA,[e("span",{class:te(["inline-flex px-2 py-1 text-xs font-medium rounded-full",I.status==="active"?"admin-badge-success":I.status==="completed"?"bg-gray-100 text-gray-800":"admin-badge-warning"])},t(I.statusLabel),3)]),e("td",KA,t(I.sold_tickets)+"/"+t(I.total_tickets),1),e("td",WA,t(D(I.end_date)),1),e("td",JA,[e("button",{onClick:N=>d(I),class:"text-[#0099cc] hover:text-[#0088bb] mr-3"}," Voir ",8,XA),I.status==="active"?(s(),o("button",{key:0,onClick:V,class:"text-orange-600 hover:text-orange-900"}," Modifier ")):T("",!0)])]))),128))])])])])]),e("div",YA,[e("div",QA,[x[10]||(x[10]=e("div",{class:"admin-card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Activités récentes")],-1)),l(c)?(s(),o("div",ZA,[(s(),o(ie,null,le(4,I=>e("div",{key:I,class:"flex items-start space-x-3 p-3 animate-pulse"},x[8]||(x[8]=[pe('<div class="w-8 h-8 bg-gray-200 rounded-full flex-shrink-0"></div><div class="flex-1 min-w-0 space-y-2"><div class="h-4 bg-gray-200 rounded w-32"></div><div class="h-3 bg-gray-200 rounded w-48"></div><div class="h-3 bg-gray-200 rounded w-16"></div></div>',2)]))),64))])):M.value.length>0?(s(),o("div",eP,[(s(!0),o(ie,null,le(M.value,I=>(s(),o("div",{key:I.id,class:"flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg transition-colors"},[e("div",{class:te(["w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0",I.type==="user"?"bg-[#0099cc]/10 text-[#0099cc]":I.type==="product"?"bg-blue-100 text-blue-600":I.type==="payment"?"bg-yellow-100 text-yellow-600":"bg-purple-100 text-purple-600"])},[(s(),ce(Ie(I.icon),{class:"w-4 h-4"}))],2),e("div",tP,[e("p",sP,t(I.title),1),e("p",oP,t(I.description),1),e("p",rP,t(m(I.time)),1)])]))),128))])):(s(),o("div",aP,[g(l(Oe),{class:"w-8 h-8 mx-auto mb-2 text-gray-400"}),x[9]||(x[9]=e("p",{class:"text-sm"},"Aucune activité récente",-1))])),e("div",{class:"mt-4 pt-4 border-t border-gray-100"},[e("button",{onClick:v,class:"admin-btn-secondary w-full text-sm"}," Voir toutes les activités ")])]),e("div",nP,[x[11]||(x[11]=e("div",{class:"admin-card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Produits populaires")],-1)),e("div",iP,[(s(!0),o(ie,null,le(l(a),(I,N)=>(s(),o("div",{key:I.id,class:"flex items-center space-x-3"},[e("div",lP,[e("span",dP,t(N+1),1)]),g(He,{src:I.image_url||I.main_image||I.image,alt:I.title,"container-class":"w-10 h-10 rounded-lg flex-shrink-0","image-class":"w-full h-full object-cover rounded-lg","fallback-class":"w-full h-full rounded-lg"},null,8,["src","alt"]),e("div",uP,[e("p",cP,t(I.title),1),e("div",mP,[e("p",pP,t(I.sales)+" tickets",1),e("span",{class:te(["text-xs font-medium",I.growth>0?"text-blue-600":"text-red-600"])},t(I.growth>0?"+":"")+t(I.growth)+"% ",3)])])]))),128))])]),e("div",gP,[x[14]||(x[14]=e("div",{class:"admin-card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Actions rapides")],-1)),e("div",fP,[e("button",{onClick:U,class:"admin-btn-primary w-full justify-center"},[g(l(us),{class:"w-4 h-4 mr-2"}),x[12]||(x[12]=z(" Gérer les utilisateurs ",-1))]),e("button",{onClick:i,class:"admin-btn-secondary w-full justify-center"},[g(l(ms),{class:"w-4 h-4 mr-2"}),x[13]||(x[13]=z(" Générer rapport ",-1))])])])])])]))}},xP={class:"px-6"},bP={class:"mb-8"},yP={class:"flex justify-between items-center"},hP={class:"flex gap-3"},_P={class:"bg-white p-4 rounded-lg shadow-sm border border-gray-200 mb-6"},wP={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},$P=["value"],kP={class:"bg-white rounded-lg shadow-sm border border-gray-200"},CP={class:"px-6 py-4 border-b border-gray-200"},AP={class:"flex justify-between items-center"},PP={class:"text-lg font-semibold text-gray-900"},EP={class:"flex space-x-2"},jP={class:"p-2 text-gray-400 hover:text-gray-600"},SP={key:0,class:"p-8 text-center"},IP={key:1,class:"overflow-x-auto"},DP={class:"min-w-full divide-y divide-gray-200"},TP={class:"bg-white divide-y divide-gray-200"},MP={class:"px-6 py-4 whitespace-nowrap"},LP={class:"flex items-center"},VP={class:"w-10 h-10 bg-gray-300 rounded-full flex items-center justify-center"},RP={class:"text-sm font-medium text-gray-700"},FP={class:"ml-4"},NP={class:"text-sm font-medium text-gray-900"},zP={key:0,class:"text-sm text-gray-500"},qP={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},UP={class:"px-6 py-4 whitespace-nowrap"},BP={class:"px-6 py-4 whitespace-nowrap"},OP={class:"flex items-center space-x-2"},GP={key:0,class:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800"},HP={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},KP={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},WP={class:"flex space-x-2"},JP=["onClick"],XP={key:1,class:"text-gray-400 cursor-not-allowed"},YP=["onClick"],QP={key:3,class:"text-gray-400 cursor-not-allowed"},ZP={class:"px-6 py-3 border-t border-gray-200"},eE={class:"flex items-center justify-between"},tE={class:"text-sm text-gray-700"},sE={class:"flex space-x-2"},oE=["disabled"],rE=["disabled"],aE={key:0,class:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4"},nE={class:"bg-white rounded-lg w-full max-w-2xl shadow-xl"},iE={class:"flex items-center justify-between p-6 border-b"},lE={class:"text-xl font-semibold text-gray-900"},dE={class:"grid grid-cols-2 gap-4"},uE=["value"],cE={class:"mt-1 text-sm text-gray-500"},mE={class:"flex items-center"},pE={key:0,class:"bg-red-50 border border-red-200 rounded-md p-4"},gE={class:"text-sm text-red-800"},fE={class:"flex justify-end gap-3 px-6 py-4 bg-gray-50 rounded-b-lg"},vE=["disabled"],xE={key:0},bE={key:1,class:"flex items-center"},yE={key:1,class:"fixed inset-0 bg-black/40 z-50 flex items-center justify-center p-4"},hE={class:"bg-white rounded-lg w-full max-w-2xl shadow-xl"},_E={class:"flex items-center justify-between p-6 border-b"},wE={class:"border-b border-gray-200 pb-4"},$E={class:"grid grid-cols-2 gap-4 mb-4"},kE={class:"grid grid-cols-2 gap-4 mb-4"},CE={key:0,class:"grid grid-cols-2 gap-4 mb-4"},AE={key:1,class:"grid grid-cols-2 gap-4"},PE={key:0,class:"border-b border-gray-200 pb-4"},EE={class:"mb-4"},jE={class:"mb-4"},SE={key:1,class:"border-b border-gray-200 pb-4"},IE={key:0,class:"mb-4"},DE=["value"],TE={class:"mb-4"},ME={class:"flex items-center"},LE={key:1},VE={class:"space-y-2"},RE={class:"flex items-center"},FE={class:"flex items-center"},NE={class:"flex items-center"},zE={key:2,class:"bg-red-50 border border-red-200 rounded-md p-4"},qE={class:"text-sm text-red-800"},UE={class:"flex justify-end gap-3 px-6 py-4 bg-gray-50 rounded-b-lg"},BE=["disabled"],OE={key:0},GE={key:1,class:"flex items-center"},HE={__name:"UserManagement",setup(_){const{get:y,post:w}=ge(),p=Pe(),f=de(()=>p.hasRole("Super Admin")),a=de(()=>p.hasRole("Super Admin")||p.hasRole("Admin")),c=ae=>{if(!p.user)return!1;if(p.hasRole("Super Admin"))return!0;if(p.hasRole("Admin")){const oe=ae.primary_role;return!["Super Admin","Admin"].includes(oe)}return!1},n=ae=>{const X=p.user;if(!X||ae.id===X.id)return!1;if(p.hasRole("Super Admin"))return!0;if(p.hasRole("Admin")){const oe=ae.primary_role;return!["Super Admin","Admin"].includes(oe)}return!1},r=ae=>["Super Admin","Admin","Agent","Agent Back Office"].includes(ae.primary_role),P=R([]),$=R(!1),M=R(!1),D=R(!1),m=R(1),k=R(20),U=R(0),V=R([]),v=R([]),d=R(!1),i=R(!1),C=R(""),x=R(""),I=R(null),N=xe({search:"",role:"",status:""}),u=xe({first_name:"",last_name:"",email:"",phone:"",role:"",is_active:!0}),A=xe({id:null,first_name:"",last_name:"",email:"",phone:"",role:"",is_active:!0,business_name:"",business_email:"",business_description:"",city:"",address:"",date_of_birth:"",gender:"",bio:"",country_id:null,language_id:null,email_notifications:!0,sms_notifications:!0,push_notifications:!0});De(()=>N,()=>{m.value=1,b()},{deep:!0});const H=de(()=>P.value),j=de(()=>P.value),h=de(()=>Math.ceil(U.value/k.value)),b=async()=>{$.value=!0;try{const ae=new URLSearchParams;ae.append("page",m.value),ae.append("per_page",k.value),N.search&&ae.append("search",N.search),N.role&&ae.append("role",N.role),N.status&&ae.append("status",N.status);const X=await y(`/admin/users?${ae.toString()}`);X&&X.data&&(P.value=X.data.users||[],U.value=X.data.pagination?.total||0,V.value=X.data.available_roles||[])}catch(ae){console.error("Erreur lors du chargement des utilisateurs:",ae),P.value=[]}finally{$.value=!1}},ee=()=>{N.search="",N.role="",N.status="",m.value=1},B=ae=>{I.value=ae,A.id=ae.id,A.first_name=ae.first_name||"",A.last_name=ae.last_name||"",A.email=ae.email||"",A.phone=ae.phone||"",A.role=ae.primary_role||(ae.roles&&ae.roles.length>0?ae.roles[0]:""),A.is_active=ae.is_active,A.business_name=ae.business_name||"",A.business_email=ae.business_email||"",A.business_description=ae.business_description||"",A.city=ae.city||"",A.address=ae.address||"",A.date_of_birth=ae.date_of_birth||"",A.gender=ae.gender||"",A.bio=ae.bio||"",A.country_id=ae.country_id||null,A.language_id=ae.language_id||null,A.email_notifications=ae.email_notifications!==!1,A.sms_notifications=ae.sms_notifications!==!1,A.push_notifications=ae.push_notifications!==!1,x.value="",a.value&&v.value.length===0&&O(),D.value=!0},S=async ae=>{try{const X=await w(`/admin/users/${ae.id}/toggle-status`);X&&X.success&&(await b(),window.$toast&&window.$toast.success(X.message||"Statut modifié","✓ Succès"))}catch(X){console.error("Erreur lors de la modification du statut:",X),window.$toast&&window.$toast.error("Erreur lors de la modification du statut","✘ Erreur")}},E=ae=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(new Date(ae)),F=ae=>({"Super Admin":"Super Admin",Admin:"Administrateur",Agent:"Agent de Support","Agent Back Office":"Agent Back Office","Business Enterprise":"Marchand Entreprise","Business Individual":"Marchand Particulier",Business:"Marchand",Particulier:"Client"})[ae]||ae,q=ae=>({"Super Admin":"bg-purple-100 text-purple-800",Admin:"bg-red-100 text-red-800",Agent:"bg-yellow-100 text-yellow-800","Agent Back Office":"bg-orange-100 text-orange-800","Business Enterprise":"bg-blue-100 text-blue-800","Business Individual":"bg-indigo-100 text-indigo-800",Business:"bg-blue-100 text-blue-800",Particulier:"bg-green-100 text-green-800"})[ae]||"bg-gray-100 text-gray-800";De(m,()=>{b()});const O=async()=>{try{const ae=await y("/admin/users/admin-roles");ae&&ae.data&&(v.value=ae.data.roles||[])}catch(ae){console.error("Erreur lors du chargement des rôles admin:",ae)}},K=ae=>{console.log("Phone changed:",ae),u.phone=ae.fullNumber},W=ae=>{console.log("Edit phone changed:",ae),A.phone=ae.fullNumber},J=async()=>{if(!u.first_name||!u.last_name||!u.email||!u.phone||!u.role){C.value="Veuillez remplir tous les champs obligatoires";return}d.value=!0,C.value="";try{const ae=await w("/admin/users",u);ae&&ae.success&&(M.value=!1,await b(),fe(),window.$toast&&window.$toast.success("Administrateur créé avec succès","✓ Succès"))}catch(ae){console.error("Erreur lors de la création:",ae),C.value=ae.response?.data?.message||"Erreur lors de la création de l'administrateur"}finally{d.value=!1}},G=async()=>{if(!A.first_name||!A.last_name||!A.email||!A.phone){x.value="Veuillez remplir tous les champs obligatoires";return}if(r(I.value)&&!A.role){x.value="Veuillez sélectionner un rôle";return}i.value=!0,x.value="";try{const ae=await w(`/admin/users/${A.id}`,{...A,_method:"PUT"});ae&&ae.success&&(D.value=!1,await b(),ke(),window.$toast&&window.$toast.success("Utilisateur modifié avec succès","Succès"))}catch(ae){console.error("Erreur lors de la modification:",ae),x.value=ae.response?.data?.message||"Erreur lors de la modification de l'utilisateur"}finally{i.value=!1}},ue=()=>{M.value=!1,fe(),C.value=""},se=()=>{D.value=!1,ke(),x.value=""},fe=()=>{u.first_name="",u.last_name="",u.email="",u.phone="",u.role="",u.is_active=!0},ke=()=>{A.id=null,A.first_name="",A.last_name="",A.email="",A.phone="",A.role="",A.is_active=!0,A.business_name="",A.business_email="",A.business_description="",A.city="",A.address="",A.date_of_birth="",A.gender="",A.bio="",A.country_id=null,A.language_id=null,A.email_notifications=!0,A.sms_notifications=!0,A.push_notifications=!0,I.value=null},we=()=>u.role&&v.value.find(X=>X.value===u.role)?.description||"";return ve(()=>{b(),a.value&&O()}),(ae,X)=>(s(),o("div",xP,[e("div",bP,[e("div",yP,[X[30]||(X[30]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Gestion des Utilisateurs"),e("p",{class:"mt-2 text-gray-600"},"Gérez tous les utilisateurs de la plateforme")],-1)),e("div",hP,[a.value?(s(),o("button",{key:0,onClick:X[0]||(X[0]=oe=>M.value=!0),class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center"},[g(l(_t),{class:"w-5 h-5 mr-2"}),z(" "+t(f.value?"Créer un Admin":"Créer un Utilisateur"),1)])):T("",!0),e("button",{onClick:b,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors"},[g(l(Fe),{class:te(["w-5 h-5 inline mr-2",$.value?"animate-spin":""])},null,8,["class"]),X[29]||(X[29]=z(" Recharger ",-1))])])])]),e("div",_P,[e("div",wP,[e("div",null,[X[31]||(X[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rechercher",-1)),Q(e("input",{"onUpdate:modelValue":X[1]||(X[1]=oe=>N.search=oe),type:"text",placeholder:"Nom, email...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,N.search]])]),e("div",null,[X[33]||(X[33]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rôle",-1)),Q(e("select",{"onUpdate:modelValue":X[2]||(X[2]=oe=>N.role=oe),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[X[32]||(X[32]=e("option",{value:""},"Tous les rôles",-1)),(s(!0),o(ie,null,le(V.value,oe=>(s(),o("option",{key:oe.value,value:oe.value},t(oe.label),9,$P))),128))],512),[[me,N.role]])]),e("div",null,[X[35]||(X[35]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),Q(e("select",{"onUpdate:modelValue":X[3]||(X[3]=oe=>N.status=oe),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},X[34]||(X[34]=[pe('<option value="">Tous les statuts</option><option value="active">Actif</option><option value="inactive">Inactif</option><option value="verified">Vérifié</option><option value="unverified">Non vérifié</option>',5)]),512),[[me,N.status]])]),e("div",{class:"flex items-end"},[e("button",{onClick:ee,class:"w-full px-4 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"}," Réinitialiser ")])])]),e("div",kP,[e("div",CP,[e("div",AP,[e("h3",PP," Utilisateurs ("+t(H.value.length)+") ",1),e("div",EP,[e("button",jP,[g(l(Fe),{class:"w-5 h-5"})])])])]),$.value?(s(),o("div",SP,X[36]||(X[36]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-2 text-gray-600"},"Chargement...",-1)]))):(s(),o("div",IP,[e("table",DP,[X[37]||(X[37]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Utilisateur "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Email "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Rôle "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Inscription "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",TP,[(s(!0),o(ie,null,le(j.value,oe=>(s(),o("tr",{key:oe.id,class:"hover:bg-gray-50"},[e("td",MP,[e("div",LP,[e("div",VP,[e("span",RP,t(oe.first_name[0])+t(oe.last_name[0]),1)]),e("div",FP,[e("div",NP,t(oe.first_name)+" "+t(oe.last_name),1),oe.phone?(s(),o("div",zP,t(oe.phone),1)):T("",!0)])])]),e("td",qP,t(oe.email),1),e("td",UP,[e("span",{class:te(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",q(oe.primary_role)])},t(F(oe.primary_role)),3)]),e("td",BP,[e("div",OP,[e("span",{class:te(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",oe.is_active?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"])},t(oe.is_active?"Actif":"Inactif"),3),oe.verified_at?(s(),o("span",GP," Vérifié ")):T("",!0)])]),e("td",HP,t(E(oe.created_at)),1),e("td",KP,[e("div",WP,[c(oe)?(s(),o("button",{key:0,onClick:rt=>B(oe),class:"text-blue-600 hover:text-blue-900"}," Modifier ",8,JP)):(s(),o("span",XP,"Modifier")),n(oe)?(s(),o("button",{key:2,onClick:rt=>S(oe),class:te(oe.is_active?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900")},t(oe.is_active?"Désactiver":"Activer"),11,YP)):(s(),o("span",QP,t(oe.is_active?"Désactiver":"Activer"),1))])])]))),128))])])])),e("div",ZP,[e("div",eE,[e("div",tE," Affichage de "+t((m.value-1)*k.value+1)+" à "+t(Math.min(m.value*k.value,U.value))+" sur "+t(U.value)+" résultats ",1),e("div",sE,[e("button",{onClick:X[4]||(X[4]=oe=>m.value--),disabled:m.value===1,class:"px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded disabled:opacity-50"}," Précédent ",8,oE),e("button",{onClick:X[5]||(X[5]=oe=>m.value++),disabled:m.value===h.value,class:"px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded disabled:opacity-50"}," Suivant ",8,rE)])])])]),M.value?(s(),o("div",aE,[e("div",nE,[e("div",iE,[e("h2",lE,t(f.value?"Créer un Administrateur":"Créer un Utilisateur"),1),e("button",{onClick:ue,class:"text-gray-400 hover:text-gray-600"},[g(l(Le),{class:"w-6 h-6"})])]),e("form",{onSubmit:_e(J,["prevent"]),class:"p-6 space-y-4"},[e("div",dE,[e("div",null,[X[38]||(X[38]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prénom *",-1)),Q(e("input",{"onUpdate:modelValue":X[6]||(X[6]=oe=>u.first_name=oe),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Jean"},null,512),[[ne,u.first_name]])]),e("div",null,[X[39]||(X[39]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom *",-1)),Q(e("input",{"onUpdate:modelValue":X[7]||(X[7]=oe=>u.last_name=oe),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Dupont"},null,512),[[ne,u.last_name]])])]),e("div",null,[X[40]||(X[40]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email *",-1)),Q(e("input",{"onUpdate:modelValue":X[8]||(X[8]=oe=>u.email=oe),type:"email",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"admin@koumbaya.com"},null,512),[[ne,u.email]])]),e("div",null,[X[41]||(X[41]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Téléphone *",-1)),g(tt,{modelValue:u.phone,"onUpdate:modelValue":X[9]||(X[9]=oe=>u.phone=oe),placeholder:"Numéro de téléphone",onPhoneChange:K,class:"w-full"},null,8,["modelValue"])]),X[45]||(X[45]=pe('<div class="bg-blue-50 border border-blue-200 rounded-md p-4"><div class="flex items-center"><svg class="w-5 h-5 text-blue-600 mr-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg><div><p class="text-sm font-medium text-blue-800">Mot de passe automatique</p><p class="text-xs text-blue-600">Un mot de passe temporaire sera généré et envoyé par email à l&#39;utilisateur pour qu&#39;il puisse l&#39;initialiser.</p></div></div></div>',1)),e("div",null,[X[43]||(X[43]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rôle *",-1)),Q(e("select",{"onUpdate:modelValue":X[10]||(X[10]=oe=>u.role=oe),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[X[42]||(X[42]=e("option",{value:""},"Sélectionner un rôle",-1)),(s(!0),o(ie,null,le(v.value,oe=>(s(),o("option",{key:oe.value,value:oe.value},t(oe.label),9,uE))),128))],512),[[me,u.role]]),e("p",cE,t(we()),1)]),e("div",null,[e("label",mE,[Q(e("input",{"onUpdate:modelValue":X[11]||(X[11]=oe=>u.is_active=oe),type:"checkbox",class:"mr-2 rounded text-blue-600 focus:ring-blue-500"},null,512),[[Ae,u.is_active]]),X[44]||(X[44]=e("span",{class:"text-sm text-gray-700"},"Activer immédiatement le compte",-1))])]),C.value?(s(),o("div",pE,[e("p",gE,t(C.value),1)])):T("",!0)],32),e("div",fE,[e("button",{onClick:ue,type:"button",class:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"}," Annuler "),e("button",{onClick:J,disabled:d.value,type:"button",class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center"},[d.value?(s(),o("span",bE,X[46]||(X[46]=[e("div",{class:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"},null,-1),z(" Création... ",-1)]))):(s(),o("span",xE,t(f.value?"Créer l'administrateur":"Créer l'utilisateur"),1))],8,vE)])])])):T("",!0),D.value?(s(),o("div",yE,[e("div",hE,[e("div",_E,[X[47]||(X[47]=e("h2",{class:"text-xl font-semibold text-gray-900"},"Modifier l'utilisateur",-1)),e("button",{onClick:se,class:"text-gray-400 hover:text-gray-600"},[g(l(Le),{class:"w-6 h-6"})])]),e("form",{onSubmit:_e(G,["prevent"]),class:"p-6 space-y-4 max-h-96 overflow-y-auto"},[e("div",wE,[X[57]||(X[57]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Informations personnelles",-1)),e("div",$E,[e("div",null,[X[48]||(X[48]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prénom *",-1)),Q(e("input",{"onUpdate:modelValue":X[12]||(X[12]=oe=>A.first_name=oe),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Jean"},null,512),[[ne,A.first_name]])]),e("div",null,[X[49]||(X[49]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom *",-1)),Q(e("input",{"onUpdate:modelValue":X[13]||(X[13]=oe=>A.last_name=oe),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Dupont"},null,512),[[ne,A.last_name]])])]),e("div",kE,[e("div",null,[X[50]||(X[50]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email *",-1)),Q(e("input",{"onUpdate:modelValue":X[14]||(X[14]=oe=>A.email=oe),type:"email",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"user@koumbaya.com"},null,512),[[ne,A.email]])]),e("div",null,[X[51]||(X[51]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Téléphone *",-1)),g(tt,{modelValue:A.phone,"onUpdate:modelValue":X[15]||(X[15]=oe=>A.phone=oe),placeholder:"Numéro de téléphone",onPhoneChange:W,class:"w-full"},null,8,["modelValue"])])]),r(I.value)?T("",!0):(s(),o("div",CE,[e("div",null,[X[52]||(X[52]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date de naissance",-1)),Q(e("input",{"onUpdate:modelValue":X[16]||(X[16]=oe=>A.date_of_birth=oe),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,A.date_of_birth]])]),e("div",null,[X[54]||(X[54]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Genre",-1)),Q(e("select",{"onUpdate:modelValue":X[17]||(X[17]=oe=>A.gender=oe),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},X[53]||(X[53]=[e("option",{value:""},"Sélectionner",-1),e("option",{value:"male"},"Homme",-1),e("option",{value:"female"},"Femme",-1),e("option",{value:"other"},"Autre",-1)]),512),[[me,A.gender]])])])),r(I.value)?T("",!0):(s(),o("div",AE,[e("div",null,[X[55]||(X[55]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Ville",-1)),Q(e("input",{"onUpdate:modelValue":X[18]||(X[18]=oe=>A.city=oe),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Libreville"},null,512),[[ne,A.city]])]),e("div",null,[X[56]||(X[56]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Adresse",-1)),Q(e("input",{"onUpdate:modelValue":X[19]||(X[19]=oe=>A.address=oe),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Adresse complète"},null,512),[[ne,A.address]])])]))]),!r(I.value)&&["Business","Business Enterprise","Business Individual"].includes(A.role)?(s(),o("div",PE,[X[61]||(X[61]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Informations business",-1)),e("div",EE,[X[58]||(X[58]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom de l'entreprise",-1)),Q(e("input",{"onUpdate:modelValue":X[20]||(X[20]=oe=>A.business_name=oe),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nom de votre entreprise"},null,512),[[ne,A.business_name]])]),e("div",jE,[X[59]||(X[59]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email business",-1)),Q(e("input",{"onUpdate:modelValue":X[21]||(X[21]=oe=>A.business_email=oe),type:"email",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"contact@entreprise.com"},null,512),[[ne,A.business_email]])]),e("div",null,[X[60]||(X[60]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description de l'entreprise",-1)),Q(e("textarea",{"onUpdate:modelValue":X[22]||(X[22]=oe=>A.business_description=oe),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Décrivez votre activité..."},null,512),[[ne,A.business_description]])])])):T("",!0),r(I.value)?T("",!0):(s(),o("div",SE,[X[63]||(X[63]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Autres informations",-1)),e("div",null,[X[62]||(X[62]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Biographie",-1)),Q(e("textarea",{"onUpdate:modelValue":X[23]||(X[23]=oe=>A.bio=oe),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Parlez-nous de vous..."},null,512),[[ne,A.bio]])])])),e("div",null,[X[71]||(X[71]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Paramètres du compte",-1)),r(I.value)?(s(),o("div",IE,[X[65]||(X[65]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rôle *",-1)),Q(e("select",{"onUpdate:modelValue":X[24]||(X[24]=oe=>A.role=oe),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[X[64]||(X[64]=e("option",{value:""},"Sélectionner un rôle",-1)),(s(!0),o(ie,null,le(v.value,oe=>(s(),o("option",{key:oe.value,value:oe.value},t(oe.label),9,DE))),128))],512),[[me,A.role]])])):T("",!0),e("div",TE,[e("label",ME,[Q(e("input",{"onUpdate:modelValue":X[25]||(X[25]=oe=>A.is_active=oe),type:"checkbox",class:"mr-2 rounded text-blue-600 focus:ring-blue-500"},null,512),[[Ae,A.is_active]]),X[66]||(X[66]=e("span",{class:"text-sm text-gray-700"},"Compte actif",-1))])]),r(I.value)?T("",!0):(s(),o("div",LE,[X[70]||(X[70]=e("h4",{class:"text-md font-medium text-gray-900 mb-3"},"Préférences de notifications",-1)),e("div",VE,[e("label",RE,[Q(e("input",{"onUpdate:modelValue":X[26]||(X[26]=oe=>A.email_notifications=oe),type:"checkbox",class:"mr-2 rounded text-blue-600 focus:ring-blue-500"},null,512),[[Ae,A.email_notifications]]),X[67]||(X[67]=e("span",{class:"text-sm text-gray-700"},"Notifications email",-1))]),e("label",FE,[Q(e("input",{"onUpdate:modelValue":X[27]||(X[27]=oe=>A.sms_notifications=oe),type:"checkbox",class:"mr-2 rounded text-blue-600 focus:ring-blue-500"},null,512),[[Ae,A.sms_notifications]]),X[68]||(X[68]=e("span",{class:"text-sm text-gray-700"},"Notifications SMS",-1))]),e("label",NE,[Q(e("input",{"onUpdate:modelValue":X[28]||(X[28]=oe=>A.push_notifications=oe),type:"checkbox",class:"mr-2 rounded text-blue-600 focus:ring-blue-500"},null,512),[[Ae,A.push_notifications]]),X[69]||(X[69]=e("span",{class:"text-sm text-gray-700"},"Notifications push",-1))])])]))]),x.value?(s(),o("div",zE,[e("p",qE,t(x.value),1)])):T("",!0)],32),e("div",UE,[e("button",{onClick:se,type:"button",class:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"}," Annuler "),e("button",{onClick:G,disabled:i.value,type:"button",class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center"},[i.value?(s(),o("span",GE,X[72]||(X[72]=[e("div",{class:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"},null,-1),z(" Modification... ",-1)]))):(s(),o("span",OE,"Modifier l'utilisateur"))],8,BE)])])])):T("",!0)]))}},KE={class:"mb-8 flex justify-between items-center"},WE={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},JE={class:"flex items-center"},XE={class:"ml-4"},YE={class:"text-sm font-medium text-gray-600"},QE={class:"text-2xl font-bold text-gray-900"},ZE={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-6"},ej={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},tj=["value"],sj={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},oj={key:0,class:"text-center py-12"},rj={key:1},aj={class:"px-6 py-3 bg-gray-50 border-b border-gray-200"},nj={class:"flex justify-between items-center"},ij={class:"text-lg font-semibold text-gray-900"},lj={class:"overflow-x-auto"},dj={class:"min-w-full divide-y divide-gray-200"},uj={class:"bg-white divide-y divide-gray-200"},cj={class:"px-6 py-4 whitespace-nowrap"},mj={class:"flex items-center"},pj={class:"w-16 h-16 flex-shrink-0"},gj={class:"ml-4"},fj={class:"text-sm font-medium text-gray-900"},vj={class:"px-6 py-4 whitespace-nowrap"},xj={class:"text-sm text-gray-900"},bj={class:"px-6 py-4 whitespace-nowrap"},yj={class:"text-sm text-gray-900"},hj={key:0,class:"text-xs text-gray-500"},_j={class:"px-6 py-4 whitespace-nowrap"},wj={key:0,class:"text-sm text-gray-900"},$j={key:1,class:"text-xs text-gray-500"},kj={class:"px-6 py-4 whitespace-nowrap"},Cj={class:"px-6 py-4 whitespace-nowrap"},Aj={key:0},Pj={class:"flex items-center"},Ej={class:"w-16 bg-gray-200 rounded-full h-2 mr-2"},jj={class:"text-xs text-gray-600"},Sj={class:"text-xs text-gray-500 mt-1"},Ij={key:1,class:"text-xs text-gray-500"},Dj={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Tj=["onClick"],Mj={class:"px-6 py-3 border-t border-gray-200"},Lj={class:"flex items-center justify-between"},Vj={class:"text-sm text-gray-700"},Rj={class:"flex space-x-2"},Fj=["disabled"],Nj=["disabled"],zj={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-40 flex items-center justify-center z-50"},qj={class:"bg-white rounded-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto"},Uj={class:"px-6 py-4 space-y-4"},Bj={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Oj=["value"],Gj={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Hj={key:0},Kj={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Wj={class:"flex items-center pt-6"},Jj={class:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3"},Xj=["disabled"],Yj={key:0},Qj={key:1},Zj={__name:"ProductManagement",setup(_){const{get:y,put:w}=ge(),p=$e(),f=R(!1),a=R(!1),c=R(!1),n=R(null),r=R([]),P=R([]),$=R(1),M=R(0),D=R(20),m=xe({search:"",category:"",status:""}),k=R([{label:"Total articles",value:"0",color:"bg-blue-500",icon:qe},{label:"Actifs",value:"0",color:"bg-green-500",icon:Je},{label:"Valeur totale",value:"0 FCFA",color:"bg-yellow-500",icon:Ke},{label:"En tombola",value:"0 FCFA",color:"bg-purple-500",icon:Ct}]),U=xe({name:"",description:"",price:"",ticket_price:"",category_id:"",sale_mode:"direct",status:"draft",is_featured:!1});De(()=>m,()=>{$.value=1,v()},{deep:!0}),De($,()=>{v()});const V=de(()=>Math.ceil(M.value/D.value)),v=async()=>{f.value=!0;try{const j=new URLSearchParams;j.append("page",$.value),j.append("per_page",D.value),m.search&&j.append("search",m.search),m.category&&j.append("category_id",m.category),m.status&&j.append("status",m.status);const h=await y(`/admin/products?${j.toString()}`);h&&h.data&&(r.value=h.data.products||[],M.value=h.data.pagination?.total||0,P.value=h.data.categories||[],h.data.stats&&(k.value[0].value=h.data.stats.total?.toString()||"0",k.value[1].value=h.data.stats.active?.toString()||"0",k.value[2].value=N(h.data.stats.total_value||0)+" FCFA",k.value[3].value=N(h.data.stats.total_lottery_value||0)+" FCFA"))}catch(j){console.error("Erreur lors du chargement des produits:",j),r.value=[]}finally{f.value=!1}},d=async()=>{a.value=!0;try{const j=await w(`/admin/products/${n.value.id}`,U);j&&j.success&&(await v(),c.value=!1,x(),window.$toast&&window.$toast.success("Produit mis à jour avec succès","✓ Succès"))}catch(j){console.error("Erreur lors de la mise à jour:",j),window.$toast&&window.$toast.error("Erreur lors de la mise à jour","✗ Erreur")}finally{a.value=!1}},i=j=>{p.push(`/admin/products/${j}`)},C=()=>{c.value=!1,x()},x=()=>{Object.assign(U,{name:"",description:"",price:"",ticket_price:"",category_id:"",sale_mode:"direct",status:"draft",is_featured:!1}),n.value=null},I=()=>{m.search="",m.category="",m.status="",$.value=1},N=j=>new Intl.NumberFormat("fr-FR").format(j||0),u=j=>({active:"Actif",draft:"Brouillon",completed:"Terminé",cancelled:"Annulé"})[j]||j,A=j=>({active:"bg-green-100 text-green-800",draft:"bg-yellow-100 text-yellow-800",completed:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800"})[j]||"bg-gray-100 text-gray-800",H=j=>({direct:"Vente directe",lottery:"Tombola"})[j]||j;return ve(()=>{v()}),(j,h)=>(s(),o("div",null,[e("div",KE,[h[14]||(h[14]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Gestion des articles"),e("p",{class:"mt-2 text-gray-600"},"Gérez les articles disponibles pour les tirages spéciaux")],-1)),e("button",{onClick:v,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2"},[g(l(Fe),{class:te(["w-5 h-5",f.value?"animate-spin":""])},null,8,["class"]),h[13]||(h[13]=z(" Actualiser ",-1))])]),e("div",WE,[(s(!0),o(ie,null,le(k.value,b=>(s(),o("div",{key:b.label,class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},[e("div",JE,[e("div",{class:te(["p-3 rounded-lg",b.color])},[(s(),ce(Ie(b.icon),{class:"w-6 h-6 text-white"}))],2),e("div",XE,[e("p",YE,t(b.label),1),e("p",QE,t(b.value),1)])])]))),128))]),e("div",ZE,[e("div",ej,[e("div",null,[h[15]||(h[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rechercher",-1)),Q(e("input",{"onUpdate:modelValue":h[0]||(h[0]=b=>m.search=b),type:"text",placeholder:"Nom de l'article...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,m.search]])]),e("div",null,[h[17]||(h[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Catégorie",-1)),Q(e("select",{"onUpdate:modelValue":h[1]||(h[1]=b=>m.category=b),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[h[16]||(h[16]=e("option",{value:""},"Toutes les catégories",-1)),(s(!0),o(ie,null,le(P.value,b=>(s(),o("option",{key:b.id,value:b.id},t(b.name),9,tj))),128))],512),[[me,m.category]])]),e("div",null,[h[19]||(h[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),Q(e("select",{"onUpdate:modelValue":h[2]||(h[2]=b=>m.status=b),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},h[18]||(h[18]=[e("option",{value:""},"Tous les statuts",-1),e("option",{value:"active"},"Actif",-1),e("option",{value:"draft"},"Brouillon",-1),e("option",{value:"completed"},"Terminé",-1)]),512),[[me,m.status]])]),e("div",{class:"flex items-end"},[e("button",{onClick:I,class:"w-full px-4 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"}," Réinitialiser ")])])]),e("div",sj,[f.value?(s(),o("div",oj,h[20]||(h[20]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement des produits...",-1)]))):(s(),o("div",rj,[e("div",aj,[e("div",nj,[e("h3",ij,t(M.value)+" produit"+t(M.value>1?"s":""),1)])]),e("div",lj,[e("table",dj,[h[22]||(h[22]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Article "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Catégorie "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Prix "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Marchand "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tirage spécial "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Détails ")])],-1)),e("tbody",uj,[(s(!0),o(ie,null,le(r.value,b=>(s(),o("tr",{key:b.id,class:"hover:bg-gray-50"},[e("td",cj,[e("div",mj,[e("div",pj,[g(He,{src:b.image_url||b.main_image,alt:b.name,"container-class":"w-16 h-16 rounded-lg","image-class":"w-full h-full object-cover rounded-lg"},null,8,["src","alt"])]),e("div",gj,[e("div",fj,t(b.name),1)])])]),e("td",vj,[e("span",xj,t(b.category?.name||"N/A"),1)]),e("td",bj,[e("div",yj,t(N(b.price))+" FCFA",1),b.sale_mode==="lottery"?(s(),o("div",hj,t(N(b.ticket_price))+" FCFA/ticket ",1)):T("",!0)]),e("td",_j,[b.merchant?(s(),o("div",wj,t(b.merchant.name),1)):T("",!0),b.merchant?(s(),o("div",$j,t(b.merchant.email),1)):T("",!0)]),e("td",kj,[e("span",{class:te(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",A(b.status)])},t(u(b.status)),3)]),e("td",Cj,[b.lottery?(s(),o("div",Aj,[e("div",Pj,[e("div",Ej,[e("div",{class:"bg-blue-600 h-2 rounded-full",style:Me({width:b.lottery.progress+"%"})},null,4)]),e("span",jj,t(b.lottery.progress)+"%",1)]),e("div",Sj,t(b.lottery.sold_tickets)+"/"+t(b.lottery.total_tickets)+" tickets ",1)])):(s(),o("span",Ij,t(H(b.sale_mode)),1))]),e("td",Dj,[e("button",{onClick:ee=>i(b.id),class:"inline-flex items-center gap-1 px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",title:"Voir les détails"},[g(l(Ue),{class:"w-4 h-4"}),h[21]||(h[21]=z(" Voir ",-1))],8,Tj)])]))),128))])])]),e("div",Mj,[e("div",Lj,[e("div",Vj," Affichage de "+t(($.value-1)*D.value+1)+" à "+t(Math.min($.value*D.value,M.value))+" sur "+t(M.value)+" résultats ",1),e("div",Rj,[e("button",{onClick:h[3]||(h[3]=b=>$.value--),disabled:$.value===1,class:"px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded disabled:opacity-50"}," Précédent ",8,Fj),e("button",{onClick:h[4]||(h[4]=b=>$.value++),disabled:$.value===V.value,class:"px-3 py-1 text-sm bg-gray-100 text-gray-600 rounded disabled:opacity-50"}," Suivant ",8,Nj)])])])]))]),c.value?(s(),o("div",zj,[e("div",qj,[h[32]||(h[32]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"}," Modifier l'article ")],-1)),e("form",{onSubmit:h[12]||(h[12]=_e(b=>d(),["prevent"]))},[e("div",Uj,[e("div",Bj,[e("div",null,[h[23]||(h[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom *",-1)),Q(e("input",{"onUpdate:modelValue":h[5]||(h[5]=b=>U.name=b),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,U.name]])]),e("div",null,[h[25]||(h[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Catégorie *",-1)),Q(e("select",{"onUpdate:modelValue":h[6]||(h[6]=b=>U.category_id=b),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[h[24]||(h[24]=e("option",{value:""},"Sélectionner une catégorie",-1)),(s(!0),o(ie,null,le(P.value,b=>(s(),o("option",{key:b.id,value:b.id},t(b.name),9,Oj))),128))],512),[[me,U.category_id]])])]),e("div",null,[h[26]||(h[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),Q(e("textarea",{"onUpdate:modelValue":h[7]||(h[7]=b=>U.description=b),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,U.description]])]),e("div",Gj,[e("div",null,[h[27]||(h[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prix de l'article (FCFA) *",-1)),Q(e("input",{"onUpdate:modelValue":h[8]||(h[8]=b=>U.price=b),type:"number",required:"",min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,U.price,void 0,{number:!0}]])]),U.sale_mode==="lottery"?(s(),o("div",Hj,[h[28]||(h[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prix par ticket (FCFA)",-1)),Q(e("input",{"onUpdate:modelValue":h[9]||(h[9]=b=>U.ticket_price=b),type:"number",min:"0",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,U.ticket_price,void 0,{number:!0}]])])):T("",!0)]),e("div",Kj,[e("div",null,[h[30]||(h[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),Q(e("select",{"onUpdate:modelValue":h[10]||(h[10]=b=>U.status=b),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},h[29]||(h[29]=[e("option",{value:"draft"},"Brouillon",-1),e("option",{value:"active"},"Actif",-1),e("option",{value:"completed"},"Terminé",-1),e("option",{value:"cancelled"},"Annulé",-1)]),512),[[me,U.status]])]),e("div",Wj,[Q(e("input",{"onUpdate:modelValue":h[11]||(h[11]=b=>U.is_featured=b),type:"checkbox",class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[Ae,U.is_featured]]),h[31]||(h[31]=e("label",{class:"ml-2 text-sm text-gray-700"},"Article en vedette",-1))])])]),e("div",Jj,[e("button",{type:"button",onClick:C,class:"px-4 py-2 text-gray-600 hover:text-gray-900"}," Annuler "),e("button",{type:"submit",disabled:a.value,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400"},[a.value?(s(),o("span",Yj,"Enregistrement...")):(s(),o("span",Qj,"Modifier"))],8,Xj)])],32)])])):T("",!0)]))}},eS=Ee(Zj,[["__scopeId","data-v-3dffb8d7"]]),tS={class:"mb-8"},sS={class:"flex justify-between items-center"},oS=["disabled"],rS={class:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},aS={class:"flex items-center"},nS={class:"ml-4"},iS={class:"text-sm font-medium text-gray-600"},lS={class:"text-2xl font-bold text-gray-900"},dS={class:"mb-8"},uS={class:"border-b border-gray-200"},cS={class:"flex space-x-8"},mS=["onClick"],pS={key:0,class:"ml-2 bg-gray-100 text-gray-600 py-1 px-2 rounded-full text-xs"},gS={class:"mt-4 flex justify-between items-center"},fS={class:"flex space-x-3"},vS={class:"text-sm text-gray-500"},xS={key:0,class:"text-center py-12"},bS={key:1},yS={class:"bg-white rounded-lg shadow-sm border border-gray-200"},hS={key:0,class:"text-center py-12"},_S={key:1,class:"divide-y divide-gray-200"},wS={class:"flex items-center justify-between"},$S={class:"flex items-center space-x-4"},kS=["src","alt"],CS={class:"text-lg font-semibold text-gray-900"},AS={class:"text-sm text-gray-600"},PS={class:"flex items-center space-x-4 mt-2"},ES={class:"text-sm font-medium text-blue-600"},jS={class:"text-sm text-gray-500"},SS={class:"flex space-x-3"},IS=["onClick"],DS=["onClick","disabled"],TS={key:0},MS={key:1},LS={class:"mt-4"},VS={class:"w-full bg-gray-200 rounded-full h-2"},RS={key:2},FS={class:"bg-white rounded-lg shadow-sm border border-gray-200"},NS={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},zS={class:"flex space-x-2"},qS={class:"overflow-x-auto"},US={class:"min-w-full divide-y divide-gray-200"},BS={class:"bg-white divide-y divide-gray-200"},OS={class:"px-6 py-4 whitespace-nowrap"},GS={class:"flex items-center"},HS=["src","alt"],KS={class:"ml-4"},WS={class:"text-sm font-medium text-gray-900"},JS={class:"text-sm text-gray-500"},XS={class:"px-6 py-4 whitespace-nowrap"},YS={class:"text-sm text-gray-900"},QS={class:"w-full bg-gray-200 rounded-full h-2 mt-1"},ZS={class:"text-xs text-gray-500 mt-1"},eI={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},tI={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},sI={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},oI=["onClick"],rI={key:3},aI={class:"bg-white rounded-lg shadow-sm border border-gray-200"},nI={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},iI={class:"flex space-x-2"},lI={class:"divide-y divide-gray-200"},dI={class:"flex items-start justify-between"},uI={class:"flex items-start space-x-4"},cI=["src","alt"],mI={class:"text-lg font-semibold text-gray-900"},pI={class:"text-sm text-gray-600"},gI={class:"flex items-center space-x-4 mt-2"},fI={class:"text-sm text-gray-500"},vI={class:"text-sm font-medium text-blue-600"},xI={class:"text-right"},bI={class:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 text-green-800"},yI={class:"mt-2 text-sm text-gray-600"},hI={key:0,class:"mt-4 bg-green-50 p-4 rounded-lg"},_I={class:"flex items-center justify-between"},wI={class:"flex items-center"},$I={class:"font-semibold text-green-900"},kI={class:"text-sm text-green-800"},CI={class:"text-right"},AI={class:"text-sm text-green-800"},PI={class:"text-sm text-green-600"},EI={class:"flex justify-end space-x-2 mt-4"},jI=["onClick"],SI=["onClick"],II={key:4,class:"fixed inset-0 bg-gray-600 bg-opacity-40 flex items-center justify-center z-50"},DI={class:"bg-white rounded-lg max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto"},TI={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},MI={class:"text-lg font-semibold text-gray-900"},LI={class:"px-6 py-4"},VI={class:"mb-4"},RI={class:"overflow-x-auto"},FI={class:"min-w-full divide-y divide-gray-200"},NI={class:"bg-white divide-y divide-gray-200"},zI={class:"px-6 py-4 whitespace-nowrap"},qI={class:"text-sm font-medium text-gray-900"},UI={class:"text-sm text-gray-500"},BI={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},OI={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},GI={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},HI={key:5,class:"fixed inset-0 bg-gray-600 bg-opacity-40 flex items-center justify-center z-50"},KI={class:"bg-white rounded-lg max-w-md w-full mx-4"},WI={class:"px-6 py-4"},JI={class:"text-gray-600 mb-4"},XI={class:"font-semibold"},YI={class:"bg-gray-50 p-4 rounded-lg mb-4"},QI={class:"text-sm text-gray-600"},ZI={class:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3"},eD=["disabled"],tD={key:0},sD={key:1},oD={__name:"LotteryManagement",setup(_){const{get:y,post:w}=ge(),p=R(!1),f=R("pending"),a=R(!1),c=R(!1),n=R(!1),r=R(null),P=R(""),$=R({}),M=R([]),D=R(1),m=R(1),k=R(20),U=de(()=>[{key:"pending",label:"Tirages en attente",count:$.value.pending_draws||0},{key:"active",label:"Tirages spéciaux actifs",count:$.value.active_lotteries||0},{key:"completed",label:"Historique",count:$.value.completed_lotteries||0}]),V=de(()=>[{label:"Tirages en attente",value:$.value.pending_draws||"0",color:"bg-yellow-500",icon:Te},{label:"Actives",value:$.value.active_lotteries||"0",color:"bg-blue-500",icon:Je},{label:"Revenus totaux",value:H($.value.total_revenue||0)+" FCFA",color:"bg-green-500",icon:Ke},{label:"Taux de participation",value:Math.round($.value.average_participation_rate||0)+"%",color:"bg-purple-500",icon:Ct}]),v=xe({search:""}),d=xe({search:"",period:""}),i=de(()=>M.value.filter(O=>O.status==="active"&&!O.is_drawn&&new Date(O.end_date)<=new Date)),C=de(()=>M.value.filter(O=>O.status==="active"&&new Date(O.end_date)>new Date)),x=de(()=>M.value.filter(O=>O.status==="completed"||O.is_drawn)),I=de(()=>{let O=C.value;if(v.search){const K=v.search.toLowerCase();O=O.filter(W=>W.product?.title?.toLowerCase().includes(K)||W.product?.name?.toLowerCase().includes(K)||W.product?.description?.toLowerCase().includes(K)||W.lottery_number?.toLowerCase().includes(K))}return O}),N=de(()=>{let O=x.value;if(d.search){const K=d.search.toLowerCase();O=O.filter(W=>W.product?.title?.toLowerCase().includes(K)||W.product?.name?.toLowerCase().includes(K)||W.winner?.first_name?.toLowerCase().includes(K)||W.winner?.last_name?.toLowerCase().includes(K)||W.winner?.email?.toLowerCase().includes(K)||W.lottery_number?.toLowerCase().includes(K))}if(d.period){const K=new Date,W=d.period;O=O.filter(J=>{const G=new Date(J.draw_date||J.created_at);if(W==="week"){const ue=new Date(K.getTime()-6048e5);return G>=ue}else if(W==="month"){const ue=new Date(K.getFullYear(),K.getMonth()-1,K.getDate());return G>=ue}else if(W==="quarter"){const ue=new Date(K.getFullYear(),K.getMonth()-3,K.getDate());return G>=ue}return!0})}return O}),u=de(()=>{if(!r.value?.participants_list)return[];let O=r.value.participants_list;if(P.value){const K=P.value.toLowerCase();O=O.filter(W=>{const J=W.user;return`${J?.first_name||""} ${J?.last_name||""}`.toLowerCase().includes(K)||J?.email?.toLowerCase().includes(K)})}return O}),A=O=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(O)),H=O=>new Intl.NumberFormat("fr-FR").format(O||0);De(f,()=>{h()});const j=async()=>{try{const O=await y("/admin/lotteries/statistics");O&&($.value=O)}catch(O){console.error("Erreur lors du chargement des statistiques:",O)}},h=async()=>{p.value=!0;try{const O=new URLSearchParams;O.append("per_page",k.value),O.append("page",D.value),f.value==="active"||f.value==="pending"?(O.append("status","active"),O.append("is_drawn","false")):f.value==="completed"&&O.append("is_drawn","true");const K=await y(`/admin/lotteries?${O.toString()}`);K&&K.data&&(M.value=K.data.map(W=>({...W,progress:W.sold_tickets&&W.total_tickets?Math.round(W.sold_tickets/W.total_tickets*100):0})),D.value=K.current_page||1,m.value=K.last_page||1)}catch(O){console.error("Erreur lors du chargement des tombolas:",O),M.value=[]}finally{p.value=!1}},b=async()=>{await Promise.all([j(),h()])},ee=async O=>{try{const K=await y(`/admin/lotteries/${O.id}`);K&&(r.value=K,c.value=!0)}catch(K){console.error("Erreur lors du chargement des participants:",K),window.$toast&&window.$toast.error("Erreur lors du chargement des participants","✗ Erreur")}},B=O=>{r.value=O,n.value=!0},S=async()=>{a.value=!0;try{const O=await w(`/admin/lotteries/${r.value.id}/draw`);O&&O.success&&(window.$toast&&window.$toast.success("Tirage effectué avec succès","✓ Succès"),await b(),f.value="completed")}catch(O){if(console.error("Erreur lors du tirage:",O),window.$toast){const K=O.response?.data?.message||"Erreur lors du tirage";window.$toast.error(K,"✗ Erreur")}}finally{a.value=!1,n.value=!1,r.value=null}},E=async O=>{try{const K=await y(`/admin/lotteries/${O.id}`);K&&console.log("Draw details:",K)}catch(K){console.error("Erreur lors du chargement des détails:",K)}},F=async O=>{try{const K=await y(`/admin/lotteries/${O.id}/export`);if(K){const W=new Blob([JSON.stringify(K,null,2)],{type:"application/json"}),J=URL.createObjectURL(W),G=document.createElement("a");G.href=J,G.download=`lottery-${O.lottery_number}-export.json`,document.body.appendChild(G),G.click(),document.body.removeChild(G),URL.revokeObjectURL(J),window.$toast&&window.$toast.success("Export téléchargé avec succès","✓ Succès")}}catch(K){console.error("Erreur lors de l'export:",K),window.$toast&&window.$toast.error("Erreur lors de l'export","✗ Erreur")}},q=async()=>{try{const O=await y("/admin/lotteries/eligible-for-draw");O&&(console.log("Eligible draws:",O),window.$toast&&window.$toast.info(`${O.count} tirages disponibles`,"ℹ Info"))}catch(O){console.error("Erreur lors du chargement des tirages disponibles:",O)}};return ve(()=>{j(),h()}),(O,K)=>(s(),o("div",null,[e("div",tS,[e("div",sS,[K[8]||(K[8]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Gestion des tirages spéciaux"),e("p",{class:"mt-2 text-gray-600"},"Gérez les tirages et suivez les résultats des tirages spéciaux")],-1)),e("button",{onClick:b,disabled:p.value,class:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center disabled:bg-gray-400"},[(s(),o("svg",{class:te(["w-4 h-4 mr-2",p.value?"animate-spin":""]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},K[6]||(K[6]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)]),2)),K[7]||(K[7]=z(" Actualiser ",-1))],8,oS)])]),e("div",rS,[(s(!0),o(ie,null,le(V.value,W=>(s(),o("div",{key:W.label,class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},[e("div",aS,[e("div",{class:te(["p-3 rounded-lg",W.color])},[(s(),ce(Ie(W.icon),{class:"w-6 h-6 text-white"}))],2),e("div",nS,[e("p",iS,t(W.label),1),e("p",lS,t(W.value),1)])])]))),128))]),e("div",dS,[e("div",uS,[e("nav",cS,[(s(!0),o(ie,null,le(U.value,W=>(s(),o("button",{key:W.key,onClick:J=>f.value=W.key,class:te(["py-2 px-1 border-b-2 font-medium text-sm",f.value===W.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[z(t(W.label)+" ",1),W.count!==void 0?(s(),o("span",pS,t(W.count),1)):T("",!0)],10,mS))),128))])]),e("div",gS,[e("div",fS,[e("button",{onClick:q,class:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-700"},[K[9]||(K[9]=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1)),z(" Tirages disponibles ("+t($.value.pending_draws||0)+") ",1)])]),e("div",vS," Dernière mise à jour : "+t(new Date().toLocaleTimeString("fr-FR")),1)])]),p.value?(s(),o("div",xS,K[10]||(K[10]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement des tombolas...",-1)]))):f.value==="pending"?(s(),o("div",bS,[e("div",yS,[K[13]||(K[13]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Tirages en attente"),e("p",{class:"text-sm text-gray-600"},"Tombolas prêtes pour le tirage")],-1)),i.value.length===0?(s(),o("div",hS,[g(l(Te),{class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),K[11]||(K[11]=e("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"Aucun tirage en attente",-1)),K[12]||(K[12]=e("p",{class:"text-gray-600"},"Toutes les tombolas sont à jour",-1))])):(s(),o("div",_S,[(s(!0),o(ie,null,le(i.value,W=>(s(),o("div",{key:W.id,class:"p-6 hover:bg-gray-50"},[e("div",wS,[e("div",$S,[e("img",{src:W.product?.image_url||W.product?.main_image||"/images/placeholder.jpg",alt:W.product?.title||W.product?.name,class:"w-16 h-16 rounded-lg object-cover"},null,8,kS),e("div",null,[e("h4",CS,t(W.product?.title||W.product?.name),1),e("p",AS,t(W.product?.description),1),e("div",PS,[e("span",ES,t(W.sold_tickets||0)+"/"+t(W.total_tickets)+" tickets vendus ",1),e("span",jS," Tirage prévu: "+t(A(W.draw_date||W.end_date)),1)])])]),e("div",SS,[e("button",{onClick:J=>ee(W),class:"px-4 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"}," Voir participants ",8,IS),e("button",{onClick:J=>B(W),disabled:a.value,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:bg-gray-400"},[a.value?(s(),o("span",TS,"Tirage...")):(s(),o("span",MS,"Effectuer le tirage"))],8,DS)])]),e("div",LS,[e("div",VS,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:Me({width:W.progress+"%"})},null,4)])])]))),128))]))])])):f.value==="active"?(s(),o("div",RS,[e("div",FS,[e("div",NS,[K[14]||(K[14]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Tirages spéciaux actifs"),e("p",{class:"text-sm text-gray-600"},"Tirages spéciaux en cours de vente")],-1)),e("div",zS,[Q(e("input",{"onUpdate:modelValue":K[0]||(K[0]=W=>v.search=W),type:"text",placeholder:"Rechercher...",class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,v.search]])])]),e("div",qS,[e("table",US,[K[16]||(K[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Produit "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Progression "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Revenus "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date de tirage "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Détails ")])],-1)),e("tbody",BS,[(s(!0),o(ie,null,le(I.value,W=>(s(),o("tr",{key:W.id,class:"hover:bg-gray-50"},[e("td",OS,[e("div",GS,[e("img",{src:W.product?.image_url||W.product?.main_image||"/images/placeholder.jpg",alt:W.product?.title||W.product?.name,class:"w-12 h-12 rounded-lg object-cover"},null,8,HS),e("div",KS,[e("div",WS,t(W.product?.title||W.product?.name),1),e("div",JS,t(H(W.product?.price||0))+" FCFA",1)])])]),e("td",XS,[e("div",YS,t(W.progress)+"%",1),e("div",QS,[e("div",{class:"bg-blue-600 h-2 rounded-full",style:Me({width:W.progress+"%"})},null,4)]),e("div",ZS,t(W.sold_tickets||0)+"/"+t(W.total_tickets),1)]),e("td",eI,t(H((W.sold_tickets||0)*(W.ticket_price||0)))+" FCFA ",1),e("td",tI,t(A(W.draw_date||W.end_date)),1),e("td",sI,[e("button",{onClick:J=>ee(W),class:"inline-flex items-center px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",title:"Voir participants"},[g(l(vt),{class:"w-4 h-4 mr-1"}),K[15]||(K[15]=z(" Participants ",-1))],8,oI)])]))),128))])])])])])):f.value==="completed"?(s(),o("div",rI,[e("div",aI,[e("div",nI,[K[18]||(K[18]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Tirages terminés"),e("p",{class:"text-sm text-gray-600"},"Historique des tombolas terminées")],-1)),e("div",iI,[Q(e("input",{"onUpdate:modelValue":K[1]||(K[1]=W=>d.search=W),type:"text",placeholder:"Rechercher...",class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,d.search]]),Q(e("select",{"onUpdate:modelValue":K[2]||(K[2]=W=>d.period=W),class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},K[17]||(K[17]=[e("option",{value:""},"Toutes les périodes",-1),e("option",{value:"week"},"Cette semaine",-1),e("option",{value:"month"},"Ce mois",-1),e("option",{value:"quarter"},"Ce trimestre",-1)]),512),[[me,d.period]])])]),e("div",lI,[(s(!0),o(ie,null,le(N.value,W=>(s(),o("div",{key:W.id,class:"p-6"},[e("div",dI,[e("div",uI,[e("img",{src:W.product?.image_url||W.product?.main_image||"/images/placeholder.jpg",alt:W.product?.title||W.product?.name,class:"w-16 h-16 rounded-lg object-cover"},null,8,cI),e("div",null,[e("h4",mI,t(W.product?.title||W.product?.name),1),e("p",pI,t(W.product?.description),1),e("div",gI,[e("span",fI," Tirage effectué: "+t(A(W.draw_date||W.updated_at)),1),e("span",vI," Revenus: "+t(H((W.sold_tickets||0)*(W.ticket_price||0)))+" FCFA ",1)])])]),e("div",xI,[e("span",bI,[g(l(Re),{class:"w-4 h-4 mr-1"}),K[19]||(K[19]=z(" Terminé ",-1))]),e("div",yI," Gagnant: "+t(W.winner?`${W.winner.first_name} ${W.winner.last_name}`:"Non réclamé"),1)])]),W.winner?(s(),o("div",hI,[e("div",_I,[e("div",wI,[g(l(Je),{class:"w-5 h-5 text-green-600 mr-2"}),e("div",null,[e("p",$I,t(W.winner.first_name)+" "+t(W.winner.last_name),1),e("p",kI,"Ticket gagnant: #"+t(W.winning_ticket_number||"N/A"),1)])]),e("div",CI,[e("p",AI,t(W.winner.email),1),e("p",PI,t(W.winner.phone),1)])])])):T("",!0),e("div",EI,[e("button",{onClick:J=>E(W),class:"px-3 py-1 text-sm text-blue-600 hover:text-blue-800"}," Voir détails ",8,jI),e("button",{onClick:J=>F(W),class:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800"}," Exporter ",8,SI)])]))),128))])])])):T("",!0),c.value?(s(),o("div",II,[e("div",DI,[e("div",TI,[e("h3",MI," Participants - "+t(r.value?.product?.title||r.value?.product?.name),1),e("button",{onClick:K[3]||(K[3]=W=>c.value=!1),class:"text-gray-400 hover:text-gray-600"},[g(l(Le),{class:"w-6 h-6"})])]),e("div",LI,[e("div",VI,[Q(e("input",{"onUpdate:modelValue":K[4]||(K[4]=W=>P.value=W),type:"text",placeholder:"Rechercher un participant...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,P.value]])]),e("div",RI,[e("table",FI,[K[20]||(K[20]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Participant "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tickets "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Total payé "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date d'achat ")])],-1)),e("tbody",NI,[(s(!0),o(ie,null,le(u.value,W=>(s(),o("tr",{key:W.user?.id,class:"hover:bg-gray-50"},[e("td",zI,[e("div",null,[e("div",qI,t(W.user?.first_name)+" "+t(W.user?.last_name),1),e("div",UI,t(W.user?.email),1)])]),e("td",BI,t(W.tickets_count),1),e("td",OI,t(H(W.total_spent))+" FCFA ",1),e("td",GI,t(A(W.tickets?.[0]?.purchased_at||W.tickets?.[0]?.created_at)),1)]))),128))])])])])])])):T("",!0),n.value?(s(),o("div",HI,[e("div",KI,[K[26]||(K[26]=e("div",{class:"px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Confirmer le tirage")],-1)),e("div",WI,[e("p",JI,[K[21]||(K[21]=z(" Êtes-vous sûr de vouloir effectuer le tirage pour ",-1)),e("span",XI,t(r.value?.product?.title||r.value?.product?.name),1),K[22]||(K[22]=z(" ? ",-1))]),e("div",YI,[e("p",QI,[z(" • "+t(r.value?.sold_tickets||0)+" tickets vendus",1),K[23]||(K[23]=e("br",null,null,-1)),z(" • "+t(r.value?.participants_list?.length||0)+" participants",1),K[24]||(K[24]=e("br",null,null,-1)),z(" • Revenus: "+t(H((r.value?.sold_tickets||0)*(r.value?.ticket_price||0)))+" FCFA ",1)])]),K[25]||(K[25]=e("p",{class:"text-sm text-red-600"}," ⚠️ Cette action est irréversible. Le gagnant sera choisi aléatoirement. ",-1))]),e("div",ZI,[e("button",{onClick:K[5]||(K[5]=W=>n.value=!1),class:"px-4 py-2 text-gray-600 hover:text-gray-900"}," Annuler "),e("button",{onClick:S,disabled:a.value,class:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400"},[a.value?(s(),o("span",tD,"Tirage en cours...")):(s(),o("span",sD,"Effectuer le tirage"))],8,eD)])])])):T("",!0)]))}},rD={name:"PhoneInputAdmin",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"Numéro de téléphone"},preferredCountries:{type:Array,default:()=>["ga","cm","ci","cg","cf","td","gq","fr"]},initialCountry:{type:String,default:"ga"}},data(){return{phoneNumber:this.modelValue,iti:null}},watch:{phoneNumber(_){this.$emit("update:modelValue",_)},modelValue(_){_!==this.phoneNumber&&(this.phoneNumber=_,this.iti&&this.$refs.phoneInput&&_&&this.iti.setNumber(_))}},mounted(){this.initializeIntlTelInput()},beforeUnmount(){this.iti&&this.iti.destroy()},methods:{initializeIntlTelInput(){const _=this.$refs.phoneInput;this.iti=ys(_,{preferredCountries:this.preferredCountries,initialCountry:this.initialCountry,separateDialCode:!0,customPlaceholder:(y,w)=>y}),_.addEventListener("input",y=>{this.phoneNumber=y.target.value,this.emitAllData()}),_.addEventListener("countrychange",()=>{this.emitAllData()}),setTimeout(()=>{this.modelValue&&this.iti.setNumber(this.modelValue),this.emitAllData()},100)},emitAllData(){if(this.iti&&this.iti.getSelectedCountryData)try{const _=this.iti.getSelectedCountryData(),y=this.phoneNumber||"";let w="";y.trim()&&(y.startsWith("+")?w=y:w=`+${_.dialCode}${y}`);const p=this.validatePhoneNumber(y,_);this.$emit("update:modelValue",w),this.$emit("phone-change",{number:y,fullNumber:w,countryCode:_.dialCode,countryIso2:_.iso2,isValid:p})}catch(_){console.warn("PhoneInputAdmin: Error emitting data",_)}},validatePhoneNumber(_,y){if(!_||!_.trim())return!1;const p={ga:{min:7,max:8},cm:{min:8,max:9},ci:{min:8,max:10},fr:{min:9,max:10},ca:{min:10,max:10},cg:{min:8,max:9},cf:{min:8,max:8},td:{min:8,max:8},gq:{min:9,max:9}}[y.iso2]||{min:7,max:15},f=_.replace(/[^\d]/g,"");return f.length>=p.min&&f.length<=p.max},getNumber(){if(this.iti&&this.iti.getSelectedCountryData){const _=this.iti.getSelectedCountryData(),y=this.phoneNumber||"";if(y.trim())return y.startsWith("+")?y:`+${_.dialCode}${y}`}return""},isValidNumber(){if(this.iti&&this.iti.getSelectedCountryData){const _=this.iti.getSelectedCountryData();return this.validatePhoneNumber(this.phoneNumber,_)}return!1}}},aD={class:"phone-input-wrapper"},nD=["placeholder"];function iD(_,y,w,p,f,a){return s(),o("div",aD,[e("input",{ref:"phoneInput",type:"tel",class:"admin-input",placeholder:w.placeholder},null,8,nD)])}const Cs=Ee(rD,[["render",iD],["__scopeId","data-v-2c35b97e"]]),lD={class:"space-y-6"},dD={class:"flex justify-between items-center"},uD={class:"flex space-x-3"},cD={class:"grid grid-cols-1 lg:grid-cols-4 gap-6"},mD={class:"lg:col-span-1"},pD={class:"admin-card space-y-1"},gD=["onClick"],fD={class:"lg:col-span-3"},vD={class:"admin-card"},xD={key:0,class:"p-6"},bD={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},yD={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},hD={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},_D=["value"],wD=["value"],$D={class:"flex justify-end"},kD=["disabled"],CD={key:1,class:"p-6"},AD={class:"admin-card-header mb-6"},PD={class:"flex justify-between items-center"},ED={class:"mb-6"},jD={class:"w-full md:w-1/2 lg:w-1/3"},SD={class:"overflow-x-auto"},ID={class:"min-w-full divide-y divide-gray-200"},DD={class:"bg-white divide-y divide-gray-200"},TD={class:"px-6 py-4 whitespace-nowrap"},MD={class:"flex items-center"},LD=["src","alt"],VD={class:"text-sm font-medium text-gray-900"},RD={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},FD={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},ND={class:"px-6 py-4 whitespace-nowrap"},zD={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},qD={class:"flex space-x-2"},UD=["onClick"],BD=["onClick"],OD=["onClick"],GD={key:2,class:"p-6"},HD={class:"admin-card-header mb-6"},KD={class:"flex justify-between items-center"},WD={class:"mb-6"},JD={class:"w-full md:w-1/2 lg:w-1/3"},XD={class:"overflow-x-auto"},YD={class:"min-w-full divide-y divide-gray-200"},QD={class:"bg-white divide-y divide-gray-200"},ZD={class:"px-6 py-4 whitespace-nowrap"},eT={class:"flex items-center"},tT={class:"text-2xl mr-3"},sT={class:"text-sm font-medium text-gray-900"},oT={class:"text-sm text-gray-500"},rT={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},aT={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},nT={class:"px-6 py-4 whitespace-nowrap"},iT={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},lT={class:"flex space-x-2"},dT=["onClick"],uT=["onClick"],cT=["onClick"],mT={key:3,class:"p-6"},pT={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},gT={class:"space-y-4"},fT={class:"space-y-3"},vT={class:"flex items-center"},xT={class:"flex items-center space-x-2"},bT={class:"font-medium text-gray-900"},yT={key:0,class:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full"},hT={key:1,class:"px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded-full"},_T={class:"text-sm text-gray-600"},wT={class:"flex items-center space-x-3"},$T={class:"relative inline-flex items-center cursor-pointer"},kT=["onUpdate:modelValue"],CT=["onClick","disabled"],AT={class:"flex justify-end"},PT=["disabled"],ET={key:4,class:"p-6"},jT={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ST={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},IT={class:"space-y-4"},DT={class:"space-y-3"},TT={class:"flex items-center justify-between"},MT={class:"relative inline-flex items-center cursor-pointer"},LT={class:"flex items-center justify-between"},VT={class:"relative inline-flex items-center cursor-pointer"},RT={class:"flex justify-end"},FT=["disabled"],NT={key:5,class:"p-6"},zT={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},qT={class:"space-y-4"},UT={class:"space-y-3"},BT={class:"font-medium text-gray-900"},OT={class:"text-sm text-gray-600"},GT={class:"relative inline-flex items-center cursor-pointer"},HT=["onUpdate:modelValue"],KT={class:"flex justify-end"},WT=["disabled"],JT={key:6,class:"p-6"},XT={class:"space-y-6"},YT={class:"p-4 border border-yellow-200 bg-yellow-50 rounded-lg"},QT={class:"flex items-center justify-between"},ZT={class:"relative inline-flex items-center cursor-pointer"},eM={key:0,class:"mt-4"},tM={class:"space-y-4"},sM={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},oM=["disabled"],rM=["disabled"],aM=["disabled"],nM=["disabled"],iM={class:"flex justify-end"},lM=["disabled"],dM={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-40 flex items-center justify-center z-50"},uM={class:"bg-white rounded-lg max-w-md w-full mx-4"},cM={class:"px-6 py-4 border-b border-gray-200"},mM={class:"text-lg font-semibold text-gray-900"},pM={class:"px-6 py-4 space-y-4"},gM={class:"flex items-center"},fM={class:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3"},vM=["disabled"],xM={key:0},bM={key:1},yM={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-40 flex items-center justify-center z-50"},hM={class:"bg-white rounded-lg max-w-md w-full mx-4"},_M={class:"px-6 py-4 border-b border-gray-200"},wM={class:"text-lg font-semibold text-gray-900"},$M={class:"px-6 py-4 space-y-4"},kM={class:"flex items-center"},CM={class:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3"},AM=["disabled"],PM={key:0},EM={key:1},jM={key:2,class:"fixed inset-0 bg-gray-600 bg-opacity-40 flex items-center justify-center z-50"},SM={class:"bg-white rounded-lg max-w-2xl w-full mx-4"},IM={class:"px-6 py-4 border-b border-gray-200"},DM={class:"text-lg font-semibold text-gray-900"},TM={class:"px-6 py-4 space-y-6"},MM={key:0},LM={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},VM={key:1},RM={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},FM={key:2},NM={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},zM={class:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex justify-end space-x-3"},qM=["disabled"],UM={key:0},BM={key:1},OM={__name:"Settings",setup(_){const{get:y,post:w,put:p}=ge(),f=R(!1),a=R("general"),c=[{id:"general",name:"Général",icon:Qe},{id:"countries",name:"Pays",icon:Ws},{id:"languages",name:"Langues",icon:Js},{id:"payment",name:"Paiements",icon:Ke},{id:"lottery",name:"Tombolas",icon:ot},{id:"notifications",name:"Notifications",icon:Gt},{id:"maintenance",name:"Maintenance",icon:Xs}],n=xe({app_name:"",app_url:"",app_description:"",contact_email:"",contact_phone:"",default_language:"fr",default_country:"GA"}),r=xe({default_currency:"XAF",platform_commission:0}),P=R([{id:"ebilling",name:"eBilling",description:"Passerelle eBilling (Airtel Money, Moov Money)",icon:mt,active:!0,type:"gateway",config:{merchant_id:"",api_key:"",secret_key:"",environment:"sandbox"}},{id:"airtel_money",name:"Airtel Money",description:"Paiement mobile via Airtel Money (eBilling)",icon:mt,active:!0,type:"mobile_money",gateway:"ebilling"},{id:"moov_money",name:"Moov Money",description:"Paiement mobile via Moov Money (eBilling)",icon:mt,active:!0,type:"mobile_money",gateway:"ebilling"},{id:"flutterwave",name:"Flutterwave",description:"Passerelle Flutterwave (Cards, Mobile Money, Bank Transfer)",icon:Xe,active:!1,type:"gateway",config:{public_key:"",secret_key:"",environment:"sandbox"}},{id:"paystack",name:"Paystack",description:"Passerelle Paystack (Cards, USSD, Bank Transfer)",icon:Xe,active:!1,type:"gateway",config:{public_key:"",secret_key:"",environment:"sandbox"}},{id:"bank_transfer",name:"Virement bancaire",description:"Paiement par virement bancaire local",icon:Ge,active:!1,type:"bank_transfer"}]),$=xe({min_ticket_price:0,max_ticket_price:0,min_participants:0,max_duration_days:0,auto_refund:!1,auto_draw:!1}),M=xe({from_email:"",from_name:""}),D=R([]),m=xe({maintenance_mode:!1,maintenance_message:""}),k=R([]),U=R([]),V=R(!1),v=R(!1),d=R(!1),i=R(!1),C=R(!1),x=R(null),I=R(null),N=R(null),u=xe({name:"",code:"",currency:"",flag:"",is_active:!0}),A=xe({name:"",native_name:"",code:"",flag:"",direction:"ltr",is_active:!0}),H=xe({search:""}),j=xe({search:""}),h=de(()=>k.value.filter(Z=>Z.is_active)),b=de(()=>U.value.filter(Z=>Z.is_active)),ee=(Z,L,Y)=>{Z.response?.status===404?(console.info(`API ${L} pas encore implémentée, simulation du succès`),window.$toast&&window.$toast.info(`${Y} (API en développement)`,"ℹ️ Développement")):window.$toast&&window.$toast.error(`Erreur lors de ${L.toLowerCase()}`,"✗ Erreur")},B=async()=>{f.value=!0;try{const Z=await y("/admin/settings");Z&&Z.success&&Z.data&&(Object.assign(n,Z.data.general||{}),Object.assign(r,Z.data.payment||{}),Object.assign($,Z.data.lottery||{}),Object.assign(M,Z.data.notifications||{}),Object.assign(m,Z.data.maintenance||{}),Z.data.payment_methods&&P.value.forEach(L=>{const Y=Z.data.payment_methods.find(Ve=>Ve.id===L.id);Y&&(L.active=Y.active)}),Z.data.countries&&(k.value=Z.data.countries),Z.data.languages&&(U.value=Z.data.languages),Z.data.notification_types&&(D.value=Z.data.notification_types))}catch(Z){console.error("Error loading settings:",Z),Z.response?.status!==404?window.$toast&&window.$toast.error("Erreur lors du chargement des paramètres","✗ Erreur"):(console.info("API /admin/settings pas encore implémentée, chargement des données par défaut"),Object.assign(n,{app_name:"Koumbaya",app_url:"https://koumbaya.com",app_description:"Plateforme de tombolas en ligne",contact_email:"contact@koumbaya.com",contact_phone:"+241 XX XX XX XX",default_language:"fr",default_country:"GA"}),Object.assign(r,{default_currency:"XAF",platform_commission:5}),Object.assign($,{min_ticket_price:1e3,max_ticket_price:1e5,min_participants:10,max_duration_days:30,auto_refund:!0,auto_draw:!1}),Object.assign(M,{from_email:"noreply@koumbaya.com",from_name:"Koumbaya"}),Object.assign(m,{maintenance_mode:!1,maintenance_message:"La plateforme est temporairement en maintenance. Nous reviendrons bientôt !"}),k.value=[{id:1,name:"Gabon",code:"GA",currency:"XAF",flag:"https://flagcdn.com/w40/ga.png",is_active:!0},{id:2,name:"France",code:"FR",currency:"EUR",flag:"https://flagcdn.com/w40/fr.png",is_active:!0}],U.value=[{id:1,name:"Français",native_name:"Français",code:"fr",flag:"🇫🇷",direction:"ltr",is_active:!0},{id:2,name:"English",native_name:"English",code:"en",flag:"🇺🇸",direction:"ltr",is_active:!0}],D.value=[{id:"new_user",name:"Nouvel utilisateur",description:"Email de bienvenue aux nouveaux utilisateurs",enabled:!0},{id:"lottery_winner",name:"Gagnant tombola",description:"Notification au gagnant d'une tombola",enabled:!0}])}finally{f.value=!1}},S=async()=>{f.value=!0;try{const Z=await p("/admin/settings/general",n);Z&&Z.success&&window.$toast&&window.$toast.success("Paramètres généraux sauvegardés","✅ Succès")}catch(Z){console.error("Error updating general settings:",Z),ee(Z,"/admin/settings/general","Paramètres généraux sauvegardés")}finally{f.value=!1}},E=async()=>{f.value=!0;try{const Z=await p("/admin/settings/payment",{...r,payment_methods:P.value});Z&&Z.success&&window.$toast&&window.$toast.success("Paramètres de paiement sauvegardés","✅ Succès")}catch(Z){console.error("Error updating payment settings:",Z),window.$toast&&window.$toast.error("Erreur lors de la sauvegarde","✗ Erreur")}finally{f.value=!1}},F=async()=>{f.value=!0;try{const Z=await p("/admin/settings/lottery",$);Z&&Z.success&&window.$toast&&window.$toast.success("Paramètres des tombolas sauvegardés","✅ Succès")}catch(Z){console.error("Error updating lottery settings:",Z),window.$toast&&window.$toast.error("Erreur lors de la sauvegarde","✗ Erreur")}finally{f.value=!1}},q=async()=>{f.value=!0;try{const Z=await p("/admin/settings/notifications",{...M,notification_types:D.value});Z&&Z.success&&window.$toast&&window.$toast.success("Paramètres de notifications sauvegardés","✅ Succès")}catch(Z){console.error("Error updating notification settings:",Z),window.$toast&&window.$toast.error("Erreur lors de la sauvegarde","✗ Erreur")}finally{f.value=!1}},O=async()=>{f.value=!0;try{const Z=await p("/admin/settings/maintenance",m);Z&&Z.success&&window.$toast&&window.$toast.success("Paramètres de maintenance sauvegardés","✅ Succès")}catch(Z){console.error("Error updating maintenance settings:",Z),window.$toast&&window.$toast.error("Erreur lors de la sauvegarde","✗ Erreur")}finally{f.value=!1}},K=async()=>{await B(),window.$toast&&window.$toast.info("Paramètres rechargés","ℹ️ Information")},W=async()=>{f.value=!0;try{const Z=await w("/admin/settings/backup");Z&&Z.success&&window.$toast&&window.$toast.success("Sauvegarde créée avec succès","✅ Sauvegarde")}catch(Z){console.error("Error creating backup:",Z),window.$toast&&window.$toast.error("Erreur lors de la sauvegarde","✗ Erreur")}finally{f.value=!1}},J=Z=>{Z.type==="gateway"&&Z.config?(N.value=Z,C.value=!0):window.$toast&&window.$toast.info(`Configuration non disponible pour ${Z.name}`,"ℹ️ Information")},G=async()=>{if(confirm("Vider le cache de l'application ?")){f.value=!0;try{const Z=await w("/admin/settings/cache/clear");Z&&Z.success&&window.$toast&&window.$toast.success("Cache vidé avec succès","✅ Maintenance")}catch(Z){console.error("Error clearing cache:",Z),window.$toast&&window.$toast.error("Erreur lors du vidage du cache","✗ Erreur")}finally{f.value=!1}}},ue=async()=>{if(confirm("Optimiser la base de données ? Cette opération peut prendre du temps.")){f.value=!0;try{const Z=await w("/admin/settings/database/optimize");Z&&Z.success&&window.$toast&&window.$toast.success("Base de données optimisée","✅ Maintenance")}catch(Z){console.error("Error optimizing database:",Z),window.$toast&&window.$toast.error("Erreur lors de l'optimisation","✗ Erreur")}finally{f.value=!1}}},se=async()=>{f.value=!0;try{const Z=await w("/admin/settings/sitemap/generate");Z&&Z.success&&window.$toast&&window.$toast.success("Sitemap généré avec succès","✅ Maintenance")}catch(Z){console.error("Error generating sitemap:",Z),window.$toast&&window.$toast.error("Erreur lors de la génération du sitemap","✗ Erreur")}finally{f.value=!1}},fe=async()=>{f.value=!0;try{const Z=await w("/admin/settings/email/test");Z&&Z.success&&window.$toast&&window.$toast.success("Email de test envoyé","✅ Test")}catch(Z){console.error("Error testing email:",Z),window.$toast&&window.$toast.error("Erreur lors du test email","✗ Erreur")}finally{f.value=!1}},ke=de(()=>{let Z=k.value;if(H.search){const L=H.search.toLowerCase();Z=Z.filter(Y=>Y.name?.toLowerCase().includes(L)||Y.iso_code_2?.toLowerCase().includes(L)||Y.iso_code_3?.toLowerCase().includes(L))}return Z}),we=de(()=>{let Z=U.value;if(j.search){const L=j.search.toLowerCase();Z=Z.filter(Y=>Y.name.toLowerCase().includes(L)||Y.native_name.toLowerCase().includes(L)||Y.code.toLowerCase().includes(L))}return Z}),ae=Z=>{x.value=Z,Object.assign(u,{name:Z.name,code:Z.iso_code_2,currency:Z.currency_code,flag:Z.flag,is_active:Z.is_active}),v.value=!0},X=async()=>{f.value=!0;try{const Z=await w("/admin/countries",u);if(Z&&Z.success){const L={id:Date.now(),...u};k.value.unshift(L),yt(),window.$toast&&window.$toast.success("Pays créé avec succès","✅ Création")}}catch(Z){console.error("Error creating country:",Z),window.$toast&&window.$toast.error("Erreur lors de la création du pays","✗ Erreur")}finally{f.value=!1}},oe=async()=>{f.value=!0;try{const Z=await p(`/admin/countries/${x.value.id}`,u);if(Z&&Z.success){const L=k.value.findIndex(Y=>Y.id===x.value.id);L!==-1&&(k.value[L]={...k.value[L],...u}),yt(),window.$toast&&window.$toast.success("Pays modifié avec succès","✅ Modification")}}catch(Z){console.error("Error updating country:",Z),window.$toast&&window.$toast.error("Erreur lors de la modification du pays","✗ Erreur")}finally{f.value=!1}},rt=async Z=>{try{const L=await p(`/admin/countries/${Z.id}/toggle-status`);L&&L.success&&(Z.is_active=!Z.is_active,window.$toast&&window.$toast.success(`Pays ${Z.is_active?"activé":"désactivé"}`,"✅ Statut"))}catch(L){console.error("Error toggling country status:",L),window.$toast&&window.$toast.error("Erreur lors du changement de statut","✗ Erreur")}},At=async Z=>{if(confirm("Êtes-vous sûr de vouloir supprimer ce pays ?"))try{const L=await w(`/admin/countries/${Z}/delete`);L&&L.success&&(k.value=k.value.filter(Y=>Y.id!==Z),window.$toast&&window.$toast.success("Pays supprimé avec succès","✅ Suppression"))}catch(L){console.error("Error deleting country:",L),window.$toast&&window.$toast.error("Erreur lors de la suppression du pays","✗ Erreur")}},yt=()=>{V.value=!1,v.value=!1,x.value=null,Object.assign(u,{name:"",code:"",currency:"",flag:"",is_active:!0})},As=Z=>{I.value=Z,Object.assign(A,{name:Z.name,native_name:Z.native_name,code:Z.code,flag:Z.flag,direction:Z.direction,is_active:Z.is_active}),i.value=!0},Ps=async()=>{f.value=!0;try{const Z=await w("/admin/languages",A);if(Z&&Z.success){const L={id:Date.now(),...A};U.value.unshift(L),Pt(),window.$toast&&window.$toast.success("Langue créée avec succès","✅ Création")}}catch(Z){console.error("Error creating language:",Z),window.$toast&&window.$toast.error("Erreur lors de la création de la langue","✗ Erreur")}finally{f.value=!1}},Es=async()=>{f.value=!0;try{const Z=await p(`/admin/languages/${I.value.id}`,A);if(Z&&Z.success){const L=U.value.findIndex(Y=>Y.id===I.value.id);L!==-1&&(U.value[L]={...U.value[L],...A}),Pt(),window.$toast&&window.$toast.success("Langue modifiée avec succès","✅ Modification")}}catch(Z){console.error("Error updating language:",Z),window.$toast&&window.$toast.error("Erreur lors de la modification de la langue","✗ Erreur")}finally{f.value=!1}},js=async Z=>{try{const L=await p(`/admin/languages/${Z.id}/toggle-status`);L&&L.success&&(Z.is_active=!Z.is_active,window.$toast&&window.$toast.success(`Langue ${Z.is_active?"activée":"désactivée"}`,"✅ Statut"))}catch(L){console.error("Error toggling language status:",L),window.$toast&&window.$toast.error("Erreur lors du changement de statut","✗ Erreur")}},Ss=async Z=>{if(confirm("Êtes-vous sûr de vouloir supprimer cette langue ?"))try{const L=await w(`/admin/languages/${Z}/delete`);L&&L.success&&(U.value=U.value.filter(Y=>Y.id!==Z),window.$toast&&window.$toast.success("Langue supprimée avec succès","✅ Suppression"))}catch(L){console.error("Error deleting language:",L),window.$toast&&window.$toast.error("Erreur lors de la suppression de la langue","✗ Erreur")}},Pt=()=>{d.value=!1,i.value=!1,I.value=null,Object.assign(A,{name:"",native_name:"",code:"",flag:"",direction:"ltr",is_active:!0})},Is=async()=>{f.value=!0;try{const Z=await p(`/admin/settings/payment-methods/${N.value.id}`,{config:N.value.config,active:N.value.active});Z&&Z.success&&(window.$toast&&window.$toast.success(`Configuration ${N.value.name} sauvegardée`,"✅ Configuration"),Xt())}catch(Z){console.error("Error updating payment method config:",Z),window.$toast&&window.$toast.error("Erreur lors de la sauvegarde de la configuration","✗ Erreur")}finally{f.value=!1}},Xt=()=>{C.value=!1,N.value=null};return ve(()=>{B()}),(Z,L)=>(s(),o("div",lD,[e("div",dD,[L[48]||(L[48]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Paramètres système"),e("p",{class:"mt-2 text-gray-600"},"Configuration et paramètres généraux de la plateforme")],-1)),e("div",uD,[e("button",{onClick:K,class:"admin-btn-secondary"},[g(l(Fe),{class:"w-4 h-4 mr-2"}),L[46]||(L[46]=z(" Actualiser ",-1))]),e("button",{onClick:W,class:"admin-btn-accent"},[g(l(dt),{class:"w-4 h-4 mr-2"}),L[47]||(L[47]=z(" Sauvegarder ",-1))])])]),e("div",cD,[e("div",mD,[e("nav",pD,[(s(),o(ie,null,le(c,Y=>e("button",{key:Y.id,onClick:Ve=>a.value=Y.id,class:te(["w-full text-left px-4 py-3 rounded-lg text-sm font-medium transition-colors flex items-center",a.value===Y.id?"bg-[#0099cc]/10 text-[#0099cc] border border-[#0099cc]/20":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"])},[(s(),ce(Ie(Y.icon),{class:"w-5 h-5 mr-3"})),z(" "+t(Y.name),1)],10,gD)),64))])]),e("div",fD,[e("div",vD,[a.value==="general"?(s(),o("div",xD,[L[56]||(L[56]=e("div",{class:"admin-card-header mb-6"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Paramètres généraux")],-1)),e("form",{onSubmit:_e(S,["prevent"]),class:"space-y-6"},[e("div",bD,[e("div",null,[L[49]||(L[49]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom de la plateforme",-1)),Q(e("input",{"onUpdate:modelValue":L[0]||(L[0]=Y=>n.app_name=Y),type:"text",class:"admin-input",placeholder:"Koumbaya"},null,512),[[ne,n.app_name]])]),e("div",null,[L[50]||(L[50]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"URL de base",-1)),Q(e("input",{"onUpdate:modelValue":L[1]||(L[1]=Y=>n.app_url=Y),type:"url",class:"admin-input",placeholder:"https://koumbaya.com"},null,512),[[ne,n.app_url]])])]),e("div",null,[L[51]||(L[51]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description de la plateforme",-1)),Q(e("textarea",{"onUpdate:modelValue":L[2]||(L[2]=Y=>n.app_description=Y),rows:"3",class:"admin-input",placeholder:"Description de votre plateforme..."},null,512),[[ne,n.app_description]])]),e("div",yD,[e("div",null,[L[52]||(L[52]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email de contact",-1)),Q(e("input",{"onUpdate:modelValue":L[3]||(L[3]=Y=>n.contact_email=Y),type:"email",class:"admin-input",placeholder:"contact@koumbaya.com"},null,512),[[ne,n.contact_email]])]),e("div",null,[L[53]||(L[53]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Téléphone de contact",-1)),g(Cs,{modelValue:n.contact_phone,"onUpdate:modelValue":L[4]||(L[4]=Y=>n.contact_phone=Y),placeholder:"Téléphone de contact","initial-country":"ga"},null,8,["modelValue"])])]),e("div",hD,[e("div",null,[L[54]||(L[54]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Langue par défaut",-1)),Q(e("select",{"onUpdate:modelValue":L[5]||(L[5]=Y=>n.default_language=Y),class:"admin-input"},[(s(!0),o(ie,null,le(b.value,Y=>(s(),o("option",{key:Y.id,value:Y.code},t(Y.name),9,_D))),128))],512),[[me,n.default_language]])]),e("div",null,[L[55]||(L[55]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Pays par défaut",-1)),Q(e("select",{"onUpdate:modelValue":L[6]||(L[6]=Y=>n.default_country=Y),class:"admin-input"},[(s(!0),o(ie,null,le(h.value,Y=>(s(),o("option",{key:Y.id,value:Y.iso_code_2},t(Y.name),9,wD))),128))],512),[[me,n.default_country]])])]),e("div",$D,[e("button",{type:"submit",disabled:f.value,class:"admin-btn-primary disabled:opacity-50"},t(f.value?"Sauvegarde...":"Sauvegarder"),9,kD)])],32)])):T("",!0),a.value==="countries"?(s(),o("div",CD,[e("div",AD,[e("div",PD,[L[58]||(L[58]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Gestion des pays"),e("p",{class:"text-sm text-gray-600"},"Configurez les pays disponibles sur la plateforme")],-1)),e("button",{onClick:L[7]||(L[7]=Y=>V.value=!0),class:"admin-btn-primary flex items-center"},[g(l(_t),{class:"w-4 h-4 mr-2"}),L[57]||(L[57]=z(" Ajouter un pays ",-1))])])]),e("div",ED,[e("div",jD,[Q(e("input",{"onUpdate:modelValue":L[8]||(L[8]=Y=>H.search=Y),type:"text",placeholder:"Rechercher un pays...",class:"admin-input"},null,512),[[ne,H.search]])])]),e("div",SD,[e("table",ID,[L[59]||(L[59]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Pays "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Code "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Devise "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",DD,[(s(!0),o(ie,null,le(ke.value,Y=>(s(),o("tr",{key:Y.id,class:"hover:bg-gray-50"},[e("td",TD,[e("div",MD,[Y.flag?(s(),o("img",{key:0,src:Y.flag,alt:Y.name,class:"w-6 h-4 rounded object-cover mr-3"},null,8,LD)):T("",!0),e("div",VD,t(Y.name),1)])]),e("td",RD,t(Y.iso_code_2),1),e("td",FD,t(Y.currency_code),1),e("td",ND,[e("span",{class:te(["px-2 py-1 text-xs font-medium rounded-full",Y.is_active?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"])},t(Y.is_active?"Actif":"Inactif"),3)]),e("td",zD,[e("div",qD,[e("button",{onClick:Ve=>ae(Y),class:"text-blue-600 hover:text-blue-900"},[g(l(es),{class:"w-4 h-4"})],8,UD),e("button",{onClick:Ve=>rt(Y),class:"text-blue-600 hover:text-blue-900 text-xs"},t(Y.is_active?"Désactiver":"Activer"),9,BD),e("button",{onClick:Ve=>At(Y.id),class:"text-red-600 hover:text-red-900"},[g(l(jt),{class:"w-4 h-4"})],8,OD)])])]))),128))])])])])):T("",!0),a.value==="languages"?(s(),o("div",GD,[e("div",HD,[e("div",KD,[L[61]||(L[61]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900"},"Gestion des langues"),e("p",{class:"text-sm text-gray-600"},"Configurez les langues disponibles sur la plateforme")],-1)),e("button",{onClick:L[9]||(L[9]=Y=>d.value=!0),class:"admin-btn-primary flex items-center"},[g(l(_t),{class:"w-4 h-4 mr-2"}),L[60]||(L[60]=z(" Ajouter une langue ",-1))])])]),e("div",WD,[e("div",JD,[Q(e("input",{"onUpdate:modelValue":L[10]||(L[10]=Y=>j.search=Y),type:"text",placeholder:"Rechercher une langue...",class:"admin-input"},null,512),[[ne,j.search]])])]),e("div",XD,[e("table",YD,[L[62]||(L[62]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Langue "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Code "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Direction "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",QD,[(s(!0),o(ie,null,le(we.value,Y=>(s(),o("tr",{key:Y.id,class:"hover:bg-gray-50"},[e("td",ZD,[e("div",eT,[e("span",tT,t(Y.flag),1),e("div",null,[e("div",sT,t(Y.name),1),e("div",oT,t(Y.native_name),1)])])]),e("td",rT,t(Y.code),1),e("td",aT,t(Y.direction==="rtl"?"Droite à gauche":"Gauche à droite"),1),e("td",nT,[e("span",{class:te(["px-2 py-1 text-xs font-medium rounded-full",Y.is_active?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"])},t(Y.is_active?"Actif":"Inactif"),3)]),e("td",iT,[e("div",lT,[e("button",{onClick:Ve=>As(Y),class:"text-blue-600 hover:text-blue-900"},[g(l(es),{class:"w-4 h-4"})],8,dT),e("button",{onClick:Ve=>js(Y),class:"text-blue-600 hover:text-blue-900 text-xs"},t(Y.is_active?"Désactiver":"Activer"),9,uT),e("button",{onClick:Ve=>Ss(Y.id),class:"text-red-600 hover:text-red-900"},[g(l(jt),{class:"w-4 h-4"})],8,cT)])])]))),128))])])])])):T("",!0),a.value==="payment"?(s(),o("div",mT,[L[68]||(L[68]=e("div",{class:"admin-card-header mb-6"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Paramètres de paiement")],-1)),e("form",{onSubmit:_e(E,["prevent"]),class:"space-y-6"},[e("div",pT,[e("div",null,[L[64]||(L[64]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Devise par défaut",-1)),Q(e("select",{"onUpdate:modelValue":L[11]||(L[11]=Y=>r.default_currency=Y),class:"admin-input"},L[63]||(L[63]=[e("option",{value:"XAF"},"Franc CFA Afrique Centrale (XAF)",-1),e("option",{value:"XOF"},"Franc CFA Afrique de l'Ouest (XOF)",-1),e("option",{value:"EUR"},"Euro (EUR)",-1),e("option",{value:"USD"},"Dollar US (USD)",-1)]),512),[[me,r.default_currency]])]),e("div",null,[L[65]||(L[65]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Commission plateforme (%)",-1)),Q(e("input",{"onUpdate:modelValue":L[12]||(L[12]=Y=>r.platform_commission=Y),type:"number",min:"0",max:"100",step:"0.1",class:"admin-input",placeholder:"5.0"},null,512),[[ne,r.platform_commission,void 0,{number:!0}]])])]),e("div",gT,[L[67]||(L[67]=e("h4",{class:"font-medium text-gray-900"},"Méthodes de paiement actives",-1)),e("div",fT,[(s(!0),o(ie,null,le(P.value,Y=>(s(),o("div",{key:Y.id,class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[e("div",vT,[(s(),ce(Ie(Y.icon),{class:te(["w-6 h-6 mr-3",{"text-green-500":Y.active,"text-gray-400":!Y.active}])},null,8,["class"])),e("div",null,[e("div",xT,[e("p",bT,t(Y.name),1),Y.type==="gateway"?(s(),o("span",yT," Passerelle ")):Y.gateway?(s(),o("span",hT," via "+t(Y.gateway),1)):T("",!0)]),e("p",_T,t(Y.description),1)])]),e("div",wT,[e("label",$T,[Q(e("input",{"onUpdate:modelValue":Ve=>Y.active=Ve,type:"checkbox",class:"sr-only peer"},null,8,kT),[[Ae,Y.active]]),L[66]||(L[66]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#0099cc]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#0099cc]"},null,-1))]),e("button",{onClick:Ve=>J(Y),class:te([{"text-[#0099cc] hover:text-[#0088bb]":Y.type==="gateway"||Y.config,"text-gray-300 cursor-not-allowed":Y.type!=="gateway"&&!Y.config},"text-sm transition-colors"]),disabled:Y.type!=="gateway"&&!Y.config},[g(l(Qe),{class:"w-4 h-4"})],10,CT)])]))),128))])]),e("div",AT,[e("button",{type:"submit",disabled:f.value,class:"admin-btn-primary disabled:opacity-50"},t(f.value?"Sauvegarde...":"Sauvegarder"),9,PT)])],32)])):T("",!0),a.value==="lottery"?(s(),o("div",ET,[L[78]||(L[78]=e("div",{class:"admin-card-header mb-6"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Paramètres des tombolas")],-1)),e("form",{onSubmit:_e(F,["prevent"]),class:"space-y-6"},[e("div",jT,[e("div",null,[L[69]||(L[69]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prix minimum ticket (FCFA)",-1)),Q(e("input",{"onUpdate:modelValue":L[13]||(L[13]=Y=>$.min_ticket_price=Y),type:"number",min:"100",class:"admin-input",placeholder:"1000"},null,512),[[ne,$.min_ticket_price,void 0,{number:!0}]])]),e("div",null,[L[70]||(L[70]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prix maximum ticket (FCFA)",-1)),Q(e("input",{"onUpdate:modelValue":L[14]||(L[14]=Y=>$.max_ticket_price=Y),type:"number",min:"1000",class:"admin-input",placeholder:"100000"},null,512),[[ne,$.max_ticket_price,void 0,{number:!0}]])])]),e("div",ST,[e("div",null,[L[71]||(L[71]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Participants minimum par tombola",-1)),Q(e("input",{"onUpdate:modelValue":L[15]||(L[15]=Y=>$.min_participants=Y),type:"number",min:"2",class:"admin-input",placeholder:"10"},null,512),[[ne,$.min_participants,void 0,{number:!0}]])]),e("div",null,[L[72]||(L[72]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Durée maximum (jours)",-1)),Q(e("input",{"onUpdate:modelValue":L[16]||(L[16]=Y=>$.max_duration_days=Y),type:"number",min:"1",class:"admin-input",placeholder:"30"},null,512),[[ne,$.max_duration_days,void 0,{number:!0}]])])]),e("div",IT,[L[77]||(L[77]=e("h4",{class:"font-medium text-gray-900"},"Options automatiques",-1)),e("div",DT,[e("div",TT,[L[74]||(L[74]=e("div",null,[e("h5",{class:"font-medium text-gray-900"},"Remboursement automatique"),e("p",{class:"text-sm text-gray-600"},"Rembourser automatiquement si pas assez de participants")],-1)),e("label",MT,[Q(e("input",{"onUpdate:modelValue":L[17]||(L[17]=Y=>$.auto_refund=Y),type:"checkbox",class:"sr-only peer"},null,512),[[Ae,$.auto_refund]]),L[73]||(L[73]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#0099cc]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#0099cc]"},null,-1))])]),e("div",LT,[L[76]||(L[76]=e("div",null,[e("h5",{class:"font-medium text-gray-900"},"Tirage automatique"),e("p",{class:"text-sm text-gray-600"},"Effectuer le tirage automatiquement à la date de fin")],-1)),e("label",VT,[Q(e("input",{"onUpdate:modelValue":L[18]||(L[18]=Y=>$.auto_draw=Y),type:"checkbox",class:"sr-only peer"},null,512),[[Ae,$.auto_draw]]),L[75]||(L[75]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#0099cc]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#0099cc]"},null,-1))])])])]),e("div",RT,[e("button",{type:"submit",disabled:f.value,class:"admin-btn-primary disabled:opacity-50"},t(f.value?"Sauvegarde...":"Sauvegarder"),9,FT)])],32)])):T("",!0),a.value==="notifications"?(s(),o("div",NT,[L[83]||(L[83]=e("div",{class:"admin-card-header mb-6"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Paramètres de notifications")],-1)),e("form",{onSubmit:_e(q,["prevent"]),class:"space-y-6"},[e("div",zT,[e("div",null,[L[79]||(L[79]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email expéditeur",-1)),Q(e("input",{"onUpdate:modelValue":L[19]||(L[19]=Y=>M.from_email=Y),type:"email",class:"admin-input",placeholder:"noreply@koumbaya.com"},null,512),[[ne,M.from_email]])]),e("div",null,[L[80]||(L[80]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom expéditeur",-1)),Q(e("input",{"onUpdate:modelValue":L[20]||(L[20]=Y=>M.from_name=Y),type:"text",class:"admin-input",placeholder:"Koumbaya"},null,512),[[ne,M.from_name]])])]),e("div",qT,[L[82]||(L[82]=e("h4",{class:"font-medium text-gray-900"},"Types de notifications automatiques",-1)),e("div",UT,[(s(!0),o(ie,null,le(D.value,Y=>(s(),o("div",{key:Y.id,class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},[e("div",null,[e("p",BT,t(Y.name),1),e("p",OT,t(Y.description),1)]),e("label",GT,[Q(e("input",{"onUpdate:modelValue":Ve=>Y.enabled=Ve,type:"checkbox",class:"sr-only peer"},null,8,HT),[[Ae,Y.enabled]]),L[81]||(L[81]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#0099cc]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#0099cc]"},null,-1))])]))),128))])]),e("div",KT,[e("button",{type:"submit",disabled:f.value,class:"admin-btn-primary disabled:opacity-50"},t(f.value?"Sauvegarde...":"Sauvegarder"),9,WT)])],32)])):T("",!0),a.value==="maintenance"?(s(),o("div",JT,[L[92]||(L[92]=e("div",{class:"admin-card-header mb-6"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Maintenance et sécurité")],-1)),e("div",XT,[e("div",YT,[e("div",QT,[L[85]||(L[85]=e("div",null,[e("h4",{class:"font-medium text-yellow-800"},"Mode maintenance"),e("p",{class:"text-sm text-yellow-700"},"Désactiver temporairement l'accès public à la plateforme")],-1)),e("label",ZT,[Q(e("input",{"onUpdate:modelValue":L[21]||(L[21]=Y=>m.maintenance_mode=Y),type:"checkbox",class:"sr-only peer"},null,512),[[Ae,m.maintenance_mode]]),L[84]||(L[84]=e("div",{class:"w-11 h-6 bg-yellow-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-yellow-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-yellow-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-yellow-600"},null,-1))])]),m.maintenance_mode?(s(),o("div",eM,[L[86]||(L[86]=e("label",{class:"block text-sm font-medium text-yellow-800 mb-2"},"Message de maintenance",-1)),Q(e("textarea",{"onUpdate:modelValue":L[22]||(L[22]=Y=>m.maintenance_message=Y),rows:"2",class:"w-full border border-yellow-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-yellow-500 focus:border-transparent bg-yellow-50",placeholder:"La plateforme est temporairement en maintenance..."},null,512),[[ne,m.maintenance_message]])])):T("",!0)]),e("div",tM,[L[91]||(L[91]=e("h4",{class:"font-medium text-gray-900"},"Actions de maintenance",-1)),e("div",sM,[e("button",{onClick:G,disabled:f.value,class:"admin-btn-secondary justify-center disabled:opacity-50"},[g(l(jt),{class:"w-4 h-4 mr-2"}),L[87]||(L[87]=z(" Vider le cache ",-1))],8,oM),e("button",{onClick:ue,disabled:f.value,class:"admin-btn-secondary justify-center disabled:opacity-50"},[g(l(Qe),{class:"w-4 h-4 mr-2"}),L[88]||(L[88]=z(" Optimiser la BDD ",-1))],8,rM),e("button",{onClick:se,disabled:f.value,class:"admin-btn-secondary justify-center disabled:opacity-50"},[g(l(Ks),{class:"w-4 h-4 mr-2"}),L[89]||(L[89]=z(" Générer sitemap ",-1))],8,aM),e("button",{onClick:fe,disabled:f.value,class:"admin-btn-secondary justify-center disabled:opacity-50"},[g(l(lt),{class:"w-4 h-4 mr-2"}),L[90]||(L[90]=z(" Tester les emails ",-1))],8,nM)])]),e("div",iM,[e("button",{onClick:O,disabled:f.value,class:"admin-btn-primary disabled:opacity-50"},t(f.value?"Sauvegarde...":"Sauvegarder"),9,lM)])])])):T("",!0)])])]),V.value||v.value?(s(),o("div",dM,[e("div",uM,[e("div",cM,[e("h3",mM,t(V.value?"Ajouter un pays":"Modifier le pays"),1)]),e("form",{onSubmit:L[28]||(L[28]=_e(Y=>V.value?X():oe(),["prevent"]))},[e("div",pM,[e("div",null,[L[93]||(L[93]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom *",-1)),Q(e("input",{"onUpdate:modelValue":L[23]||(L[23]=Y=>u.name=Y),type:"text",required:"",class:"admin-input"},null,512),[[ne,u.name]])]),e("div",null,[L[94]||(L[94]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Code *",-1)),Q(e("input",{"onUpdate:modelValue":L[24]||(L[24]=Y=>u.code=Y),type:"text",required:"",maxlength:"2",class:"admin-input"},null,512),[[ne,u.code]])]),e("div",null,[L[95]||(L[95]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Devise",-1)),Q(e("input",{"onUpdate:modelValue":L[25]||(L[25]=Y=>u.currency=Y),type:"text",class:"admin-input"},null,512),[[ne,u.currency]])]),e("div",null,[L[96]||(L[96]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"URL du drapeau",-1)),Q(e("input",{"onUpdate:modelValue":L[26]||(L[26]=Y=>u.flag=Y),type:"url",class:"admin-input"},null,512),[[ne,u.flag]])]),e("div",gM,[Q(e("input",{"onUpdate:modelValue":L[27]||(L[27]=Y=>u.is_active=Y),type:"checkbox",class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[Ae,u.is_active]]),L[97]||(L[97]=e("label",{class:"ml-2 text-sm text-gray-700"},"Actif",-1))])]),e("div",fM,[e("button",{type:"button",onClick:yt,class:"admin-btn-secondary"}," Annuler "),e("button",{type:"submit",disabled:f.value,class:"admin-btn-primary disabled:opacity-50"},[f.value?(s(),o("span",xM,"Enregistrement...")):(s(),o("span",bM,t(V.value?"Créer":"Modifier"),1))],8,vM)])],32)])])):T("",!0),d.value||i.value?(s(),o("div",yM,[e("div",hM,[e("div",_M,[e("h3",wM,t(d.value?"Ajouter une langue":"Modifier la langue"),1)]),e("form",{onSubmit:L[35]||(L[35]=_e(Y=>d.value?Ps():Es(),["prevent"]))},[e("div",$M,[e("div",null,[L[98]||(L[98]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom *",-1)),Q(e("input",{"onUpdate:modelValue":L[29]||(L[29]=Y=>A.name=Y),type:"text",required:"",class:"admin-input"},null,512),[[ne,A.name]])]),e("div",null,[L[99]||(L[99]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom natif",-1)),Q(e("input",{"onUpdate:modelValue":L[30]||(L[30]=Y=>A.native_name=Y),type:"text",class:"admin-input"},null,512),[[ne,A.native_name]])]),e("div",null,[L[100]||(L[100]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Code *",-1)),Q(e("input",{"onUpdate:modelValue":L[31]||(L[31]=Y=>A.code=Y),type:"text",required:"",maxlength:"2",class:"admin-input"},null,512),[[ne,A.code]])]),e("div",null,[L[101]||(L[101]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Drapeau (emoji)",-1)),Q(e("input",{"onUpdate:modelValue":L[32]||(L[32]=Y=>A.flag=Y),type:"text",maxlength:"2",class:"admin-input"},null,512),[[ne,A.flag]])]),e("div",null,[L[103]||(L[103]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Direction",-1)),Q(e("select",{"onUpdate:modelValue":L[33]||(L[33]=Y=>A.direction=Y),class:"admin-input"},L[102]||(L[102]=[e("option",{value:"ltr"},"Gauche à droite",-1),e("option",{value:"rtl"},"Droite à gauche",-1)]),512),[[me,A.direction]])]),e("div",kM,[Q(e("input",{"onUpdate:modelValue":L[34]||(L[34]=Y=>A.is_active=Y),type:"checkbox",class:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"},null,512),[[Ae,A.is_active]]),L[104]||(L[104]=e("label",{class:"ml-2 text-sm text-gray-700"},"Actif",-1))])]),e("div",CM,[e("button",{type:"button",onClick:Pt,class:"admin-btn-secondary"}," Annuler "),e("button",{type:"submit",disabled:f.value,class:"admin-btn-primary disabled:opacity-50"},[f.value?(s(),o("span",PM,"Enregistrement...")):(s(),o("span",EM,t(d.value?"Créer":"Modifier"),1))],8,AM)])],32)])])):T("",!0),C.value?(s(),o("div",jM,[e("div",SM,[e("div",IM,[e("h3",DM," Configuration "+t(N.value?.name),1)]),e("form",{onSubmit:_e(Is,["prevent"])},[e("div",TM,[N.value?.id==="ebilling"?(s(),o("div",MM,[L[110]||(L[110]=pe('<div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"><div class="flex items-start"><div class="flex-shrink-0"><svg class="w-5 h-5 text-blue-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div><div class="ml-3"><h3 class="text-sm font-medium text-blue-800">Configuration eBilling</h3><div class="mt-2 text-sm text-blue-700"><p>eBilling prend en charge Airtel Money et Moov Money au Gabon. Configurez vos identifiants API ci-dessous.</p></div></div></div></div>',1)),e("div",LM,[e("div",null,[L[105]||(L[105]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Merchant ID *",-1)),Q(e("input",{"onUpdate:modelValue":L[36]||(L[36]=Y=>N.value.config.merchant_id=Y),type:"text",required:"",class:"admin-input",placeholder:"Votre Merchant ID eBilling"},null,512),[[ne,N.value.config.merchant_id]])]),e("div",null,[L[107]||(L[107]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Environnement",-1)),Q(e("select",{"onUpdate:modelValue":L[37]||(L[37]=Y=>N.value.config.environment=Y),class:"admin-input"},L[106]||(L[106]=[e("option",{value:"sandbox"},"Test (Sandbox)",-1),e("option",{value:"production"},"Production",-1)]),512),[[me,N.value.config.environment]])])]),e("div",null,[L[108]||(L[108]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Clé API *",-1)),Q(e("input",{"onUpdate:modelValue":L[38]||(L[38]=Y=>N.value.config.api_key=Y),type:"text",required:"",class:"admin-input",placeholder:"Votre clé API eBilling"},null,512),[[ne,N.value.config.api_key]])]),e("div",null,[L[109]||(L[109]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Clé secrète *",-1)),Q(e("input",{"onUpdate:modelValue":L[39]||(L[39]=Y=>N.value.config.secret_key=Y),type:"password",required:"",class:"admin-input",placeholder:"Votre clé secrète eBilling"},null,512),[[ne,N.value.config.secret_key]])]),L[111]||(L[111]=pe('<div class="bg-gray-50 rounded-lg p-4"><h4 class="text-sm font-medium text-gray-900 mb-2">Méthodes supportées via eBilling</h4><div class="flex flex-wrap gap-2"><span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg> Airtel Money </span><span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg> Moov Money </span></div></div>',1))])):T("",!0),N.value?.id==="flutterwave"?(s(),o("div",VM,[L[116]||(L[116]=pe('<div class="bg-purple-50 border border-purple-200 rounded-lg p-4 mb-6"><div class="flex items-start"><div class="flex-shrink-0"><svg class="w-5 h-5 text-purple-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div><div class="ml-3"><h3 class="text-sm font-medium text-purple-800">Configuration Flutterwave</h3><div class="mt-2 text-sm text-purple-700"><p>Flutterwave prend en charge les cartes, mobile money, et virements bancaires à travers l&#39;Afrique.</p></div></div></div></div>',1)),e("div",RM,[e("div",null,[L[112]||(L[112]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Clé publique *",-1)),Q(e("input",{"onUpdate:modelValue":L[40]||(L[40]=Y=>N.value.config.public_key=Y),type:"text",required:"",class:"admin-input",placeholder:"FLWPUBK_TEST-..."},null,512),[[ne,N.value.config.public_key]])]),e("div",null,[L[114]||(L[114]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Environnement",-1)),Q(e("select",{"onUpdate:modelValue":L[41]||(L[41]=Y=>N.value.config.environment=Y),class:"admin-input"},L[113]||(L[113]=[e("option",{value:"sandbox"},"Test (Sandbox)",-1),e("option",{value:"live"},"Production (Live)",-1)]),512),[[me,N.value.config.environment]])])]),e("div",null,[L[115]||(L[115]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Clé secrète *",-1)),Q(e("input",{"onUpdate:modelValue":L[42]||(L[42]=Y=>N.value.config.secret_key=Y),type:"password",required:"",class:"admin-input",placeholder:"FLWSECK_TEST-..."},null,512),[[ne,N.value.config.secret_key]])])])):T("",!0),N.value?.id==="paystack"?(s(),o("div",FM,[L[121]||(L[121]=pe('<div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6"><div class="flex items-start"><div class="flex-shrink-0"><svg class="w-5 h-5 text-green-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg></div><div class="ml-3"><h3 class="text-sm font-medium text-green-800">Configuration Paystack</h3><div class="mt-2 text-sm text-green-700"><p>Paystack prend en charge les cartes, USSD, et virements bancaires principalement au Nigeria et Ghana.</p></div></div></div></div>',1)),e("div",NM,[e("div",null,[L[117]||(L[117]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Clé publique *",-1)),Q(e("input",{"onUpdate:modelValue":L[43]||(L[43]=Y=>N.value.config.public_key=Y),type:"text",required:"",class:"admin-input",placeholder:"pk_test_..."},null,512),[[ne,N.value.config.public_key]])]),e("div",null,[L[119]||(L[119]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Environnement",-1)),Q(e("select",{"onUpdate:modelValue":L[44]||(L[44]=Y=>N.value.config.environment=Y),class:"admin-input"},L[118]||(L[118]=[e("option",{value:"sandbox"},"Test (Sandbox)",-1),e("option",{value:"live"},"Production (Live)",-1)]),512),[[me,N.value.config.environment]])])]),e("div",null,[L[120]||(L[120]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Clé secrète *",-1)),Q(e("input",{"onUpdate:modelValue":L[45]||(L[45]=Y=>N.value.config.secret_key=Y),type:"password",required:"",class:"admin-input",placeholder:"sk_test_..."},null,512),[[ne,N.value.config.secret_key]])])])):T("",!0)]),e("div",zM,[e("button",{type:"button",onClick:Xt,class:"admin-btn-secondary"}," Annuler "),e("button",{type:"submit",disabled:f.value,class:"admin-btn-primary disabled:opacity-50"},[f.value?(s(),o("span",UM,"Sauvegarde...")):(s(),o("span",BM,"Sauvegarder la configuration"))],8,qM)])],32)])])):T("",!0)]))}},GM={class:"space-y-6"},HM={class:"flex justify-between items-center"},KM={class:"flex space-x-3"},WM={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},JM={class:"lg:col-span-1"},XM={class:"admin-card text-center"},YM={class:"p-6"},QM={class:"text-xl font-bold text-gray-900 mb-1"},ZM={class:"text-gray-600 mb-2"},eL={class:"mt-4 p-3 bg-gray-50 rounded-lg"},tL={class:"text-sm text-gray-900"},sL={class:"border-t border-gray-200 px-6 py-4"},oL={class:"grid grid-cols-2 gap-4 text-center"},rL={class:"text-2xl font-bold text-gray-900"},aL={class:"text-2xl font-bold text-gray-900"},nL={class:"admin-card mt-6"},iL={class:"p-6 space-y-4"},lL={class:"flex items-center justify-between"},dL={class:"flex items-center"},uL={class:"text-sm font-medium text-gray-900"},cL={class:"flex items-center justify-between"},mL={class:"flex items-center"},pL={class:"flex items-center justify-between"},gL={class:"flex items-center"},fL={class:"text-sm font-medium text-gray-900"},vL={class:"lg:col-span-2 space-y-6"},xL={class:"admin-card"},bL={class:"p-6"},yL={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},hL={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},_L={class:"flex justify-end"},wL=["disabled"],$L={class:"admin-card"},kL={class:"p-6 space-y-6"},CL={class:"border border-gray-200 rounded-lg p-4"},AL={class:"font-medium text-gray-900 mb-3 flex items-center"},PL={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},EL={class:"flex justify-end"},jL=["disabled"],SL={class:"border border-gray-200 rounded-lg p-4"},IL={class:"flex items-center justify-between mb-3"},DL={class:"font-medium text-gray-900 flex items-center"},TL={class:"relative inline-flex items-center cursor-pointer"},ML={class:"text-sm text-gray-600"},LL={class:"border border-gray-200 rounded-lg p-4"},VL={class:"font-medium text-gray-900 mb-3 flex items-center"},RL={class:"space-y-3"},FL={class:"flex items-center"},NL={class:"text-sm font-medium text-gray-900"},zL={class:"text-xs text-gray-600"},qL=["onClick"],UL={key:1,class:"text-xs text-blue-600 font-medium"},BL={class:"admin-card"},OL={class:"p-6 space-y-6"},GL={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},HL={class:"space-y-4"},KL={class:"space-y-3"},WL={class:"font-medium text-gray-900"},JL={class:"text-sm text-gray-600"},XL={class:"relative inline-flex items-center cursor-pointer"},YL=["onUpdate:modelValue"],QL={class:"flex justify-end"},ZL=["disabled"],eV={__name:"Profile",setup(_){const y=Pe(),{get:w,post:p,put:f}=ge(),a=R(!1);R(!1),R(!1),R(null);const c=xe({first_name:y.user?.first_name||"",last_name:y.user?.last_name||"",email:y.user?.email||"",phone:"",position:"",bio:"",timezone:"Africa/Libreville",language:"fr",two_factor_enabled:!1,avatar_url:y.user?.avatar_url||null}),n=xe({current_password:"",new_password:"",confirm_password:""}),r=de(()=>{const j=y.user;return j&&j.roles&&Array.isArray(j.roles)&&j.roles.length>0?j.roles.map(b=>{switch(b.name){case"Business Individual":return"Vendeur Individuel (simple-dashboard)";case"Business Enterprise":return"Vendeur Entreprise (dashboard complet)";case"Business":return"Vendeur (legacy)";case"Particulier":return"Client";case"Admin":return"Administrateur";case"Super Admin":return"Super Administrateur";case"Agent":return"Agent";default:return b.name}}).join(", "):"Non défini"}),P=R({actions_count:0,login_streak:0,last_login:null,created_at:null}),$=R([]),M=R([]),D=(j,h,b)=>{j.response?.status===404?(console.info(`API ${h} pas encore implémentée, simulation du succès`),window.$toast&&window.$toast.info(`${b} (API en développement)`,"ℹ️ Développement")):window.$toast&&window.$toast.error(`Erreur lors de ${h.toLowerCase()}`,"✗ Erreur")},m=async()=>{a.value=!0;try{const j=await w("/admin/profile");j&&j.success&&j.data&&(Object.assign(c,j.data.profile),P.value=j.data.stats||{},j.data.sessions&&($.value=j.data.sessions))}catch(j){console.error("Error loading profile:",j),j.response?.status!==404?window.$toast&&window.$toast.error("Erreur lors du chargement du profil","✗ Erreur"):(console.info("API /admin/profile pas encore implémentée, utilisation des données par défaut"),y.user&&Object.assign(c,{first_name:y.user.first_name||"",last_name:y.user.last_name||"",email:y.user.email||"",phone:c.phone,position:c.position,bio:c.bio,timezone:c.timezone,language:c.language,two_factor_enabled:c.two_factor_enabled,avatar_url:y.user.avatar_url||null}),P.value={actions_count:127,login_streak:12,last_login:new Date(Date.now()-1e3*60*30).toISOString(),created_at:new Date(Date.now()-1e3*60*60*24*90).toISOString()},$.value=[{id:1,device:"Chrome sur Mac",location:"Libreville, Gabon",last_activity:new Date,current:!0}],M.value=[{id:"new_user_registration",name:"Nouveaux utilisateurs",description:"Notification lors de l'inscription d'un nouvel utilisateur",enabled:!0},{id:"suspicious_activity",name:"Activité suspecte",description:"Alertes de sécurité et activités inhabituelles",enabled:!0}])}finally{a.value=!1}},k=async()=>{a.value=!0;try{const j=await f("/admin/profile",c);j&&j.success&&(await y.refreshUser(),window.$toast&&window.$toast.success("Informations mises à jour avec succès","✅ Profil"))}catch(j){console.error("Error updating profile:",j),D(j,"/admin/profile","Informations mises à jour avec succès")}finally{a.value=!1}},U=async()=>{if(n.new_password!==n.confirm_password){window.$toast&&window.$toast.error("Les mots de passe ne correspondent pas","✗ Validation");return}if(n.new_password.length<8){window.$toast&&window.$toast.error("Le mot de passe doit contenir au moins 8 caractères","✗ Validation");return}a.value=!0;try{const j=await f("/admin/profile/password",{current_password:n.current_password,new_password:n.new_password});j&&j.success&&(n.current_password="",n.new_password="",n.confirm_password="",window.$toast&&window.$toast.success("Mot de passe mis à jour avec succès","✅ Sécurité"))}catch(j){if(console.error("Error updating password:",j),window.$toast){const h=j.response?.data?.message||"Erreur lors du changement de mot de passe";window.$toast.error(h,"✗ Erreur")}}finally{a.value=!1}},V=async()=>{a.value=!0;try{const j=await f("/admin/profile/preferences",{timezone:c.timezone,language:c.language,notifications:M.value});j&&j.success&&window.$toast&&window.$toast.success("Préférences sauvegardées avec succès","✅ Préférences")}catch(j){console.error("Error updating preferences:",j),window.$toast&&window.$toast.error("Erreur lors de la sauvegarde des préférences","✗ Erreur")}finally{a.value=!1}},v=async()=>{a.value=!0;try{const j=await p("/admin/profile/2fa/toggle",{enabled:c.two_factor_enabled});if(j&&j.success){const h=c.two_factor_enabled?"Authentification 2FA activée":"Authentification 2FA désactivée";window.$toast&&window.$toast.success(h,"✅ Sécurité")}}catch(j){console.error("Error toggling 2FA:",j),c.two_factor_enabled=!c.two_factor_enabled,window.$toast&&window.$toast.error("Erreur lors de la modification 2FA","✗ Erreur")}finally{a.value=!1}},d=async j=>{if(confirm("Voulez-vous vraiment déconnecter cette session ?"))try{const h=await p("/admin/profile/sessions/terminate",{session_id:j});h&&h.success&&($.value=$.value.filter(b=>b.id!==j),window.$toast&&window.$toast.success("Session déconnectée","✅ Sécurité"))}catch(h){console.error("Error terminating session:",h),window.$toast&&window.$toast.error("Erreur lors de la déconnexion","✗ Erreur")}},i=async()=>{if(confirm("Voulez-vous vraiment déconnecter toutes les autres sessions ?"))try{const j=await p("/admin/profile/sessions/terminate-all");j&&j.success&&($.value=$.value.filter(h=>h.current),window.$toast&&window.$toast.success("Toutes les sessions ont été déconnectées","✅ Sécurité"))}catch(j){console.error("Error terminating sessions:",j),window.$toast&&window.$toast.error("Erreur lors de la déconnexion","✗ Erreur")}},C=j=>{c.avatar_url=j.avatar_url,y.updateUser({avatar_url:j.avatar_url}),window.$toast&&window.$toast.success("Photo de profil mise à jour avec succès","✅ Profil")},x=j=>{console.error("Avatar upload error:",j),window.$toast&&window.$toast.error("Erreur lors de l'upload de l'avatar","✗ Erreur")},I=async()=>{await m(),window.$toast&&window.$toast.info("Profil rechargé","ℹ️ Information")},N=async()=>{try{const j=await w("/admin/profile/activity-log/export");if(j&&j.success){const h=new Blob([JSON.stringify(j.data,null,2)],{type:"application/json"}),b=URL.createObjectURL(h),ee=document.createElement("a");ee.href=b,ee.download=`admin-activity-log-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(ee),ee.click(),document.body.removeChild(ee),URL.revokeObjectURL(b),window.$toast&&window.$toast.success("Journal d'activité téléchargé","✅ Export")}}catch(j){console.error("Error downloading activity log:",j),D(j,"/admin/profile/activity-log/export","Journal d'activité téléchargé")}},u=()=>P.value.last_login?new Date(P.value.last_login).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Jamais",A=()=>P.value.created_at?new Date(P.value.created_at).toLocaleDateString("fr-FR",{month:"long",year:"numeric"}):"N/A",H=j=>{const b=Math.floor((new Date-j)/1e3);return b<60?"À l'instant":b<3600?`il y a ${Math.floor(b/60)} min`:b<86400?`il y a ${Math.floor(b/3600)} h`:`il y a ${Math.floor(b/86400)} j`};return ve(()=>{m()}),(j,h)=>(s(),o("div",GM,[e("div",HM,[h[14]||(h[14]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Profil Administrateur"),e("p",{class:"mt-2 text-gray-600"},"Gérez vos informations personnelles et paramètres de compte")],-1)),e("div",KM,[e("button",{onClick:I,class:"admin-btn-secondary"},[g(l(Fe),{class:"w-4 h-4 mr-2"}),h[12]||(h[12]=z(" Actualiser ",-1))]),e("button",{onClick:N,class:"admin-btn-accent"},[g(l(dt),{class:"w-4 h-4 mr-2"}),h[13]||(h[13]=z(" Journal d'activité ",-1))])])]),e("div",WM,[e("div",JM,[e("div",XM,[e("div",YM,[g(ks,{"current-avatar-url":c.avatar_url,"upload-endpoint":"/admin/profile/image","field-name":"avatar","alt-text":"Photo de profil administrateur","help-text":"Cliquez pour modifier votre photo de profil",onSuccess:C,onError:x},null,8,["current-avatar-url"]),e("h2",QM,t(c.first_name)+" "+t(c.last_name),1),e("p",ZM,t(c.email),1),h[16]||(h[16]=e("span",{class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},[e("div",{class:"w-2 h-2 bg-green-500 rounded-full mr-2"}),z(" Administrateur actif ")],-1)),e("div",eL,[h[15]||(h[15]=e("p",{class:"text-xs font-medium text-gray-700 mb-1"},"Rôle",-1)),e("p",tL,t(r.value),1)])]),e("div",sL,[e("div",oL,[e("div",null,[e("p",rL,t(P.value.actions_count||0),1),h[17]||(h[17]=e("p",{class:"text-sm text-gray-600"},"Actions ce mois",-1))]),e("div",null,[e("p",aL,t(P.value.login_streak||0),1),h[18]||(h[18]=e("p",{class:"text-sm text-gray-600"},"Jours consécutifs",-1))])])])]),e("div",nL,[h[23]||(h[23]=e("div",{class:"admin-card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Statistiques rapides")],-1)),e("div",iL,[e("div",lL,[e("div",dL,[g(l(Te),{class:"w-5 h-5 text-blue-500 mr-3"}),h[19]||(h[19]=e("span",{class:"text-sm text-gray-700"},"Dernière connexion",-1))]),e("span",uL,t(u()),1)]),e("div",cL,[e("div",mL,[g(l(ut),{class:"w-5 h-5 text-green-500 mr-3"}),h[20]||(h[20]=e("span",{class:"text-sm text-gray-700"},"Privilèges",-1))]),h[21]||(h[21]=e("span",{class:"text-sm font-medium text-gray-900"},"Super Admin",-1))]),e("div",pL,[e("div",gL,[g(l(Ot),{class:"w-5 h-5 text-purple-500 mr-3"}),h[22]||(h[22]=e("span",{class:"text-sm text-gray-700"},"Membre depuis",-1))]),e("span",fL,t(A()),1)])])])]),e("div",vL,[e("div",xL,[h[30]||(h[30]=e("div",{class:"admin-card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Informations personnelles")],-1)),e("div",bL,[e("form",{onSubmit:_e(k,["prevent"]),class:"space-y-6"},[e("div",yL,[e("div",null,[h[24]||(h[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Prénom",-1)),Q(e("input",{"onUpdate:modelValue":h[0]||(h[0]=b=>c.first_name=b),type:"text",class:"admin-input",required:""},null,512),[[ne,c.first_name]])]),e("div",null,[h[25]||(h[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nom",-1)),Q(e("input",{"onUpdate:modelValue":h[1]||(h[1]=b=>c.last_name=b),type:"text",class:"admin-input",required:""},null,512),[[ne,c.last_name]])])]),e("div",null,[h[26]||(h[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email",-1)),Q(e("input",{"onUpdate:modelValue":h[2]||(h[2]=b=>c.email=b),type:"email",class:"admin-input",required:""},null,512),[[ne,c.email]])]),e("div",hL,[e("div",null,[h[27]||(h[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Téléphone",-1)),g(Cs,{modelValue:c.phone,"onUpdate:modelValue":h[3]||(h[3]=b=>c.phone=b),placeholder:"Numéro de téléphone","initial-country":"ga"},null,8,["modelValue"])]),e("div",null,[h[28]||(h[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Poste/Fonction",-1)),Q(e("input",{"onUpdate:modelValue":h[4]||(h[4]=b=>c.position=b),type:"text",class:"admin-input",placeholder:"Administrateur système"},null,512),[[ne,c.position]])])]),e("div",null,[h[29]||(h[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Bio",-1)),Q(e("textarea",{"onUpdate:modelValue":h[5]||(h[5]=b=>c.bio=b),rows:"3",class:"admin-input",placeholder:"Présentez-vous en quelques mots..."},null,512),[[ne,c.bio]])]),e("div",_L,[e("button",{type:"submit",disabled:a.value,class:"admin-btn-primary disabled:opacity-50"},t(a.value?"Sauvegarde...":"Sauvegarder les modifications"),9,wL)])],32)])]),e("div",$L,[h[39]||(h[39]=e("div",{class:"admin-card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Sécurité et confidentialité")],-1)),e("div",kL,[e("div",CL,[e("h4",AL,[g(l(qt),{class:"w-5 h-5 mr-2 text-red-500"}),h[31]||(h[31]=z(" Changer le mot de passe ",-1))]),e("form",{onSubmit:_e(U,["prevent"]),class:"space-y-4"},[e("div",null,[h[32]||(h[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mot de passe actuel",-1)),Q(e("input",{"onUpdate:modelValue":h[6]||(h[6]=b=>n.current_password=b),type:"password",class:"admin-input",required:""},null,512),[[ne,n.current_password]])]),e("div",PL,[e("div",null,[h[33]||(h[33]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Nouveau mot de passe",-1)),Q(e("input",{"onUpdate:modelValue":h[7]||(h[7]=b=>n.new_password=b),type:"password",class:"admin-input",minlength:"8",required:""},null,512),[[ne,n.new_password]])]),e("div",null,[h[34]||(h[34]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Confirmer le mot de passe",-1)),Q(e("input",{"onUpdate:modelValue":h[8]||(h[8]=b=>n.confirm_password=b),type:"password",class:"admin-input",required:""},null,512),[[ne,n.confirm_password]])])]),e("div",EL,[e("button",{type:"submit",disabled:a.value,class:"admin-btn-danger disabled:opacity-50"},t(a.value?"Mise à jour...":"Mettre à jour le mot de passe"),9,jL)])],32)]),e("div",SL,[e("div",IL,[e("h4",DL,[g(l(mt),{class:"w-5 h-5 mr-2 text-blue-500"}),h[35]||(h[35]=z(" Authentification à deux facteurs (2FA) ",-1))]),e("label",TL,[Q(e("input",{"onUpdate:modelValue":h[9]||(h[9]=b=>c.two_factor_enabled=b),type:"checkbox",class:"sr-only peer",onChange:v},null,544),[[Ae,c.two_factor_enabled]]),h[36]||(h[36]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#0099cc]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#0099cc]"},null,-1))])]),e("p",ML,t(c.two_factor_enabled?"L'authentification à deux facteurs est activée pour votre compte.":"Activez l'authentification à deux facteurs pour renforcer la sécurité de votre compte."),1)]),e("div",LL,[e("h4",VL,[g(l(cs),{class:"w-5 h-5 mr-2 text-yellow-500"}),h[37]||(h[37]=z(" Sessions actives ",-1))]),e("div",RL,[(s(!0),o(ie,null,le($.value,b=>(s(),o("div",{key:b.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[e("div",FL,[h[38]||(h[38]=e("div",{class:"w-2 h-2 bg-green-500 rounded-full mr-3"},null,-1)),e("div",null,[e("p",NL,t(b.device),1),e("p",zL,t(b.location)+" • "+t(H(b.last_activity)),1)])]),b.current?(s(),o("span",UL,"Session actuelle")):(s(),o("button",{key:0,onClick:ee=>d(b.id),class:"text-red-600 hover:text-red-900 text-sm"}," Déconnecter ",8,qL))]))),128))]),e("div",{class:"mt-4 flex justify-end"},[e("button",{onClick:i,class:"admin-btn-danger text-sm"}," Déconnecter toutes les autres sessions ")])])])]),e("div",BL,[h[46]||(h[46]=e("div",{class:"admin-card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Préférences d'administration")],-1)),e("div",OL,[e("div",GL,[e("div",null,[h[41]||(h[41]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Fuseau horaire",-1)),Q(e("select",{"onUpdate:modelValue":h[10]||(h[10]=b=>c.timezone=b),class:"admin-input"},h[40]||(h[40]=[pe('<option value="Africa/Libreville">Afrique/Libreville (WAT)</option><option value="UTC">UTC (Temps universel)</option><option value="Africa/Abidjan">Afrique/Abidjan (GMT)</option><option value="Europe/Paris">Europe/Paris (CET)</option><option value="America/New_York">Amérique/New York (EST)</option>',5)]),512),[[me,c.timezone]])]),e("div",null,[h[43]||(h[43]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Langue",-1)),Q(e("select",{"onUpdate:modelValue":h[11]||(h[11]=b=>c.language=b),class:"admin-input"},h[42]||(h[42]=[e("option",{value:"fr"},"Français",-1),e("option",{value:"en"},"English",-1)]),512),[[me,c.language]])])]),e("div",HL,[h[45]||(h[45]=e("h4",{class:"font-medium text-gray-900"},"Notifications d'administration",-1)),e("div",KL,[(s(!0),o(ie,null,le(M.value,b=>(s(),o("div",{key:b.id,class:"flex items-center justify-between"},[e("div",null,[e("p",WL,t(b.name),1),e("p",JL,t(b.description),1)]),e("label",XL,[Q(e("input",{"onUpdate:modelValue":ee=>b.enabled=ee,type:"checkbox",class:"sr-only peer"},null,8,YL),[[Ae,b.enabled]]),h[44]||(h[44]=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#0099cc]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-[#0099cc]"},null,-1))])]))),128))])]),e("div",QL,[e("button",{onClick:V,disabled:a.value,class:"admin-btn-primary disabled:opacity-50"},t(a.value?"Sauvegarde...":"Sauvegarder les préférences"),9,ZL)])])])])])]))}},tV={class:"fixed inset-0 z-50 overflow-y-auto"},sV={class:"flex min-h-screen items-center justify-center p-4"},oV={class:"relative bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden"},rV={class:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"},aV={class:"text-sm text-gray-500 mt-1"},nV={class:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]"},iV={class:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 mb-6 border border-blue-200"},lV={class:"grid grid-cols-3 gap-4"},dV={class:"text-3xl font-bold text-blue-900"},uV={class:"text-3xl font-bold text-blue-900"},cV={class:"text-3xl font-bold text-green-700"},mV={class:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6"},pV={class:"flex"},gV={key:0,class:"text-center py-12"},fV={key:1,class:"space-y-4"},vV={class:"border border-gray-200 rounded-lg overflow-hidden"},xV={class:"min-w-full divide-y divide-gray-200"},bV={class:"bg-white divide-y divide-gray-200"},yV={class:"px-4 py-3"},hV={class:"flex items-center"},_V={class:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center mr-3"},wV={class:"text-sm font-medium text-gray-900"},$V={class:"text-xs text-gray-500"},kV={class:"px-4 py-3"},CV={class:"text-sm font-mono text-gray-900"},AV={class:"text-xs text-gray-500"},PV={class:"px-4 py-3"},EV={class:"text-sm text-gray-900"},jV={class:"px-4 py-3 text-right"},SV={class:"text-sm font-medium text-gray-900"},IV={class:"px-4 py-3 text-right"},DV={class:"text-sm font-bold text-green-700"},TV={key:0,class:"text-xs text-gray-500"},MV={class:"bg-gray-100"},LV={class:"px-4 py-3 text-right font-bold text-gray-900"},VV={class:"px-4 py-3 text-right font-bold text-green-700"},RV={key:2,class:"text-center py-12"},FV={key:3,class:"mt-4 bg-red-50 border border-red-200 rounded-lg p-4"},NV={class:"flex"},zV={class:"text-sm text-red-800"},qV={class:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex gap-3"},UV=["disabled"],BV={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},OV={__name:"LotteryRefundModal",props:{lottery:{type:Object,required:!0}},emits:["close","success"],setup(_,{emit:y}){const w=_,p=y,{get:f,post:a}=ge(),c=R([]),n=R(!1),r=R(!1),P=R(""),$=de(()=>c.value.reduce((v,d)=>v+parseFloat(d.amount||0),0)),M=de(()=>c.value.reduce((v,d)=>v+parseFloat(d.refund_amount||0),0)),D=async()=>{n.value=!0,P.value="";try{const v=await f(`/admin/lotteries/${w.lottery.id}/payments`);if(v&&v.success)c.value=v.payments||v.data||[];else throw new Error(v.message||"Erreur lors du chargement des paiements")}catch(v){console.error("Error loading payments:",v),P.value=v.response?.data?.message||"Erreur lors du chargement des paiements"}finally{n.value=!1}},m=async()=>{if(confirm(`Confirmer le remboursement de ${c.value.length} paiement(s) pour un total de ${U(M.value)} ?`)){r.value=!0,P.value="";try{const v=await a("/admin/refunds/process-automatic",{lottery_id:w.lottery.id,dry_run:!1});if(v&&v.success)window.$toast&&window.$toast.success(`${c.value.length} remboursement(s) traité(s) avec succès`,"✅ Remboursement"),p("success",v),k();else throw new Error(v.message||"Erreur lors du traitement")}catch(v){console.error("Error processing refunds:",v),P.value=v.response?.data?.message||"Erreur lors du traitement des remboursements",window.$toast&&window.$toast.error(P.value,"✗ Erreur")}finally{r.value=!1}}},k=()=>{p("close")},U=v=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(v||0)+" FCFA",V=v=>v?new Date(v).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return ve(()=>{D()}),(v,d)=>(s(),o("div",tV,[e("div",sV,[e("div",{class:"fixed inset-0 bg-black/40 transition-opacity",onClick:k}),e("div",oV,[e("div",rV,[e("div",null,[d[0]||(d[0]=e("h2",{class:"text-2xl font-bold text-gray-900"},"Détails du remboursement",-1)),e("p",aV,t(_.lottery.lottery_number)+" - "+t(_.lottery.product_title),1)]),e("button",{onClick:k,class:"text-gray-400 hover:text-gray-600 transition-colors"},[g(l(Le),{class:"h-6 w-6"})])]),e("div",nV,[e("div",iV,[e("div",lV,[e("div",null,[d[1]||(d[1]=e("p",{class:"text-sm text-blue-700 font-medium mb-1"},"Total participants",-1)),e("p",dV,t(c.value.length),1)]),e("div",null,[d[2]||(d[2]=e("p",{class:"text-sm text-blue-700 font-medium mb-1"},"Montant total collecté",-1)),e("p",uV,t(U($.value)),1)]),e("div",null,[d[3]||(d[3]=e("p",{class:"text-sm text-blue-700 font-medium mb-1"},"Montant à rembourser",-1)),e("p",cV,t(U(M.value)),1)])])]),e("div",mV,[e("div",pV,[g(l(We),{class:"h-5 w-5 text-amber-400 mr-3 flex-shrink-0 mt-0.5"}),d[4]||(d[4]=e("div",{class:"text-sm text-amber-800"},[e("p",{class:"font-medium mb-1"},"Calcul du remboursement"),e("p",null,[z("Le montant remboursé correspond au prix du ticket payé par le client, "),e("strong",null,"sans les frais Koumbaya et la marge du marchand"),z(".")])],-1))])]),n.value?(s(),o("div",gV,d[5]||(d[5]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"},null,-1),e("p",{class:"text-gray-600"},"Chargement des paiements...",-1)]))):c.value.length>0?(s(),o("div",fV,[d[8]||(d[8]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Liste des paiements à rembourser",-1)),e("div",vV,[e("table",xV,[d[7]||(d[7]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Client"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Commande"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Téléphone"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Montant payé"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"À rembourser")])],-1)),e("tbody",bV,[(s(!0),o(ie,null,le(c.value,i=>(s(),o("tr",{key:i.id,class:"hover:bg-gray-50"},[e("td",yV,[e("div",hV,[e("div",_V,[g(l(ze),{class:"h-4 w-4 text-blue-600"})]),e("div",null,[e("p",wV,t(i.user?.first_name)+" "+t(i.user?.last_name),1),e("p",$V,t(i.user?.email),1)])])]),e("td",kV,[e("p",CV,t(i.order_number||"N/A"),1),e("p",AV,t(V(i.created_at)),1)]),e("td",PV,[e("p",EV,t(i.user?.phone||"N/A"),1)]),e("td",jV,[e("p",SV,t(U(i.amount)),1)]),e("td",IV,[e("p",DV,t(U(i.refund_amount)),1),i.koumbaya_fees>0?(s(),o("p",TV," -"+t(U(i.koumbaya_fees))+" frais ",1)):T("",!0)])]))),128))]),e("tfoot",MV,[e("tr",null,[d[6]||(d[6]=e("td",{colspan:"3",class:"px-4 py-3 text-right font-semibold text-gray-900"},"Total",-1)),e("td",LV,t(U($.value)),1),e("td",VV,t(U(M.value)),1)])])])])])):(s(),o("div",RV,[g(l(Ge),{class:"mx-auto h-12 w-12 text-gray-400 mb-4"}),d[9]||(d[9]=e("p",{class:"text-gray-600"},"Aucun paiement trouvé pour cette tombola",-1))])),P.value?(s(),o("div",FV,[e("div",NV,[g(l(Se),{class:"h-5 w-5 text-red-400 mr-2"}),e("p",zV,t(P.value),1)])])):T("",!0)]),e("div",qV,[e("button",{onClick:k,class:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 font-medium transition-colors"}," Annuler "),e("button",{onClick:m,disabled:r.value||c.value.length===0,class:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[r.value?(s(),o("span",BV)):(s(),ce(l(Ge),{key:1,class:"h-5 w-5"})),z(" "+t(r.value?"Traitement en cours...":`Rembourser ${c.value.length} paiement(s)`),1)],8,UV)])])])]))}},GV={class:"fixed inset-0 z-50 overflow-y-auto"},HV={class:"flex min-h-screen items-center justify-center p-4"},KV={class:"relative bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden"},WV={class:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"},JV={class:"text-sm text-gray-500 mt-1"},XV={class:"p-6 overflow-y-auto max-h-[calc(90vh-180px)] space-y-6"},YV={class:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200"},QV={class:"flex items-center justify-between"},ZV={class:"text-4xl font-bold text-blue-900"},eR={class:"flex flex-col items-end gap-2"},tR={key:0,class:"px-3 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full"},sR={class:"bg-white border border-gray-200 rounded-lg p-4"},oR={class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},rR={class:"grid grid-cols-2 gap-4"},aR={class:"font-medium text-gray-900"},nR={class:"text-sm text-gray-900"},iR={class:"text-sm text-gray-900"},lR={key:0},dR={class:"text-sm font-mono text-gray-900"},uR={class:"grid grid-cols-2 gap-4"},cR={class:"bg-white border border-gray-200 rounded-lg p-4"},mR={class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},pR={class:"space-y-2"},gR={class:"font-medium text-gray-900"},fR={class:"text-sm text-gray-900"},vR={class:"bg-white border border-gray-200 rounded-lg p-4"},xR={class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},bR={class:"space-y-2"},yR={class:"font-medium text-gray-900 font-mono"},hR={class:"text-sm text-gray-900"},_R={class:"bg-white border border-gray-200 rounded-lg p-4"},wR={class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},$R={class:"grid grid-cols-3 gap-4"},kR={class:"font-medium text-gray-900"},CR={key:0},AR={class:"text-sm font-mono text-gray-900"},PR={key:1},ER={class:"text-sm text-gray-900"},jR={key:0,class:"bg-amber-50 border border-amber-200 rounded-lg p-4"},SR={class:"text-sm font-semibold text-amber-900 mb-3 flex items-center gap-2"},IR={class:"grid grid-cols-3 gap-4"},DR={class:"font-medium text-amber-900"},TR={class:"font-medium text-amber-900"},MR={class:"font-medium text-green-700"},LR={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},VR={class:"text-sm font-semibold text-blue-900 mb-2 flex items-center gap-2"},RR={class:"text-sm text-blue-800"},FR={key:1,class:"bg-red-50 border border-red-200 rounded-lg p-4"},NR={class:"text-sm font-semibold text-red-900 mb-2 flex items-center gap-2"},zR={class:"text-sm text-red-800 font-mono whitespace-pre-wrap"},qR={key:0,class:"text-xs text-red-600 mt-2"},UR={key:2,class:"bg-gray-50 border border-gray-200 rounded-lg p-4"},BR={class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},OR={class:"grid grid-cols-2 gap-3 text-sm"},GR={class:"font-mono text-gray-900"},HR={key:0},KR={class:"font-mono text-gray-900"},WR={key:1},JR={class:"text-gray-900"},XR={key:2},YR={class:"text-gray-900"},QR={class:"bg-white border border-gray-200 rounded-lg p-4"},ZR={class:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2"},eF={class:"space-y-3"},tF={class:"flex items-start gap-3"},sF={class:"flex-1"},oF={class:"text-xs text-gray-500"},rF={key:0,class:"flex items-start gap-3"},aF={class:"flex-1"},nF={class:"text-xs text-gray-500"},iF={key:1,class:"flex items-start gap-3"},lF={class:"flex-1"},dF={class:"text-xs text-gray-500"},uF={key:2,class:"flex items-start gap-3"},cF={class:"flex-1"},mF={class:"text-xs text-gray-500"},pF={key:3,class:"flex items-start gap-3"},gF={class:"flex-1"},fF={class:"text-xs text-gray-500"},vF={key:3,class:"bg-gray-50 border border-gray-200 rounded-lg p-4"},xF={class:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2"},bF={class:"text-sm text-gray-700 whitespace-pre-wrap"},yF={class:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex gap-3"},hF=["disabled"],_F={key:1,class:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"},wF={__name:"RefundDetailModal",props:{refund:{type:Object,required:!0}},emits:["close","refund-updated"],setup(_,{emit:y}){const w=_,p=y,f=R(!1),a=()=>{p("close")},c=async()=>{if(confirm("Êtes-vous sûr de vouloir relancer ce remboursement ?")){f.value=!0;try{const{post:D}=ge(),m=await D(`/admin/refunds/${w.refund.id}/retry`);if(m.success)window.$toast&&window.$toast.success(m.message||"Remboursement relancé avec succès","✅ Succès"),p("refund-updated",m.refund),setTimeout(()=>{a()},1500);else throw new Error(m.message||"Erreur lors de la relance")}catch(D){console.error("Error retrying refund:",D),window.$toast&&window.$toast.error(D.response?.data?.message||D.message||"Erreur lors de la relance du remboursement","🚫 Erreur")}finally{f.value=!1}}},n=D=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(D||0)+" FCFA",r=D=>D?new Date(D).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",P=D=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",processed:"bg-purple-100 text-purple-800",completed:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"})[D]||"bg-gray-100 text-gray-800",$=D=>({pending:"En attente",approved:"Approuvé",processed:"En cours",completed:"Terminé",rejected:"Rejeté"})[D]||D,M=D=>({mobile_money:"Mobile Money",wallet_credit:"Crédit Portefeuille",bank_transfer:"Virement Bancaire",cash:"Espèces"})[D]||D;return(D,m)=>(s(),o("div",GV,[e("div",HV,[e("div",{class:"fixed inset-0 bg-black/40 transition-opacity",onClick:a}),e("div",KV,[e("div",WV,[e("div",null,[m[0]||(m[0]=e("h2",{class:"text-2xl font-bold text-gray-900"},"Détails du remboursement",-1)),e("p",JV,t(_.refund.refund_number),1)]),e("button",{onClick:a,class:"text-gray-400 hover:text-gray-600 transition-colors"},[g(l(Le),{class:"h-6 w-6"})])]),e("div",XV,[e("div",YV,[e("div",QV,[e("div",null,[m[1]||(m[1]=e("p",{class:"text-sm text-blue-700 font-medium mb-1"},"Montant du remboursement",-1)),e("p",ZV,t(n(_.refund.amount)),1)]),e("div",eR,[e("span",{class:te([P(_.refund.status),"px-4 py-2 text-sm font-medium rounded-full"])},t($(_.refund.status)),3),_.refund.auto_processed?(s(),o("span",tR," Automatique ")):T("",!0)])])]),e("div",sR,[e("h3",oR,[g(l(ze),{class:"h-5 w-5 text-blue-600"}),m[2]||(m[2]=z(" Informations du client ",-1))]),e("div",rR,[e("div",null,[m[3]||(m[3]=e("p",{class:"text-xs text-gray-500"},"Nom complet",-1)),e("p",aR,t(_.refund.user?.first_name)+" "+t(_.refund.user?.last_name),1)]),e("div",null,[m[4]||(m[4]=e("p",{class:"text-xs text-gray-500"},"Email",-1)),e("p",nR,t(_.refund.user?.email||"N/A"),1)]),e("div",null,[m[5]||(m[5]=e("p",{class:"text-xs text-gray-500"},"Téléphone",-1)),e("p",iR,t(_.refund.user?.phone||"N/A"),1)]),_.refund.meta?.order_number?(s(),o("div",lR,[m[6]||(m[6]=e("p",{class:"text-xs text-gray-500"},"Numéro de commande",-1)),e("p",dR,t(_.refund.meta.order_number),1)])):T("",!0)])]),e("div",uR,[e("div",cR,[e("h3",mR,[g(l(je),{class:"h-5 w-5 text-blue-600"}),m[7]||(m[7]=z(" Tombola ",-1))]),e("div",pR,[e("div",null,[m[8]||(m[8]=e("p",{class:"text-xs text-gray-500"},"Numéro de tombola",-1)),e("p",gR,t(_.refund.lottery?.lottery_number||"N/A"),1)]),e("div",null,[m[9]||(m[9]=e("p",{class:"text-xs text-gray-500"},"Produit",-1)),e("p",fR,t(_.refund.lottery?.product?.name||"N/A"),1)])])]),e("div",vR,[e("h3",xR,[g(l(Xe),{class:"h-5 w-5 text-blue-600"}),m[10]||(m[10]=z(" Transaction ",-1))]),e("div",bR,[e("div",null,[m[11]||(m[11]=e("p",{class:"text-xs text-gray-500"},"Référence",-1)),e("p",yR,t(_.refund.transaction?.reference||"N/A"),1)]),e("div",null,[m[12]||(m[12]=e("p",{class:"text-xs text-gray-500"},"Montant original",-1)),e("p",hR,t(n(_.refund.meta?.original_amount||_.refund.amount)),1)])])])]),e("div",_R,[e("h3",wR,[g(l(Fe),{class:"h-5 w-5 text-blue-600"}),m[13]||(m[13]=z(" Méthode de remboursement ",-1))]),e("div",$R,[e("div",null,[m[14]||(m[14]=e("p",{class:"text-xs text-gray-500"},"Méthode",-1)),e("p",kR,t(M(_.refund.refund_method)),1)]),_.refund.external_refund_id?(s(),o("div",CR,[m[15]||(m[15]=e("p",{class:"text-xs text-gray-500"},"ID SHAP Payout",-1)),e("p",AR,t(_.refund.external_refund_id),1)])):T("",!0),_.refund.meta?.operator?(s(),o("div",PR,[m[16]||(m[16]=e("p",{class:"text-xs text-gray-500"},"Opérateur",-1)),e("p",ER,t(_.refund.meta.operator),1)])):T("",!0)])]),_.refund.meta?.koumbaya_fees?(s(),o("div",jR,[e("h3",SR,[g(l(Ge),{class:"h-5 w-5 text-amber-600"}),m[17]||(m[17]=z(" Frais Koumbaya ",-1))]),e("div",IR,[e("div",null,[m[18]||(m[18]=e("p",{class:"text-xs text-amber-700"},"Montant payé",-1)),e("p",DR,t(n(_.refund.meta.original_amount)),1)]),e("div",null,[m[19]||(m[19]=e("p",{class:"text-xs text-amber-700"},"Frais retenus",-1)),e("p",TR,t(n(_.refund.meta.koumbaya_fees)),1)]),e("div",null,[m[20]||(m[20]=e("p",{class:"text-xs text-amber-700"},"Montant remboursé",-1)),e("p",MR,t(n(_.refund.amount)),1)])])])):T("",!0),e("div",LR,[e("h3",VR,[g(l(Oe),{class:"h-5 w-5 text-blue-600"}),m[21]||(m[21]=z(" Raison du remboursement ",-1))]),e("p",RR,t(_.refund.reason||"N/A"),1)]),_.refund.status==="rejected"&&_.refund.rejection_reason?(s(),o("div",FR,[e("h3",NR,[g(l(Se),{class:"h-5 w-5 text-red-600"}),m[22]||(m[22]=z(" Raison du rejet ",-1))]),e("p",zR,t(_.refund.rejection_reason),1),_.refund.rejected_at?(s(),o("p",qR," Rejeté le "+t(r(_.refund.rejected_at)),1)):T("",!0)])):T("",!0),_.refund.meta?.shap_payout_id?(s(),o("div",UR,[e("h3",BR,[g(l(Ys),{class:"h-5 w-5 text-gray-600"}),m[23]||(m[23]=z(" Réponse API SHAP ",-1))]),e("div",OR,[e("div",null,[m[24]||(m[24]=e("p",{class:"text-xs text-gray-500"},"Payout ID",-1)),e("p",GR,t(_.refund.meta.shap_payout_id),1)]),_.refund.meta.shap_transaction_id?(s(),o("div",HR,[m[25]||(m[25]=e("p",{class:"text-xs text-gray-500"},"Transaction ID",-1)),e("p",KR,t(_.refund.meta.shap_transaction_id),1)])):T("",!0),_.refund.meta.state?(s(),o("div",WR,[m[26]||(m[26]=e("p",{class:"text-xs text-gray-500"},"État SHAP",-1)),e("p",JR,t(_.refund.meta.state),1)])):T("",!0),_.refund.meta.timestamp?(s(),o("div",XR,[m[27]||(m[27]=e("p",{class:"text-xs text-gray-500"},"Horodatage",-1)),e("p",YR,t(r(_.refund.meta.timestamp)),1)])):T("",!0)])])):T("",!0),e("div",QR,[e("h3",ZR,[g(l(Te),{class:"h-5 w-5 text-gray-600"}),m[28]||(m[28]=z(" Chronologie ",-1))]),e("div",eF,[e("div",tF,[m[30]||(m[30]=e("div",{class:"p-1.5 bg-blue-100 rounded-full mt-0.5"},[e("div",{class:"h-2 w-2 bg-blue-600 rounded-full"})],-1)),e("div",sF,[m[29]||(m[29]=e("p",{class:"text-sm font-medium text-gray-900"},"Demande créée",-1)),e("p",oF,t(r(_.refund.created_at)),1)])]),_.refund.approved_at?(s(),o("div",rF,[m[32]||(m[32]=e("div",{class:"p-1.5 bg-green-100 rounded-full mt-0.5"},[e("div",{class:"h-2 w-2 bg-green-600 rounded-full"})],-1)),e("div",aF,[m[31]||(m[31]=e("p",{class:"text-sm font-medium text-gray-900"},"Approuvée",-1)),e("p",nF,t(r(_.refund.approved_at)),1)])])):T("",!0),_.refund.processed_at?(s(),o("div",iF,[m[34]||(m[34]=e("div",{class:"p-1.5 bg-purple-100 rounded-full mt-0.5"},[e("div",{class:"h-2 w-2 bg-purple-600 rounded-full"})],-1)),e("div",lF,[m[33]||(m[33]=e("p",{class:"text-sm font-medium text-gray-900"},"Traitée",-1)),e("p",dF,t(r(_.refund.processed_at)),1)])])):T("",!0),_.refund.completed_at?(s(),o("div",uF,[m[36]||(m[36]=e("div",{class:"p-1.5 bg-green-100 rounded-full mt-0.5"},[e("div",{class:"h-2 w-2 bg-green-600 rounded-full"})],-1)),e("div",cF,[m[35]||(m[35]=e("p",{class:"text-sm font-medium text-gray-900"},"Complétée",-1)),e("p",mF,t(r(_.refund.completed_at)),1)])])):T("",!0),_.refund.rejected_at?(s(),o("div",pF,[m[38]||(m[38]=e("div",{class:"p-1.5 bg-red-100 rounded-full mt-0.5"},[e("div",{class:"h-2 w-2 bg-red-600 rounded-full"})],-1)),e("div",gF,[m[37]||(m[37]=e("p",{class:"text-sm font-medium text-gray-900"},"Rejetée",-1)),e("p",fF,t(r(_.refund.rejected_at)),1)])])):T("",!0)])]),_.refund.notes?(s(),o("div",vF,[e("h3",xF,[g(l(ms),{class:"h-5 w-5 text-gray-600"}),m[39]||(m[39]=z(" Notes ",-1))]),e("p",bF,t(_.refund.notes),1)])):T("",!0)]),e("div",yF,[["rejected","failed"].includes(_.refund.status)?(s(),o("button",{key:0,onClick:c,disabled:f.value,class:"flex-1 px-4 py-3 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-lg hover:from-orange-600 hover:to-red-600 font-medium transition-all shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"},[f.value?(s(),o("div",_F)):(s(),ce(l(Fe),{key:0,class:"h-5 w-5"})),e("span",null,t(f.value?"Relance...":"Relancer le remboursement"),1)],8,hF)):T("",!0),e("button",{onClick:a,class:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 font-medium transition-colors"}," Fermer ")])])])]))}},$F={class:"space-y-6"},kF={class:"flex justify-between items-center"},CF={class:"flex space-x-3"},AF={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},PF={class:"admin-card hover:shadow-md transition-shadow duration-200"},EF={class:"flex items-center"},jF={class:"p-3 rounded-lg bg-green-100"},SF={class:"ml-4"},IF={class:"text-2xl font-bold text-gray-900"},DF={class:"admin-card hover:shadow-md transition-shadow duration-200"},TF={class:"flex items-center"},MF={class:"p-3 rounded-lg bg-blue-100"},LF={class:"ml-4"},VF={class:"text-2xl font-bold text-gray-900"},RF={class:"admin-card hover:shadow-md transition-shadow duration-200"},FF={class:"flex items-center"},NF={class:"p-3 rounded-lg bg-yellow-100"},zF={class:"ml-4"},qF={class:"text-2xl font-bold text-gray-900"},UF={class:"admin-card hover:shadow-md transition-shadow duration-200"},BF={class:"flex items-center"},OF={class:"p-3 rounded-lg bg-purple-100"},GF={class:"ml-4"},HF={class:"text-2xl font-bold text-gray-900"},KF={key:0,class:"admin-card"},WF={class:"p-6"},JF={key:0,class:"mb-6"},XF={class:"text-md font-medium text-orange-700 mb-3 flex items-center gap-1"},YF={class:"space-y-3"},QF={class:"font-medium"},ZF={class:"text-sm text-gray-600"},eN={class:"text-sm"},tN={class:"text-right"},sN={class:"font-semibold text-orange-700 mb-2"},oN=["onClick"],rN={key:1},aN={class:"text-md font-medium text-red-700 mb-3 flex items-center gap-1"},nN={class:"space-y-3"},iN={class:"font-medium"},lN={class:"text-sm text-gray-600"},dN={class:"text-sm"},uN={class:"text-right"},cN={class:"font-semibold text-red-700 mb-2"},mN=["onClick"],pN={class:"bg-white p-6 rounded-lg shadow-sm border border-gray-200"},gN={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},fN={class:"mt-4 flex justify-between items-center"},vN={class:"text-sm text-gray-500"},xN={key:1,class:"text-center py-12"},bN={key:2,class:"text-center py-12"},yN={key:3,class:"admin-card"},hN={class:"overflow-x-auto"},_N={class:"min-w-full divide-y divide-gray-200"},wN={class:"bg-white divide-y divide-gray-200"},$N={class:"px-6 py-4 whitespace-nowrap"},kN={class:"font-mono text-sm font-medium text-gray-900"},CN={class:"text-sm text-gray-500"},AN={key:0,class:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800 mt-1"},PN={class:"px-6 py-4 whitespace-nowrap"},EN={class:"text-sm font-medium text-gray-900"},jN={class:"text-sm text-gray-500"},SN={class:"px-6 py-4 whitespace-nowrap"},IN={class:"text-sm font-semibold text-gray-900"},DN={class:"text-xs text-gray-500"},TN={class:"px-6 py-4 whitespace-nowrap"},MN={class:"text-sm text-gray-900"},LN={key:0,class:"text-xs text-gray-500"},VN={key:1,class:"text-xs text-gray-500"},RN={class:"px-6 py-4 whitespace-nowrap"},FN={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},NN={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},zN=["onClick"],qN={key:4,class:"fixed inset-0 z-50 overflow-y-auto"},UN={class:"flex items-center justify-center min-h-screen px-4"},BN={class:"relative bg-white rounded-lg max-w-md w-full"},ON={class:"p-6"},GN={class:"flex items-center justify-between mb-4"},HN={class:"text-lg font-semibold flex items-center gap-2"},KN={class:"space-y-4"},WN={class:"flex items-center"},JN={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},XN={class:"text-sm text-yellow-800"},YN={class:"font-medium mb-1 flex items-center gap-1"},QN={class:"flex justify-end space-x-3 mt-6"},ZN=["disabled"],ez={key:5,class:"fixed inset-0 z-50 overflow-y-auto"},tz={class:"flex items-center justify-center min-h-screen px-4"},sz={class:"relative bg-white rounded-lg max-w-md w-full"},oz={class:"p-6"},rz={class:"flex items-center justify-between mb-4"},az={class:"space-y-4"},nz={class:"flex justify-end space-x-3 mt-6"},iz=["disabled"],lz={__name:"RefundManagement",setup(_){const{get:y,post:w}=ge(),p=R([]),f=R({}),a=R(!1),c=R(!1),n=R({}),r=R(!1),P=R(null),$=R(""),M=R(!1),D=R(null),m=R(!1),k=R(null),U=R({status:"",type:"",reason:""}),V=R({dryRun:!1}),v=async()=>{a.value=!0;try{const E=new URLSearchParams({limit:100});Object.keys(U.value).forEach(q=>{U.value[q]&&E.append(q,U.value[q])});const F=await y(`/admin/refunds?${E}`);F&&F.success&&F.data&&(p.value=F.data.refunds||[])}catch(E){console.error("Error loading refunds:",E),window.$toast&&window.$toast.error("Erreur lors du chargement des remboursements","✗ Erreur"),p.value=[]}finally{a.value=!1}},d=async()=>{try{const E=await y("/admin/refunds/stats");E&&E.success&&E.data&&(f.value=E.data)}catch(E){console.error("Error loading stats:",E),window.$toast&&window.$toast.error("Erreur lors du chargement des statistiques","✗ Erreur"),f.value={total_refunds:0,total_amount_refunded:0,pending_refunds:0,auto_processed:0}}},i=async()=>{try{const E=await y("/admin/refunds/eligible-lotteries");E&&E.success&&E.data&&(n.value=E.data)}catch(E){console.error("Error loading eligible lotteries:",E),window.$toast&&window.$toast.error("Erreur lors du chargement des tombolas éligibles","✗ Erreur"),n.value={expired_insufficient:[],cancelled:[],summary:{expired_count:0,expired_estimated_refund:0,cancelled_count:0,cancelled_estimated_refund:0}}}},C=async()=>{c.value=!0;try{const E=await w("/admin/refunds/process-automatic",{dry_run:V.value.dryRun});if(E&&E.success&&window.$toast){const F=E.data.message||"Traitement automatique terminé";window.$toast.success(F,"✅ Traitement")}await Promise.all([v(),d(),i()]),r.value=!1}catch(E){if(console.error("Error processing automatic refunds:",E),window.$toast){const F=E.response?.data?.message||"Erreur lors du traitement automatique";window.$toast.error(F,"✗ Erreur")}}finally{c.value=!1}},x=E=>{D.value=E,M.value=!0},I=async()=>{M.value=!1,D.value=null,await Promise.all([v(),d(),i()])},N=async E=>{await Promise.all([v(),d()]),k.value&&k.value.id===E.id&&(k.value=E)},u=async()=>{if($.value.trim()){c.value=!0;try{const E=await w(`/admin/refunds/${P.value.id}/reject`,{reason:$.value});if(E&&E.success){if(window.$toast){const q=E.data.message||"Remboursement rejeté";window.$toast.warning(q,"⚠️ Rejet")}const F=p.value.findIndex(q=>q.id===P.value.id);F!==-1&&E.data.refund&&(p.value[F]=E.data.refund),await d()}P.value=null,$.value=""}catch(E){if(console.error("Error rejecting refund:",E),window.$toast){const F=E.response?.data?.message||"Erreur lors du rejet";window.$toast.error(F,"✗ Erreur")}P.value=null,$.value=""}finally{c.value=!1}}},A=async E=>{try{const F=await y(`/admin/refunds/${E.id}`);F&&F.success?(k.value=F.data?.refund||F.refund||F.data,m.value=!0):window.$toast&&window.$toast.error("Erreur lors du chargement des détails","✗ Erreur")}catch(F){console.error("Error loading refund details:",F),window.$toast&&window.$toast.error("Erreur lors du chargement des détails","✗ Erreur")}},H=()=>{U.value={status:"",type:"",reason:""},v()},j=E=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(E||0)+" FCFA",h=E=>E?E>=1e6?(E/1e6).toFixed(1)+"M":E>=1e3?(E/1e3).toFixed(0)+"K":E.toString():"0",b=E=>new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(E)),ee=E=>({pending:"bg-yellow-100 text-yellow-800",approved:"bg-blue-100 text-blue-800",processed:"bg-purple-100 text-purple-800",completed:"bg-blue-100 text-blue-800",rejected:"bg-red-100 text-red-800",failed:"bg-red-100 text-red-800"})[E]||"bg-gray-100 text-gray-800",B=E=>({pending:"En attente",approved:"Approuvé",processed:"Traité",completed:"Terminé",rejected:"Rejeté",failed:"Échec"})[E]||E,S=E=>({insufficient_participants:"Participants insuffisants",lottery_cancelled:"Tombola annulée",accidental_purchase:"Achat accidentel",changed_mind:"Changement d'avis",duplicate_purchase:"Achat en double",technical_issue:"Problème technique",system_error:"Erreur système",other:"Autre"})[E]||E;return ve(async()=>{await Promise.all([v(),d(),i()])}),(E,F)=>(s(),o("div",$F,[e("div",kF,[F[17]||(F[17]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Gestion des Remboursements"),e("p",{class:"mt-2 text-gray-600"},"Administration des remboursements automatiques et manuels")],-1)),e("div",CF,[e("button",{onClick:i,class:"admin-btn-secondary flex items-center gap-2"},[g(l(it),{class:"w-4 h-4"}),F[15]||(F[15]=z(" Vérifier les tombolas ",-1))]),e("button",{onClick:F[0]||(F[0]=q=>r.value=!0),class:"admin-btn-primary flex items-center gap-2"},[g(l(Qe),{class:"w-4 h-4"}),F[16]||(F[16]=z(" Traiter automatique ",-1))])])]),e("div",AF,[e("div",PF,[e("div",EF,[e("div",jF,[g(l(Ge),{class:"w-6 h-6 text-green-600"})]),e("div",SF,[F[18]||(F[18]=e("p",{class:"text-sm font-medium text-gray-600"},"Total remboursements",-1)),e("p",IF,t(f.value.total_refunds||0),1)])])]),e("div",DF,[e("div",TF,[e("div",MF,[g(l(Re),{class:"w-6 h-6 text-[#0099cc]"})]),e("div",LF,[F[19]||(F[19]=e("p",{class:"text-sm font-medium text-gray-600"},"Montant remboursé",-1)),e("p",VF,t(h(f.value.total_amount_refunded)),1)])])]),e("div",RF,[e("div",FF,[e("div",NF,[g(l(Te),{class:"w-6 h-6 text-yellow-600"})]),e("div",zF,[F[20]||(F[20]=e("p",{class:"text-sm font-medium text-gray-600"},"En attente",-1)),e("p",qF,t(f.value.pending_refunds||0),1)])])]),e("div",UF,[e("div",BF,[e("div",OF,[g(l(Qe),{class:"w-6 h-6 text-purple-600"})]),e("div",GF,[F[21]||(F[21]=e("p",{class:"text-sm font-medium text-gray-600"},"Auto-traités",-1)),e("p",HF,t(f.value.auto_processed||0),1)])])])]),n.value.expired_insufficient?.length||n.value.cancelled?.length?(s(),o("div",KF,[F[26]||(F[26]=e("div",{class:"admin-card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Tombolas éligibles aux remboursements")],-1)),e("div",WF,[n.value.expired_insufficient?.length?(s(),o("div",JF,[e("h4",XF,[g(l(Te),{class:"w-4 h-4"}),F[22]||(F[22]=z(" Expirées - Participants insuffisants ",-1))]),e("div",YF,[(s(!0),o(ie,null,le(n.value.expired_insufficient,q=>(s(),o("div",{key:q.id,class:"flex items-center justify-between bg-orange-50 border border-orange-200 rounded-lg p-4"},[e("div",null,[e("div",QF,t(q.lottery_number),1),e("div",ZF,t(q.product_title),1),e("div",eN,t(q.participants)+"/"+t(q.min_participants)+" participants",1)]),e("div",tN,[e("div",sN,t(j(q.estimated_refund)),1),e("button",{onClick:O=>x(q),class:"px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition-all duration-200 shadow-md hover:shadow-lg flex items-center gap-2 text-sm font-medium"},[g(l(Ge),{class:"w-4 h-4"}),F[23]||(F[23]=z(" Voir les détails & Rembourser ",-1))],8,oN)])]))),128))])])):T("",!0),n.value.cancelled?.length?(s(),o("div",rN,[e("h4",aN,[g(l(kt),{class:"w-4 h-4"}),F[24]||(F[24]=z(" Tombolas annulées ",-1))]),e("div",nN,[(s(!0),o(ie,null,le(n.value.cancelled,q=>(s(),o("div",{key:q.id,class:"flex items-center justify-between bg-red-50 border border-red-200 rounded-lg p-4"},[e("div",null,[e("div",iN,t(q.lottery_number),1),e("div",lN,t(q.product_title),1),e("div",dN,t(q.participants)+" participants",1)]),e("div",uN,[e("div",cN,t(j(q.estimated_refund)),1),e("button",{onClick:O=>x(q),class:"px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition-all duration-200 shadow-md hover:shadow-lg flex items-center gap-2 text-sm font-medium"},[g(l(Ge),{class:"w-4 h-4"}),F[25]||(F[25]=z(" Voir les détails & Rembourser ",-1))],8,mN)])]))),128))])])):T("",!0)])])):T("",!0),e("div",pN,[e("div",gN,[e("div",null,[F[27]||(F[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Rechercher",-1)),Q(e("input",{"onUpdate:modelValue":F[1]||(F[1]=q=>U.value.search=q),onInput:v,type:"text",placeholder:"N° remboursement, utilisateur...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544),[[ne,U.value.search]])]),e("div",null,[F[29]||(F[29]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),Q(e("select",{"onUpdate:modelValue":F[2]||(F[2]=q=>U.value.status=q),onChange:v,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},F[28]||(F[28]=[pe('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="approved">Approuvé</option><option value="processed">Traité</option><option value="completed">Terminé</option><option value="rejected">Rejeté</option>',6)]),544),[[me,U.value.status]])]),e("div",null,[F[31]||(F[31]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type",-1)),Q(e("select",{"onUpdate:modelValue":F[3]||(F[3]=q=>U.value.type=q),onChange:v,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},F[30]||(F[30]=[e("option",{value:""},"Tous les types",-1),e("option",{value:"automatic"},"Automatique",-1),e("option",{value:"manual"},"Manuel",-1),e("option",{value:"admin"},"Admin",-1)]),544),[[me,U.value.type]])]),e("div",{class:"flex items-end"},[e("button",{onClick:H,class:"w-full px-4 py-2 text-gray-600 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors"}," Réinitialiser ")])]),e("div",fN,[e("div",vN,t(p.value.length)+" remboursement(s) trouvé(s) ",1),e("div",null,[Q(e("select",{"onUpdate:modelValue":F[4]||(F[4]=q=>U.value.reason=q),onChange:v,class:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"},F[32]||(F[32]=[pe('<option value="">Toutes les raisons</option><option value="insufficient_participants">Participants insuffisants</option><option value="lottery_cancelled">Tombola annulée</option><option value="accidental_purchase">Achat accidentel</option><option value="technical_issue">Problème technique</option>',5)]),544),[[me,U.value.reason]])])])]),a.value?(s(),o("div",xN,F[33]||(F[33]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"},null,-1),e("p",{class:"mt-4 text-gray-600"},"Chargement des remboursements...",-1)]))):p.value.length===0?(s(),o("div",bN,[g(l(Ge),{class:"mx-auto h-16 w-16 text-gray-400 mb-4"}),F[34]||(F[34]=e("h3",{class:"text-xl font-medium text-gray-900 mb-2"},"Aucun remboursement",-1)),F[35]||(F[35]=e("p",{class:"text-gray-600"},"Aucun remboursement ne correspond aux filtres sélectionnés.",-1))])):(s(),o("div",yN,[e("div",hN,[e("table",_N,[F[38]||(F[38]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Remboursement"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Utilisateur"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Montant"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Raison"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Statut"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Détails")])],-1)),e("tbody",wN,[(s(!0),o(ie,null,le(p.value,q=>(s(),o("tr",{key:q.id,class:"hover:bg-gray-50"},[e("td",$N,[e("div",null,[e("div",kN,t(q.refund_number),1),e("div",CN,t(q.type),1),q.auto_processed?(s(),o("div",AN,[g(l(Qe),{class:"w-3 h-3"}),F[36]||(F[36]=z(" Auto ",-1))])):T("",!0)])]),e("td",PN,[e("div",null,[e("div",EN,t(q.user?.full_name||`${q.user?.first_name||""} ${q.user?.last_name||""}`.trim()||"N/A"),1),e("div",jN,t(q.user?.email||"N/A"),1)])]),e("td",SN,[e("div",IN,t(j(q.amount)),1),e("div",DN,t(q.currency),1)]),e("td",TN,[e("div",MN,t(S(q.reason)),1),q.lottery?(s(),o("div",LN,t(q.lottery.lottery_number),1)):q.ticket?(s(),o("div",VN," Ticket #"+t(q.ticket.ticket_number),1)):T("",!0)]),e("td",RN,[e("span",{class:te(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",ee(q.status)])},t(B(q.status)),3)]),e("td",FN,t(b(q.created_at)),1),e("td",NN,[e("button",{onClick:O=>A(q),class:"inline-flex items-center gap-1 px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",title:"Voir détails"},[g(l(Ue),{class:"w-4 h-4"}),F[37]||(F[37]=z(" Voir ",-1))],8,zN)])]))),128))])])])])),r.value?(s(),o("div",qN,[e("div",UN,[e("div",{class:"fixed inset-0 bg-gray-600 bg-opacity-40",onClick:F[5]||(F[5]=q=>r.value=!1)}),e("div",BN,[e("div",ON,[e("div",GN,[e("h3",HN,[g(l(Qe),{class:"w-5 h-5"}),F[39]||(F[39]=z(" Traitement Automatique ",-1))]),e("button",{onClick:F[6]||(F[6]=q=>r.value=!1),class:"text-gray-400 hover:text-gray-600"},[g(l(Le),{class:"w-6 h-6"})])]),e("div",KN,[e("div",null,[e("label",WN,[Q(e("input",{type:"checkbox","onUpdate:modelValue":F[7]||(F[7]=q=>V.value.dryRun=q),class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,512),[[Ae,V.value.dryRun]]),F[40]||(F[40]=e("span",{class:"ml-2 text-sm text-gray-700"},"Mode test (pas de changements)",-1))])]),e("div",JN,[e("div",XN,[e("p",YN,[g(l(We),{class:"w-4 h-4"}),F[41]||(F[41]=z(" Attention ",-1))]),F[42]||(F[42]=e("p",null,"Cette action va traiter automatiquement tous les remboursements éligibles.",-1))])])]),e("div",QN,[e("button",{onClick:F[8]||(F[8]=q=>r.value=!1),class:"admin-btn-secondary"}," Annuler "),e("button",{onClick:C,disabled:c.value,class:"admin-btn-primary disabled:opacity-50"},t(c.value?"Traitement...":"Traiter"),9,ZN)])])])])])):T("",!0),P.value?(s(),o("div",ez,[e("div",tz,[e("div",{class:"fixed inset-0 bg-gray-600 bg-opacity-40",onClick:F[9]||(F[9]=q=>P.value=null)}),e("div",sz,[e("div",oz,[e("div",rz,[F[43]||(F[43]=e("h3",{class:"text-lg font-semibold"},"Rejeter le remboursement",-1)),e("button",{onClick:F[10]||(F[10]=q=>P.value=null),class:"text-gray-400 hover:text-gray-600"},[g(l(Le),{class:"w-6 h-6"})])]),e("div",az,[e("div",null,[F[44]||(F[44]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Raison du rejet *",-1)),Q(e("textarea",{"onUpdate:modelValue":F[11]||(F[11]=q=>$.value=q),rows:"3",required:"",class:"admin-input focus:border-red-500 focus:ring-red-500",placeholder:"Expliquez pourquoi ce remboursement est rejeté..."},null,512),[[ne,$.value]])])]),e("div",nz,[e("button",{onClick:F[12]||(F[12]=q=>{P.value=null,$.value=""}),class:"admin-btn-secondary"}," Annuler "),e("button",{onClick:u,disabled:c.value||!$.value.trim(),class:"admin-btn-danger disabled:opacity-50"},t(c.value?"Rejet...":"Rejeter"),9,iz)])])])])])):T("",!0),M.value&&D.value?(s(),ce(OV,{key:6,lottery:D.value,onClose:F[13]||(F[13]=q=>M.value=!1),onSuccess:I},null,8,["lottery"])):T("",!0),m.value&&k.value?(s(),ce(wF,{key:7,refund:k.value,onClose:F[14]||(F[14]=q=>m.value=!1),onRefundUpdated:N},null,8,["refund"])):T("",!0)]))}},dz={class:"order-management"},uz={class:"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-6 gap-6 mb-8"},cz={class:"bg-white rounded-lg shadow p-6"},mz={class:"flex items-center"},pz={class:"ml-4"},gz={class:"text-2xl font-semibold text-gray-900"},fz={class:"bg-white rounded-lg shadow p-6"},vz={class:"flex items-center"},xz={class:"ml-4"},bz={class:"text-2xl font-semibold text-gray-900"},yz={class:"bg-white rounded-lg shadow p-6"},hz={class:"flex items-center"},_z={class:"ml-4"},wz={class:"text-2xl font-semibold text-gray-900"},$z={class:"bg-white rounded-lg shadow p-6"},kz={class:"flex items-center"},Cz={class:"ml-4"},Az={class:"text-2xl font-semibold text-gray-900"},Pz={class:"bg-white rounded-lg shadow p-6"},Ez={class:"flex items-center"},jz={class:"ml-4"},Sz={class:"text-2xl font-semibold text-gray-900"},Iz={class:"bg-white rounded-lg shadow p-6"},Dz={class:"flex items-center"},Tz={class:"ml-4"},Mz={class:"text-2xl font-semibold text-gray-900"},Lz={class:"bg-white rounded-lg shadow p-6 mb-6"},Vz={class:"grid grid-cols-1 md:grid-cols-6 gap-4"},Rz={class:"md:col-span-2"},Fz={class:"flex space-x-2"},Nz={class:"bg-white rounded-lg shadow overflow-hidden"},zz={key:0,class:"flex items-center justify-center py-12"},qz={key:1,class:"text-center py-12"},Uz={key:2,class:"overflow-x-auto"},Bz={class:"min-w-full divide-y divide-gray-200"},Oz={class:"bg-white divide-y divide-gray-200"},Gz={class:"px-6 py-4 whitespace-nowrap"},Hz={class:"text-sm font-medium text-gray-900"},Kz={class:"text-sm text-gray-500"},Wz={class:"px-6 py-4 whitespace-nowrap"},Jz={class:"text-sm font-medium text-gray-900"},Xz={class:"text-sm text-gray-500"},Yz={class:"px-6 py-4"},Qz={class:"text-sm font-medium text-gray-900"},Zz={key:0,class:"text-sm text-gray-500"},eq={class:"px-6 py-4 whitespace-nowrap"},tq={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},sq={class:"px-6 py-4 whitespace-nowrap"},oq=["value","onChange"],rq={class:"px-6 py-4 whitespace-nowrap"},aq={key:0},nq={key:0,class:"text-xs text-gray-500"},iq={key:1,class:"text-sm text-gray-400"},lq={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},dq={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},uq=["onClick"],cq={key:3,class:"bg-white px-6 py-3 flex items-center justify-between border-t border-gray-200"},mq={class:"flex-1 flex justify-between items-center"},pq={class:"text-sm text-gray-700"},gq={class:"font-medium"},fq={class:"font-medium"},vq={class:"font-medium"},xq={class:"flex items-center space-x-2"},bq=["disabled"],yq={class:"text-sm text-gray-700"},hq=["disabled"],_q={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-40 overflow-y-auto h-full w-full z-50"},wq={class:"relative top-20 mx-auto p-5 border w-11/12 max-w-4xl shadow-lg rounded-md bg-white"},$q={class:"flex justify-between items-center mb-4"},kq={class:"text-lg font-medium text-gray-900"},Cq={key:0,class:"space-y-6"},Aq={class:"grid grid-cols-2 gap-4"},Pq={key:0},Eq={class:"space-y-2"},jq={class:"font-medium"},Sq={class:"text-sm text-gray-500"},Iq={__name:"OrderManagement",setup(_){const{get:y,put:w}=ge(),{showError:p,showSuccess:f}=bt(),a=R([]),c=R({total_orders:0,paid_orders:0,pending_orders:0,fulfilled_orders:0,total_amount:0,today_orders:0}),n=R(!1),r=R(!1),P=R(null),$=R({current_page:1,last_page:1,per_page:15,total:0}),M=xe({search:"",status:"",type:"",date_from:"",date_to:""}),D=N=>N==null||isNaN(N)?"0":new Intl.NumberFormat("fr-FR").format(Number(N)),m=N=>N==null||isNaN(N)?"0 FCFA":new Intl.NumberFormat("fr-FR").format(Number(N))+" FCFA",k=N=>{if(!N)return"N/A";const u=new Date(N);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(u)},U=N=>({pending:"bg-yellow-100 text-yellow-800",paid:"bg-green-100 text-green-800",fulfilled:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800"})[N]||"bg-gray-100 text-gray-800",V=N=>({paid:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",failed:"bg-red-100 text-red-800",expired:"bg-gray-100 text-gray-800"})[N]||"bg-gray-100 text-gray-800",v=async()=>{try{const N=await y("/admin/orders/stats");c.value=N.data}catch(N){console.error("Erreur lors du chargement des statistiques:",N)}},d=async(N=1)=>{n.value=!0;try{const u=new URLSearchParams({page:N,per_page:15});M.search&&u.append("search",M.search),M.status&&u.append("status",M.status),M.type&&u.append("type",M.type),M.date_from&&u.append("date_from",M.date_from),M.date_to&&u.append("date_to",M.date_to);const A=await y(`/admin/orders?${u.toString()}`);a.value=A.data,$.value=A.pagination}catch(u){p("Erreur lors du chargement des commandes"),console.error("Erreur:",u)}finally{n.value=!1}},i=async N=>{try{const u=await y(`/admin/orders/${N}`);P.value=u.data,r.value=!0}catch(u){p("Erreur lors du chargement des détails"),console.error("Erreur:",u)}},C=async(N,u)=>{if(N.status!==u)try{const A=await w(`/admin/orders/${N.order_number}/status`,{status:u});A.success&&(N.status=u,N.status_label=A.data.status_label,f(`Statut de la commande #${N.order_number} mis à jour`),v())}catch(A){p("Erreur lors de la mise à jour du statut"),console.error("Erreur:",A),d($.value.current_page)}},x=()=>{r.value=!1,P.value=null},I=()=>{Object.keys(M).forEach(N=>{M[N]=""}),d(1)};return De(M,()=>{clearTimeout(window.ordersFilterTimeout),window.ordersFilterTimeout=setTimeout(()=>{d(1)},500)},{deep:!0}),ve(()=>{v(),d(1)}),(N,u)=>(s(),o("div",dz,[u[42]||(u[42]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Gestion des Commandes"),e("p",{class:"text-gray-600"},"Suivre et gérer toutes les commandes de la plateforme")],-1)),e("div",uz,[e("div",cz,[e("div",mz,[u[9]||(u[9]=e("div",{class:"p-3 rounded-full bg-blue-100"},[e("svg",{class:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})])],-1)),e("div",pz,[u[8]||(u[8]=e("p",{class:"text-sm font-medium text-gray-600"},"Total",-1)),e("p",gz,t(D(c.value.total_orders)),1)])])]),e("div",fz,[e("div",vz,[u[11]||(u[11]=e("div",{class:"p-3 rounded-full bg-green-100"},[e("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",xz,[u[10]||(u[10]=e("p",{class:"text-sm font-medium text-gray-600"},"Payées",-1)),e("p",bz,t(D(c.value.paid_orders)),1)])])]),e("div",yz,[e("div",hz,[u[13]||(u[13]=e("div",{class:"p-3 rounded-full bg-yellow-100"},[e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),e("div",_z,[u[12]||(u[12]=e("p",{class:"text-sm font-medium text-gray-600"},"En attente",-1)),e("p",wz,t(D(c.value.pending_orders)),1)])])]),e("div",$z,[e("div",kz,[u[15]||(u[15]=e("div",{class:"p-3 rounded-full bg-purple-100"},[e("svg",{class:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1)),e("div",Cz,[u[14]||(u[14]=e("p",{class:"text-sm font-medium text-gray-600"},"Traitées",-1)),e("p",Az,t(D(c.value.fulfilled_orders)),1)])])]),e("div",Pz,[e("div",Ez,[u[17]||(u[17]=e("div",{class:"p-3 rounded-full bg-indigo-100"},[e("svg",{class:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])],-1)),e("div",jz,[u[16]||(u[16]=e("p",{class:"text-sm font-medium text-gray-600"},"CA Total",-1)),e("p",Sz,t(m(c.value.total_amount)),1)])])]),e("div",Iz,[e("div",Dz,[u[19]||(u[19]=e("div",{class:"p-3 rounded-full bg-teal-100"},[e("svg",{class:"w-6 h-6 text-teal-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v4"})])],-1)),e("div",Tz,[u[18]||(u[18]=e("p",{class:"text-sm font-medium text-gray-600"},"Aujourd'hui",-1)),e("p",Mz,t(D(c.value.today_orders)),1)])])])]),e("div",Lz,[e("div",Vz,[e("div",Rz,[Q(e("input",{"onUpdate:modelValue":u[0]||(u[0]=A=>M.search=A),type:"text",placeholder:"Rechercher (n° commande, client, produit...)",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyup:u[1]||(u[1]=xt(A=>d(1),["enter"]))},null,544),[[ne,M.search]])]),e("div",null,[Q(e("select",{"onUpdate:modelValue":u[2]||(u[2]=A=>M.status=A),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},u[20]||(u[20]=[pe('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="paid">Payée</option><option value="fulfilled">Traitée</option><option value="cancelled">Annulée</option>',5)]),512),[[me,M.status]])]),e("div",null,[Q(e("select",{"onUpdate:modelValue":u[3]||(u[3]=A=>M.type=A),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},u[21]||(u[21]=[e("option",{value:""},"Tous les types",-1),e("option",{value:"lottery"},"Tombola",-1),e("option",{value:"direct"},"Achat direct",-1)]),512),[[me,M.type]])]),e("div",null,[Q(e("input",{"onUpdate:modelValue":u[4]||(u[4]=A=>M.date_from=A),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[ne,M.date_from]])]),e("div",Fz,[e("button",{onClick:u[5]||(u[5]=A=>d(1)),class:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors text-sm"}," Filtrer "),e("button",{onClick:I,class:"flex-1 bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 transition-colors text-sm"}," Reset ")])])]),e("div",Nz,[n.value?(s(),o("div",zz,u[22]||(u[22]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),e("span",{class:"ml-2 text-gray-600"},"Chargement des commandes...",-1)]))):a.value.length===0?(s(),o("div",qz,u[23]||(u[23]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Aucune commande",-1),e("p",{class:"mt-1 text-sm text-gray-500"},"Aucune commande ne correspond aux critères de recherche.",-1)]))):(s(),o("div",Uz,[e("table",Bz,[u[25]||(u[25]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Commande"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Koumbuyer"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Article/Tirage spécial"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Type"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Montant"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Statut"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Paiement"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Date"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Détails")])],-1)),e("tbody",Oz,[(s(!0),o(ie,null,le(a.value,A=>(s(),o("tr",{key:A.id,class:"hover:bg-gray-50"},[e("td",Gz,[e("div",null,[e("div",Hz,"#"+t(A.order_number),1),e("div",Kz,"ID: "+t(A.id),1)])]),e("td",Wz,[e("div",null,[e("div",Jz,t(A.customer_name),1),e("div",Xz,t(A.user.email),1)])]),e("td",Yz,[e("div",Qz,t(A.item_name||"N/A"),1),A.lottery?(s(),o("div",Zz," Progress: "+t(A.lottery_progress)+"% ("+t(A.lottery.sold_tickets)+"/"+t(A.lottery.max_tickets)+") ",1)):T("",!0)]),e("td",eq,[e("span",{class:te(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",A.type==="lottery"?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"])},t(A.type_label),3)]),e("td",tq,t(m(A.total_amount)),1),e("td",sq,[e("select",{value:A.status,onChange:H=>C(A,H.target.value),class:te(["text-xs font-semibold rounded-full px-2 py-1 border-0",U(A.status)])},u[24]||(u[24]=[e("option",{value:"pending"},"En attente",-1),e("option",{value:"paid"},"Payée",-1),e("option",{value:"fulfilled"},"Traitée",-1),e("option",{value:"cancelled"},"Annulée",-1)]),42,oq)]),e("td",rq,[A.payment_status?(s(),o("div",aq,[e("span",{class:te(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",V(A.payment_status)])},t(A.payment_status),3),A.payment_method?(s(),o("div",nq,t(A.payment_method),1)):T("",!0)])):(s(),o("span",iq,"-"))]),e("td",lq,t(k(A.created_at)),1),e("td",dq,[e("button",{onClick:H=>i(A.order_number),class:"text-blue-600 hover:text-blue-900 mr-3"}," Voir ",8,uq)])]))),128))])])])),a.value.length>0?(s(),o("div",cq,[e("div",mq,[e("div",null,[e("p",pq,[u[26]||(u[26]=z(" Affichage de ",-1)),e("span",gq,t(($.value.current_page-1)*$.value.per_page+1),1),u[27]||(u[27]=z(" à ",-1)),e("span",fq,t(Math.min($.value.current_page*$.value.per_page,$.value.total)),1),u[28]||(u[28]=z(" de ",-1)),e("span",vq,t($.value.total),1),u[29]||(u[29]=z(" résultats ",-1))])]),e("div",xq,[e("button",{onClick:u[6]||(u[6]=A=>d($.value.current_page-1)),disabled:$.value.current_page<=1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Précédent ",8,bq),e("span",yq," Page "+t($.value.current_page)+" de "+t($.value.last_page),1),e("button",{onClick:u[7]||(u[7]=A=>d($.value.current_page+1)),disabled:$.value.current_page>=$.value.last_page,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Suivant ",8,hq)])])])):T("",!0)]),r.value?(s(),o("div",_q,[e("div",wq,[e("div",$q,[e("h3",kq,"Détails de la commande #"+t(P.value?.order_number),1),e("button",{onClick:x,class:"text-gray-400 hover:text-gray-600"},u[30]||(u[30]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),P.value?(s(),o("div",Cq,[e("div",Aq,[e("div",null,[u[34]||(u[34]=e("h4",{class:"font-medium text-gray-900 mb-2"},"Informations koumbuyer",-1)),e("p",null,[u[31]||(u[31]=e("strong",null,"Nom:",-1)),z(" "+t(P.value.customer_name),1)]),e("p",null,[u[32]||(u[32]=e("strong",null,"Email:",-1)),z(" "+t(P.value.user.email),1)]),e("p",null,[u[33]||(u[33]=e("strong",null,"Téléphone:",-1)),z(" "+t(P.value.user.phone||"N/A"),1)])]),e("div",null,[u[39]||(u[39]=e("h4",{class:"font-medium text-gray-900 mb-2"},"Informations commande",-1)),e("p",null,[u[35]||(u[35]=e("strong",null,"Statut:",-1)),z(" "+t(P.value.status_label),1)]),e("p",null,[u[36]||(u[36]=e("strong",null,"Type:",-1)),z(" "+t(P.value.type_label),1)]),e("p",null,[u[37]||(u[37]=e("strong",null,"Montant:",-1)),z(" "+t(m(P.value.total_amount)),1)]),e("p",null,[u[38]||(u[38]=e("strong",null,"Date:",-1)),z(" "+t(k(P.value.created_at)),1)])])]),P.value.timeline?(s(),o("div",Pq,[u[41]||(u[41]=e("h4",{class:"font-medium text-gray-900 mb-2"},"Chronologie",-1)),e("div",Eq,[(s(!0),o(ie,null,le(P.value.timeline,A=>(s(),o("div",{key:A.type,class:"flex items-center"},[u[40]||(u[40]=e("div",{class:"w-2 h-2 bg-green-500 rounded-full mr-3"},null,-1)),e("div",null,[e("p",jq,t(A.title),1),e("p",Sq,t(k(A.timestamp)),1)])]))),128))])])):T("",!0)])):T("",!0)])])):T("",!0)]))}},Dq={class:"space-y-6"},Tq={class:"flex justify-between items-center"},Mq={class:"flex space-x-3"},Lq={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},Vq={class:"flex items-center"},Rq={class:"ml-4"},Fq={class:"text-sm font-medium text-gray-600"},Nq={class:"text-2xl font-bold text-gray-900"},zq={class:"mt-4 pt-4 border-t border-gray-100"},qq={class:"flex items-center text-sm"},Uq={class:"admin-card"},Bq={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Oq={class:"flex flex-col"},Gq={class:"relative"},Hq={class:"flex flex-col"},Kq={class:"flex flex-col"},Wq={class:"flex flex-col"},Jq={class:"admin-card"},Xq={key:0,class:"flex justify-center py-12"},Yq={key:1,class:"overflow-x-auto"},Qq={class:"min-w-full"},Zq={class:"bg-white divide-y divide-gray-200"},eU={class:"px-6 py-4 whitespace-nowrap"},tU={class:"text-sm font-medium text-gray-900"},sU={class:"text-sm text-gray-500"},oU={class:"px-6 py-4 whitespace-nowrap"},rU={class:"flex items-center"},aU={class:"flex-shrink-0 h-8 w-8"},nU={class:"h-8 w-8 rounded-full bg-gray-300 flex items-center justify-center"},iU={class:"ml-3"},lU={class:"text-sm font-medium text-gray-900"},dU={class:"text-sm text-gray-500"},uU={class:"px-6 py-4 whitespace-nowrap"},cU={class:"text-sm text-gray-900"},mU={class:"text-sm text-gray-500"},pU={class:"px-6 py-4 whitespace-nowrap"},gU={class:"text-sm font-medium text-gray-900"},fU={class:"text-sm text-gray-500"},vU={class:"px-6 py-4 whitespace-nowrap"},xU={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},bU={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},yU=["onClick"],hU={class:"bg-white px-6 py-3 border-t border-gray-200 flex items-center justify-between"},_U={class:"text-sm text-gray-700"},wU={class:"font-medium"},$U={class:"font-medium"},kU={class:"font-medium"},CU={class:"flex space-x-2"},AU=["disabled"],PU=["disabled"],EU={key:0,class:"fixed inset-0 bg-gray-600 bg-opacity-40 overflow-y-auto h-full w-full z-50"},jU={class:"relative top-20 mx-auto p-5 border w-11/12 md:w-1/2 shadow-lg rounded-md bg-white"},SU={class:"mt-3"},IU={class:"flex justify-between items-center mb-4"},DU={key:0,class:"space-y-4"},TU={class:"grid grid-cols-2 gap-4"},MU={class:"text-sm text-gray-900"},LU={class:"text-sm text-gray-900"},VU={class:"text-sm text-gray-900"},RU={class:"text-sm text-gray-900"},FU={class:"text-sm text-gray-900"},NU={class:"mt-6 flex justify-end space-x-3"},zU={__name:"PaymentManagement",setup(_){const{get:y,post:w}=ge(),p=R(!1),f=R([]),a=de(()=>[{label:"Total des revenus",value:i(D.value.total_revenue)+" FCFA",change:D.value.revenue_change,icon:Ke,bgColor:"bg-green-100",iconColor:"text-green-600"},{label:"Transactions réussies",value:D.value.successful_transactions.toString(),change:D.value.transactions_change,icon:Xe,bgColor:"bg-blue-100",iconColor:"text-[#0099cc]"},{label:"Taux de réussite",value:D.value.success_rate+"%",change:D.value.success_rate_change,icon:Ct,bgColor:"bg-purple-100",iconColor:"text-purple-600"},{label:"Transactions échouées",value:D.value.failed_transactions.toString(),change:-Math.abs(D.value.failed_transactions/Math.max(D.value.successful_transactions,1)*100),icon:We,bgColor:"bg-red-100",iconColor:"text-red-600"}]),c=xe({search:"",status:"",startDate:"",endDate:""}),n=R(1),r=R(20),P=R(0),$=R(!1),M=R(null),D=R({total_revenue:0,current_month_revenue:0,revenue_change:0,successful_transactions:0,current_month_transactions:0,transactions_change:0,success_rate:0,success_rate_change:0,failed_transactions:0,pending_transactions:0}),m=de(()=>Math.ceil(P.value/r.value)),k=de(()=>(n.value-1)*r.value+1),U=de(()=>Math.min(n.value*r.value,P.value)),V=async()=>{p.value=!0;try{const ee=new URLSearchParams;ee.append("page",n.value),ee.append("per_page",r.value),c.search&&ee.append("search",c.search),c.status&&ee.append("status",c.status),c.startDate&&ee.append("start_date",c.startDate),c.endDate&&ee.append("end_date",c.endDate);const B=await y(`/admin/payments?${ee.toString()}`);B&&B.success&&B.data&&(f.value=B.data.payments||[],P.value=B.data.pagination?.total||0,B.data.stats&&(D.value=B.data.stats))}catch(ee){console.error("Error loading payments:",ee),window.$toast&&window.$toast.error("Erreur lors du chargement des paiements","✗ Erreur"),f.value=[],P.value=0}finally{p.value=!1}},v=()=>{n.value=1,V()},d=async()=>{try{const ee=await y("/admin/payments/stats");ee&&ee.success&&ee.data&&(D.value=ee.data)}catch(ee){console.error("Error loading payment stats:",ee)}},i=ee=>new Intl.NumberFormat("fr-FR").format(ee),C=ee=>new Date(ee).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),x=ee=>({pending:"admin-badge-warning",completed:"admin-badge-success",failed:"admin-badge-danger",refunded:"bg-gray-100 text-gray-800 px-2 py-1 text-xs font-medium rounded-full"})[ee]||"bg-gray-100 text-gray-800 px-2 py-1 text-xs font-medium rounded-full",I=ee=>({pending:"En attente",completed:"Complété",failed:"Échoué",refunded:"Remboursé"})[ee]||ee,N=ee=>{M.value=ee,$.value=!0},u=()=>{$.value=!1,M.value=null},A=async ee=>{if(confirm("Êtes-vous sûr de vouloir initier un remboursement pour cette transaction ?"))try{const B=await w(`/admin/payments/${ee.id}/refund`,{reason:"admin_initiated"});B&&B.success&&(window.$toast&&window.$toast.success("Remboursement initié avec succès","✅ Remboursement"),V(),u())}catch(B){if(console.error("Error initiating refund:",B),window.$toast){const S=B.response?.data?.message||"Erreur lors de l'initiation du remboursement";window.$toast.error(S,"✗ Erreur")}}},H=async()=>{try{const ee=new URLSearchParams;c.search&&ee.append("search",c.search),c.status&&ee.append("status",c.status),c.startDate&&ee.append("start_date",c.startDate),c.endDate&&ee.append("end_date",c.endDate);const B=await y(`/admin/payments/export?${ee.toString()}`);if(B&&B.success&&B.data){const S=new Blob([JSON.stringify(B.data,null,2)],{type:"application/json"}),E=URL.createObjectURL(S),F=document.createElement("a");F.href=E,F.download=`payments-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(E),window.$toast&&window.$toast.success("Export téléchargé avec succès","✅ Export")}}catch(ee){console.error("Error exporting payments:",ee),window.$toast&&window.$toast.error("Erreur lors de l'export","✗ Erreur")}},j=async()=>{await Promise.all([V(),d()])},h=()=>{n.value>1&&(n.value--,V())},b=()=>{n.value<m.value&&(n.value++,V())};return ve(()=>{V(),d()}),(ee,B)=>(s(),o("div",Dq,[e("div",Tq,[B[7]||(B[7]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"Gestion des Paiements"),e("p",{class:"mt-2 text-gray-600"},"Suivez et gérez toutes les transactions financières")],-1)),e("div",Mq,[e("button",{onClick:H,class:"admin-btn-secondary"},[g(l(dt),{class:"w-4 h-4 mr-2"}),B[5]||(B[5]=z(" Exporter ",-1))]),e("button",{onClick:j,class:"admin-btn-primary"},[g(l(Fe),{class:"w-4 h-4 mr-2"}),B[6]||(B[6]=z(" Actualiser ",-1))])])]),e("div",Lq,[(s(!0),o(ie,null,le(a.value,S=>(s(),o("div",{key:S.label,class:"admin-card hover:shadow-md transition-shadow duration-200"},[e("div",Vq,[e("div",{class:te(["p-3 rounded-lg",S.bgColor])},[(s(),ce(Ie(S.icon),{class:te(["w-6 h-6",S.iconColor])},null,8,["class"]))],2),e("div",Rq,[e("p",Fq,t(S.label),1),e("p",Nq,t(S.value),1)])]),e("div",zq,[e("div",qq,[e("span",{class:te(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",S.change>=0?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"])},[(s(),ce(Ie(S.change>=0?l(ps):l(gs)),{class:"w-3 h-3 mr-1"})),z(" "+t(Math.abs(S.change))+"% ",1)],2),B[8]||(B[8]=e("span",{class:"ml-2 text-gray-500"},"vs mois dernier",-1))])])]))),128))]),e("div",Uq,[e("div",Bq,[e("div",Oq,[B[9]||(B[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Recherche",-1)),e("div",Gq,[g(l(it),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),Q(e("input",{"onUpdate:modelValue":B[0]||(B[0]=S=>c.search=S),type:"text",placeholder:"Transaction ID, utilisateur...",class:"admin-input pl-10 w-full",onInput:v},null,544),[[ne,c.search]])])]),e("div",Hq,[B[11]||(B[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Statut",-1)),Q(e("select",{"onUpdate:modelValue":B[1]||(B[1]=S=>c.status=S),onChange:v,class:"admin-input w-full"},B[10]||(B[10]=[pe('<option value="">Tous les statuts</option><option value="pending">En attente</option><option value="completed">Complété</option><option value="failed">Échoué</option><option value="refunded">Remboursé</option>',5)]),544),[[me,c.status]])]),e("div",Kq,[B[12]||(B[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date début",-1)),Q(e("input",{"onUpdate:modelValue":B[2]||(B[2]=S=>c.startDate=S),type:"date",class:"admin-input w-full",onChange:v},null,544),[[ne,c.startDate]])]),e("div",Wq,[B[13]||(B[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Date fin",-1)),Q(e("input",{"onUpdate:modelValue":B[3]||(B[3]=S=>c.endDate=S),type:"date",class:"admin-input w-full",onChange:v},null,544),[[ne,c.endDate]])])])]),e("div",Jq,[B[21]||(B[21]=e("div",{class:"admin-card-header"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Transactions récentes")],-1)),p.value?(s(),o("div",Xq,B[14]||(B[14]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#0099cc]"},null,-1)]))):(s(),o("div",Yq,[e("table",Qq,[B[16]||(B[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Transaction "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Utilisateur "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Produit/Tombola "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Montant "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Statut "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Date "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Détails ")])],-1)),e("tbody",Zq,[(s(!0),o(ie,null,le(f.value,S=>(s(),o("tr",{key:S.id,class:"hover:bg-gray-50"},[e("td",eU,[e("div",tU,"#"+t(S.transaction_id),1),e("div",sU,t(S.payment_method),1)]),e("td",oU,[e("div",rU,[e("div",aU,[e("div",nU,[g(l(ze),{class:"h-4 w-4 text-gray-600"})])]),e("div",iU,[e("div",lU,t(S.user_name),1),e("div",dU,t(S.user_email),1)])])]),e("td",uU,[e("div",cU,t(S.product_name),1),e("div",mU,t(S.tickets_count)+" tickets",1)]),e("td",pU,[e("div",gU,t(i(S.amount)),1),e("div",fU,t(S.currency),1)]),e("td",vU,[e("span",{class:te(x(S.status))},t(I(S.status)),3)]),e("td",xU,t(C(S.created_at)),1),e("td",bU,[e("button",{onClick:E=>N(S),class:"inline-flex items-center px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors",title:"Voir détails"},[g(l(Ue),{class:"w-4 h-4 mr-1"}),B[15]||(B[15]=z(" Voir ",-1))],8,yU)])]))),128))])])])),e("div",hU,[e("div",_U,[B[17]||(B[17]=z(" Affichage de ",-1)),e("span",wU,t(k.value),1),B[18]||(B[18]=z(" à ",-1)),e("span",$U,t(U.value),1),B[19]||(B[19]=z(" sur ",-1)),e("span",kU,t(P.value),1),B[20]||(B[20]=z(" résultats ",-1))]),e("div",CU,[e("button",{onClick:h,disabled:n.value===1,class:"admin-btn-secondary disabled:opacity-50 disabled:cursor-not-allowed"}," Précédent ",8,AU),e("button",{onClick:b,disabled:n.value===m.value,class:"admin-btn-secondary disabled:opacity-50 disabled:cursor-not-allowed"}," Suivant ",8,PU)])])]),$.value?(s(),o("div",EU,[e("div",jU,[e("div",SU,[e("div",IU,[B[22]||(B[22]=e("h3",{class:"text-lg font-medium text-gray-900"},"Détails du paiement",-1)),e("button",{onClick:u,class:"text-gray-400 hover:text-gray-600"},[g(l(Le),{class:"w-6 h-6"})])]),M.value?(s(),o("div",DU,[e("div",TU,[e("div",null,[B[23]||(B[23]=e("label",{class:"block text-sm font-medium text-gray-700"},"ID Transaction",-1)),e("p",MU,t(M.value.transaction_id),1)]),e("div",null,[B[24]||(B[24]=e("label",{class:"block text-sm font-medium text-gray-700"},"Montant",-1)),e("p",LU,t(i(M.value.amount))+" "+t(M.value.currency),1)]),e("div",null,[B[25]||(B[25]=e("label",{class:"block text-sm font-medium text-gray-700"},"Statut",-1)),e("span",{class:te(x(M.value.status))},t(I(M.value.status)),3)]),e("div",null,[B[26]||(B[26]=e("label",{class:"block text-sm font-medium text-gray-700"},"Méthode",-1)),e("p",VU,t(M.value.payment_method),1)]),e("div",null,[B[27]||(B[27]=e("label",{class:"block text-sm font-medium text-gray-700"},"Date",-1)),e("p",RU,t(C(M.value.created_at)),1)]),e("div",null,[B[28]||(B[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"Utilisateur",-1)),e("p",FU,t(M.value.user_name),1)])])])):T("",!0),e("div",NU,[e("button",{onClick:u,class:"admin-btn-secondary"}," Fermer "),M.value?.status==="completed"?(s(),o("button",{key:0,onClick:B[4]||(B[4]=S=>A(M.value)),class:"admin-btn-accent"}," Initier remboursement ")):T("",!0)])])])])):T("",!0)]))}},qU=[{path:"/register",name:"register",component:_i,meta:{requiresGuest:!0}},{path:"/verify-email",name:"verify-email",component:Mi},{path:"/forgot-password",name:"forgot-password",component:ul,meta:{requiresGuest:!0}},{path:"/reset-password-verify",name:"reset-password-verify",component:Ol,meta:{requiresGuest:!0}},{path:"/",component:Uo,children:[{path:"",name:"home",component:ku},{path:"results",name:"public.results",component:Fc},{path:"verify",name:"public.verify",component:D0},{path:"history",name:"public.history",component:np},{path:"login",name:"login",component:Sn,meta:{requiresGuest:!0}},{path:"auth/callback",name:"auth.callback",component:()=>ye(()=>import("./SocialCallback-AoBdwr5X.js"),__vite__mapDeps([0,1]))},{path:"products",name:"public.products",component:Mg},{path:"products/:id",name:"public.product.detail",component:jv,props:!0},{path:"how-it-works",name:"public.how-it-works",component:Qx},{path:"contact",name:"public.contact",component:B1},{path:"about",name:"public.about",component:()=>ye(()=>import("./AboutPage-BfPk8n7C.js"),__vite__mapDeps([2,3,1,4]))},{path:"affiliates",name:"public.affiliates",component:()=>ye(()=>import("./AffiliatesPage-Dqy84FEV.js"),__vite__mapDeps([5,3,1,4]))},{path:"earn-gombos",name:"public.earn-gombos",component:()=>ye(()=>import("./EarnGombosPage-Dq_egy_T.js"),__vite__mapDeps([6,3,1,4]))},{path:"careers",name:"public.careers",component:()=>ye(()=>import("./CareersPage-BOT6cUeO.js"),__vite__mapDeps([7,3,1,4]))},{path:"media-press",name:"public.media-press",component:()=>ye(()=>import("./MediaPressPage-B3xmt4j3.js"),__vite__mapDeps([8,3,1,4]))},{path:"lottery-participation",name:"public.lottery-participation",component:()=>ye(()=>import("./StaticPage-sZ50idl1.js"),__vite__mapDeps([9,1,10]))},{path:"intellectual-property",name:"public.intellectual-property",component:()=>ye(()=>import("./StaticPage-sZ50idl1.js"),__vite__mapDeps([9,1,10]))},{path:"order-delivery",name:"public.order-delivery",component:()=>ye(()=>import("./StaticPage-sZ50idl1.js"),__vite__mapDeps([9,1,10]))},{path:"report-suspicious",name:"public.report-suspicious",component:()=>ye(()=>import("./ReportSuspiciousPage-CAi-c21J.js"),__vite__mapDeps([11,3,1,4]))},{path:"support-center",name:"public.support-center",component:()=>ye(()=>import("./SupportCenterPage-s284KxSu.js"),__vite__mapDeps([12,3,1,4]))},{path:"security-center",name:"public.security-center",component:()=>ye(()=>import("./SecurityCenterPage-BDRtdues.js"),__vite__mapDeps([13,3,1,4]))},{path:"peace-on-koumbaya",name:"public.peace-on-koumbaya",component:()=>ye(()=>import("./StaticPage-sZ50idl1.js"),__vite__mapDeps([9,1,10]))},{path:"sitemap",name:"public.sitemap",component:()=>ye(()=>import("./SitemapPage-DOx0cRFm.js"),__vite__mapDeps([14,3,1,4]))},{path:"sell-on-koumbaya",name:"public.sell-on-koumbaya",component:()=>ye(()=>import("./SellOnKoumbayaPage-BYqJopoZ.js"),__vite__mapDeps([15,3,1,4]))},{path:"terms",name:"public.terms",component:()=>ye(()=>import("./StaticPage-sZ50idl1.js"),__vite__mapDeps([9,1,10]))},{path:"privacy",name:"public.privacy",component:()=>ye(()=>import("./StaticPage-sZ50idl1.js"),__vite__mapDeps([9,1,10]))},{path:"legal",name:"public.legal",component:()=>ye(()=>import("./StaticPage-sZ50idl1.js"),__vite__mapDeps([9,1,10]))},{path:"cookies",name:"public.cookies",component:()=>ye(()=>import("./StaticPage-sZ50idl1.js"),__vite__mapDeps([9,1,10]))}]},{path:"/customer",component:Fr,meta:{requiresAuth:!0},children:[{path:"",name:"customer.dashboard",component:jb},{path:"products",name:"customer.products",component:Ub},{path:"products/:id",name:"customer.product.detail",component:eh,props:!0},{path:"profile",name:"customer.profile",component:C_},{path:"tickets",name:"customer.tickets",component:V2},{path:"refunds",name:"customer.refunds",component:r4},{path:"orders",name:"customer.orders",component:H$},{path:"payments",name:"customer.payments",component:E6},{path:"orders/:id",name:"customer.order.detail",component:v9,props:!0},{path:"payments/:id",name:"customer.payment.detail",component:Z8,props:!0},{path:"notifications",name:"customer.notifications",component:Vt}]},{path:"/payment/method",name:"payment.method",component:gC,meta:{requiresAuth:!0}},{path:"/payment/phone",name:"payment.phone",component:TC,meta:{requiresAuth:!0}},{path:"/payment/confirmation",name:"payment.confirmation",component:bA,meta:{requiresAuth:!1}},{path:"/admin",component:ka,meta:{requiresAuth:!0,role:"ADMIN"},children:[{path:"",name:"admin.dashboard",component:vP},{path:"users",name:"admin.users",component:HE},{path:"products",name:"admin.products",component:eS},{path:"products/:id",name:"admin.product.detail",component:()=>ye(()=>import("./ProductDetail-qXPDV2YY.js"),__vite__mapDeps([16,1,17]))},{path:"lotteries",name:"admin.lotteries",component:oD},{path:"settings",name:"admin.settings",component:OM},{path:"profile",name:"admin.profile",component:eV},{path:"orders",name:"admin.orders",component:Iq},{path:"vendors",name:"admin.vendors",component:()=>ye(()=>import("./VendorManagement-5QaNbqpw.js"),__vite__mapDeps([18,1]))},{path:"refunds",name:"admin.refunds",component:lz},{path:"payments",name:"admin.payments",component:zU},{path:"notifications",name:"admin.notifications",component:Vt}]},{path:"/merchant",component:()=>ye(()=>import("./MerchantLayout-C2y0N1NL.js"),__vite__mapDeps([19,1])),meta:{requiresAuth:!0,role:"MERCHANT"},children:[{path:"",redirect:"dashboard"},{path:"dashboard",name:"merchant.dashboard",component:()=>ye(()=>import("./Dashboard-BcwoiFUd.js"),__vite__mapDeps([20,1]))},{path:"simple-dashboard",name:"merchant.simple-dashboard",component:()=>ye(()=>import("./SimpleMerchantDashboard-VFCQcKMc.js"),__vite__mapDeps([21,1,22]))},{path:"products",name:"merchant.products",component:()=>ye(()=>import("./Products-Bf7b80ZG.js"),__vite__mapDeps([23,1]))},{path:"products/create",name:"merchant.products.create",component:()=>ye(()=>import("./CreateProduct-sOWsXud8.js"),__vite__mapDeps([24,1,25,26]))},{path:"products/:id/edit",name:"merchant.products.edit",component:()=>ye(()=>import("./EditProduct-Bh6xDyRa.js"),__vite__mapDeps([27,1,25,26])),props:!0},{path:"orders",name:"merchant.orders",component:()=>ye(()=>import("./Orders-1TRg_Rjw.js"),__vite__mapDeps([28,1]))},{path:"lotteries",name:"merchant.lotteries",component:()=>ye(()=>import("./LotteriesSimple-Bxxcn9jO.js"),__vite__mapDeps([29,1]))},{path:"lotteries/:id",name:"merchant.lottery.view",component:()=>ye(()=>import("./LotteryView-CRCulJSv.js"),__vite__mapDeps([30,1,31])),props:!0},{path:"refunds",name:"merchant.refunds",component:()=>ye(()=>import("./Refunds-DfIkMl3i.js"),__vite__mapDeps([32,1]))},{path:"analytics",name:"merchant.analytics",component:()=>ye(()=>import("./Analytics-ekh6dkST.js"),__vite__mapDeps([33,1]))},{path:"settings",name:"merchant.settings",component:()=>ye(()=>import("./Settings-DVcOkgJV.js"),__vite__mapDeps([34,1]))},{path:"profile",name:"merchant.profile",component:()=>ye(()=>import("./Profile-BDUaS-RC.js"),__vite__mapDeps([35,1]))},{path:"notifications",name:"merchant.notifications",component:Vt}]},{path:"/notifications",name:"notifications",redirect:_=>{const y=Pe();if(!y.isAuthenticated)return{name:"login"};switch(y.user?.role?.name?.toLowerCase()){case"admin":case"super_admin":return{name:"admin.notifications"};case"merchant":return{name:"merchant.notifications"};case"customer":default:return{name:"customer.notifications"}}}}],Wt=Qs({history:Zs(),routes:qU});Wt.beforeEach(async(_,y,w)=>{const p=Pe();if(p.initializing){let f=0;for(;p.initializing&&f<100;)await new Promise(a=>setTimeout(a,50)),f++}if(_.meta.requiresAuth&&!p.isAuthenticated){const f=_.fullPath;w({name:"login",query:{redirect:encodeURIComponent(f)}});return}if(_.meta.requiresGuest&&p.isAuthenticated){const f=p.getDefaultRedirect();w({name:f});return}if(_.meta.role&&p.isAuthenticated&&!UU(_.meta.role,p)){const a=p.getDefaultRedirect();w({name:a});return}w()});function UU(_,y){switch(_){case"ADMIN":return y.isAdmin;case"MERCHANT":return y.isMerchant;case"CUSTOMER":return y.isCustomer;default:return!1}}const BU={class:"fixed top-4 right-4 z-50 space-y-2"},OU={class:"flex-shrink-0"},GU={class:"ml-3 flex-1"},HU={key:0,class:"text-sm font-semibold mb-1"},KU={class:"text-sm"},WU=["onClick"],JU={__name:"Toast",setup(_,{expose:y}){const w=R([]);let p=0;const f={success:Re,error:kt,warning:We,info:Oe},a=V=>f[V]||Oe,c=V=>{const v="bg-white/90 border-l-4",d={success:"border-blue-500 text-blue-900",error:"border-red-500 text-red-900",warning:"border-orange-500 text-orange-900",info:"border-blue-500 text-blue-900"};return`${v} ${d[V]||d.info}`},n=V=>{const v={success:"text-blue-600",error:"text-red-600",warning:"text-orange-600",info:"text-blue-600"};return v[V]||v.info},r=V=>{const v={success:"bg-blue-500",error:"bg-red-500",warning:"bg-orange-500",info:"bg-blue-500"};return v[V]||v.info},P=({title:V,message:v,type:d="info",duration:i=5e3})=>{const C=++p,x={id:C,title:V,message:v,type:d,duration:i};return w.value.push(x),i>0&&setTimeout(()=>{$(C)},i),C},$=V=>{const v=w.value.findIndex(d=>d.id===V);v>-1&&w.value.splice(v,1)},M=()=>{w.value=[]},D=(V,v="Succès")=>P({title:v,message:V,type:"success"}),m=(V,v="Erreur")=>P({title:v,message:V,type:"error"}),k=(V,v="Attention")=>P({title:v,message:V,type:"warning"}),U=(V,v="Information")=>P({title:v,message:V,type:"info"});return y({addToast:P,removeToast:$,clearAll:M,showSuccess:D,showError:m,showWarning:k,showInfo:U}),ve(()=>{window.$toast={success:D,error:m,warning:k,info:U,add:P,remove:$,clear:M}}),st(()=>{delete window.$toast}),(V,v)=>(s(),ce(to,{to:"body"},[e("div",BU,[g(eo,{name:"toast",tag:"div",class:"space-y-2"},{default:re(()=>[(s(!0),o(ie,null,le(w.value,d=>(s(),o("div",{key:d.id,class:te([c(d.type),"flex items-start p-4 rounded-xl shadow-lg border backdrop-blur-sm max-w-sm transition-all duration-300"])},[e("div",OU,[(s(),ce(Ie(a(d.type)),{class:te([n(d.type),"w-5 h-5"])},null,8,["class"]))]),e("div",GU,[d.title?(s(),o("h4",HU,t(d.title),1)):T("",!0),e("p",KU,t(d.message),1)]),e("button",{onClick:i=>$(d.id),class:"flex-shrink-0 ml-2 p-1 rounded-lg hover:bg-black/5 transition-colors"},[g(l(Le),{class:"w-4 h-4 text-gray-400 hover:text-gray-600"})],8,WU),d.duration?(s(),o("div",{key:0,class:te([r(d.type),"absolute bottom-0 left-0 h-1 rounded-b-xl transition-all duration-linear"]),style:Me({width:"100%",animationDuration:d.duration+"ms",animationName:"toast-progress"})},null,6)):T("",!0)],2))),128))]),_:1})])]))}},XU=Ee(JU,[["__scopeId","data-v-583315c0"]]),YU={id:"app"},QU={__name:"App",setup(_){const y=Pe();return ve(async()=>{await y.checkAuth()}),(w,p)=>{const f=he("router-view");return s(),o("div",YU,[g(f),g(XU,{ref:"toastRef"},null,512)])}}},Jt=so(QU),ZU=oo();window.router=Wt;Jt.use(ZU);Jt.use(Wt);Jt.mount("#app");export{ks as A,vs as K,bs as N,tt as P,xs as V,Ee as _,ge as a,bt as b,fs as c,He as d,Gl as e,tB as f,sB as g,Pe as u};
