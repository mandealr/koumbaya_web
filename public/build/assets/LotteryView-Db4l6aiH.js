import{r as T,c as y,P as at,b as c,l as f,o as u,e as t,g as r,i as _,u as i,G as N,t as o,aj as nt,at as W,a0 as R,ah as rt,a1 as I,ag as lt,O as it,x as dt,U as O,V as B,K as ut,j as ct,z as mt,w as U,h as gt,v as vt,a7 as pt,aR as xt,D as _t,I as ft,A as yt,ak as bt,a6 as G,s as wt,an as ht,aF as kt,b3 as $t,F as Dt,y as Tt,aw as jt}from"./vendor-jx2CZFIM.js";import{a as J}from"./app-FQGCXZh0.js";const Et={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Ct={class:"flex items-center justify-center min-h-screen px-4 text-center sm:block sm:p-0"},Mt={class:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle bg-white shadow-xl transform transition-all rounded-xl"},Pt={class:"flex items-center justify-between mb-6"},Nt={class:"text-lg font-semibold text-gray-900 flex items-center"},Ft={key:0,class:"text-center py-8"},At={class:"text-sm text-gray-500"},Lt={key:1,class:"text-center py-6"},St={class:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},Vt={class:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},qt={class:"text-lg font-bold text-green-900"},zt={class:"text-sm text-green-700"},Rt={key:2,class:"text-center py-6"},It={class:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},Ot={class:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4"},Bt={class:"text-red-800"},Ut={key:3,class:"space-y-4"},Gt={class:"bg-gray-50 rounded-lg p-4"},Wt={class:"font-semibold text-gray-900 mb-2"},Jt={class:"grid grid-cols-2 gap-4 text-sm"},Kt={class:"font-medium ml-1"},Ht={class:"font-medium ml-1"},Qt={class:"font-medium ml-1"},Xt={class:"font-medium ml-1"},Yt={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Zt={class:"font-medium text-blue-900 mb-2 flex items-center"},te={class:"text-sm text-blue-800 space-y-1"},ee={key:0,class:"flex items-center"},se={key:1,class:"flex items-center"},oe={key:2,class:"flex items-center"},ae={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},ne={class:"flex"},re={key:4,class:"flex justify-end gap-3 mt-6"},le=["disabled"],A=1,ie={__name:"LotteryDrawModal",props:{show:{type:Boolean,default:!1},lottery:{type:Object,default:()=>({})}},emits:["close","drawn"],setup(x,{emit:j}){const $=x,s=j,{post:b}=J(),m=T(!1),d=T(null),w=T(""),g=y(()=>$.lottery.sold_tickets>=$.lottery.max_tickets),D=y(()=>g.value&&$.lottery.participants_count>=A),M=v=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(v||0)+" FCFA",P=()=>{m.value||s("close")},L=async()=>{if(D.value){m.value=!0,d.value=null;try{w.value="V√©rification des conditions...",await new Promise(n=>setTimeout(n,500)),w.value="Collecte des tickets participants...",await new Promise(n=>setTimeout(n,800)),w.value="G√©n√©ration du tirage al√©atoire v√©rifiable...",await new Promise(n=>setTimeout(n,1e3)),w.value="S√©lection du gagnant...";const v=await b(`/lotteries/${$.lottery.id}/draw`);if(v.success!==!1)d.value={success:!0,lottery:v.lottery,winning_ticket:v.winning_ticket,verification_hash:v.verification_hash},s("drawn",d.value),window.$toast&&window.$toast.success("Tirage effectu√© avec succ√®s !","üéâ Gagnant s√©lectionn√©");else throw new Error(v.error||"Erreur lors du tirage")}catch(v){console.error("Erreur lors du tirage:",v),d.value={success:!1,error:v.response?.data?.error||v.message||"Une erreur inattendue s'est produite"},window.$toast&&window.$toast.error(d.value.error,"‚ùå Erreur de tirage")}finally{m.value=!1,w.value=""}}};return at(()=>$.show,v=>{v||setTimeout(()=>{m.value=!1,d.value=null,w.value=""},300)}),(v,n)=>x.show?(u(),c("div",Et,[t("div",Ct,[t("div",{class:"fixed inset-0 bg-gray-600 bg-opacity-50 transition-opacity",onClick:n[0]||(n[0]=q=>!m.value&&P())}),t("div",Mt,[t("div",Pt,[t("h3",Nt,[r(i(N),{class:"w-6 h-6 text-purple-600 mr-2"}),_(" "+o(m.value?"Tirage en cours...":"Effectuer le tirage"),1)]),m.value?f("",!0):(u(),c("button",{key:0,onClick:P,class:"text-gray-400 hover:text-gray-600"},[r(i(nt),{class:"w-6 h-6"})]))]),m.value?(u(),c("div",Ft,[n[1]||(n[1]=t("div",{class:"animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600 mx-auto mb-4"},null,-1)),n[2]||(n[2]=t("p",{class:"text-gray-600 mb-2"},"S√©lection du gagnant en cours...",-1)),t("p",At,o(w.value),1)])):d.value&&d.value.success?(u(),c("div",Lt,[t("div",St,[r(i(W),{class:"w-8 h-8 text-green-600"})]),n[4]||(n[4]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-2"},"üéâ Tirage termin√© !",-1)),t("div",Vt,[n[3]||(n[3]=t("p",{class:"text-green-800 font-medium"},"Gagnant :",-1)),t("p",qt,o(d.value.winning_ticket.user.first_name)+" "+o(d.value.winning_ticket.user.last_name),1),t("p",zt,"Ticket N¬∞ "+o(d.value.winning_ticket.ticket_number),1)]),n[5]||(n[5]=t("p",{class:"text-sm text-gray-600 mb-4"},"Le gagnant a √©t√© automatiquement notifi√© par email.",-1))])):d.value&&!d.value.success?(u(),c("div",Rt,[t("div",It,[r(i(R),{class:"w-8 h-8 text-red-600"})]),n[6]||(n[6]=t("h4",{class:"text-lg font-semibold text-gray-900 mb-2"},"Erreur lors du tirage",-1)),t("div",Ot,[t("p",Bt,o(d.value.error||"Une erreur inattendue s'est produite"),1)])])):(u(),c("div",Ut,[t("div",Gt,[t("h4",Wt,o(x.lottery.title),1),t("div",Jt,[t("div",null,[n[7]||(n[7]=t("span",{class:"text-gray-600"},"Participants :",-1)),t("span",Kt,o(x.lottery.participants_count),1)]),t("div",null,[n[8]||(n[8]=t("span",{class:"text-gray-600"},"Tickets vendus :",-1)),t("span",Ht,o(x.lottery.sold_tickets)+"/"+o(x.lottery.max_tickets),1)]),t("div",null,[n[9]||(n[9]=t("span",{class:"text-gray-600"},"Valeur du lot :",-1)),t("span",Qt,o(M(x.lottery.product_value)),1)]),t("div",null,[n[10]||(n[10]=t("span",{class:"text-gray-600"},"Revenus g√©n√©r√©s :",-1)),t("span",Xt,o(M(x.lottery.total_revenue)),1)])])]),t("div",Yt,[t("h5",Zt,[r(i(rt),{class:"w-5 h-5 mr-2"}),n[11]||(n[11]=_(" Conditions de tirage ",-1))]),t("ul",te,[g.value?(u(),c("li",ee,[r(i(I),{class:"w-4 h-4 text-green-600 mr-2"}),n[12]||(n[12]=_(" Tous les tickets sont vendus ",-1))])):f("",!0),x.lottery.participants_count>=A?(u(),c("li",se,[r(i(I),{class:"w-4 h-4 text-green-600 mr-2"}),_(" Minimum de participants atteint ("+o(x.lottery.participants_count)+"/"+o(A)+") ",1)])):(u(),c("li",oe,[r(i(lt),{class:"w-4 h-4 text-red-600 mr-2"}),_(" Participants insuffisants ("+o(x.lottery.participants_count)+"/"+o(A)+") ",1)]))])]),t("div",ae,[t("div",ne,[r(i(R),{class:"w-5 h-5 text-yellow-600 mr-2 mt-0.5"}),n[13]||(n[13]=t("div",{class:"text-sm text-yellow-800"},[t("p",{class:"font-medium mb-1"},"‚ö†Ô∏è Action irr√©versible"),t("p",null,"Une fois le tirage effectu√©, il ne pourra plus √™tre modifi√©. Le gagnant sera automatiquement notifi√© et le produit sera marqu√© comme vendu.")],-1))])])])),m.value?f("",!0):(u(),c("div",re,[t("button",{onClick:P,class:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"},o(d.value?"Fermer":"Annuler"),1),d.value?f("",!0):(u(),c("button",{key:0,onClick:L,disabled:!D.value,class:"px-6 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center"},[r(i(N),{class:"w-4 h-4 mr-2"}),n[14]||(n[14]=_(" Effectuer le tirage ",-1))],8,le))]))])])])):f("",!0)}},de={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},ue={class:"flex items-center justify-center min-h-screen px-4 text-center"},ce={class:"koumbaya-card inline-block w-full max-w-md my-8 overflow-hidden text-left align-middle bg-white shadow-xl transform transition-all"},me={class:"koumbaya-form-group"},ge={class:"koumbaya-form-group"},ve={__name:"LotteryExtendModal",props:{show:{type:Boolean,default:!1},lottery:{type:Object,default:()=>({})}},emits:["close","submit"],setup(x,{emit:j}){const $=x,s=j,b=it({newDrawDate:"",reason:""}),m=()=>{s("close")},d=()=>{s("submit",{lotteryId:$.lottery.id,...b})};return(w,g)=>x.show?(u(),c("div",de,[t("div",ue,[t("div",{class:"fixed inset-0 bg-gray-600 bg-opacity-40 transition-opacity",onClick:m}),t("div",ce,[g[5]||(g[5]=t("div",{class:"koumbaya-card-header"},[t("h3",{class:"koumbaya-heading-4"},"Prolonger la tombola")],-1)),t("form",{onSubmit:dt(d,["prevent"]),class:"koumbaya-card-body space-y-4"},[t("div",me,[g[2]||(g[2]=t("label",{class:"koumbaya-label"},"Nouvelle date de tirage",-1)),O(t("input",{"onUpdate:modelValue":g[0]||(g[0]=D=>b.newDrawDate=D),type:"datetime-local",required:"",class:"koumbaya-input"},null,512),[[B,b.newDrawDate]])]),t("div",ge,[g[3]||(g[3]=t("label",{class:"koumbaya-label"},"Raison de la prolongation",-1)),O(t("textarea",{"onUpdate:modelValue":g[1]||(g[1]=D=>b.reason=D),rows:"3",class:"koumbaya-input",placeholder:"Expliquez pourquoi vous prolongez cette tombola...",required:""},null,512),[[B,b.reason]])]),t("div",{class:"koumbaya-card-footer"},[t("div",{class:"flex gap-4"},[t("button",{type:"button",onClick:m,class:"koumbaya-btn koumbaya-btn-outline flex-1"}," Annuler "),g[4]||(g[4]=t("button",{type:"submit",class:"koumbaya-btn koumbaya-btn-primary flex-1"}," Prolonger ",-1))])])],32)])])])):f("",!0)}},pe={class:"space-y-6"},xe={class:"flex justify-between items-start"},_e={class:"flex items-center space-x-3 mb-2"},fe={class:"text-3xl font-bold text-gray-900"},ye={class:"flex space-x-3"},be={class:"grid grid-cols-1 md:grid-cols-4 gap-6"},we={class:"bg-white p-6 rounded-xl shadow-sm border"},he={class:"flex items-center"},ke={class:"p-3 bg-blue-100 rounded-lg"},$e={class:"ml-4"},De={class:"text-2xl font-bold text-gray-900"},Te={class:"bg-white p-6 rounded-xl shadow-sm border"},je={class:"flex items-center"},Ee={class:"p-3 bg-blue-100 rounded-lg"},Ce={class:"ml-4"},Me={class:"text-2xl font-bold text-gray-900"},Pe={class:"bg-white p-6 rounded-xl shadow-sm border"},Ne={class:"flex items-center"},Fe={class:"p-3 bg-purple-100 rounded-lg"},Ae={class:"ml-4"},Le={class:"text-2xl font-bold text-gray-900"},Se={class:"bg-white p-6 rounded-xl shadow-sm border"},Ve={class:"flex items-center"},qe={class:"p-3 bg-yellow-100 rounded-lg"},ze={class:"ml-4"},Re={class:"text-2xl font-bold text-gray-900"},Ie={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Oe={class:"lg:col-span-2 space-y-6"},Be={class:"bg-white rounded-xl shadow-sm border overflow-hidden"},Ue={class:"p-6"},Ge={class:"flex space-x-6"},We={class:"flex-shrink-0"},Je=["src","alt"],Ke={class:"flex-1"},He={class:"text-xl font-semibold text-gray-900 mb-2"},Qe={class:"text-gray-600 mb-4"},Xe={class:"grid grid-cols-2 gap-4"},Ye={class:"text-lg font-semibold text-gray-900"},Ze={class:"text-lg font-semibold text-gray-900"},ts={class:"text-lg font-semibold text-gray-900"},es={class:"text-lg font-semibold text-gray-900"},ss={class:"bg-white rounded-xl shadow-sm border"},os={class:"p-6"},as={class:"space-y-4"},ns={class:"flex justify-between items-center mb-2"},rs={class:"text-sm text-gray-500"},ls={class:"w-full bg-gray-200 rounded-full h-2"},is={class:"flex justify-between items-center mb-2"},ds={class:"text-sm text-gray-500"},us={class:"text-xs text-gray-600"},cs={key:0},ms={class:"flex justify-between items-center mb-2"},gs={class:"text-sm text-gray-500"},vs={class:"w-full bg-gray-200 rounded-full h-2"},ps={class:"mt-6 grid grid-cols-3 gap-4 text-center"},xs={class:"p-4 bg-blue-50 rounded-lg"},_s={class:"text-2xl font-bold text-blue-600"},fs={class:"p-4 bg-blue-50 rounded-lg"},ys={class:"text-2xl font-bold text-blue-600"},bs={class:"p-4 bg-yellow-50 rounded-lg"},ws={class:"text-2xl font-bold text-yellow-600"},hs={key:0,class:"bg-green-50 border border-green-200 rounded-xl p-4"},ks={class:"flex items-center space-x-3"},$s={class:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center"},Ds={class:"text-sm text-green-600"},Ts={key:1,class:"bg-white rounded-xl shadow-sm border"},js={class:"px-6 py-4 border-b border-gray-200"},Es={class:"text-lg font-semibold text-gray-900 flex items-center"},Cs={class:"p-6"},Ms={class:"flex items-center space-x-4"},Ps={class:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center"},Ns={class:"font-semibold text-gray-900"},Fs={class:"text-sm text-gray-600"},As={class:"space-y-6"},Ls={class:"bg-white rounded-xl shadow-sm border"},Ss={class:"p-6 space-y-3"},Vs={class:"bg-white rounded-xl shadow-sm border"},qs={class:"px-6 py-4 border-b border-gray-200"},zs={class:"flex justify-between items-center"},Rs={class:"p-6"},Is={class:"space-y-3"},Os={class:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center"},Bs={class:"text-sm font-medium text-gray-600"},Us={class:"flex-1 min-w-0"},Gs={class:"text-sm font-medium text-gray-900 truncate"},Ws={class:"text-xs text-gray-500"},Js={class:"text-sm text-gray-500"},Ks={class:"bg-white rounded-xl shadow-sm border"},Hs={class:"p-6"},Qs={class:"space-y-4"},Xs={class:"flex justify-between"},Ys={class:"text-sm font-medium text-gray-900"},Zs={class:"flex justify-between"},to={class:"text-sm font-medium text-gray-900"},eo={class:"flex justify-between"},so={class:"text-sm font-medium text-gray-900"},oo={class:"flex justify-between"},ao={class:"text-sm font-medium text-blue-600"},lo={__name:"LotteryView",setup(x){const j=ut(),{get:$}=J(),s=T({id:j.params.id,title:"",description:"",status:"",product_value:0,ticket_price:0,category:"",participants_count:0,tickets_sold:0,total_revenue:0,max_participants:0,revenue_target:0,end_date:"",created_at:"",views_count:0,product_image:"",winner:null,draw_date:null,product:null,lottery_number:"",max_tickets:0,sold_tickets:0,progress_percentage:0}),b=T([]),m=T(!1),d=T(!1),w=T(!1),g=y(()=>s.value.max_tickets?Math.min(s.value.sold_tickets/s.value.max_tickets*100,100):0),D=y(()=>s.value.revenue_target?Math.min(s.value.total_revenue/s.value.revenue_target*100,100):0),M=y(()=>!s.value.views_count||s.value.views_count===0?0:(s.value.participants_count/s.value.views_count*100).toFixed(1)),P=y(()=>s.value.participants_count===0?0:s.value.total_revenue/s.value.participants_count),L=y(()=>{const a=s.value.product_value;return((s.value.total_revenue-a)/a*100).toFixed(1)}),v=y(()=>{if(!s.value.end_date)return"Non d√©finie";try{const a=new Date,e=new Date(s.value.end_date);if(isNaN(e.getTime()))return"Date invalide";const p=e-a;if(p<=0)return"Termin√©e";const l=Math.floor(p/(1e3*60*60*24)),h=Math.floor(p%(1e3*60*60*24)/(1e3*60*60));return l>0?`${l}j ${h}h`:`${h}h`}catch(a){return console.error("Error calculating time remaining:",a),"Erreur de calcul"}}),n=y(()=>{if(!s.value.end_date)return 0;try{const a=new Date,e=new Date(s.value.end_date);if(isNaN(e.getTime()))return 0;const p=e-a;return p<=0?0:Math.ceil(p/(1e3*60*60*24))}catch(a){return console.error("Error calculating days remaining:",a),0}}),q=y(()=>{try{const a=s.value.status==="active",e=!s.value.winning_ticket_number,p=s.value.sold_tickets>=s.value.max_tickets;let l=!1;if(s.value.draw_date){const h=new Date(s.value.draw_date);isNaN(h.getTime())||(l=h<=new Date)}return a&&e&&(p||l)}catch(a){return console.error("Error calculating canDraw:",a),!1}}),z=y(()=>{try{const a=s.value.status==="active",e=!s.value.winning_ticket_number,p=s.value.sold_tickets>=s.value.max_tickets;let l=!1;if(s.value.draw_date){const h=new Date(s.value.draw_date);isNaN(h.getTime())||(l=h>new Date)}return a&&e&&p&&l}catch(a){return console.error("Error calculating canDrawManually:",a),!1}}),K=a=>({active:"Active",completed:"Termin√©e",pending:"En attente",paused:"En pause",cancelled:"Annul√©e"})[a]||a,E=a=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(a||0)+" FCFA",S=a=>{if(!a)return"Non d√©finie";try{const e=new Date(a);return isNaN(e.getTime())?"Date invalide":new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(e)}catch(e){return console.error("Error formatting date:",e),"Erreur de format"}},H=()=>{const a=`${window.location.origin}/lottery/${s.value.id}`;navigator.clipboard.writeText(a),window.$toast&&window.$toast.success("Lien de partage copi√© dans le presse-papiers!","‚úÖ Partage")},Q=()=>{window.$toast&&window.$toast.info("Fonctionnalit√© de t√©l√©chargement en cours de d√©veloppement","üöÄ En d√©veloppement")},X=()=>{window.$toast&&window.$toast.info("Mise en pause de la tombola...","‚è∏Ô∏è Pause")},Y=()=>{m.value=!0},Z=a=>{console.log("Tirage termin√©:",a),a&&a.success&&a.lottery&&(s.value={...s.value,...a.lottery,status:"completed",is_drawn:!0,winner_user_id:a.winning_ticket?.user_id,winner_ticket_number:a.winning_ticket?.ticket_number,winner:a.winning_ticket?.user,draw_date:new Date().toISOString()}),setTimeout(()=>{V()},1e3),setTimeout(()=>{m.value=!1},3e3)},tt=()=>{d.value=!1,V()},V=async()=>{try{const a=await $(`/lotteries/${j.params.id}`);if(a?.lottery){const e=a.lottery;console.log("LotteryData:",e),console.log("Available keys:",Object.keys(e));const p=new Set,l=e.paid_tickets||e.paidTickets||e.tickets||[];console.log("PaidTickets:",l),console.log("PaidTickets length:",l.length),l.forEach(k=>{k.user?.id&&p.add(k.user.id)});const h=p.size,et=(e.sold_tickets||0)*(e.ticket_price||0),F=new Map;l.forEach(k=>{if(k.user?.id){const C=k.user.id,ot=`${k.user.first_name||""} ${k.user.last_name||""}`.trim();F.has(C)?F.get(C).tickets_count++:F.set(C,{id:C,name:ot||"Utilisateur anonyme",participated_at:k.created_at||new Date().toISOString(),tickets_count:1})}});const st=Array.from(F.values()).sort((k,C)=>new Date(C.participated_at)-new Date(k.participated_at)).slice(0,5);s.value={...s.value,id:e.id,title:e.title,description:e.description||"",status:e.status,lottery_number:e.lottery_number,ticket_price:e.ticket_price||0,max_tickets:e.max_tickets||0,sold_tickets:e.sold_tickets||0,progress_percentage:e.progress_percentage||0,draw_date:e.draw_date,created_at:e.created_at,tickets_sold:e.sold_tickets||0,participants_count:h,total_revenue:et,max_participants:e.max_tickets||0,end_date:e.draw_date,revenue_target:e.revenue_target||null,views_count:e.views_count||0,product:e.product,product_value:e.product?.price||0,category:e.product?.category?.name||"",product_image:e.product?.image_url||e.product?.image||"",winner:e.winner||null,winning_ticket_number:e.winning_ticket_number||null},b.value=st}}catch(a){console.error("Erreur lors du chargement de la tombola:",a),window.$toast&&window.$toast.error("Erreur lors du chargement des donn√©es de la tombola")}};return ct(()=>{V()}),(a,e)=>{const p=gt("router-link");return u(),c("div",pe,[t("div",xe,[t("div",null,[t("div",_e,[r(p,{to:"/merchant/lotteries",class:"text-gray-500 hover:text-gray-700"},{default:U(()=>[r(i(jt),{class:"w-5 h-5"})]),_:1}),t("h1",fe,o(s.value.title),1),t("span",{class:vt(["px-3 py-1 rounded-full text-sm font-medium",s.value.status==="active"||s.value.status==="completed"?"bg-blue-100 text-blue-800":s.value.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"])},o(K(s.value.status)),3)]),e[5]||(e[5]=t("p",{class:"text-gray-600"},"G√©rez votre tombola et suivez les participations",-1))]),t("div",ye,[s.value.status==="active"?(u(),c("button",{key:0,onClick:e[0]||(e[0]=l=>d.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center whitespace-nowrap"},[r(i(pt),{class:"w-4 h-4 mr-2 flex-shrink-0"}),e[6]||(e[6]=_(" Prolonger ",-1))])):f("",!0),s.value.status==="active"&&q.value?(u(),c("button",{key:1,onClick:e[1]||(e[1]=l=>m.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center whitespace-nowrap"},[r(i(N),{class:"w-4 h-4 mr-2 flex-shrink-0"}),e[7]||(e[7]=_(" Effectuer le tirage ",-1))])):f("",!0),t("button",{onClick:e[2]||(e[2]=l=>w.value=!0),class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 flex items-center whitespace-nowrap"},[r(i(xt),{class:"w-4 h-4 mr-2 flex-shrink-0"}),e[8]||(e[8]=_(" Modifier ",-1))])])]),t("div",be,[t("div",we,[t("div",he,[t("div",ke,[r(i(_t),{class:"w-6 h-6 text-blue-600"})]),t("div",$e,[e[9]||(e[9]=t("p",{class:"text-sm font-medium text-gray-600"},"Participants",-1)),t("p",De,o(s.value.participants_count),1)])])]),t("div",Te,[t("div",je,[t("div",Ee,[r(i(ft),{class:"w-6 h-6 text-blue-600"})]),t("div",Ce,[e[10]||(e[10]=t("p",{class:"text-sm font-medium text-gray-600"},"Revenus g√©n√©r√©s",-1)),t("p",Me,o(E(s.value.total_revenue)),1)])])]),t("div",Pe,[t("div",Ne,[t("div",Fe,[r(i(yt),{class:"w-6 h-6 text-purple-600"})]),t("div",Ae,[e[11]||(e[11]=t("p",{class:"text-sm font-medium text-gray-600"},"Tickets vendus",-1)),t("p",Le,o(s.value.tickets_sold),1)])])]),t("div",Se,[t("div",Ve,[t("div",qe,[r(i(bt),{class:"w-6 h-6 text-yellow-600"})]),t("div",ze,[e[12]||(e[12]=t("p",{class:"text-sm font-medium text-gray-600"},"Temps restant",-1)),t("p",Re,o(v.value),1)])])])]),t("div",Ie,[t("div",Oe,[t("div",Be,[e[17]||(e[17]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Informations du produit")],-1)),t("div",Ue,[t("div",Ge,[t("div",We,[t("img",{src:s.value.product_image||"/images/products/placeholder.jpg",alt:s.value.title,class:"w-32 h-32 object-cover rounded-lg"},null,8,Je)]),t("div",Ke,[t("h4",He,o(s.value.title),1),t("p",Qe,o(s.value.description),1),t("div",Xe,[t("div",null,[e[13]||(e[13]=t("p",{class:"text-sm font-medium text-gray-500"},"Valeur du produit",-1)),t("p",Ye,o(E(s.value.product_value)),1)]),t("div",null,[e[14]||(e[14]=t("p",{class:"text-sm font-medium text-gray-500"},"Prix du ticket",-1)),t("p",Ze,o(E(s.value.ticket_price)),1)]),t("div",null,[e[15]||(e[15]=t("p",{class:"text-sm font-medium text-gray-500"},"Cat√©gorie",-1)),t("p",ts,o(s.value.category?.name||s.value.category||"Sans cat√©gorie"),1)]),t("div",null,[e[16]||(e[16]=t("p",{class:"text-sm font-medium text-gray-500"},"Date de fin",-1)),t("p",es,o(S(s.value.end_date)),1)])])])])])]),t("div",ss,[e[24]||(e[24]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Progression")],-1)),t("div",os,[t("div",as,[t("div",null,[t("div",ns,[e[18]||(e[18]=t("span",{class:"text-sm font-medium text-gray-700"},"Objectif de tickets",-1)),t("span",rs,o(s.value.sold_tickets)+" / "+o(s.value.max_tickets),1)]),t("div",ls,[t("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:G({width:g.value+"%"})},null,4)])]),t("div",null,[t("div",is,[e[19]||(e[19]=t("span",{class:"text-sm font-medium text-gray-700"},"Participants uniques",-1)),t("span",ds,o(s.value.participants_count)+" personnes",1)]),t("div",us," Moyenne: "+o(s.value.participants_count>0?(s.value.sold_tickets/s.value.participants_count).toFixed(1):0)+" tickets/personne ",1)]),s.value.revenue_target?(u(),c("div",cs,[t("div",ms,[e[20]||(e[20]=t("span",{class:"text-sm font-medium text-gray-700"},"Objectif de revenus",-1)),t("span",gs,o(E(s.value.total_revenue))+" / "+o(E(s.value.revenue_target)),1)]),t("div",vs,[t("div",{class:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:G({width:D.value+"%"})},null,4)])])):f("",!0)]),t("div",ps,[t("div",xs,[t("p",_s,o(g.value)+"%",1),e[21]||(e[21]=t("p",{class:"text-sm text-blue-600"},"Tickets vendus",-1))]),t("div",fs,[t("p",ys,o(M.value)+"%",1),e[22]||(e[22]=t("p",{class:"text-sm text-blue-600"},"Conversion",-1))]),t("div",bs,[t("p",ws,o(n.value),1),e[23]||(e[23]=t("p",{class:"text-sm text-yellow-600"},"Jours restants",-1))])])])]),z.value?(u(),c("div",hs,[t("div",ks,[t("div",$s,[r(i(N),{class:"w-5 h-5 text-green-600"})]),t("div",null,[e[25]||(e[25]=t("h4",{class:"text-md font-semibold text-green-800"},"Tirage possible !",-1)),t("p",Ds," Tous les tickets sont vendus ("+o(s.value.sold_tickets)+"/"+o(s.value.max_tickets)+'). Vous pouvez effectuer le tirage maintenant dans "Actions rapides". ',1)])])])):f("",!0),s.value.winner?(u(),c("div",Ts,[t("div",js,[t("h3",Es,[r(i(W),{class:"w-5 h-5 text-yellow-500 mr-2"}),e[26]||(e[26]=_(" Gagnant ",-1))])]),t("div",Cs,[t("div",Ms,[t("div",Ps,[r(i(wt),{class:"w-6 h-6 text-yellow-600"})]),t("div",null,[t("p",Ns,o(s.value.winner.name),1),t("p",Fs,"Tirage effectu√© le "+o(S(s.value.draw_date)),1)])]),e[27]||(e[27]=t("div",{class:"mt-4 p-4 bg-yellow-50 rounded-lg"},[t("p",{class:"text-sm text-yellow-800"}," F√©licitations ! Le gagnant a √©t√© contact√© automatiquement par email. ")],-1))])])):f("",!0)]),t("div",As,[t("div",Ls,[e[32]||(e[32]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Actions rapides")],-1)),t("div",Ss,[t("button",{onClick:H,class:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},[r(i(ht),{class:"w-4 h-4 mr-2"}),e[28]||(e[28]=_(" Partager la tombola ",-1))]),t("button",{onClick:Q,class:"w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700"},[r(i(kt),{class:"w-4 h-4 mr-2"}),e[29]||(e[29]=_(" T√©l√©charger le rapport ",-1))]),z.value?(u(),c("button",{key:0,onClick:Y,class:"w-full flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"},[r(i(N),{class:"w-4 h-4 mr-2"}),e[30]||(e[30]=_(" Effectuer le tirage maintenant ",-1))])):f("",!0),s.value.status==="active"?(u(),c("button",{key:1,onClick:X,class:"w-full flex items-center justify-center px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"},[r(i($t),{class:"w-4 h-4 mr-2"}),e[31]||(e[31]=_(" Mettre en pause ",-1))])):f("",!0)])]),t("div",Vs,[t("div",qs,[t("div",zs,[e[34]||(e[34]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Participants r√©cents",-1)),r(p,{to:`/merchant/lotteries/${s.value.id}/participants`,class:"text-sm text-blue-600 hover:text-blue-700"},{default:U(()=>e[33]||(e[33]=[_(" Voir tout ",-1)])),_:1,__:[33]},8,["to"])])]),t("div",Rs,[t("div",Is,[(u(!0),c(Dt,null,Tt(b.value,l=>(u(),c("div",{key:l.id,class:"flex items-center space-x-3"},[t("div",Os,[t("span",Bs,o(l.name.charAt(0)),1)]),t("div",Us,[t("p",Gs,o(l.name),1),t("p",Ws,o(S(l.participated_at)),1)]),t("div",Js,o(l.tickets_count)+" ticket"+o(l.tickets_count>1?"s":""),1)]))),128))])])]),t("div",Ks,[e[39]||(e[39]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-semibold text-gray-900"},"Statistiques")],-1)),t("div",Hs,[t("div",Qs,[t("div",Xs,[e[35]||(e[35]=t("span",{class:"text-sm text-gray-600"},"Vues de la tombola",-1)),t("span",Ys,o(s.value.views_count||"N/A"),1)]),t("div",Zs,[e[36]||(e[36]=t("span",{class:"text-sm text-gray-600"},"Taux de conversion",-1)),t("span",to,o(M.value)+"%",1)]),t("div",eo,[e[37]||(e[37]=t("span",{class:"text-sm text-gray-600"},"Panier moyen",-1)),t("span",so,o(E(P.value)),1)]),t("div",oo,[e[38]||(e[38]=t("span",{class:"text-sm text-gray-600"},"Retour sur investissement",-1)),t("span",ao,"+"+o(L.value)+"%",1)])])])])])]),r(ie,{show:m.value,lottery:s.value,onClose:e[3]||(e[3]=l=>m.value=!1),onDrawn:Z},null,8,["show","lottery"]),d.value?(u(),mt(ve,{key:0,lottery:s.value,onClose:e[4]||(e[4]=l=>d.value=!1),onExtended:tt},null,8,["lottery"])):f("",!0)])}}};export{lo as default};
