import{r as v,c,D as Q,L as G,N as H,M as J,O as X,aK as Y,aP as S,j as Z,k as ee,b as l,e,U as A,g as i,l as te,w as f,h as V,F as _,z as y,t as n,u as D,m as se,T as ae,W as j,s as re,o as r,A as x,i as g,V as w,x as B,v as ne,p as oe}from"./vendor-Bi4LjMey.js";import{u as le,a as ie,N as ce,V as ue,K as de,d as me}from"./app-DkfTsk_6.js";const he={class:"min-h-screen bg-gray-50"},ve={class:"bg-white shadow-sm border-b border-gray-200"},fe={class:"mx-auto px-4 sm:px-6 lg:px-8"},xe={class:"flex justify-between h-16"},pe={class:"flex"},ge={class:"flex-shrink-0 flex items-center min-w-0"},be={key:1,class:"flex items-center space-x-1"},_e={class:"ml-1 sm:ml-2 text-xs sm:text-sm text-[#0099cc] font-medium whitespace-nowrap"},ye={class:"hidden sm:ml-6 sm:flex sm:space-x-8"},we={class:"flex items-center space-x-2 sm:space-x-4"},ke={class:"relative ml-1 sm:ml-3"},Ce={class:"h-7 w-7 sm:h-8 sm:w-8 rounded-full overflow-hidden flex-shrink-0 border border-gray-200"},$e=["src","alt"],Fe={key:1,class:"w-full h-full bg-blue-100 flex items-center justify-center"},Ee={class:"text-xs sm:text-sm font-medium text-blue-600"},Ie={class:"ml-2 sm:ml-3 text-gray-700 text-xs sm:text-sm font-medium hidden lg:block min-w-0 truncate"},Ne={class:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50"},Se={class:"py-1"},Ae={class:"sm:hidden"},Ve={class:"pt-2 pb-3 space-y-1"},De={class:"max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8"},je={key:0,class:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 lg:hidden z-40"},Be={class:"flex justify-around text-center"},Me={class:"text-lg font-semibold text-gray-900"},Re={class:"text-lg font-semibold text-blue-600"},Ke={class:"text-lg font-semibold text-purple-600"},Te={__name:"MerchantLayout",setup(Le){const M=re(),p=le(),{get:k}=ie(),d=v(!1),C=v(!1),$=v(!1),m=v({products:"0",lotteries:"0",revenue:"0 FCFA"}),F=c(()=>{const s=[{name:h.value?"Mon Espace Vendeur":"Dashboard",href:h.value?"/merchant/simple-dashboard":"/merchant/dashboard",icon:Q},{name:"Articles",href:"/merchant/products",icon:G},{name:"Commandes",href:"/merchant/orders",icon:H}];return h.value||s.push({name:"Tombolas",href:"/merchant/lotteries",icon:J},{name:"Remboursements",href:"/merchant/refunds",icon:X},{name:"Statistiques",href:"/merchant/analytics",icon:Y}),s.push({name:"Paramètres",href:"/merchant/settings",icon:S}),s}),R=[{name:"Profil",href:"/merchant/profile",icon:ne},{name:"Paramètres",href:"/merchant/settings",icon:S}],o=c(()=>p.user),K=c(()=>{if(!o.value)return"U";const s=o.value.first_name?.[0]||"",t=o.value.last_name?.[0]||"";return(s+t).toUpperCase()}),h=c(()=>p.hasRole("Business Individual"));c(()=>p.hasRole("Business Enterprise"));const L=c(()=>h.value?"Vendeur":"Marchand"),P=c(()=>h.value?"/merchant/simple-dashboard":"/merchant/dashboard"),O=c(()=>window.innerWidth<1024),E=v(0),T=async()=>{await p.logout(),M.push({name:"login"})},z=()=>{$.value=!0},U=s=>{console.log("Avatar image failed to load, hiding image element"),s.target.style.display="none"},I=async()=>{try{const t=(await k("/merchant/dashboard/stats")).data;m.value={products:t.total_products?.toString()||"0",lotteries:t.active_lotteries?.toString()||"0",revenue:W(t.revenue_this_month||0)}}catch(s){console.error("Erreur lors du chargement des stats rapides:",s),m.value={products:"0",lotteries:"0",revenue:"0 FCFA"}}},N=async()=>{try{const s=await k("/notifications/unread-count");s&&s.data&&s.data.unread_count!==void 0&&(E.value=s.data.unread_count)}catch(s){console.error("Erreur lors du chargement des notifications:",s),E.value=0}},W=s=>new Intl.NumberFormat("fr-FR",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s||0)+" FCFA";return Z(()=>{I(),N();const s=setInterval(N,120*1e3),t=setInterval(I,300*1e3),u=b=>{b.target.closest(".relative")||(d.value=!1)};document.addEventListener("click",u),ee(()=>{document.removeEventListener("click",u),clearInterval(s),clearInterval(t)})}),(s,t)=>{const u=V("router-link"),b=V("router-view");return r(),l("div",he,[e("nav",ve,[e("div",fe,[e("div",xe,[e("div",pe,[e("div",ge,[i(u,{to:P.value,class:"flex items-center"},{default:f(()=>[$.value?(r(),l("div",be,t[3]||(t[3]=[e("div",{class:"w-5 h-5 sm:w-6 sm:h-6 bg-[#0099cc] rounded flex items-center justify-center flex-shrink-0"},[e("span",{class:"text-white font-bold text-xs sm:text-sm"},"K")],-1),e("span",{class:"text-sm sm:text-lg font-bold text-[#0099cc] whitespace-nowrap"},"Koumbaya",-1)]))):(r(),l("img",{key:0,class:"h-6 sm:h-8 w-auto object-contain max-w-none",src:me,alt:"Koumbaya",onError:z},null,32)),e("span",_e,n(L.value),1)]),_:1},8,["to"])]),e("div",ye,[(r(!0),l(_,null,y(F.value,a=>(r(),x(u,{key:a.name,to:a.href,class:B(["inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium",s.$route.path.startsWith(a.href)?"border-[#0099cc] text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},{default:f(()=>[(r(),x(w(a.icon),{class:"w-4 h-4 mr-2"})),g(" "+n(a.name),1)]),_:2},1032,["to","class"]))),128))])]),e("div",we,[i(ce),e("div",ke,[e("div",null,[e("button",{onClick:t[0]||(t[0]=a=>d.value=!d.value),class:"flex items-center max-w-xs bg-white rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#0099cc]"},[t[4]||(t[4]=e("span",{class:"sr-only"},"Open user menu",-1)),e("div",Ce,[o.value?.avatar_url?(r(),l("img",{key:0,src:o.value.avatar_url,alt:`Photo de profil de ${o.value.first_name} ${o.value.last_name}`,class:"w-full h-full object-cover",onError:U},null,40,$e)):(r(),l("div",Fe,[e("span",Ee,n(K.value),1)]))]),e("span",Ie,n(o.value?.first_name)+" "+n(o.value?.last_name),1),i(D(se),{class:"ml-1 sm:ml-2 h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"})])]),i(ae,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:f(()=>[A(e("div",Ne,[e("div",Se,[(r(),l(_,null,y(R,a=>i(u,{key:a.name,to:a.href,onClick:t[1]||(t[1]=q=>d.value=!1),class:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},{default:f(()=>[(r(),x(w(a.icon),{class:"w-4 h-4 mr-3"})),g(" "+n(a.name),1)]),_:2},1032,["to"])),64)),e("button",{onClick:T,class:"flex items-center w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},[i(D(oe),{class:"w-4 h-4 mr-3"}),t[5]||(t[5]=g(" Déconnexion ",-1))])])],512),[[j,d.value]])]),_:1})])])])])]),A(e("div",Ae,[e("div",Ve,[(r(!0),l(_,null,y(F.value,a=>(r(),x(u,{key:a.name,to:a.href,onClick:t[2]||(t[2]=q=>C.value=!1),class:B(["block pl-3 pr-4 py-2 border-l-4 text-base font-medium",s.$route.path.startsWith(a.href)?"bg-blue-50 border-blue-500 text-blue-700":"border-transparent text-gray-500 hover:bg-gray-100 hover:border-gray-300 hover:text-gray-700"])},{default:f(()=>[(r(),x(w(a.icon),{class:"w-5 h-5 mr-3 inline"})),g(" "+n(a.name),1)]),_:2},1032,["to","class"]))),128))])],512),[[j,C.value]]),e("main",De,[i(ue),i(b)]),i(de),O.value?(r(),l("div",je,[e("div",Be,[e("div",null,[e("div",Me,n(m.value.products),1),t[6]||(t[6]=e("div",{class:"text-xs text-gray-600"},"Articles",-1))]),e("div",null,[e("div",Re,n(m.value.lotteries),1),t[7]||(t[7]=e("div",{class:"text-xs text-gray-600"},"Tirages spéciaux",-1))]),e("div",null,[e("div",Ke,n(m.value.revenue),1),t[8]||(t[8]=e("div",{class:"text-xs text-gray-600"},"Revenus",-1))])])])):te("",!0)])}}};export{Te as default};
